<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>è§£è€¦ç¥å™¨ä¹‹è§‚å¯Ÿè€…æ¨¡å¼</title>
      <link href="/post/5b3d1989.html"/>
      <url>/post/5b3d1989.html</url>
      
        <content type="html"><![CDATA[<p>å¤§å®¶æ˜¯ä¸æ˜¯ä¼šç»å¸¸å¬åˆ°æœ‰äººè¯´å†™ä»£ç è¦â€œé«˜å†…èšã€ä½è€¦åˆâ€ï¼Œä½†æ˜¯ä½ è¦æ˜¯é—®ä»–ä»€ä¹ˆæ˜¯é«˜å†…èšä½è€¦åˆï¼ˆwahtï¼‰ï¼Ÿä¸ºä»€ä¹ˆè¦é«˜å†…èšã€ä½è€¦åˆ(why)ï¼Ÿæ€ä¹ˆåšæ‰èƒ½é«˜å†…èšã€ä½è€¦åˆ(how)? è¿™äº›é—®é¢˜å°±ä¸ä¸€å®šéƒ½èƒ½å›ç­”çš„äº†ï¼</p><a id="more"></a><blockquote><p>ç™¾åº¦ç™¾ç§‘ï¼šåœ¨è½¯ä»¶è®¾è®¡ä¸­é€šå¸¸ç”¨è€¦åˆåº¦å’Œå†…èšåº¦ä½œä¸ºè¡¡é‡æ¨¡å—ç‹¬ç«‹ç¨‹åº¦çš„æ ‡å‡†ã€‚åˆ’åˆ†æ¨¡å—çš„ä¸€ä¸ªå‡†åˆ™æ˜¯é«˜å†…èšä½è€¦åˆã€‚<br>ä»æ¨¡å—ç²’åº¦æ¥çœ‹ï¼Œé«˜å†…èšï¼šå°½å¯èƒ½ç±»çš„æ¯ä¸ªæˆå‘˜æ–¹æ³•åªå®Œæˆä¸€ä»¶äº‹ï¼ˆæœ€å¤§é™åº¦çš„èšåˆï¼‰ï¼› ä½è€¦åˆï¼šå‡å°‘ç±»å†…éƒ¨ï¼Œä¸€ä¸ªæˆå‘˜æ–¹æ³•è°ƒç”¨å¦ä¸€ä¸ªæˆå‘˜æ–¹æ³•ã€‚<br>ä»ç±»è§’åº¦æ¥çœ‹ï¼Œ é«˜å†…èšä½è€¦åˆï¼šå‡å°‘ç±»å†…éƒ¨ï¼Œå¯¹å…¶ä»–ç±»çš„è°ƒç”¨ï¼›<br>ä»åŠŸèƒ½å—æ¥çœ‹ï¼Œé«˜å†…èšä½è€¦åˆï¼šå‡å°‘æ¨¡å—ä¹‹é—´çš„äº¤äº’å¤æ‚åº¦ï¼ˆæ¥å£æ•°é‡ï¼Œå‚æ•°æ•°æ®ï¼‰å³æ¨ªå‘ï¼šç±»ä¸ç±»ä¹‹é—´ã€æ¨¡å—ä¸æ¨¡å—ä¹‹é—´ï¼›çºµå‘ï¼šå±‚æ¬¡ä¹‹é—´ï¼›å°½å¯èƒ½ï¼Œå†…å®¹å†…èšï¼Œæ•°æ®è€¦åˆã€‚</p></blockquote><p>æˆ‘æœ¬äººç‰¹åˆ«å–œæ¬¢æè¿æ°æ¼”çš„è¿™ä¸€ç‰ˆéœå…ƒç”²ï¼Œä»–å¹´å°‘è½»ç‹‚ï¼Œå¥½å‹‡æ–—ç‹ ï¼Œå‹‡äº‰æ´¥é—¨ç¬¬ä¸€ï¼Œä¸­å¹´å®¶ç ´äººäº¡ï¼Œæµè½ä»–ä¹¡æ‚Ÿå‡ºäº†ä¾ çš„çœŸè°›ï¼Œæˆä¸ºçœŸæ­£çš„å¤§ä¾ éœå…ƒç”²ã€‚å½“ç„¶æˆ‘ä¸å¤ªå¸Œæœ›æˆ‘çš„ä¸€ç”Ÿè¿™ä¹ˆæ³¢è¡èµ·ä¼ï¼Œå› ä¸ºæˆ‘æ²¡æœ‰ä»–é‚£ä¹ˆå‰å®³ã€‚ä½†æ˜¯æˆ‘ç‰¹åˆ«å–œæ¬¢å‰§ä¸­çš„ä¸€å¥å°è¯ï¼Œå°±æ˜¯â€œ<strong>åŠŸå¤«æ˜¯éœ€è¦æ—¶é—´å»ç£¨ç»ƒå‡ºæ¥çš„ï¼Œä¸¤ä¸‰å¹´çš„çŒ«è„šåŠŸå¤«ï¼Œè¿™ä¸€æ‹³20å¹´çš„åŠŸå¤«ï¼Œä½ ä»¬æŒ¡å¾—ä½ä¹ˆï¼Ÿ</strong>ã€‚ä½œä¸ºä¸€ä½ç¨‹åºå‘˜ï¼Œæˆ‘ä»¬å¯¹ä¸šåŠ¡çš„ç†è§£ã€ç³»ç»Ÿçš„è®¾è®¡ã€ä»£ç å®ç°è¿™äº›èƒ½åŠ›ä¹Ÿæ˜¯éœ€è¦ç£¨ç»ƒçš„ï¼Œè€Œä¸”ä¹Ÿè¦æ—¥å¤ä¸€æ—¥çš„ç»ƒä¹ ï¼Œä¸ç„¶ä½ æ€ä¹ˆæŒ¡å¾—ä½é¢è¯•å®˜20å¹´çš„åŠŸå¤«ã€‚ğŸ˜„ğŸ˜„</p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210206152451.png" alt="éœå…ƒç”²" style="zoom:30%;" /><p>æœ¬æ–‡å¯¹äºä»€ä¹ˆæ˜¯é«˜å†…èšä½è€¦åˆï¼ˆwahtï¼‰ï¼Ÿä¸ºä»€ä¹ˆè¦é«˜å†…èšã€ä½è€¦åˆ(why)ï¼ŸæŒ‰ä¸‹ä¸è¡¨ï¼Œå°±å…ˆè¯´è¯´ä¸€ç§èƒ½å¤Ÿè®©ä½ çš„ä»£ç é«˜å†…èšä½è€¦åˆçš„æ–¹æ³•ï¼š <strong>è§‚å¯Ÿè€…æ¨¡å¼</strong>,è¿™ç§è®¾è®¡æ¨¡å¼æˆ‘è®¤ä¸ºå°±å’Œç­–ç•¥æ¨¡å¼ä¸€æ ·çš„å¸¸ç”¨ï¼Œè¿™ä¸¤ç§è®¾è®¡æ¨¡å¼ä¸ä»…å®ç°èµ·æ¥ç®€å•ï¼Œè€Œä¸”æ•ˆæœè¿˜å¥½ï¼å…¶ä¸­çš„è§‚å¯Ÿè€…æ¨¡å¼<strong>ç®€ç›´æ˜¯é™ä½æ¨¡å—è€¦åˆæ€§æé«˜æˆ‘ä»¬ä»£ç é€¼æ ¼çš„ç¥å¥‡å•Šï¼</strong> é‚£æ¥ä¸‹æ¥å°±å…ˆè¯´è¯´è§‚å¯Ÿè€…æ¨¡å¼ç»„æˆè§’è‰²ï¼š</p><h5 id="æŠ½è±¡ä¸»é¢˜-Subject"><a href="#æŠ½è±¡ä¸»é¢˜-Subject" class="headerlink" title="æŠ½è±¡ä¸»é¢˜(Subject)"></a>æŠ½è±¡ä¸»é¢˜(Subject)</h5><p>å®ƒæŠŠæ‰€æœ‰è§‚å¯Ÿè€…å¯¹è±¡çš„å¼•ç”¨ä¿å­˜åˆ°ä¸€ä¸ªå®¹å™¨é‡Œï¼Œæ¯ä¸ªä¸»é¢˜éƒ½å¯ä»¥æœ‰ä»»ä½•æ•°é‡çš„è§‚å¯Ÿè€…ã€‚æŠ½è±¡ä¸»é¢˜æä¾›ä¸€ä¸ªæ¥å£ï¼Œå¯ä»¥å¢åŠ å’Œåˆ é™¤è§‚å¯Ÿè€…å¯¹è±¡ã€‚</p><h5 id="å…·ä½“ä¸»é¢˜-ConcreteSubject"><a href="#å…·ä½“ä¸»é¢˜-ConcreteSubject" class="headerlink" title="å…·ä½“ä¸»é¢˜(ConcreteSubject)"></a>å…·ä½“ä¸»é¢˜(ConcreteSubject)</h5><p>å°†æœ‰å…³çŠ¶æ€å­˜å…¥å…·ä½“è§‚å¯Ÿè€…å¯¹è±¡ï¼›åœ¨å…·ä½“ä¸»é¢˜å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶ï¼Œç»™æ‰€æœ‰ç™»è®°è¿‡çš„è§‚å¯Ÿè€…å‘å‡ºé€šçŸ¥ã€‚</p><h5 id="æŠ½è±¡æŠ½è±¡è§‚å¯Ÿè€…-Observer"><a href="#æŠ½è±¡æŠ½è±¡è§‚å¯Ÿè€…-Observer" class="headerlink" title="æŠ½è±¡æŠ½è±¡è§‚å¯Ÿè€…(Observer)"></a>æŠ½è±¡æŠ½è±¡è§‚å¯Ÿè€…(Observer)</h5><p>ä¸ºæ‰€æœ‰çš„å…·ä½“è§‚å¯Ÿè€…å®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œåœ¨å¾—åˆ°ä¸»é¢˜é€šçŸ¥æ—¶æ›´æ–°è‡ªå·±ã€‚</p><h5 id="å…·ä½“è§‚å¯Ÿè€…-ConcreteObserver"><a href="#å…·ä½“è§‚å¯Ÿè€…-ConcreteObserver" class="headerlink" title="å…·ä½“è§‚å¯Ÿè€…(ConcreteObserver)"></a>å…·ä½“è§‚å¯Ÿè€…(ConcreteObserver)</h5><p>å®ç°æŠ½è±¡è§‚å¯Ÿè€…è§’è‰²æ‰€è¦æ±‚çš„æ›´æ–°æ¥å£ï¼Œä»¥ä¾¿ä½¿æœ¬èº«çš„çŠ¶æ€ä¸ä¸»é¢˜çŠ¶æ€åè°ƒã€‚</p><h6 id="JavaåŸç”Ÿå®ç°"><a href="#JavaåŸç”Ÿå®ç°" class="headerlink" title="JavaåŸç”Ÿå®ç°"></a>JavaåŸç”Ÿå®ç°</h6><p>Javaä»JDK1.0å¼€å§‹å°±è‡ªå¸¦äº† <code>java.util.Observer</code> å’Œ <code>java.util.Observable</code> ,ç›¸å…³æ¥å£ã€ç±»æ¥å®ç°è§‚å¯Ÿè€…æ¨¡å¼ï¼Œç”±æ­¤å¯è§Javaå¯¹äºè§‚å¯Ÿè€…æ¨¡å¼çš„é‡è§†ï¼Œä¹Ÿä»å¦ä¸€æ–¹é¢è¯´æ˜è§‚å¯Ÿè€…æ¨¡å¼æ˜¯å¤šä¹ˆé‡è¦ã€‚é‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬å¼€å§‹ç”¨Javaè‡ªå¸¦çš„æ¥å®ç°è§‚å¯Ÿè€…æ¨¡å¼çš„ç¼–ç ã€‚</p><p>åœ¨è¿™é‡Œæˆ‘ä»¬ä»¥ä¸€ä¸ªä¸‹å•çš„åœºæ™¯æ¥ä¸¾ä¾‹æè¿°ï¼Œç”¨æˆ·åˆ›å»ºå®Œè®¢å•ï¼Œè¦å‘é€ä¸€ä¸ªæ¶ˆæ¯é€šçŸ¥ç”¨æˆ·è®¢å•åˆ›å»ºæˆåŠŸï¼Œè¿˜è¦å‘é€ä¸€ä¸ªæ¶ˆæ¯ç»™ä»“åº“ï¼Œæ£€æŸ¥å¯¹åº”çš„è®¢å•å•†å“ã€‚å…·ä½“ä»£ç å¦‚ä¸‹ã€‚</p><h4 id="1-ç»§æ‰¿java-util-Observableå®šä¹‰ä¸»é¢˜"><a href="#1-ç»§æ‰¿java-util-Observableå®šä¹‰ä¸»é¢˜" class="headerlink" title="1. ç»§æ‰¿java.util.Observableå®šä¹‰ä¸»é¢˜"></a>1. ç»§æ‰¿<code>java.util.Observable</code>å®šä¹‰ä¸»é¢˜</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderSubject</span> <span class="keyword">extends</span> <span class="title">Observable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¢å•çŠ¶æ€å‘ç”Ÿå˜åŒ–é€šçŸ¥å…¶ä»–ï¼Œ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String status;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getStatus</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> status;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStatus</span><span class="params">(String status)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.status = status;</span><br><span class="line">        <span class="comment">// é€šçŸ¥å…¶ä»–</span></span><br><span class="line">        <span class="keyword">this</span>.setChanged();</span><br><span class="line">        <span class="comment">// è¿™é‡Œæ˜¯å¯ä»¥æºå¸¦ä¸€äº›é¢å¤–çš„å‚æ•°</span></span><br><span class="line">        <span class="keyword">this</span>.notifyObservers();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-å®ç°java-util-Observeræ¥å£å®šä¹‰è§‚å¯Ÿè€…"><a href="#2-å®ç°java-util-Observeræ¥å£å®šä¹‰è§‚å¯Ÿè€…" class="headerlink" title="2. å®ç°java.util.Observeræ¥å£å®šä¹‰è§‚å¯Ÿè€…"></a>2. å®ç°<code>java.util.Observer</code>æ¥å£å®šä¹‰è§‚å¯Ÿè€…</h4><p><code>java.util.Observer</code> æ˜¯ä¸€ä¸ªæ¥å£ï¼Œæ¥å£ä¸­åªæœ‰ä¸€ä¸ª <code>update</code> æ–¹æ³•ã€‚æ¯å½“æ›´æ”¹è¢«è§‚å¯Ÿå¯¹è±¡æ—¶ï¼Œéƒ½ä¼šè°ƒç”¨æ­¤æ–¹æ³•ã€‚ åº”ç”¨ç¨‹åºè°ƒç”¨Observableå¯¹è±¡çš„ <code>notifyObservers</code>æ–¹æ³•ï¼Œä»¥å°†æ›´æ”¹é€šçŸ¥ç»™æ‰€æœ‰å¯¹è±¡çš„è§‚å¯Ÿè€…ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­é€šçŸ¥æ¨¡å—ã€ä»“åº“æ¨¡å—å°±æ˜¯æ‰®æ¼”è§‚å¯Ÿè€…çš„è§’è‰²ï¼Œå…·ä½“çš„ä»£ç å®ç°å¦‚ä¸‹ï¼š</p><ul><li>é€šçŸ¥æ¨¡å—å®ç°<code>java.util.Observer</code>æ¥å£</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NoticeObserver</span> <span class="keyword">implements</span> <span class="title">Observer</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(Observable o, Object arg)</span> </span>&#123;</span><br><span class="line">        OrderSubject orderSubject = (OrderSubject) o;</span><br><span class="line">        log.info(<span class="string">"é€šçŸ¥ä¸­å¿ƒæ”¶åˆ°äº†è®¢å•çš„å˜åŒ–[&#123;&#125;],arg = [&#123;&#125;]"</span>, orderSubject.getStatus(),arg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ä»“åº“æ¨¡å—å®ç°<code>java.util.Observer</code>æ¥å£</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WareHouseObserver</span> <span class="keyword">implements</span> <span class="title">Observer</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(Observable observable, Object arg)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        OrderSubject orderSubject = (OrderSubject) observable;</span><br><span class="line">        log.info(<span class="string">"ä»“åº“è§‚å¯Ÿè€…æ”¶åˆ°äº†è®¢å•çš„å˜åŒ–[&#123;&#125;],arg = [&#123;&#125;]"</span>, orderSubject.getStatus(), arg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-ä»£ç ç¼–å†™å®Œæˆï¼Œæµ‹è¯•ä¸€æŠŠ"><a href="#3-ä»£ç ç¼–å†™å®Œæˆï¼Œæµ‹è¯•ä¸€æŠŠ" class="headerlink" title="3. ä»£ç ç¼–å†™å®Œæˆï¼Œæµ‹è¯•ä¸€æŠŠ"></a>3. ä»£ç ç¼–å†™å®Œæˆï¼Œæµ‹è¯•ä¸€æŠŠ</h4><p>å…·ä½“æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ObserverTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">        OrderSubject orderSubject = <span class="keyword">new</span> OrderSubject();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é€šçŸ¥ç³»ç»Ÿç›‘å¬è€…</span></span><br><span class="line">        NoticeObserver noticeObserver = <span class="keyword">new</span> NoticeObserver();</span><br><span class="line">        orderSubject.addObserver(noticeObserver);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä»“åº“ç›‘å¬è€…</span></span><br><span class="line">        WareHouseObserver wareHouseObserver = <span class="keyword">new</span> WareHouseObserver();</span><br><span class="line">        orderSubject.addObserver(wareHouseObserver);</span><br><span class="line">         <span class="comment">// è®¢å•åˆ›å»º</span></span><br><span class="line">        orderSubject.setStatus(<span class="string">"è®¢å•åˆ›å»ºå•¦"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è®¢å•ä»˜æ¬¾</span></span><br><span class="line">        orderSubject.setStatus(<span class="string">"è®¢å•ä»˜æ¬¾å•¦"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è®¢å•çš„çŠ¶æ€å‘ç”Ÿäº†å˜åŒ–ï¼Œå¯¹åº”çš„è§‚å¯Ÿè€…å°±æ¥å—åˆ°äº†é€šçŸ¥ã€‚JDKæä¾›çš„å®ç°å¾ˆç®€å•ï¼Œä½†æ˜¯ç¼ºé™·ä¹Ÿæ˜¯å¾ˆæ˜æ˜¾ã€‚</p><ul><li><p><code>Observable</code> æ˜¯ä¸€ä¸ªç±»ï¼Œä¸æ˜¯ä¸€ä¸ªæ¥å£ï¼Œä¹Ÿä¸æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œä¸ç»§æ‰¿è¯¥ç±»æ— æ³•ä½¿ç”¨æƒé™ç±»å‹ä¸º protected çš„<code>setChanged()</code>å’Œ <code>clearChanged()</code>æ–¹æ³•ã€‚</p></li><li><p>ç”¨<code>Vector&lt;Observer&gt;</code>ä¿å­˜è§‚å¯Ÿè€…ã€‚<code>Vector</code>æ•ˆç‡ä½ä¸‹ï¼ŒJDKå·²ç»ä¸å»ºè®®ä½¿ç”¨äº†ã€‚</p></li><li><p>ä¸»é¢˜å˜åŒ–é€šçŸ¥è§‚å¯Ÿè€…çš„é¡ºåºæ— æ³•è‡ªå®šä¹‰ã€‚é€šçŸ¥çš„é¡ºåºæ˜¯å›ºå®šä¸ºæŒ‰ç…§è®¾ç½®è§‚å¯Ÿè€…çš„æ—¶é—´å€’å™é€šçŸ¥ï¼Œæ— æ³•è‡ªå®šä¹‰ã€‚</p></li><li><p>æ•´ä½“ä»£ç æ‰§è¡Œæ˜¯åŒæ­¥çš„ï¼Œä¸èƒ½è®¾ç½®ä¸ºå¼‚æ­¥ã€‚ä¸”è§‚å¯Ÿè€…çš„æ‰§è¡Œå‡ºç°å¼‚å¸¸ï¼Œç¨‹åºå¤„ç†ä¸åˆ°ä½ä¼šå¯¼è‡´<strong>äº‹åŠ¡å›æ»š</strong>ã€‚</p></li></ul><p>æ—¢ç„¶JDKä¸­å®ç°ä¸å¤Ÿå®Œç¾ï¼Œæˆ‘ä»¬å°±çœ‹çœ‹æœ‰æ²¡æœ‰å…¶ä»–çš„å®ç°æ–¹å¼ã€‚Googleçš„Guavaå·¥å…·åŒ…æä¾›äº†EventBuså¯ä»¥å®ç°ã€Springæ¡†æ¶ä¸­ä¹Ÿæä¾›äº†ç›¸åº”çš„æ”¯æŒï¼Œç”±äºæˆ‘ä»¬ä½¿ç”¨Springæ¡†æ¶æ¯”è¾ƒå¤šï¼Œä»Šå¤©æˆ‘ä»¬å°±å…ˆæ¥è¯´è¯´Springæ¡†æ¶ä¸­æ˜¯å¦‚ä½•å®ç°å¯¹è§‚å¯Ÿè€…æ¨¡å¼çš„æ”¯æŒå§ï¼</p><h6 id="Springä¸­çš„å®ç°"><a href="#Springä¸­çš„å®ç°" class="headerlink" title="Springä¸­çš„å®ç°"></a>Springä¸­çš„å®ç°</h6><p>Springæ¡†æ¶ä¸­æä¾›äº†ç›¸å½“å¤šçš„ç»„ä»¶å¯ä»¥å®ç°è§‚å¯Ÿè€…æ¨¡å¼ï¼Œæ–‡ç« åé¢ä¼šä¸€ä¸€å‘å¤§å®¶ä»‹ç»ã€‚è¿™é‡Œæˆ‘å¼•å…¥ä¸€ä¸ªæ–°çš„ä¸šåŠ¡åœºæ™¯ï¼Œç”¨æˆ·æ³¨å†Œä¹‹åå‘é€çŸ­ä¿¡é€šçŸ¥ã€ç§¯åˆ†è¿˜æœ‰ä¼˜æƒ åˆ¸ã€‚è¿™ç§ä¸šåŠ¡åœºæ™¯éå¸¸çš„å¸¸è§ï¼Œæˆ‘å±•ç¤ºä¸€ä¸‹å°ä¼™ä¼´ä»¬ä¸€èˆ¬æ˜¯æ€ä¹ˆæ ·å®ç°è¿™æ ·çš„åŠŸèƒ½çš„ã€‚å› ä¸ºç¯‡å¹…æœ‰é™ï¼Œè¿™é‡Œå°±å±•ç¤ºä¸€ä¸‹ä¼ªä»£ç å§ï¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MemberService</span></span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Autowired</span></span><br><span class="line">   <span class="keyword">private</span> MemberDao memberDao;</span><br><span class="line">  </span><br><span class="line">   <span class="meta">@Autowired</span></span><br><span class="line">   <span class="keyword">private</span> CouponService couponService;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Autowired</span></span><br><span class="line">   <span class="keyword">private</span> SmsService smsService;</span><br><span class="line">   </span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å®Œæˆç”¨æˆ·æ³¨å†Œï¼ŒæˆåŠŸä¹‹åå‘é€ä¼˜æƒ åˆ¸ã€çŸ­ä¿¡é€šçŸ¥</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> memberName æŸ¥è¯¢æ¡ä»¶</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> phone åˆ†é¡µä¿¡æ¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> Result <span class="title">normalRegister</span><span class="params">(String memberName,String phone)</span></span>&#123;</span><br><span class="line">        <span class="comment">// 1ã€æ‰§è¡Œæ³¨å†Œé€»è¾‘</span></span><br><span class="line">        log.info(<span class="string">"[register][æ‰§è¡Œç”¨æˆ·(&#123;&#125;) çš„æ³¨å†Œé€»è¾‘]"</span>, phone);</span><br><span class="line">        <span class="comment">// ä¿å­˜ç”¨æˆ·</span></span><br><span class="line">        Long memberId = memberDao.saveMember();</span><br><span class="line">        <span class="comment">// 2ã€å‘é€ä¼˜æƒ åˆ¸</span></span><br><span class="line">        couponService.sendCoupon(memberId);</span><br><span class="line">        <span class="comment">// 3ã€å‘é€çŸ­ä¿¡</span></span><br><span class="line">        smsService.sendSms(phone);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Result();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å¤§å®¶å¯¹è¿™éƒ¨åˆ†ä»£ç æ€ä¹ˆçœ‹ï¼Ÿ</strong></p><p>å¯¹äºç”¨æˆ·æ³¨å†ŒåŠŸèƒ½æ¥è¯´ï¼Œä¿éšœç”¨æˆ·æˆåŠŸæ³¨å†Œï¼Œè¿™æ˜¯ä¸ªä¸šåŠ¡çš„æ ¸å¿ƒè¯‰æ±‚ï¼Œå…¶ä»–çš„éƒ½æ˜¯é”¦ä¸Šæ·»èŠ±ï¼Œæ‰€ä»¥è¿™ä¸ªåœ°æ–¹ä¸åº”è¯¥æºæ‚å…¶ä»–çš„ä¸šåŠ¡ã€‚ç”¨æˆ·æ³¨å†Œä¸å‘é€çŸ­ä¿¡ã€ä¼˜æƒ åˆ¸åŠŸèƒ½åº”è¯¥åˆ†éš”å¼€ï¼Œè¿™æ ·ä¹Ÿç¬¦åˆè§£è€¦çš„è®¾è®¡è§„åˆ™ã€‚ä¸ç„¶åç»­ä¸šåŠ¡å¢åŠ éœ€æ±‚ï¼Œéœ€è¦ç”¨æˆ·æ³¨å†Œå®Œæˆä¹‹åç»™ç”¨æˆ·å‘é€ç§¯åˆ†ï¼Œä½ æ˜¯ä¸æ˜¯è¿˜è¦åœ¨è¿™ä¸ª <code>normalRegister</code>æ–¹æ³•ä¸­å¢åŠ å‘é€ç§¯åˆ†çš„é€»è¾‘ï¼Œé‚£è¿™ä¸ªå²‚ä¸æ˜¯åˆè¿èƒŒäº†å¼€é—­åŸåˆ™ã€‚</p><blockquote><p>ä¸€ä»¶äº‹åšå®¹æ˜“ï¼Œæƒ³åšå¥½ä¸å®¹æ˜“ã€‚å†™ç¨‹åºä¹Ÿæ˜¯å¦‚æ­¤ï¼Œèƒ½å¤ŸæŠŠåŠŸèƒ½ç¼–ç å®ç°bugåˆå°‘ï¼Œå…¶å®æ˜¯å¾ˆè€—è´¹æ—¶é—´å’Œç²¾åŠ›çš„ã€‚æˆ‘å¸¸è·ŸåŒäº‹ä»¬å¼€ç©ç¬‘è¯´â€œå†™ä»£ç ä¸è¦ç³Šå¼„ï¼Œè¯¥å†™çš„ä»£ç ä¸€å®šè¦å†™ï¼Œä¸ç„¶ä½ æœ€åè‚¯å®šä¼šè¢«ä»£ç ç³Šå¼„â€ã€‚</p></blockquote><p><strong>æ¥ä¸‹æ¥æˆ‘æ¥ä»‹ç»ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨Springçš„äº‹ä»¶å‘å¸ƒæœºåˆ¶æ¥å®ç°ä¸šåŠ¡è§£è€¦çš„</strong></p><p>ç”±äºåé¢çš„å®ç°æ–¹æ³•ä¸­ç”¨æˆ·æ³¨å†Œäº‹ä»¶ç±»çš„ä»£ç éƒ½æ˜¯ç±»ä¼¼çš„åªæ˜¯ç±»åä¸åŒï¼Œé‚£æˆ‘å°±æŠŠç”¨æˆ·æ³¨å†Œäº‹ä»¶ç±»çš„ä»£ç å†™åœ¨å‰é¢ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationEvent;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserRegisterEvent</span> <span class="keyword">extends</span> <span class="title">ApplicationEvent</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¯ä»¥è‡ªå®šä¹‰äº›è‡ªå·±éœ€è¦çš„å±æ€§</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·çš„id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long memberId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·æ‰‹æœºå·</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String memberPhone;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UserRegisterEvent</span><span class="params">(Object source)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(source);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UserRegisterEvent</span><span class="params">(Object source, Long memberId, String memberPhone)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(source);</span><br><span class="line">        <span class="keyword">this</span>.memberId = memberId;</span><br><span class="line">        <span class="keyword">this</span>.memberPhone = memberPhone;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="åˆ©ç”¨ç»§æ‰¿ApplicationEventç±»ã€å®ç°ApplicationListeneræ¥å£æˆ–è€…-EventListeneræ³¨è§£æ¥å®ç°"><a href="#åˆ©ç”¨ç»§æ‰¿ApplicationEventç±»ã€å®ç°ApplicationListeneræ¥å£æˆ–è€…-EventListeneræ³¨è§£æ¥å®ç°" class="headerlink" title="åˆ©ç”¨ç»§æ‰¿ApplicationEventç±»ã€å®ç°ApplicationListeneræ¥å£æˆ–è€…  @EventListeneræ³¨è§£æ¥å®ç°"></a>åˆ©ç”¨ç»§æ‰¿<code>ApplicationEvent</code>ç±»ã€å®ç°<code>ApplicationListener</code>æ¥å£æˆ–è€…  <code>@EventListener</code>æ³¨è§£æ¥å®ç°</h5><p><code>org.springframework.context.ApplicationListener</code>æ˜¯Springæä¾›çš„ä¸€ä¸ªæ³›å‹æ¥å£ã€‚ç”±åº”ç”¨ç¨‹åºäº‹ä»¶ä¾¦å¬å™¨å®ç°çš„æ¥å£,ä»Spring 3.0å¼€å§‹ï¼Œ<code>ApplicationListener</code>å¯ä»¥ä¸€èˆ¬æ€§åœ°å£°æ˜å…¶æ„Ÿå…´è¶£çš„äº‹ä»¶ç±»å‹ã€‚åœ¨Spring ApplicationContextä¸­æ³¨å†Œåï¼Œå°†ç›¸åº”åœ°è¿‡æ»¤äº‹ä»¶ï¼Œå¹¶ä¸”ä»…é’ˆå¯¹åŒ¹é…äº‹ä»¶å¯¹è±¡è°ƒç”¨ä¾¦å¬å™¨ã€‚è§‚å¯Ÿè€…å¯ä»¥å®ç°<code>ApplicationListener</code>æ¥å£æˆ–è€…ä½¿ç”¨<code>@EventListener</code>æ³¨è§£ï¼Œè¿™ä¸ªæ³¨è§£å’Œ<code>ApplicationListener</code>æ¥å£æœ‰ç€ç›¸åŒçš„åŠŸèƒ½ï¼Œç›¸æ¯”ä¹‹ä¸‹ä½¿ç”¨æ³¨è§£æ¯”ä½¿ç”¨æ¥å£æ›´æ–¹ä¾¿ä¸€ç‚¹ã€‚</p><h4 id="çŸ­ä¿¡Serviceå®ç°ApplicationListeneræ¥å£"><a href="#çŸ­ä¿¡Serviceå®ç°ApplicationListeneræ¥å£" class="headerlink" title="çŸ­ä¿¡Serviceå®ç°ApplicationListeneræ¥å£"></a>çŸ­ä¿¡Serviceå®ç°ApplicationListeneræ¥å£</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SmsService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@EventListener</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendSms</span><span class="params">(UserRegisterEvent event)</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">"[EventListener][ç»™ç”¨æˆ·(&#123;&#125;) å‘é€çŸ­ä¿¡]"</span>, event);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ä¼˜æƒ åˆ¸Serviceç›´æ¥åœ¨addCoupon-æ–¹æ³•ä¸Šæ·»åŠ æ³¨è§£-EventListener"><a href="#ä¼˜æƒ åˆ¸Serviceç›´æ¥åœ¨addCoupon-æ–¹æ³•ä¸Šæ·»åŠ æ³¨è§£-EventListener" class="headerlink" title="ä¼˜æƒ åˆ¸Serviceç›´æ¥åœ¨addCoupon æ–¹æ³•ä¸Šæ·»åŠ æ³¨è§£ @EventListener"></a>ä¼˜æƒ åˆ¸Serviceç›´æ¥åœ¨<code>addCoupon</code> æ–¹æ³•ä¸Šæ·»åŠ æ³¨è§£ <code>@EventListener</code></h4><p>æ³¨æ„<code>addCoupon</code> æ–¹æ³•çš„å…¥å‚ä¸º <code>UserRegisterEvent</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CouponService</span> <span class="keyword">implements</span> <span class="title">ApplicationListener</span>&lt;<span class="title">UserRegisterEvent</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onApplicationEvent</span><span class="params">(UserRegisterEvent event)</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">"[addCoupon][ç»™ç”¨æˆ·(&#123;&#125;) å‘æ”¾ä¼˜æƒ åŠµ]"</span>, event);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç§¯åˆ†Serviceä¸­çš„ä»£ç ä¸ä¸Šé¢çš„ç±»ä¼¼å°±ä¸è´´å‡ºæ¥äº†</strong></p><h4 id="æ³¨å†Œä¸šåŠ¡å®Œæˆå‘å¸ƒUserRegisterEventäº‹ä»¶"><a href="#æ³¨å†Œä¸šåŠ¡å®Œæˆå‘å¸ƒUserRegisterEventäº‹ä»¶" class="headerlink" title="æ³¨å†Œä¸šåŠ¡å®Œæˆå‘å¸ƒUserRegisterEventäº‹ä»¶"></a>æ³¨å†Œä¸šåŠ¡å®Œæˆå‘å¸ƒ<code>UserRegisterEvent</code>äº‹ä»¶</h4><p>è¿™ä¸ªåœ°æ–¹MemberServiceè¦å®ç°<code>org.springframework.beans.factory.Aware.ApplicationEventPublisherAware</code>æ¥å£ï¼Œæ‰æœ‰èƒ½åŠ›ä½¿ç”¨ <code>ApplicationEventPublisher</code> å‘å¸ƒäº‹ä»¶ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MemberService</span> <span class="keyword">implements</span> <span class="title">ApplicationEventPublisherAware</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ApplicationEventPublisher applicationEventPublisher;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setApplicationEventPublisher</span><span class="params">(ApplicationEventPublisher applicationEventPublisher)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.applicationEventPublisher = applicationEventPublisher;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æœ€ç®€å•çš„è§‚å¯Ÿè€…å®ç°</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> phone ç”¨æˆ·æ‰‹æœºå·</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">register</span><span class="params">(String memberPhone)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 1ã€ ... æ‰§è¡Œæ³¨å†Œé€»è¾‘</span></span><br><span class="line">        log.info(<span class="string">"[register][æ‰§è¡Œç”¨æˆ·(&#123;&#125;) çš„æ³¨å†Œé€»è¾‘]"</span>, memberPhone);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2ã€ç”¨æˆ·æ•°æ®ä¿å­˜åˆ°æ•°æ®åº“</span></span><br><span class="line">        Long memberId = <span class="number">1000L</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3ã€å‘å¸ƒäº‹ä»¶é€šçŸ¥</span></span><br><span class="line">        applicationEventPublisher.publishEvent(<span class="keyword">new</span> UserRegisterEvent(<span class="keyword">this</span>, memberId, memberPhone));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Result();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å•å…ƒæµ‹è¯•"><a href="#å•å…ƒæµ‹è¯•" class="headerlink" title="å•å…ƒæµ‹è¯•"></a>å•å…ƒæµ‹è¯•</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ContextConfiguration</span>(locations = &#123;<span class="string">"classpath:spring/spring-dao.xml"</span>, <span class="string">"classpath:spring/spring-service.xml"</span>&#125;)</span><br><span class="line"><span class="meta">@RunWith</span>(value = SpringJUnit4ClassRunner<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">ObserverTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> MemberService memberService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">register</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        memberService.register(<span class="string">"13911111111"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ‰§è¡Œç»“æœ"><a href="#æ‰§è¡Œç»“æœ" class="headerlink" title="æ‰§è¡Œç»“æœ"></a>æ‰§è¡Œç»“æœ</h4><p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210204230758.png" alt="å‘é€çŸ­ä¿¡åœ¨å‘é€ä¼˜æƒ åˆ¸ä¹‹å‰"></p><p>ä»£ç æ‰§è¡ŒæˆåŠŸï¼Œæ‰“å°å‡ºäº†ç»™ç”¨æˆ·å‘é€çŸ­ä¿¡ã€ä¼˜æƒ åˆ¸æ—¥å¿—ï¼ŒåŠŸèƒ½å®Œç¾å®ç°ã€‚ä½†æ˜¯ç¨å¾®æœ‰ç‚¹é—®é¢˜ï¼Œæˆ‘æƒ³è°ƒæ¢ä¸€ä¸‹ä¸¤è€…çš„é¡ºåºï¼Œå…ˆæ‰§è¡Œå‘é€ä¼˜æƒ åˆ¸ï¼Œå†å‘é€çŸ­ä¿¡ã€‚è¿™ä¸ªè¦æ±‚è¿˜æ˜¯è›®å¸¸è§ï¼Œé‚£æ€ä¹ˆå®ç°å‘¢ï¼Ÿ</p><h5 id="ä½¿ç”¨SmartApplicationListeneræˆ–è€…GenericApplicationListeneræ¥å£å®ç°æŒ‡å®šè§‚å¯Ÿè€…è‡ªå®šä¹‰é¡ºåºæ‰§è¡Œ"><a href="#ä½¿ç”¨SmartApplicationListeneræˆ–è€…GenericApplicationListeneræ¥å£å®ç°æŒ‡å®šè§‚å¯Ÿè€…è‡ªå®šä¹‰é¡ºåºæ‰§è¡Œ" class="headerlink" title="ä½¿ç”¨SmartApplicationListeneræˆ–è€…GenericApplicationListeneræ¥å£å®ç°æŒ‡å®šè§‚å¯Ÿè€…è‡ªå®šä¹‰é¡ºåºæ‰§è¡Œ"></a>ä½¿ç”¨<code>SmartApplicationListener</code>æˆ–è€…<code>GenericApplicationListener</code>æ¥å£å®ç°æŒ‡å®šè§‚å¯Ÿè€…è‡ªå®šä¹‰é¡ºåºæ‰§è¡Œ</h5><p><code>org.springframework.context.event.SmartApplicationListener</code>æ˜¯Spring3.0ç‰ˆæœ¬æä¾›çš„æ¥å£ï¼Œ<code>org.springframework.context.event.GenericApplicationListener</code>åˆ™æ˜¯Spring4.2ç‰ˆæœ¬æä¾›çš„æ¥å£ï¼Œå¦‚æœåœ¨ä½ çš„é¡¹ç›®ä¸­ä½¿ç”¨ä¸äº†ï¼Œé‚£å°±æ˜¯è¯´æ˜ä½ é¡¹ç›®ä¸­ä½¿ç”¨çš„Springç‰ˆæœ¬è¿‡ä½ï¼Œè¿™ä¸ªé—®é¢˜è‡ªå·±è‡ªè¡Œå¤„ç†ã€‚<br>åœ¨æŸ¥<code>SmartApplicationListener</code>æºç æ—¶å‘ç°æœ‰ä»¥ä¸‹æ³¨é‡Šï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Extended variant of the standard &#123;<span class="meta">@link</span> ApplicationListener&#125; <span class="class"><span class="keyword">interface</span>,</span></span><br><span class="line"><span class="class"><span class="title">exposing</span> <span class="title">further</span> <span class="title">metadata</span> <span class="title">such</span> <span class="title">as</span> <span class="title">the</span> <span class="title">supported</span> <span class="title">event</span> <span class="title">type</span>.</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">&lt;<span class="title">p</span>&gt;<span class="title">Users</span> <span class="title">are</span> &lt;<span class="title">bold</span>&gt;<span class="title">strongly</span> <span class="title">advised</span>&lt;/<span class="title">bold</span>&gt; <span class="title">to</span> <span class="title">use</span> <span class="title">the</span> </span>&#123;<span class="meta">@link</span> GenericApplicationListener&#125;</span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">instead</span> <span class="title">as</span> <span class="title">it</span> <span class="title">provides</span> <span class="title">an</span> <span class="title">improved</span> <span class="title">detection</span> <span class="title">of</span> <span class="title">generics</span>-<span class="title">based</span></span></span><br><span class="line"><span class="class"><span class="title">event</span> <span class="title">types</span>.</span></span><br></pre></td></tr></table></figure><p>ç¿»è¯‘ä¹‹åå¤§æ¦‚çš„æ„æ€å°±æ˜¯ï¼Œ<strong>SmartApplicationListeneræ˜¯æ ‡å‡†<code>ApplicationListener</code>æ¥å£çš„æ‰©å±•å˜ä½“ï¼Œå…¬å¼€äº†è¿›ä¸€æ­¥çš„å…ƒæ•°æ®ï¼Œä¾‹å¦‚å—æ”¯æŒçš„äº‹ä»¶ç±»å‹ã€‚ä½†å¼ºçƒˆå»ºè®®æ”¹ç”¨<code>GenericApplicationListener</code>æ¥å£ï¼Œå› ä¸ºå®ƒæä¾›äº†å¯¹åŸºäºæ³›å‹çš„äº‹ä»¶ç±»å‹çš„æ”¹è¿›æ£€æµ‹</strong>ï¼Œé‚£æˆ‘æ­¤å¤„å°±åªä»¥GenericApplicationListenerä¸ºä¾‹äº†ã€‚</p><p>ä¼˜æƒ åˆ¸æœåŠ¡ServiceåŒæ ·å®ç°æ¥å£ <code>GenericApplicationListener</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SecondVersionCouponService</span> <span class="keyword">implements</span> <span class="title">GenericApplicationListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç¡®å®šæ­¤ä¾¦å¬å™¨æ˜¯å¦å®é™…ä¸Šæ”¯æŒç»™å®šçš„äº‹ä»¶ç±»å‹ã€‚</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> eventType</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supportsEventType</span><span class="params">(ResolvableType eventType)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> SecondVersionUserRegisterEvent<span class="class">.<span class="keyword">class</span>.<span class="title">equals</span>(<span class="title">eventType</span>.<span class="title">getRawClass</span>())</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç¡®å®šæ­¤ä¾¦å¬å™¨æ˜¯å¦å®é™…ä¸Šæ”¯æŒç»™å®šçš„æºç±»å‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sourceType</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supportsSourceType</span><span class="params">(Class&lt;?&gt; sourceType)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> MemberService<span class="class">.<span class="keyword">class</span> </span>== sourceType;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å…·ä½“çš„ä¸šåŠ¡é€»è¾‘</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> event</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onApplicationEvent</span><span class="params">(ApplicationEvent event)</span> </span>&#123;</span><br><span class="line">        SecondVersionUserRegisterEvent userRegisterEvent = (SecondVersionUserRegisterEvent) event;</span><br><span class="line">        Long memberId = userRegisterEvent.getMemberId();</span><br><span class="line">        log.info(<span class="string">"[Second addCoupon][ç»™ç”¨æˆ·(&#123;&#125;) å‘æ”¾ä¼˜æƒ åŠµ]"</span>, memberId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¾å®šæ‰§è¡Œçš„é¡ºåºï¼Œæ•°å­—è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜å°±è¶Šå…ˆè¢«æ‰§è¡Œ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getOrder</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çŸ­ä¿¡æœåŠ¡ServiceåŒæ ·å®ç°æ¥å£ <code>GenericApplicationListener</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SecondVersionSmsService</span> <span class="keyword">implements</span> <span class="title">GenericApplicationListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supportsEventType</span><span class="params">(ResolvableType eventType)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> SecondVersionUserRegisterEvent<span class="class">.<span class="keyword">class</span> </span>== eventType.getRawClass();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supportsSourceType</span><span class="params">(Class&lt;?&gt; sourceType)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> MemberService<span class="class">.<span class="keyword">class</span> </span>== sourceType;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onApplicationEvent</span><span class="params">(ApplicationEvent event)</span> </span>&#123;</span><br><span class="line">        SecondVersionUserRegisterEvent userRegisterEvent = (SecondVersionUserRegisterEvent) event;</span><br><span class="line">        String memberPhone = userRegisterEvent.getMemberPhone();</span><br><span class="line">        log.info(<span class="string">"[Second onApplicationEvent][ç»™ç”¨æˆ·(&#123;&#125;) å‘é€çŸ­ä¿¡]"</span>, memberPhone);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getOrder</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>å…¶å®ä½¿ç”¨<code>org.springframework.context.ApplicationListener</code> + <code>org.springframework.core.annotation.Order</code>æ³¨è§£ä¹Ÿå¯ä»¥å®ç°æ§åˆ¶è§‚å¯Ÿè€…çš„æ‰§è¡Œé¡ºåºï¼Œè€Œä¸”æ›´ç®€æ´ï¼</p></blockquote><h4 id="æ³¨å†Œä¸šåŠ¡å®Œæˆå‘å¸ƒUserRegisterEventäº‹ä»¶-1"><a href="#æ³¨å†Œä¸šåŠ¡å®Œæˆå‘å¸ƒUserRegisterEventäº‹ä»¶-1" class="headerlink" title="æ³¨å†Œä¸šåŠ¡å®Œæˆå‘å¸ƒUserRegisterEventäº‹ä»¶"></a>æ³¨å†Œä¸šåŠ¡å®Œæˆå‘å¸ƒ<code>UserRegisterEvent</code>äº‹ä»¶</h4><p>è¿™ä¸ªåœ°æ–¹MemberServiceè¦å®ç°<code>org.springframework.beans.factory.Aware.ApplicationEventPublisherAware</code>æ¥å£ï¼Œæ‰æœ‰èƒ½åŠ›ä½¿ç”¨ <code>ApplicationEventPublisher</code> å‘å¸ƒäº‹ä»¶ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MemberService</span> <span class="keyword">implements</span> <span class="title">ApplicationEventPublisherAware</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ApplicationEventPublisher applicationEventPublisher;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setApplicationEventPublisher</span><span class="params">(ApplicationEventPublisher applicationEventPublisher)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.applicationEventPublisher = applicationEventPublisher;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æœ€ç®€å•çš„è§‚å¯Ÿè€…å®ç°</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> phone ç”¨æˆ·æ‰‹æœºå·</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">     <span class="meta">@Transactional</span>(rollbackFor = Exception<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">    <span class="title">public</span> <span class="title">Result</span> <span class="title">register</span>(<span class="title">String</span> <span class="title">phone</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 1ã€ ... æ‰§è¡Œæ³¨å†Œé€»è¾‘</span></span><br><span class="line">        log.info(<span class="string">"[Second register][æ‰§è¡Œç”¨æˆ·(&#123;&#125;) çš„æ³¨å†Œé€»è¾‘]"</span>, phone);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2ã€ ä¿å­˜ç”¨æˆ·åˆ°æ•°æ®åº“ï¼ˆå‡è®¾è¿™ä¸ªæ˜¯ï¼‰</span></span><br><span class="line">        BizLocalMessageEntity entity = <span class="keyword">new</span> BizLocalMessageEntity();</span><br><span class="line">        ThreadLocalRandom random = ThreadLocalRandom.current();</span><br><span class="line">        entity.setBizModule((<span class="keyword">byte</span>) <span class="number">0</span>);</span><br><span class="line">        entity.setBizNo(<span class="string">""</span> + random.nextInt(<span class="number">100000</span>));</span><br><span class="line">        entity.setBizType((<span class="keyword">byte</span>) <span class="number">0</span>);</span><br><span class="line">        entity.setSendStatus((<span class="keyword">byte</span>) <span class="number">0</span>);</span><br><span class="line">        entity.setCreateTime(<span class="keyword">new</span> Date());</span><br><span class="line">        entity.setUpdateTime(<span class="keyword">new</span> Date());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> affectRow = bizLocalMessageMapper.insert(entity);</span><br><span class="line">        Long memberId = entity.getId();</span><br><span class="line">        log.info(<span class="string">"æ’å…¥çš„affectRow= [&#123;&#125;],ä¸»é”®[&#123;&#125;]"</span>, affectRow, memberId);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3ã€å‘å¸ƒäº‹ä»¶é€šçŸ¥</span></span><br><span class="line">        applicationEventPublisher.publishEvent(<span class="keyword">new</span> SecondVersionUserRegisterEvent(<span class="keyword">this</span>, memberId, phone));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Result();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å•å…ƒæµ‹è¯•-1"><a href="#å•å…ƒæµ‹è¯•-1" class="headerlink" title="å•å…ƒæµ‹è¯•"></a>å•å…ƒæµ‹è¯•</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ContextConfiguration</span>(locations = &#123;<span class="string">"classpath:spring/spring-dao.xml"</span>, <span class="string">"classpath:spring/spring-service.xml"</span>&#125;)</span><br><span class="line"><span class="meta">@RunWith</span>(value = SpringJUnit4ClassRunner<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">ObserverTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> MemberService memberService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">register</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        memberService.register(<span class="string">"13911111111"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ‰§è¡Œç»“æœ-1"><a href="#æ‰§è¡Œç»“æœ-1" class="headerlink" title="æ‰§è¡Œç»“æœ"></a>æ‰§è¡Œç»“æœ</h4><p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210204230024.png" alt="è¿è¡Œæˆªå›¾"></p><p>ä¿®æ”¹ä¸¤ä¸ªServiceä¸­orderçš„æ•°å€¼å¯ä»¥è½»æ¾ä¸¤ä¸ªè§‚å¯Ÿè€…çš„æ‰§è¡Œé¡ºåºï¼Œå®Œç¾çš„è§£å†³äº†è‡ªå®šä¹‰è§‚å¯Ÿè€…æ‰§è¡Œé¡ºåºçš„è¦æ±‚ã€‚ç»†å¿ƒçš„å°ä¼™ä¼´ä¼šå‘ç°ï¼Œå‡è®¾åœ¨ç”¨æˆ·æ³¨å†Œçš„æ–¹æ³•ä¸­å­˜åœ¨äº‹åŠ¡ï¼Œè§‚å¯Ÿè€…çš„æ‰§è¡Œå‡ºç°å¼‚å¸¸ï¼Œä¼šå¯¼è‡´æ•´ä¸ªäº‹åŠ¡å›æ»šï¼Œæ˜æ˜ç”¨æˆ·çš„æ•°æ®å·²ç»ä¿å­˜åˆ°æ•°æ®åº“ï¼Œç°åœ¨å´æ²¡æœ‰äº†ï¼è¿˜æ˜¯å‰é¢é‚£å¥è¯ï¼Œåœ¨è¿™ä¸ªä¸šåŠ¡åœºæ™¯ï¼Œç”¨æˆ·æ³¨å†ŒæˆåŠŸæ˜¯æ ¸å¿ƒè¯‰æ±‚ï¼Œå‘é€çŸ­ä¿¡ã€ä¼˜æƒ åˆ¸é‡è¦æ€§éƒ½æ˜¯æ¯”ä¸ä¸Šçš„ã€‚é‚£è¦è§£å†³è¿™ç§æƒ…å†µï¼Œå°±éœ€è¦ç”¨æˆ·æ³¨å†ŒæˆåŠŸçš„äº‹åŠ¡æäº¤ä¹‹åï¼Œå†å‘å¸ƒæ³¨å†ŒæˆåŠŸäº‹ä»¶ï¼Œé¿å…è§‚å¯Ÿè€…æ‰§è¡Œç»“æœçš„å½±å“ã€‚</p><p><strong>çŸ­ä¿¡æœåŠ¡Serviceæœ‰æœ‰å¼‚å¸¸æŠ›å‡ºå¯¼è‡´äº‹åŠ¡å›æ»š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onApplicationEvent</span><span class="params">(ApplicationEvent event)</span> </span>&#123;</span><br><span class="line">       SecondVersionUserRegisterEvent userRegisterEvent = (SecondVersionUserRegisterEvent) event;</span><br><span class="line">       String memberPhone = userRegisterEvent.getMemberPhone();</span><br><span class="line">       <span class="keyword">if</span> (StringUtils.isNotBlank(memberPhone)) &#123;</span><br><span class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"æµ‹è¯•äº‹ä»¶ä¸­å‘ç”Ÿå¼‚å¸¸å¯¹åŸæœ‰ä¸šåŠ¡çš„å½±å“,çŸ­ä¿¡å‘é€å¤±è´¥ï¼ï¼ï¼ï¼"</span>);</span><br><span class="line">       &#125;</span><br><span class="line">       log.info(<span class="string">"[Second onApplicationEvent][ç»™ç”¨æˆ·(&#123;&#125;) å‘é€çŸ­ä¿¡]"</span>, memberPhone);</span><br><span class="line"></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210204225825.png" alt="çŸ­ä¿¡è§‚å¯Ÿè€…æ‰§è¡Œå‘ç”Ÿå¼‚å¸¸"></p><p>å¯èƒ½æœ‰çš„å°ä¼™ä¼´æƒ³ï¼Œè§‚å¯Ÿè€…æ‰§è¡Œå¼‚å¸¸å¯¼è‡´äº‹åŠ¡å›æ»šï¼Œæœ¬è´¨ä¸Šæ¥è¯´è¿™ç§æ–¹å¼å®ç°çš„è§‚å¯Ÿè€…æ¨¡å¼ï¼Œå…¶å®è¿˜æ˜¯åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­åŒæ­¥æ‰§è¡Œçš„ã€‚é‚£æˆ‘å°±åœ¨è§‚å¯Ÿè€…ä¸­æ•è·æ‰€æœ‰çš„å¼‚å¸¸æˆ–è€…ç”¨æˆ·æ³¨å†ŒæˆåŠŸä¹‹åå¼‚æ­¥å‘å¸ƒäº‹ä»¶ã€‚</p><ul><li><strong>æ•è·æ‰€æœ‰å¼‚å¸¸</strong></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onApplicationEvent</span><span class="params">(ApplicationEvent event)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">            SecondVersionUserRegisterEvent userRegisterEvent = (SecondVersionUserRegisterEvent) event;</span><br><span class="line">            Long memberId = userRegisterEvent.getMemberId();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (memberId != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"æµ‹è¯•äº‹ä»¶ä¸­å‘ç”Ÿå¼‚å¸¸å¯¹åŸæœ‰ä¸šåŠ¡çš„å½±å“,çŸ­ä¿¡å‘é€å¤±è´¥ï¼ï¼ï¼ï¼"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            log.info(<span class="string">"[Second addCoupon][ç»™ç”¨æˆ·(&#123;&#125;) å‘æ”¾ä¼˜æƒ åŠµ]"</span>, memberId);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">"å‘æ”¾ä¼˜æƒ åŠµå‘ç”Ÿå¼‚å¸¸"</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><ul><li><strong>å¼‚æ­¥å‘å¸ƒäº‹ä»¶</strong></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 3ã€å¼‚æ­¥å‘å¸ƒäº‹ä»¶é€šçŸ¥,è¿™æ ·çš„æœ‰å¯èƒ½äº‹åŠ¡è¿˜æ²¡æœ‰æäº¤ï¼Œåˆ™å¼‚æ­¥çº¿ç¨‹è¯»å–ä¸åˆ°æ•°æ®åº“ä¸­çš„æ•°æ®</span></span><br><span class="line">CompletableFuture&lt;Void&gt; voidCompletableFuture = CompletableFuture.runAsync(() -&gt; &#123;</span><br><span class="line">    applicationEventPublisher.publishEvent(<span class="keyword">new</span> UserRegisterEvent(<span class="keyword">this</span>, memberId, phone));</span><br><span class="line">&#125;);</span><br><span class="line">voidCompletableFuture.exceptionally(exception -&gt; &#123;</span><br><span class="line">    log.error(<span class="string">"å‘ç”Ÿäº†å¼‚å¸¸"</span>, exception);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ç§æ–¹å¼å¯ä»¥è§£å†³äº‹åŠ¡å›æ»šçš„é—®é¢˜ï¼Œä½†æ˜¯å‘¢æ„Ÿè§‰ä¼šæœ‰ç‚¹lowï¼</p><p>ç¬¬äºŒç§æ–¹å¼å‡å¦‚è§‚å¯Ÿè€…ä¸­æŸ¥è¯¢ä¼šå‘˜çš„ä¿¡æ¯ï¼Œå¯èƒ½å‡ºç°æŸ¥ä¸åˆ°ï¼Œå› ä¸ºå¯èƒ½äº‹åŠ¡è¿˜æ²¡æœ‰æäº¤ã€‚</p><h5 id="ä½¿ç”¨-TransactionalEventListener-å®ç°äº‹åŠ¡æäº¤ä¹‹åæ‰æ‰§è¡Œè§‚å¯Ÿè€…"><a href="#ä½¿ç”¨-TransactionalEventListener-å®ç°äº‹åŠ¡æäº¤ä¹‹åæ‰æ‰§è¡Œè§‚å¯Ÿè€…" class="headerlink" title="ä½¿ç”¨ @TransactionalEventListener å®ç°äº‹åŠ¡æäº¤ä¹‹åæ‰æ‰§è¡Œè§‚å¯Ÿè€…"></a>ä½¿ç”¨ <code>@TransactionalEventListener</code> å®ç°äº‹åŠ¡æäº¤ä¹‹åæ‰æ‰§è¡Œè§‚å¯Ÿè€…</h5><p>ä½¿ç”¨èµ·æ¥å¾ˆç®€å•ï¼Œç›´æ¥åœ¨å¯¹åº”çš„è§‚å¯Ÿè€…æ–¹æ³•ä¸Šæ·»åŠ è¯¥æ³¨è§£å³å¯ã€‚<code>@TransactionalEventListener(phase = TransactionPhase.AFTER_COMMIT)</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreeCouponService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@TransactionalEventListener</span>(phase = TransactionPhase.AFTER_COMMIT)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addCoupon</span><span class="params">(ThreeUserRegisterEvent event)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        log.info(<span class="string">"æµ‹è¯•äº‹ä»¶ä¸­å‘ç”Ÿå¼‚å¸¸å¯¹åŸæœ‰ä¸šåŠ¡çš„å½±å“"</span>);</span><br><span class="line">        Long memberId = event.getMemberId();</span><br><span class="line">        <span class="keyword">if</span> (memberId != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"æµ‹è¯•äº‹ä»¶ä¸­å‘ç”Ÿå¼‚å¸¸å¯¹åŸæœ‰ä¸šåŠ¡çš„å½±å“,ä¼˜æƒ åˆ¸å‘é€å¤±è´¥ï¼ï¼ï¼ï¼"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        log.info(<span class="string">" Version=3 [addCoupon][ç»™ç”¨æˆ·(&#123;&#125;) å‘æ”¾ä¼˜æƒ åŠµ]"</span>, memberId);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„ä¸€å®šè¦åœ¨ <code>register()</code> æ–¹æ³•ä¸Šæ·»åŠ  <code>@Transactional</code> æ³¨è§£</strong>ï¼Œä¸ç„¶ <code>register()</code> æ–¹æ³•ä¸­æœ‰æŠ›å‡ºå¼‚å¸¸ä¹‹åï¼Œä¼šæœ‰ä¸‹é¢çš„é”™è¯¯æç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ä¿¡æ¯: Closing org.springframework.context.support.GenericApplicationContext<span class="meta">@a</span>67c67e: </span><br><span class="line">startup date [Thu Feb <span class="number">04</span> <span class="number">18</span>:<span class="number">06</span>:<span class="number">53</span> CST <span class="number">2021</span>]; root of context hierarchy</span><br></pre></td></tr></table></figure><p><strong>@Transactionalä¸€å®šè¦åŠ ä¸Š</strong>ä¸ç„¶æ–¹æ³•ä½“å†…æœ‰ä¸€æ¬¡æŠ›å‡ºä¼šæœ‰ä¸Šçš„é”™è¯¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional</span>(rollbackFor = Exception<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">Result</span> <span class="title">register</span>(<span class="title">String</span> <span class="title">phone</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 1ã€ ... æ‰§è¡Œæ³¨å†Œé€»è¾‘</span></span><br><span class="line">    log.info(<span class="string">"[Second register][æ‰§è¡Œç”¨æˆ·(&#123;&#125;) çš„æ³¨å†Œé€»è¾‘]"</span>, phone);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2ã€ ä¿å­˜ç”¨æˆ·(å‡è®¾è¿™æ˜¯)</span></span><br><span class="line">    <span class="keyword">int</span> affectRow = bizLocalMessageMapper.insert(entity);</span><br><span class="line">    Long memberId = entity.getId();</span><br><span class="line">    log.info(<span class="string">"æ’å…¥çš„affectRow= [&#123;&#125;],ä¸»é”®[&#123;&#125;]"</span>, affectRow, memberId);</span><br><span class="line">    <span class="keyword">if</span> (memberId != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"æ•…æ„æŠ›å‡ºå¼‚å¸¸"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    applicationEventPublisher.publishEvent(<span class="keyword">new</span> ThreeUserRegisterEvent(<span class="keyword">this</span>, memberId, phone));</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Result();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶å®ï¼Œå®ç° <code>register()</code> äº‹åŠ¡æäº¤ä¹‹åï¼Œå†å‘å¸ƒäº‹ä»¶è¿˜æœ‰ä¸¤ç§æ–¹å¼ï¼š</p><ul><li>ä½¿ç”¨äº‹åŠ¡æ¨¡æ¿TransactionTemplate</li></ul><ol><li>ä½¿ç”¨ä¹‹å‰éœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®äº‹åŠ¡æ¨¡æ¿</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- é…ç½® transactionTemplate --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"transactionTemplate"</span> <span class="attr">class</span>=<span class="string">"org.springframework.transaction.support.TransactionTemplate"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"transactionManager"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">"transactionManager"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>åœ¨ä»£ç ä¸­ä½¿ç”¨äº‹åŠ¡æ¨¡æ¿æäº¤äº‹åŠ¡</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> TransactionTemplate transactionTemplate;</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">public</span> Result <span class="title">register</span><span class="params">(String phone)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 1ã€ ... æ‰§è¡Œæ³¨å†Œé€»è¾‘</span></span><br><span class="line">        log.info(<span class="string">"[çº¿ç¨‹name=&#123;&#125;,register][æ‰§è¡Œç”¨æˆ·(&#123;&#125;) çš„æ³¨å†Œé€»è¾‘]"</span>, Thread.currentThread().getName(), phone);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2ã€ ä¿å­˜ç”¨æˆ·(å‡è®¾è¿™æ˜¯)</span></span><br><span class="line">        Long memberId = transactionTemplate.execute(status -&gt; &#123;</span><br><span class="line">            Long result = <span class="keyword">null</span>;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                BizLocalMessageEntity entity = <span class="keyword">new</span> BizLocalMessageEntity();</span><br><span class="line">                ThreadLocalRandom random = ThreadLocalRandom.current();</span><br><span class="line">                entity.setBizModule((<span class="keyword">byte</span>) <span class="number">0</span>);</span><br><span class="line">                entity.setBizNo(<span class="string">""</span> + random.nextInt(<span class="number">200000</span>));</span><br><span class="line">                entity.setBizType((<span class="keyword">byte</span>) <span class="number">0</span>);</span><br><span class="line">                entity.setMsg(<span class="string">"æ¶ˆæ¯å†…å®¹"</span>);</span><br><span class="line">                entity.setMsgDesc(<span class="string">"æ¶ˆæ¯å¤‡æ³¨"</span>);</span><br><span class="line">                entity.setCreateTime(<span class="keyword">new</span> Date());</span><br><span class="line">                entity.setUpdateTime(<span class="keyword">new</span> Date());</span><br><span class="line"></span><br><span class="line">                <span class="keyword">int</span> affectRow = bizLocalMessageMapper.insert(entity);</span><br><span class="line">                result = entity.getId();</span><br><span class="line">                log.info(<span class="string">"Version5 æ’å…¥çš„affectRow= [&#123;&#125;],ä¸»é”®[&#123;&#125;]"</span>, affectRow, result);</span><br><span class="line">                <span class="keyword">if</span> (affectRow &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="comment">//throw new RuntimeException("æµ‹è¯•ä¸»è¦ä¸šåŠ¡å¤±è´¥ï¼Œäº‹ä»¶æ˜¯å¦ä¼šå‘å¸ƒæ‰§è¡Œ");</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                log.error(<span class="string">"ä¸šåŠ¡å¤±è´¥å‘ç”Ÿå¼‚å¸¸"</span>, e);</span><br><span class="line">                <span class="comment">// æ ‡è®°äº‹åŠ¡å›æ»š</span></span><br><span class="line">                status.setRollbackOnly();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        log.info(<span class="string">"äº‹åŠ¡æ‰§è¡Œæƒ…å†µ ç”¨æˆ·çš„id= [&#123;&#125;]"</span>, memberId);</span><br><span class="line">        <span class="keyword">if</span> (memberId != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="comment">// 3ã€å¼‚æ­¥å‘å¸ƒäº‹ä»¶é€šçŸ¥</span></span><br><span class="line">            log.info(<span class="string">"å‘å¸ƒæ³¨å†ŒæˆåŠŸäº‹ä»¶"</span>);</span><br><span class="line">            applicationEventPublisher.publishEvent(<span class="keyword">new</span> UserRegisterEvent(<span class="keyword">this</span>, memberId, phone));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Result();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><ul><li>ä½¿ç”¨TransactionSynchronizationManager</li></ul><p>è¿™ä¸ªå¯ä»¥ç›´æ¥ä½¿ç”¨æ— éœ€é…ç½®ï¼Œé‡å†™TransactionSynchronizationAdapterçš„afterCommit()æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Transactional</span>(rollbackFor = Exception<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">Result</span> <span class="title">register</span>(<span class="title">String</span> <span class="title">phone</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 1ã€ ... æ‰§è¡Œæ³¨å†Œé€»è¾‘</span></span><br><span class="line">    log.info(<span class="string">"[Version4 register][æ‰§è¡Œç”¨æˆ·(&#123;&#125;) çš„æ³¨å†Œé€»è¾‘]"</span>, phone);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2ã€ ä¿å­˜ç”¨æˆ·(å‡è®¾è¿™æ˜¯)</span></span><br><span class="line">    BizLocalMessageEntity entity = <span class="keyword">new</span> BizLocalMessageEntity();</span><br><span class="line">    ThreadLocalRandom random = ThreadLocalRandom.current();</span><br><span class="line">    entity.setBizModule((<span class="keyword">byte</span>) <span class="number">0</span>);</span><br><span class="line">    entity.setBizNo(<span class="string">""</span> + random.nextInt(<span class="number">100000</span>));</span><br><span class="line">    entity.setBizType((<span class="keyword">byte</span>) <span class="number">0</span>);</span><br><span class="line">    entity.setMsg(<span class="string">""</span>);</span><br><span class="line">    entity.setMsgDesc(<span class="string">""</span>);</span><br><span class="line">    entity.setCreateTime(<span class="keyword">new</span> Date());</span><br><span class="line">    entity.setUpdateTime(<span class="keyword">new</span> Date());</span><br><span class="line"></span><br><span class="line">    Long memberId = entity.getId();</span><br><span class="line">    <span class="keyword">int</span> affectRow = bizLocalMessageMapper.insert(entity);</span><br><span class="line">    log.info(<span class="string">"Version4 æ’å…¥çš„affectRow= [&#123;&#125;],ä¸»é”®[&#123;&#125;]"</span>, affectRow, memberId);</span><br><span class="line">    <span class="keyword">if</span> (affectRow &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">//throw new RuntimeException("Version4 æµ‹è¯•ä¸»è¦ä¸šåŠ¡å¤±è´¥ï¼Œäº‹ä»¶æ˜¯å¦ä¼šå‘å¸ƒæ‰§è¡Œ");</span></span><br><span class="line">    &#125;</span><br><span class="line">    TransactionSynchronizationManager.registerSynchronization(<span class="keyword">new</span> TransactionSynchronizationAdapter() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterCommit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">super</span>.afterCommit();</span><br><span class="line">            <span class="comment">// 3ã€äº‹åŠ¡æäº¤ä¹‹åå‘å¸ƒäº‹ä»¶é€šçŸ¥</span></span><br><span class="line">            applicationEventPublisher.publishEvent(<span class="keyword">new</span> UserRegisterEvent(<span class="keyword">this</span>, memberId, phone));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Result();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æŠŠç›®å‰çš„ä»£ç æ‰§è¡Œä¸€ä¸‹çœ‹çœ‹æƒ…å†µæ€ä¹ˆæ ·</p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210204214744.png" style="zoom:50%;" alt="æ‰§è¡Œæ—¥å¿—æˆªå›¾"/><p>ä»æˆªå›¾ä¸Šçœ‹ï¼Œæˆ‘ä»¬ç›®å‰å·²ç»é€šè¿‡å¥½å‡ ç§æ–¹å¼è§£å†³äº†è§‚å¯Ÿè€…æ‰§è¡Œå¼‚å¸¸å¯¼è‡´äº‹åŠ¡å›æ»šçš„é—®é¢˜ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥ä»æˆªå›¾ä¸­çœ‹å‡ºç”¨æˆ·æ³¨å†Œé€»è¾‘å’Œå¯¹åº”çš„è§‚å¯Ÿè€…éƒ½æ˜¯åœ¨mainçº¿ç¨‹ä¸­æ‰§è¡Œçš„ï¼Œé‚£æˆ‘ä»¬å¯ä»¥è®©è§‚å¯Ÿè€…å¼‚æ­¥æ‰§è¡Œå—ï¼Ÿè¿™æ ·ä¹Ÿå¯ä»¥åŠ å¿«ä»£ç çš„æ‰§è¡Œé€Ÿåº¦ã€‚è¿™ä¸ªé—®é¢˜å½“ç„¶ä¹Ÿæ˜¯å¯ä»¥è§£å†³çš„ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š</p><ul><li>ç›´æ¥ä½¿ç”¨@Asyncæ³¨è§£</li></ul><p><strong>éœ€è¦æ³¨æ„çš„æ˜¯</strong>ï¼Œä½¿ç”¨è¿™ä¸ªæ³¨è§£ä¸€å®šè¦è‡ªå®šä¹‰çº¿ç¨‹æ± ï¼Œä¸æ˜¯å®ƒé»˜è®¤ä½¿ç”¨çš„æ˜¯ <code>org.springframework.core.task.SimpleAsyncTaskExecutor</code> ã€‚ä½†è¿™ä¸ª SimpleAsyncTaskExecutor ä¸æ˜¯çœŸçš„çº¿ç¨‹æ± ï¼Œè¿™ä¸ªç±»ä¸é‡ç”¨çº¿ç¨‹ï¼Œæ¯æ¬¡è°ƒç”¨éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SixCouponService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Async</span></span><br><span class="line">    <span class="meta">@Order</span>(<span class="number">20</span>)</span><br><span class="line">    <span class="meta">@EventListener</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addCoupon</span><span class="params">(SixUserRegisterEvent event)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        log.info(<span class="string">"æµ‹è¯•äº‹ä»¶ä¸­å‘ç”Ÿå¼‚å¸¸å¯¹åŸæœ‰ä¸šåŠ¡çš„å½±å“"</span>, <span class="string">""</span>);</span><br><span class="line">        Long memberId = event.getMemberId();</span><br><span class="line">        log.info(<span class="string">"çº¿ç¨‹name=&#123;&#125;,[addCoupon][ç»™ç”¨æˆ·(&#123;&#125;) å‘æ”¾ä¼˜æƒ åŠµ]"</span>, Thread.currentThread().getName(), memberId);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å¯åŠ¨å¼‚æ­¥çº¿ç¨‹æ¥å‘å¸ƒäº‹ä»¶</li></ul><p>æ„æ€å°±æ˜¯äº‹åŠ¡æäº¤ä¹‹åï¼Œåˆ¤æ–­äº‹åŠ¡æäº¤æˆåŠŸåˆ™æ–°å»ºä¸€ä¸ªçº¿ç¨‹ç„¶åå‘å¸ƒæ³¨å†ŒæˆåŠŸäº‹ä»¶ã€‚äº‹åŠ¡æäº¤æˆåŠŸå¯ä»¥å‰é¢æåˆ°çš„äº‹åŠ¡æ¨¡æ¿transactionTemplateå’Œäº‹åŠ¡ç®¡ç†å™¨TransactionSynchronizationManagerã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> Result <span class="title">register</span><span class="params">(String phone)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 1ã€ ... æ‰§è¡Œæ³¨å†Œé€»è¾‘</span></span><br><span class="line">        log.info(<span class="string">"[çº¿ç¨‹name=&#123;&#125;,register][æ‰§è¡Œç”¨æˆ·(&#123;&#125;) çš„æ³¨å†Œé€»è¾‘]"</span>, Thread.currentThread().getName(), phone);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2ã€ ä¿å­˜ç”¨æˆ·(å‡è®¾è¿™æ˜¯)</span></span><br><span class="line">        Long memberId = transactionTemplate.execute(status -&gt; &#123;</span><br><span class="line">            Long result = <span class="keyword">null</span>;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                BizLocalMessageEntity entity = <span class="keyword">new</span> BizLocalMessageEntity();</span><br><span class="line">                ThreadLocalRandom random = ThreadLocalRandom.current();</span><br><span class="line">                entity.setBizModule((<span class="keyword">byte</span>) <span class="number">0</span>);</span><br><span class="line">                entity.setBizNo(<span class="string">""</span> + random.nextInt(<span class="number">200000</span>));</span><br><span class="line">                entity.setBizType((<span class="keyword">byte</span>) <span class="number">0</span>);</span><br><span class="line">                entity.setMsg(<span class="string">"æ¶ˆæ¯å†…å®¹"</span>);</span><br><span class="line">                entity.setMsgDesc(<span class="string">"æ¶ˆæ¯å¤‡æ³¨"</span>);</span><br><span class="line">                entity.setCreateTime(<span class="keyword">new</span> Date());</span><br><span class="line">                entity.setUpdateTime(<span class="keyword">new</span> Date());</span><br><span class="line"></span><br><span class="line">                <span class="keyword">int</span> affectRow = bizLocalMessageMapper.insert(entity);</span><br><span class="line">                result = entity.getId();</span><br><span class="line">                log.info(<span class="string">"Version5 æ’å…¥çš„affectRow= [&#123;&#125;],ä¸»é”®[&#123;&#125;]"</span>, affectRow, result);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                log.error(<span class="string">"ä¸šåŠ¡å¤±è´¥å‘ç”Ÿå¼‚å¸¸"</span>, e);</span><br><span class="line">                <span class="comment">// æ ‡è®°äº‹åŠ¡å›æ»š</span></span><br><span class="line">                status.setRollbackOnly();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        log.info(<span class="string">"äº‹åŠ¡æ‰§è¡Œæƒ…å†µ ç”¨æˆ·çš„id= [&#123;&#125;]"</span>, memberId);</span><br><span class="line">        <span class="keyword">if</span> (memberId != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="comment">// 3ã€å¼‚æ­¥å‘å¸ƒäº‹ä»¶é€šçŸ¥</span></span><br><span class="line">            log.info(<span class="string">"å‘å¸ƒæ³¨å†ŒæˆåŠŸäº‹ä»¶"</span>);</span><br><span class="line">            CompletableFuture.runAsync(()-&gt;&#123;</span><br><span class="line">                applicationEventPublisher.publishEvent(<span class="keyword">new</span> SixUserRegisterEvent(<span class="keyword">this</span>, memberId, phone));</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Result();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>ä»£ç ä¿®æ”¹ä¹‹åæ‰§è¡Œï¼Œè¿è¡Œæˆªå›¾å¦‚ä¸‹ï¼š</p><p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210204222111.png" alt="è¿è¡Œæˆªå›¾"><br>æˆ‘ä»¬å¯ä»¥å‘ç°ä»£ç åˆ†åˆ«mainã€taskExecutor-1å’ŒtaskExecutor-2 ä¸‰ä¸ªçº¿ç¨‹æ‰§è¡Œçš„ï¼Œå®Œç¾çš„è§£å†³äº†ä¸Šé¢æåˆ°çš„é—®é¢˜ã€‚</p><p>ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼ä¹‹å‰çš„ç”¨æˆ·æ³¨å†Œæµç¨‹ï¼š</p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210204230251.png" alt="ä¼˜åŒ–åçš„æ³¨å†Œæµç¨‹" style="zoom:35%;" /><p>ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼ä¹‹åçš„ç”¨æˆ·æ³¨å†Œæµç¨‹ï¼š</p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210204230429.png" alt="ä¼˜åŒ–åçš„æ³¨å†Œæµç¨‹" style="zoom:30%;" /><h5 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h5><p>ç”¨æˆ·æ•°æ®å†™å…¥æ•°æ®è¡¨æˆåŠŸï¼Œå‘å¸ƒæ³¨å†ŒæˆåŠŸäº‹ä»¶ï¼Œé€šçŸ¥ç›¸å…³çš„çŸ­ä¿¡ã€ä¼˜æƒ åˆ¸ã€ç§¯åˆ†æ¨¡å—ã€‚ç”¨è§‚å¯Ÿè€…æ¨¡å¼å®ç°ä¹‹åï¼Œæ³¨å†Œé€»è¾‘å’Œå…¶ä»–çš„é€»è¾‘åˆ†ç¦»å¼€ï¼Œå³ä½¿åç»­æ–°åŠ ä¸€ä¸ªé‚®ä»¶é€šçŸ¥æˆ–è€…å»æ‰ä¸€ä¸ªå‘é€ç§¯åˆ†çš„æ“ä½œ,åªæ˜¯ä¿®æ”¹äº†å¯¹åº”çš„ä»£ç é€»è¾‘ï¼Œä¸ç”¨å›æ»šæµ‹è¯•æ‰€æœ‰åœºæ™¯ã€‚è¿™ç¬¦åˆå¯¹ä¿®æ”¹å…³é—­å¯¹æ‰©å±•å¼€æ”¾çš„è§„åˆ™ï¼Œæœ‰æ•ˆçš„é™ä½äº†å„ä¸ªæ¨¡å—ä¹‹é—´è€¦åˆåº¦ï¼Œä½¿å¾—ä»£ç çš„å¯ç»´æŠ¤æ€§å¤§å¤§æé«˜ã€‚æœ‰äº›åŒå­¦å¯èƒ½ä¼šæŠ±æ€¨ï¼Œè‡ªå·±çš„é¡¹ç›®ç®€å•ç”¨ä¸åˆ°è¿™äº›çœ‹ä¼¼é«˜å¤§ä¸Šçš„è®¾è®¡æ¨¡å¼ï¼Œå…¶å®ä¸ç„¶ï¼Œä½ åªæ˜¯æ²¡æœ‰è®¤çœŸç ”ç©¶è‡ªå·±çš„é¡¹ç›®ï¼Œè¿˜æœ‰å°±æ˜¯å¯¹è‡ªå·±çš„å†™çš„ä»£ç æ²¡æœ‰å¤ªé«˜çš„è¦æ±‚ã€‚å¦‚æœä½ çœ‹åˆ°äº†æœ¬æ–‡ï¼Œè€Œä¸”çœ‹åˆ°æ­¤å¤„ï¼Œä½ å›æƒ³ä¸€ä¸‹ä½ æ‰€åšçš„é¡¹ç›®ï¼Œéš¾é“æ²¡æœ‰ä¸€ä¸ªä¸šåŠ¡åœºæ™¯æ»¡è¶³è§‚å¯Ÿè€…æ¨¡å¼æ¡ä»¶ä¹ˆï¼Ÿä½ æƒ³æƒ³æ˜¯ä¸æ˜¯ï¼</p>]]></content>
      
      
      
        <tags>
            
            <tag> spring </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
            <tag> è§‚å¯Ÿè€…æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>èˆ¹æ–°ç‰ˆæœ¬çš„ç­–ç•¥æ¨¡å¼ï¼Œä½ ä¸€å®šæ²¡æœ‰è§è¿‡</title>
      <link href="/post/cd1b2f51.html"/>
      <url>/post/cd1b2f51.html</url>
      
        <content type="html"><![CDATA[<p>æˆ‘åœ¨ä¹‹å‰çš„æ–‡ç« <a href="https://ydstudios.gitee.io/post/170b3d6a.html">è®¾è®¡æ¨¡å¼å­¦ä¹ ä¹‹ç­–ç•¥æ¨¡å¼</a> ä¸€æ–‡ä¸­ä»‹ç»äº†ç­–ç•¥æ¨¡å¼çš„ä¼˜ç‚¹ã€ç¼ºç‚¹ã€å®ç°æ–¹æ³•å’Œå…·ä½“çš„ä½¿ç”¨åœºæ™¯ã€‚ç­–ç•¥ç±»æœ‰<code>ç­–ç•¥ç±»ä¼šå¢å¤š,é€ æˆç±»è†¨èƒ€</code>çš„ç¼ºç‚¹ï¼Œè¿™ä¸ªç¼ºç‚¹æˆ‘è¿˜æ˜¯æ¯”è¾ƒåœ¨æ„çš„ã€‚å› ä¸ºåœ¨å®é™…å¼€å‘ä¸­å‘ç°ï¼Œæœ‰æ—¶ç­–ç•¥çš„å®ç°æ²¡æœ‰å¤šå°‘ä»£ç ï¼Œè¿™æ ·çš„å®šä¹‰æˆä¸€ä¸ªç­–ç•¥ç±»åè€ŒçœŸçš„æœ‰ç‚¹æµªè´¹ï¼Œç¡®å®é€ æˆäº†ç±»è†¨èƒ€ã€‚è‡ªä»å‘ç°äº†è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä¸€ç›´åœ¨æ€è€ƒå¦‚ä½•è§£å†³è¿™ç§é—®é¢˜ï¼Œç»è¿‡æ€è€ƒè§£å†³é—®é¢˜çš„æ–¹æ³•å·²ç»æƒ³å‡ºæ¥äº†ï¼Œä½†æ˜¯ä¸€ç›´æ²¡æœ‰å»å°è¯•åšå‡ºæ¥çœ‹çœ‹æ˜¯å¦çœŸçš„èƒ½è§£å†³ç­–ç•¥æ¨¡å¼ <code>ç±»è†¨èƒ€çš„é—®é¢˜</code>,ç»ˆäºåœ¨è¿™å‘¨æˆ‘å¿™é‡Œå·é—²ç”¨ä»£ç å®ç°äº†æˆ‘çš„æƒ³æ³•ï¼Œæˆ‘è‡ªè®¤ä¸ºåˆ©ç”¨ <code>Lambdaè¡¨è¾¾å¼ + åå°„ + æ³¨è§£</code> ç»„åˆè§£å†³äº†<code>ç±»è†¨èƒ€çš„é—®é¢˜</code>ï¼Œè¿™ç§èˆ¹æ–°ç‰ˆæœ¬å®ç°æ–¹æ¡ˆï¼Œå®¹æˆ‘ç»†ç»†é“æ¥ï¼</p><a id="more"></a><blockquote><p>å¤§æ‰å¥½ï¼Œæˆ‘ç³»æ¸£æ¸£è¾‰ï¼Œæ¢æŒ½æ‡’æœˆï¼Œä»‹å››é‡Œæ²¡æœ‰æŒ½è¿‡çš„èˆ¹æ–°ç‰ˆæœ¬ï¼ŒæŒ¤éœ€ä½“éªŒä¸‰ç•ªé’Ÿï¼Œé‡Œé€ ä¼šå¹²æˆ‘ä¸€æ ·ï¼Œçˆ±è±¡èŠ‚æ¬¾æ¸¸æˆã€‚ â€”å¼€å¿ƒä¸€å“ˆ ğŸ˜„ğŸ˜„</p></blockquote><h5 id="ä»£ç ç»“æ„å›¾"><a href="#ä»£ç ç»“æ„å›¾" class="headerlink" title="ä»£ç ç»“æ„å›¾"></a>ä»£ç ç»“æ„å›¾</h5><p>è¿™ç§å®ç°æ–¹æ³•ï¼ŒUMLå›¾æ²¡æ³•å±•ç°å…¶ä¸­å…³ç³»ï¼Œæ‰€ä»¥å°±ä¸è´´UMLå›¾äº†ï¼Œç›´æ¥ä¸Šä»£ç çš„ç»“æ„å›¾ã€‚</p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210130154828.png" alt="èˆ¹æ–°ç‰ˆæœ¬ç­–ç•¥æ¨¡å¼" style="zoom:50%;" /><h5 id="ä¸»è¦æ€æƒ³"><a href="#ä¸»è¦æ€æƒ³" class="headerlink" title="ä¸»è¦æ€æƒ³"></a>ä¸»è¦æ€æƒ³</h5><ul><li>ä¸ºä½•ä¼šå‡ºç°ç±»è†¨èƒ€</li></ul><p>ç­–ç•¥æ¨¡å¼ç±»è†¨èƒ€çš„ç¼ºç‚¹ï¼Œå°±æ˜¯ç­–ç•¥ç±»å¤ªå¤šçš„ç¼˜æ•…ã€‚å¦‚æœç­–ç•¥ç±»çš„å®ç°ä»£ç ä¸æ˜¯å¾ˆå¤šï¼Œæ˜¯å¦å¯ä»¥å°†ç­–ç•¥ä¸åœ¨ç±»çš„çº§åˆ«ä¸Šå®ç°ï¼Ÿäºæ˜¯æƒ³åˆ°äº†åˆ©ç”¨Lambdaè¡¨è¾¾å¼çš„åŒ¿åç±»æ¥å®ç°ç­–ç•¥æ¥å£ï¼Œè¿™æ ·ä¸å°±æŠŠå®ç°ä»ç±»é™çº§åˆ°äº†æ–¹æ³•çº§åˆ«äº†ä¹ˆï¼Œå“ˆå“ˆğŸ˜„ğŸ˜„ï¼ï¼</p><ul><li>å¦‚ä½•å°†è¿™äº›ç­–ç•¥æ–¹æ³•ç»Ÿä¸€èµ·æ¥ï¼Œæ–¹ä¾¿å¤–éƒ¨è°ƒç”¨<br>ç­–ç•¥æ–¹æ³•éƒ½åœ¨ä¸€ä¸ªç±»ä¸­ï¼Œè¿™æ ·é¦–å…ˆè¦æ ‡æ³¨ä¸€ä¸‹æ–¹æ³•ï¼Œå“ªä¸ªæ˜¯ç­–ç•¥æ–¹æ³•ï¼Œå“ªä¸ªæ˜¯æ™®é€šæ–¹æ³•ã€‚è¿™ä¸ªé—®é¢˜æˆ‘ä»¬ç”¨æ³¨è§£æ¥å®ç°ï¼Œå› ä¸ºåœ¨Java è¯­è¨€ä¸­çš„ç±»ã€æ–¹æ³•ã€å˜é‡ã€å‚æ•°å’ŒåŒ…ç­‰éƒ½å¯ä»¥ç”¨æ³¨è§£æ¥æ ‡æ³¨ã€‚</li></ul><p>æˆ‘æƒ³æŠŠç­–ç•¥æ–¹æ³•å­˜æ”¾åœ¨Mapä¸­ï¼Œç”¨ç­–ç•¥çš„åå­—ä½œä¸ºMapçš„keyï¼Œç­–ç•¥æ–¹æ³•ä½œä¸ºMapçš„valueã€‚æˆ‘ä»¬åœ¨è¿™é‡Œç”¨åå°„æ¥å°†Lambdaå®ç°çš„åŒ¿åç±»å­˜æ”¾åˆ°Mapä¸­ã€‚</p><h5 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h5><ol><li><p>å®šä¹‰ä¸€ä¸ªç­–ç•¥æ³¨è§£ Strategyï¼Œç”¨æ¥æ ‡æ³¨ç­–ç•¥æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Strategy æ³¨è§£</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/1/26</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.7.7</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Inherited</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Target</span>(&#123;ElementType.METHOD,ElementType.TYPE&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Strategy &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ‡è¯†ä¸åŒçš„æ¨¡å— productã€orderæ¨¡å—</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">String <span class="title">module</span><span class="params">()</span> <span class="keyword">default</span> ""</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å…·ä½“çš„ç­–ç•¥ç±»å‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">String <span class="title">value</span><span class="params">()</span> <span class="keyword">default</span> ""</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ç­–ç•¥æ¥å£,è¿™é‡Œçš„ç­–ç•¥æ¥å£å¦‚æœä¸æ˜¯å¾ˆå¤æ‚çš„è¯å¯ä»¥ç”¨jdkè‡ªå¸¦çš„<code>java.util.function.Function&lt;T, R&gt;</code>æ›¿ä»£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &lt;T&gt; ç­–ç•¥çš„å…¥å‚ç±»å‹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &lt;R&gt; ç­–ç•¥çš„è¿”å›å€¼ç±»å‹</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/1/26</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.7.7</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IStrategyHandler</span>&lt;<span class="title">T</span>, <span class="title">R</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç­–ç•¥</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> param å‚æ•°</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">R <span class="title">apply</span><span class="params">(T param)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>AbstractStrategyå®ç°ä½¿ç”¨Springæä¾›çš„æ‰©å±•ç‚¹ApplicationContextAwareï¼Œåœ¨ç³»ç»Ÿå¯åŠ¨çš„æ—¶å€™å°†å¯¹åº”ç­–ç•¥æ–¹æ³•çš„å­˜æ”¾åœ¨Mapä¸­ï¼ŒåŒæ—¶å¯¹å¤–æä¾›æ‰§è¡Œå…¥å£ execute</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractStrategyContext</span>&lt;<span class="title">T</span>, <span class="title">R</span>&gt; <span class="keyword">implements</span> <span class="title">ApplicationContextAware</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, IStrategyHandler&lt;T, R&gt;&gt; implMap = <span class="keyword">new</span> ConcurrentHashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String DELIMITER = <span class="string">"####"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å¾—bean çš„class</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &lt;K&gt; ç±»å‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">abstract</span> &lt;K&gt; <span class="function">Class&lt;K&gt; <span class="title">getClazz</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿”å›springä¸­çš„beanName</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> String <span class="title">getBeanName</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‰§è¡Œå‡½æ•°</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> strategy ç­–ç•¥ç±»å‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> module   æ¨¡å—</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> param    å‚æ•°</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> R <span class="title">execute</span><span class="params">(String strategy, String <span class="keyword">module</span>, T param)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        String key = StringUtils.join(<span class="keyword">module</span>, DELIMITER, strategy);</span><br><span class="line">        IStrategyHandler&lt;T, R&gt; handler = implMap.get(key);</span><br><span class="line">        log.debug(<span class="string">"ç­–ç•¥å®ç°é›†åˆ&#123;&#125;"</span>, implMap);</span><br><span class="line">        <span class="keyword">if</span> (handler == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"æ²¡æœ‰ç›¸åº”çš„ç­–ç•¥å®ç°"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        R apply = handler.apply(param);</span><br><span class="line">        <span class="keyword">return</span> apply;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setApplicationContext</span><span class="params">(ApplicationContext applicationContext)</span> <span class="keyword">throws</span> BeansException </span>&#123;</span><br><span class="line">        log.error(<span class="string">"AbstractStrategy æ‰§è¡Œ"</span>);</span><br><span class="line"></span><br><span class="line">        Class&lt;Object&gt; clazz = getClazz();</span><br><span class="line">        Object bean = applicationContext.getBean(getBeanName(), clazz);</span><br><span class="line">        <span class="keyword">if</span> (bean == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        Strategy strategyAnnotation = bean.getClass().getAnnotation(Strategy<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        <span class="keyword">if</span> (strategyAnnotation == <span class="keyword">null</span>) &#123;</span><br><span class="line">            log.error(<span class="string">"ç±»[&#123;&#125;]æ²¡æœ‰æ·»åŠ Strategyæ³¨è§£"</span>, clazz);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ¨¡å—çš„åç§°</span></span><br><span class="line">        String <span class="keyword">module</span> = strategyAnnotation.<span class="keyword">module</span>();</span><br><span class="line">        Method[] declaredMethods = clazz.getDeclaredMethods();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (ArrayUtils.isEmpty(declaredMethods)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(clazz + <span class="string">"æ²¡æœ‰ç›¸å…³ç­–ç•¥æ–¹æ³•"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (Method declaredMethod : declaredMethods) &#123;</span><br><span class="line">            Strategy annotation = declaredMethod.getAnnotation(Strategy<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">            <span class="keyword">if</span> (annotation == <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">// ç”¨moduleå’Œ å››ä¸ª #### åŠ ä¸Š value ç»„æˆmapçš„key</span></span><br><span class="line">                String key = StringUtils.join(<span class="keyword">module</span>, DELIMITER, annotation.value());</span><br><span class="line">                IStrategyHandler&lt;T, R&gt; handler = (IStrategyHandler&lt;T, R&gt;) declaredMethod.invoke(bean);</span><br><span class="line">                implMap.put(key, handler);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IllegalAccessException | InvocationTargetException e) &#123;</span><br><span class="line">                log.error(<span class="string">"æ¨¡å—[&#123;&#125;]ç­–ç•¥å¤„ç†å‘ç”Ÿäº†é”™è¯¯"</span>, <span class="keyword">module</span>, e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>è®¢å•ã€äº§å“æ¨¡å—æœ‰è¿™ç§ç­–ç•¥æ¨¡å¼åœºæ™¯</p></li></ol><p>è®¢å•æ¨¡å—çš„ç­–ç•¥æ¨¡å¼åœºæ™¯,IStrategyHandlerçš„ç­–ç•¥æ–¹æ³•éƒ½åœ¨OrderStrategyImplä¸­å®ç°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Strategy</span>(<span class="keyword">module</span> = <span class="string">"Order"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderStrategyImpl</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> BizLocalMessageService bizLocalMessageService;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Strategy</span>(value = <span class="string">"strategy1"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> IStrategyHandler&lt;BInDto, BOutDto&gt; <span class="title">strategy1</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> bInDto -&gt; &#123;</span><br><span class="line">            log.error(<span class="string">"è®¢å•æ¨¡å—ç›¸å…³ç­–ç•¥ strategy1 executeStart"</span>);</span><br><span class="line">            String join = StringUtils.join(<span class="string">"strategy1:"</span>, bInDto.getParam1(), bInDto.getParam2());</span><br><span class="line">            BOutDto bOutDto = <span class="keyword">new</span> BOutDto();</span><br><span class="line">            bOutDto.setOrderNo(join);</span><br><span class="line">            bOutDto.setPrice(<span class="number">111</span>);</span><br><span class="line"></span><br><span class="line">            SaveBizLocalMessageDto dto = <span class="keyword">new</span> SaveBizLocalMessageDto();</span><br><span class="line">            dto.setBizModule((<span class="keyword">byte</span>)<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">            ThreadLocalRandom localRandom = ThreadLocalRandom.current();</span><br><span class="line">            dto.setBizNo(localRandom.nextInt(<span class="number">16000</span>,<span class="number">115000</span>)+<span class="string">""</span>);</span><br><span class="line">            dto.setBizType((<span class="keyword">byte</span>)<span class="number">0</span>);</span><br><span class="line">            dto.setMsg(<span class="string">""</span>);</span><br><span class="line">            dto.setMsgDesc(<span class="string">""</span>);</span><br><span class="line">            dto.setHandledCount((<span class="keyword">byte</span>)<span class="number">0</span>);</span><br><span class="line">            dto.setMaxHandleCount((<span class="keyword">byte</span>)<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">            bizLocalMessageService.saveBizLocalMessage(dto);</span><br><span class="line">            log.error(<span class="string">"è®¢å•æ¨¡å—ç›¸å…³ç­–ç•¥ strategy1 executeEnd"</span>);</span><br><span class="line">            <span class="keyword">return</span> bOutDto;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Strategy</span>(value = <span class="string">"strategy2"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> IStrategyHandler&lt;BInDto, BOutDto&gt; <span class="title">strategy2</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> param -&gt; &#123;</span><br><span class="line"></span><br><span class="line">            log.error(<span class="string">"è®¢å•æ¨¡å—ç›¸å…³ç­–ç•¥ strategy2 executeStart"</span>);</span><br><span class="line"></span><br><span class="line">            String join = StringUtils.join(<span class="string">"strategy2:"</span>, param.getParam1(), param.getParam2());</span><br><span class="line">            BOutDto bOutDto = <span class="keyword">new</span> BOutDto();</span><br><span class="line">            bOutDto.setOrderNo(join);</span><br><span class="line">            bOutDto.setPrice(<span class="number">11121</span>);</span><br><span class="line"></span><br><span class="line">            SaveBizLocalMessageDto dto = <span class="keyword">new</span> SaveBizLocalMessageDto();</span><br><span class="line">            dto.setBizModule((<span class="keyword">byte</span>)<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">            ThreadLocalRandom localRandom = ThreadLocalRandom.current();</span><br><span class="line">            dto.setBizNo(localRandom.nextInt(<span class="number">6000</span>,<span class="number">15000</span>)+<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line">            dto.setBizType((<span class="keyword">byte</span>)<span class="number">0</span>);</span><br><span class="line">            dto.setMsg(<span class="string">""</span>);</span><br><span class="line">            dto.setMsgDesc(<span class="string">""</span>);</span><br><span class="line">            dto.setHandledCount((<span class="keyword">byte</span>)<span class="number">0</span>);</span><br><span class="line">            dto.setMaxHandleCount((<span class="keyword">byte</span>)<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">            bizLocalMessageService.saveBizLocalMessage(dto);</span><br><span class="line">            log.error(<span class="string">"è®¢å•æ¨¡å—ç›¸å…³ç­–ç•¥ strategy2 executeEnd"</span>);</span><br><span class="line">            <span class="keyword">return</span> bOutDto;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>äº§å“æ¨¡å—çš„ç­–ç•¥æ¨¡å¼åœºæ™¯ï¼ŒIStrategyHandlerçš„ç­–ç•¥æ–¹æ³•éƒ½åœ¨ProductStrategyImplä¸­å®ç°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Strategy</span>(<span class="keyword">module</span> = <span class="string">"Product"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductStrategyImpl</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> BizLocalMessageService bizLocalMessageService;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Strategy</span>(value = <span class="string">"strategyA"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> IStrategyHandler&lt;BInDto, BOutDto&gt; <span class="title">strategy1</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> bInDto -&gt; &#123;</span><br><span class="line"></span><br><span class="line">            log.error(<span class="string">"äº§å“æ¨¡å—ç›¸å…³ç­–ç•¥ strategy1 executeStart"</span>);</span><br><span class="line"></span><br><span class="line">            String join = StringUtils.join(<span class="string">"strategyA:"</span>, bInDto.getParam1(), bInDto.getParam2());</span><br><span class="line">            BOutDto bOutDto = <span class="keyword">new</span> BOutDto();</span><br><span class="line">            bOutDto.setOrderNo(join);</span><br><span class="line">            bOutDto.setPrice(<span class="number">111</span>);</span><br><span class="line"></span><br><span class="line">            SaveBizLocalMessageDto dto = <span class="keyword">new</span> SaveBizLocalMessageDto();</span><br><span class="line">            dto.setBizModule((<span class="keyword">byte</span>)<span class="number">0</span>);</span><br><span class="line">            ThreadLocalRandom localRandom = ThreadLocalRandom.current();</span><br><span class="line">            dto.setBizNo(localRandom.nextInt(<span class="number">1000</span>,<span class="number">5000</span>)+<span class="string">""</span>);</span><br><span class="line">            dto.setBizType((<span class="keyword">byte</span>)<span class="number">0</span>);</span><br><span class="line">            dto.setMsg(<span class="string">""</span>);</span><br><span class="line">            dto.setMsgDesc(<span class="string">""</span>);</span><br><span class="line">            dto.setHandledCount((<span class="keyword">byte</span>)<span class="number">0</span>);</span><br><span class="line">            dto.setMaxHandleCount((<span class="keyword">byte</span>)<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">            bizLocalMessageService.saveBizLocalMessage(dto);</span><br><span class="line"></span><br><span class="line">            log.error(<span class="string">"äº§å“æ¨¡å—ç›¸å…³ç­–ç•¥ strategy1 executeEnd"</span>);</span><br><span class="line">            <span class="keyword">return</span> bOutDto;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Strategy</span>(value = <span class="string">"strategyB"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> IStrategyHandler&lt;BInDto, BOutDto&gt; <span class="title">strategy2</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> param -&gt; &#123;</span><br><span class="line"></span><br><span class="line">            log.error(<span class="string">"äº§å“æ¨¡å—ç›¸å…³ç­–ç•¥ strategy2 executeStart"</span>);</span><br><span class="line"></span><br><span class="line">            String join = StringUtils.join(<span class="string">"strategyB:"</span>, param.getParam1(), param.getParam2());</span><br><span class="line">            BOutDto bOutDto = <span class="keyword">new</span> BOutDto();</span><br><span class="line">            bOutDto.setOrderNo(join);</span><br><span class="line">            bOutDto.setPrice(<span class="number">11121</span>);</span><br><span class="line"></span><br><span class="line">            SaveBizLocalMessageDto dto = <span class="keyword">new</span> SaveBizLocalMessageDto();</span><br><span class="line">            dto.setBizModule((<span class="keyword">byte</span>)<span class="number">0</span>);</span><br><span class="line">            ThreadLocalRandom localRandom = ThreadLocalRandom.current();</span><br><span class="line">            dto.setBizNo(localRandom.nextInt(<span class="number">5000</span>,<span class="number">8000</span>)+<span class="string">""</span>);</span><br><span class="line">            dto.setBizType((<span class="keyword">byte</span>)<span class="number">0</span>);</span><br><span class="line">            dto.setMsg(<span class="string">""</span>);</span><br><span class="line">            dto.setMsgDesc(<span class="string">""</span>);</span><br><span class="line">            dto.setHandledCount((<span class="keyword">byte</span>)<span class="number">0</span>);</span><br><span class="line">            dto.setMaxHandleCount((<span class="keyword">byte</span>)<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">            bizLocalMessageService.saveBizLocalMessage(dto);</span><br><span class="line"></span><br><span class="line">            log.error(<span class="string">"äº§å“æ¨¡å—ç›¸å…³ç­–ç•¥ strategy2  executeEnd"</span>);</span><br><span class="line">            <span class="keyword">return</span> bOutDto;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="5"><li>å°†å­˜æ”¾ç­–ç•¥æ–¹æ³•çš„ç±»å’Œç­–ç•¥ä¸Šä¸‹æ–‡å…³è”èµ·æ¥</li></ol><p>è®¢å•æ¨¡å—ç›¸å…³</p>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderStrategyContext</span> <span class="keyword">extends</span> <span class="title">AbstractStrategyContext</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function">Class&lt;OrderStrategyImpl&gt; <span class="title">getClazz</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> OrderStrategyImpl<span class="class">.<span class="keyword">class</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function">String <span class="title">getBeanName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"orderStrategyImpl"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>äº§å“æ¨¡å—ç›¸å…³</p>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductStrategyContext</span> <span class="keyword">extends</span> <span class="title">AbstractStrategyContext</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function">Class&lt;ProductStrategyImpl&gt; <span class="title">getClazz</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ProductStrategyImpl<span class="class">.<span class="keyword">class</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function">String <span class="title">getBeanName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"productStrategyImpl"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="6"><li>ä»£ç å®ç°å®Œæ¯•ï¼Œæˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ContextConfiguration</span>(locations = &#123;<span class="string">"classpath:spring/spring-dao.xml"</span>,<span class="string">"classpath:spring/spring-service.xml"</span>&#125;)</span><br><span class="line"><span class="meta">@RunWith</span>(value = SpringJUnit4ClassRunner<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">StrategyTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> AbstractStrategy&lt;BInDto, BOutDto&gt; orderStrategyContext;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> AbstractStrategy&lt;BInDto, BOutDto&gt; productStrategyContext;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">productTest</span><span class="params">()</span></span>&#123;</span><br><span class="line">        BInDto bInDto = <span class="keyword">new</span> BInDto();</span><br><span class="line">        bInDto.setParam1(<span class="string">"äº§å“é‡‘é¢"</span>);</span><br><span class="line">        bInDto.setParam2(<span class="number">222</span>);</span><br><span class="line"></span><br><span class="line">        productStrategyContext.execute(<span class="string">"strategyA"</span>, <span class="string">"Product"</span>, bInDto);</span><br><span class="line">        productStrategyContext.execute(<span class="string">"strategyB"</span>, <span class="string">"Product"</span>, bInDto);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">orderTest</span><span class="params">()</span></span>&#123;</span><br><span class="line">        BInDto bInDto = <span class="keyword">new</span> BInDto();</span><br><span class="line">        bInDto.setParam1(<span class="string">"ä¼˜æƒ åˆ¸é‡‘é¢"</span>);</span><br><span class="line">        bInDto.setParam2(<span class="number">180</span>);</span><br><span class="line"></span><br><span class="line">        orderStrategyContext.execute(<span class="string">"strategy1"</span>, <span class="string">"Order"</span>, bInDto);</span><br><span class="line">        orderStrategyContext.execute(<span class="string">"strategy2"</span>, <span class="string">"Order"</span>, bInDto);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>äº§å“æ¨¡å—çš„æµ‹è¯•<br><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210130164441.png" alt="äº§å“æ¨¡å—çš„æµ‹è¯•" style="zoom:50%;" /></p><p>è®¢å•æ¨¡å—çš„æµ‹è¯•</p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210130164512.png" alt="è®¢å•æ¨¡å—çš„æµ‹è¯•" style="zoom:50%;" /><h5 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h5><p>ç­–ç•¥æ¥å£ä¸æ˜¯å¾ˆå¤æ‚çš„æƒ…å†µä¸‹ IStrategyHandler æ¥å£å¯ä»¥å¤ç”¨ï¼Œè‡ªå·±å®ç° StrategyContext æŠ½è±¡ç±»ï¼Œç„¶åå†å®ç°è‡ªå·±çš„ç­–ç•¥æ–¹æ³•å°±å¯ä»¥äº†ï¼Œä¸çŸ¥å¤§å®¶å¯¹äºè¿™ç§èˆ¹æ–°ç‰ˆæœ¬æœ‰ä»€ä¹ˆçœ‹æ³•ï¼</p>]]></content>
      
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
            <tag> ç­–ç•¥æ¨¡å¼ </tag>
            
            <tag> åå°„ </tag>
            
            <tag> lambdaè¡¨è¾¾å¼ </tag>
            
            <tag> æ³¨è§£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>UMLç±»å›¾</title>
      <link href="/post/122fc4b2.html"/>
      <url>/post/122fc4b2.html</url>
      
        <content type="html"><![CDATA[<h5 id="UML"><a href="#UML" class="headerlink" title="UML"></a>UML</h5><p>UML(Unified Modeling Languageï¼Œç»Ÿä¸€å»ºæ¨¡è¯­è¨€)æ˜¯ä¸€ç§ä¸ºé¢å‘å¯¹è±¡ç³»ç»Ÿçš„äº§å“è¿›è¡Œè¯´æ˜ã€å¯è§†åŒ–å’Œç¼–åˆ¶æ–‡æ¡£çš„ä¸€ç§æ ‡å‡†è¯­è¨€ï¼Œæ˜¯éä¸“åˆ©çš„ç¬¬ä¸‰ä»£å»ºæ¨¡å’Œè§„çº¦è¯­è¨€ã€‚UMLæ˜¯é¢å‘å¯¹è±¡è®¾è®¡çš„å»ºæ¨¡å·¥å…·ï¼Œç‹¬ç«‹äºä»»ä½•å…·ä½“ç¨‹åºè®¾è®¡è¯­è¨€ã€‚</p><a id="more"></a><h5 id="UMLå’Œè®¾è®¡æ¨¡å¼"><a href="#UMLå’Œè®¾è®¡æ¨¡å¼" class="headerlink" title="UMLå’Œè®¾è®¡æ¨¡å¼"></a>UMLå’Œè®¾è®¡æ¨¡å¼</h5><p>è®¾è®¡æ¨¡å¼ï¼ˆDesign patternï¼‰æ˜¯ä¸€å¥—è¢«åå¤ä½¿ç”¨ã€å¤šæ•°äººçŸ¥æ™“çš„ã€ç»è¿‡åˆ†ç±»ç¼–ç›®çš„ã€ä»£ç è®¾è®¡ç»éªŒçš„æ€»ç»“ã€‚<strong>ä¸ªäººè§‰å¾—è®¾è®¡æ¨¡å¼æ˜¯å‰äººå¤§ä½¬æ€»ç»“çš„ä¸€ç§æ€æƒ³ï¼Œæ˜¯ä¸€ç§è„±ç¦»è¯­è¨€å¹¶ä¸”èƒ½å¤ŸæŒ‡å¯¼ç¨‹åºå‘˜æ›´å®¹æ˜“å†™å‡ºå¥½çš„ä»£ç çš„ç¼–ç¨‹ä¹ æƒ¯ã€‚</strong>å¯¹äºä¸€ä¸ªæ²¡æœ‰å¤ªå¤šç»éªŒçš„ç¨‹åºå‘˜ï¼Œå¦‚ä½•å†™å‡º <strong>ç®€æ´ä¼˜é›…ï¼Œå¯å¤ç”¨æ€§é«˜ï¼Œå¯æ‰©å±•æ€§å¼ºï¼Œé«˜å†…èšä½è€¦åˆ</strong> çš„ä»£ç è‡³å…³é‡è¦ã€‚å­¦ä¹ åˆ«äººçš„è®¾è®¡æ¨¡å¼å°±æ˜¯ä¸ºäº†åœ¨æ²¡æœ‰ç»éªŒçš„æƒ…å†µä¸‹å†™å‡ºä¸€æ‰‹ä¸é”™çš„ä»£ç ï¼Œåªçœ‹ä¸å†™å¹¶ä¸èƒ½æ·±åˆ»ä½“éªŒåˆ°è®¾è®¡æ¨¡å¼çš„å·§å¦™ä¹‹å¤„ï¼Œè€Œå­¦ä¼šä½¿ç”¨UMLè¿›è¡Œéœ€æ±‚åˆ†æï¼Œæ˜¯ä½¿ç”¨è®¾è®¡æ¨¡å¼å†™å¥½ä»£ç çš„å‰æã€‚</p><h5 id="UMLå›¾åˆ†ç±»"><a href="#UMLå›¾åˆ†ç±»" class="headerlink" title="UMLå›¾åˆ†ç±»"></a>UMLå›¾åˆ†ç±»</h5><ul><li>ç”¨ä¾‹å›¾(Use Case Diagram)ï¼Œæè¿°ç³»ç»ŸåŠŸèƒ½ï¼›</li><li>ç±»å›¾(Class Diagram)ï¼Œæè¿°ç³»ç»Ÿçš„é™æ€ç»“æ„ï¼›</li><li>å¯¹è±¡å›¾(Object Diagram)ï¼Œæè¿°ç³»ç»Ÿåœ¨æŸä¸ªæ—¶åˆ»çš„é™æ€ç»“æ„ï¼›</li><li>ç»„ä»¶å›¾(Component Diagram)ï¼Œæè¿°äº†å®ç°ç³»ç»Ÿçš„å…ƒç´ çš„ç»„ç»‡ï¼›</li><li>é…ç½®å›¾(Deployment Diagram)ï¼Œæè¿°äº†ç¯å¢ƒå…ƒç´ çš„é…ç½®ï¼Œå¹¶æŠŠå®ç°ç³»ç»Ÿçš„å…ƒç´ æ˜ å°„åˆ°é…ç½®ä¸Šï¼›</li><li>çŠ¶æ€å›¾(State Diagram)ï¼Œæè¿°äº†ç³»ç»Ÿå…ƒç´ çš„çŠ¶æ€æ¡ä»¶å’Œå“åº”ï¼›</li><li>æ—¶åºå›¾(Sequence Diagram)ï¼ŒæŒ‰æ—¶é—´é¡ºåºæè¿°ç³»ç»Ÿå…ƒç´ é—´çš„äº¤äº’ï¼›</li><li>åä½œå›¾(Collaboration Diagram)ï¼ŒæŒ‰ç…§æ—¶é—´å’Œç©ºé—´é¡ºåºæè¿°ç³»ç»Ÿå…ƒç´ é—´çš„äº¤äº’å’Œå®ƒä»¬ä¹‹é—´çš„å…³ç³»ï¼›</li><li>æ´»åŠ¨å›¾(Activity Diagram)ï¼Œæè¿°äº†ç³»ç»Ÿå…ƒç´ çš„æ´»åŠ¨ï¼›</li></ul><blockquote><p>å…¶ä¸­ç±»å›¾æ˜¯æè¿°ç±»ä¸ç±»ä¹‹é—´çš„å…³ç³»çš„ï¼Œæ˜¯UMLå›¾ä¸­æœ€æ ¸å¿ƒçš„ã€‚</p></blockquote><h5 id="UMLä½œç”¨"><a href="#UMLä½œç”¨" class="headerlink" title="UMLä½œç”¨"></a>UMLä½œç”¨</h5><ul><li><p>ä¸ºè½¯ä»¶ç³»ç»Ÿå»ºç«‹å¯è§†åŒ–æ¨¡å‹ï¼›</p></li><li><p>èƒ½å¤Ÿäº†è§£ç³»ç»Ÿçš„ç»“æ„å’Œèƒ½åŠ›ï¼›</p></li><li><p>ä¸ºè½¯ä»¶ç³»ç»Ÿå»ºç«‹æ„ä»¶ï¼›</p></li><li><p>ä¸ºè½¯ä»¶ç³»ç»Ÿå»ºç«‹æ–‡æ¡£ï¼›</p></li></ul><blockquote><p>ä»€ä¹ˆæ˜¯æ¨¡å‹ï¼Ÿæ¨¡å‹æ˜¯å¯¹ç°å®ä¸–ç•Œçš„å½¢çŠ¶æˆ–çŠ¶æ€çš„æŠ½è±¡æ¨¡æ‹Ÿå’Œç®€åŒ–ã€‚<br>ä¸ºä»€ä¹ˆè¦å»ºæ¨¡ï¼Ÿæœ€ç®€å•çš„ç†ç”±ï¼šä¸ºäº†èƒ½å¤Ÿæ›´å¥½åœ°ç†è§£æ­£åœ¨å¼€å‘çš„ç³»ç»Ÿã€‚</p></blockquote><h5 id="UML-ç±»å›¾"><a href="#UML-ç±»å›¾" class="headerlink" title="UML ç±»å›¾"></a>UML ç±»å›¾</h5><p>å­¦ä¹ è®¾è®¡æ¨¡å¼å¿…å®šéœ€è¦å…ˆè¯»æ‡‚ UML ç±»å›¾ï¼Œä¸‹é¢å°±è°ˆè°ˆå…·ä½“ UML ç±»å›¾ä¸­çš„æ¦‚å¿µã€‚ç±»å›¾æ˜¯ç”¨äºæè¿°ä¸€ç»„ç±»ã€æ¥å£ã€åä½œä»¥åŠå®ƒä»¬ä¹‹é—´çš„é™æ€å…³ç³»ã€‚åœ¨é¢å‘å¯¹è±¡ç³»ç»Ÿçš„å»ºæ¨¡ä¸­ï¼Œç±»å›¾æ˜¯æœ€ä¸ºå¸¸ç”¨çš„å›¾ï¼Œå®ƒç”¨æ¥é˜æ˜ç³»ç»Ÿçš„é™æ€ç»“æ„ã€‚äº‹å®ä¸Šç±»æ˜¯å¯¹ä¸€ç»„å…·æœ‰ç›¸åŒå±æ€§ã€æ“ä½œã€å…³ç³»å’Œè¯­ä¹‰çš„å¯¹è±¡çš„æè¿°ï¼Œå…¶ä¸­å¯¹ç±»çš„å±æ€§å’Œæ“ä½œè¿›è¡Œæè¿°æ—¶çš„ä¸€ä¸ªæœ€é‡è¦çš„ç»†èŠ‚å°±æ˜¯å®ƒçš„å¯è§æ€§ã€‚</p><h6 id="ç±»å›¾çš„åŸºæœ¬ç¬¦å·ä¸å«ä¹‰"><a href="#ç±»å›¾çš„åŸºæœ¬ç¬¦å·ä¸å«ä¹‰" class="headerlink" title="ç±»å›¾çš„åŸºæœ¬ç¬¦å·ä¸å«ä¹‰"></a>ç±»å›¾çš„åŸºæœ¬ç¬¦å·ä¸å«ä¹‰</h6><p>1ã€ <strong>ç±»(Class)</strong>ï¼šä¸€èˆ¬æ˜¯ç”¨ä¸‰å±‚çŸ©å½¢æ¡†è¡¨ç¤ºï¼Œç¬¬ä¸€å±‚è¡¨ç¤ºç±»çš„åç§°ï¼Œç¬¬äºŒå±‚è¡¨ç¤ºçš„æ˜¯å­—æ®µå’Œå±æ€§ï¼Œç¬¬ä¸‰å±‚åˆ™æ˜¯ç±»çš„æ–¹æ³•ã€‚ç¬¬ä¸€å±‚ä¸­ï¼Œå¦‚æœæ˜¯æŠ½è±¡ç±»ï¼Œéœ€ç”¨æ–œä½“æ˜¾ç¤ºã€‚</p><ul><li><p><strong>ç±»çš„å±æ€§</strong>è¡¨è¾¾æ–¹å¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æƒé™ å±æ€§åï¼šç±»å‹ [ = é»˜è®¤å€¼ ]</span><br></pre></td></tr></table></figure></li><li><p><strong>ç±»çš„æ–¹æ³•</strong>è¡¨è¾¾æ–¹å¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æƒé™  æ–¹æ³•åç§°(å‚æ•°åˆ—è¡¨) [ : è¿”å›ç±»å‹]</span><br></pre></td></tr></table></figure><blockquote><p>  æ³¨æ„ï¼špublic ç”¨    <code>+</code>  è¡¨ç¤º ï¼Œprotected ç”¨   <code>#</code>  è¡¨ç¤º ï¼Œprivate ç”¨   <code>-</code>  è¡¨ç¤º ï¼Œdefault ç”¨   <code>~</code>  è¡¨ç¤º</p></blockquote></li></ul><p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210123143148.png" alt="ç±»å›¾ç¤º"></p><p>2ã€<strong>æ¥å£(interface)</strong>ï¼šæ¥å£ä¸ç±»å›¾ç±»ä¼¼ï¼Œä¸ç±»å›¾çš„ä¸»è¦åŒºåˆ«å°±æ˜¯é¡¶ç«¯æœ‰<code>&lt;&lt;interface&gt;&gt;</code>æ˜¾ç¤ºã€‚</p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210123143316.png" style="zoom:50%;"  alt="æ¥å£ç¤ºä¾‹å›¾"/><p>3ã€ç±»ä¹‹é—´çš„å…³ç³»<br>ç±»ä¸ç±»ä¸€å…±æœ‰å¦‚ä¸‹6ç§å…³ç³»ï¼šæ³›åŒ–ï¼ˆGeneralizationï¼‰ã€å®ç°ï¼ˆRealizationï¼‰ã€ç»„åˆï¼ˆCompositionï¼‰ã€èšåˆï¼ˆAggregationï¼‰ã€å…³è”ï¼ˆAssociationï¼‰ã€ä¾èµ– ï¼ˆDependenceï¼‰ã€‚ä¸Šè¿°6ç§å…³ç³»çš„å¼ºå¼±å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ³›åŒ– = å®ç° &gt; ç»„åˆ &gt; èšåˆ &gt; å…³è” &gt; ä¾èµ–</span><br></pre></td></tr></table></figure><p><strong>ç±»å…³ç³»å›¾ç¤º</strong></p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210123142628.png" alt="ç±»å…³ç³»å›¾ç¤º" style="zoom:50%;" /><ul><li><p>æ³›åŒ–ï¼ˆGeneralizationï¼‰ï¼šè¡¨ç¤ºçš„æ˜¯ç±»ä¹‹é—´çš„ç»§æ‰¿å…³ç³»ï¼Œæ³¨æ„æ˜¯å­ç±»æŒ‡å‘çˆ¶ç±»ã€‚UMLä¸­ç”¨å¸¦ç©ºå¿ƒä¸‰è§’ç®­å¤´çš„å®çº¿è¡¨ç¤ºæ³›åŒ–å…³ç³»ï¼Œç®­å¤´æŒ‡å‘çš„æ˜¯çˆ¶ç±»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">People</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword">extends</span> <span class="title">People</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Double grade;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">study</span><span class="params">(String course)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"å­¦ä¹ "</span> + course);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Long <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Long id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Double <span class="title">getGrade</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> grade;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setGrade</span><span class="params">(Double grade)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.grade = grade;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>å®ç°(Realization)ï¼šå®ç°å…³ç³»ç”¨ä¸€æ¡å¸¦ç©ºå¿ƒç®­å¤´çš„è™šçº¿è¡¨ç¤ºã€‚UMLä¸­ç”¨å¸¦ç©ºå¿ƒä¸‰è§’ç®­å¤´çš„è™šçº¿è¡¨ç¤ºå®ç°å…³ç³»ï¼Œç®­å¤´æŒ‡å‘çš„æ˜¯æ¥å£ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IWork</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">doWork</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">People</span> <span class="keyword">implements</span> <span class="title">IWork</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doWork</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"å·¥ä½œ"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ç»„åˆ(Composition)ï¼šæ˜¯èšåˆçš„ä¸€ç§ç‰¹æ®Šå½¢å¼ï¼Œè¡¨ç¤ºçš„æ˜¯ç±»ä¹‹é—´æ›´å¼ºçš„ç»„åˆå…³ç³»ã€‚ä»–ä½“ç°çš„æ˜¯ä¸€ç§contains-açš„å…³ç³»ï¼Œè¿™ç§å…³ç³»æ¯”èšåˆæ›´å¼ºï¼Œä¹Ÿç§°ä¸ºå¼ºèšåˆï¼›ä»–åŒæ ·ä½“ç°æ•´ä½“ä¸éƒ¨åˆ†é—´çš„å…³ç³»ï¼Œä½†æ­¤æ—¶æ•´ä½“ä¸éƒ¨åˆ†æ˜¯ä¸å¯åˆ†çš„ï¼Œæ•´ä½“çš„ç”Ÿå‘½å‘¨æœŸç»“æŸä¹Ÿå°±æ„å‘³ç€éƒ¨åˆ†çš„ç”Ÿå‘½å‘¨æœŸç»“æŸã€‚UMLä¸­ç”¨å®å¿ƒè±å½¢å¤´çš„å®çº¿æ¥è¡¨ç¤ºç»„åˆï¼Œè±å½¢å¤´æŒ‡å‘æ•´ä½“ã€‚</p></li></ul><blockquote><p>ä¾‹å¦‚å…¬å¸ç”±å¤šä¸ªéƒ¨é—¨ç»„æˆï¼›å…¬å¸ä¸å­˜åœ¨äº†ï¼Œéƒ¨é—¨ä¹Ÿå°†ä¸å­˜åœ¨äº†ã€‚</p></blockquote><ul><li>èšåˆï¼ˆAggregationï¼‰ï¼šç”¨äºè¡¨ç¤ºå®ä½“å¯¹è±¡ä¹‹é—´çš„å…³ç³»ï¼Œè¡¨ç¤ºæ•´ä½“ç”±éƒ¨åˆ†æ„æˆçš„è¯­ä¹‰ã€‚ä¸ç»„åˆå…³ç³»ä¸åŒçš„æ˜¯ï¼Œæ•´ä½“å’Œéƒ¨åˆ†ä¸æ˜¯å¼ºä¾èµ–çš„ï¼Œå³ä½¿æ•´ä½“ä¸å­˜åœ¨äº†ï¼Œéƒ¨åˆ†ä»ç„¶å­˜åœ¨ï¼›èšåˆå…³ç³»æ˜¯å…³è”å…³ç³»çš„ä¸€ç§ï¼Œè€¦åˆåº¦å¼ºäºå…³è”ï¼Œä»–ä»¬çš„ä»£ç è¡¨ç°æ˜¯ç›¸åŒçš„ï¼Œä»…ä»…æ˜¯åœ¨è¯­ä¹‰ä¸Šæœ‰æ‰€åŒºåˆ«ï¼šå…³è”å…³ç³»çš„å¯¹è±¡é—´æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œè€Œèšåˆå…³ç³»çš„å¯¹è±¡ä¹‹é—´å­˜åœ¨ç€åŒ…å®¹å…³ç³»ï¼Œä»–ä»¬ä¹‹é—´æ˜¯â€œæ•´ä½“-ä¸ªä½“â€çš„ç›¸äº’å…³ç³»ã€‚UMLä¸­ç”¨ç©ºå¿ƒè±å½¢å¤´çš„å®çº¿è¡¨ç¤ºèšåˆå…³ç³»ï¼Œè±å½¢å¤´æŒ‡å‘æ•´ä½“ã€‚</li></ul><blockquote><p>ä¾‹å¦‚ä¸€ä¸ªéƒ¨é—¨ç”±å¤šä¸ªå‘˜å·¥ç»„æˆï¼Œéƒ¨é—¨æ’¤é”€äº†ï¼Œäººå‘˜ä¸ä¼šæ¶ˆå¤±ï¼Œä»–ä»¬ä¾ç„¶å­˜åœ¨ã€‚</p></blockquote><ul><li>å…³è”(Association)ï¼šè¡¨ç¤ºçš„æ˜¯ç±»ä¸ç±»ä¹‹é—´å­˜åœ¨æŸç§ç‰¹å®šçš„å¯¹åº”å…³ç³»ã€‚å®ƒæ˜¯ä¸€ç§é™æ€å…³ç³»ï¼Œé€šå¸¸ä¸è¿è¡ŒçŠ¶æ€æ— å…³ï¼Œä¸€èˆ¬ç”±å¸¸è¯†ç­‰å› ç´ å†³å®šçš„ï¼›å…³è”å…³ç³»é»˜è®¤ä¸å¼ºè°ƒæ–¹å‘ï¼Œè¡¨ç¤ºå¯¹è±¡é—´ç›¸äº’çŸ¥é“ã€‚UMLä¸­ç”¨åŒå‘ã€å•å‘å¸¦ç®­å¤´çš„è™šçº¿è¡¨ç¤ºå…³è”å…³ç³»ï¼Œç®­å¤´ä¸¤ç«¯ä¸ºç›¸äº’å…³è”çš„ä¸¤ä¸ªç±»ã€‚</li></ul><p><strong>æ³¨</strong>ï¼šåœ¨æœ€ç»ˆä»£ç ä¸­ï¼Œå…³è”å¯¹è±¡é€šå¸¸æ˜¯ä»¥æˆå‘˜å˜é‡çš„å½¢å¼å®ç°çš„;</p><blockquote><p>ä¾‹å¦‚ä¹˜è½¦äººå’Œè½¦ç¥¨ä¹‹é—´å°±æ˜¯ä¸€ç§å…³è”å…³ç³»ã€‚</p></blockquote><ul><li>ä¾èµ–(Dependency)ï¼šè¡¨ç¤ºçš„æ˜¯ç±»ä¹‹é—´çš„è°ƒç”¨å…³ç³»ã€‚ä¸å…³è”å…³ç³»ä¸åŒçš„æ˜¯ï¼Œå®ƒæ˜¯ä¸€ç§ä¸´æ—¶æ€§çš„å…³ç³»ï¼Œé€šå¸¸åœ¨è¿è¡ŒæœŸé—´äº§ç”Ÿï¼Œå¹¶ä¸”éšç€è¿è¡Œæ—¶çš„å˜åŒ–ï¼›ä¾èµ–å…³ç³»ä¹Ÿå¯èƒ½å‘ç”Ÿå˜åŒ–ï¼›æ˜¾ç„¶ï¼Œä¾èµ–ä¹Ÿæœ‰æ–¹å‘ï¼ŒåŒå‘ä¾èµ–æ˜¯ä¸€ç§éå¸¸ç³Ÿç³•çš„ç»“æ„ï¼Œæˆ‘ä»¬æ€»æ˜¯åº”è¯¥ä¿æŒå•å‘ä¾èµ–ï¼Œæœç»åŒå‘ä¾èµ–çš„äº§ç”Ÿã€‚UMLä¸­ç”¨å¸¦ç®­å¤´çš„è™šçº¿è¡¨ç¤ºä¾èµ–å…³ç³»ï¼Œè€Œç®­å¤´æ‰€æŒ‡çš„åˆ™æ˜¯è¢«ä¾èµ–çš„ç±»ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Book</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String author;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Date publishDate;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> BigDecimal price;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getAuthor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> author;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAuthor</span><span class="params">(String author)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.author = author;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Date <span class="title">getPublishDate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> publishDate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPublishDate</span><span class="params">(Date publishDate)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.publishDate = publishDate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> BigDecimal <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrice</span><span class="params">(BigDecimal price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword">extends</span> <span class="title">People</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Double grade;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">study</span><span class="params">(String course)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"å­¦ä¹ "</span> + course);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * Studentçš„ç±»ä¾èµ–Bookç±»</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(Book book)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"é˜…è¯»"</span> + book.getName());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Long <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Long id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Double <span class="title">getGrade</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> grade;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setGrade</span><span class="params">(Double grade)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.grade = grade;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ³¨</strong>ï¼šåœ¨æœ€ç»ˆä»£ç ä¸­ï¼Œä¾èµ–å…³ç³»ä½“ç°ä¸º<strong>ç±»æ„é€ æ–¹æ³•</strong>åŠ<strong>ç±»æ–¹æ³•çš„ä¼ å…¥å‚æ•°</strong>ï¼Œç®­å¤´çš„æŒ‡å‘ä¸ºè°ƒç”¨å…³ç³»ï¼›ä¾èµ–å…³ç³»é™¤äº†ä¸´æ—¶çŸ¥é“å¯¹æ–¹å¤–ï¼Œè¿˜æ˜¯â€œä½¿ç”¨â€å¯¹æ–¹çš„æ–¹æ³•å’Œå±æ€§ï¼›</p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210123144416.png" alt="ç±»ç»§æ‰¿å®ç°ç¤ºä¾‹å›¾" style="zoom:50%;" /><p><strong>å…³è”ã€èšåˆã€ç»„åˆä¸‰ç§å…³ç³»ç”¨ä»£ç è¡¨ç¤ºçš„è¯ï¼Œå¤§å¤šéƒ½æ˜¯ä¸€ä¸ªç±»æ˜¯å¦ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡ã€‚çœŸæ­£çš„å…³ç³»åªèƒ½é…åˆè¯­ä¹‰ï¼Œç»“åˆä¸Šä¸‹æ–‡æ‰èƒ½å¤Ÿåˆ¤æ–­å‡ºæ¥ï¼Œè€Œåªç»™å‡ºä¸€æ®µä»£ç è®©æˆ‘ä»¬åˆ¤æ–­æ˜¯å…³è”ã€èšåˆè¿˜æ˜¯ç»„åˆå…³ç³»ï¼Œåˆ™æ˜¯æ— æ³•åˆ¤æ–­çš„ã€‚</strong></p><p>[1]<a href="https://zhuanlan.zhihu.com/p/24576502" target="_blank" rel="noopener">å‚è€ƒèµ„æ–™https://zhuanlan.zhihu.com/p/24576502</a><br>[2]<a href="https://design-patterns.readthedocs.io/zh_CN/latest/read_uml.html" target="_blank" rel="noopener">å‚è€ƒèµ„æ–™https://design-patterns.readthedocs.io/zh_CN/latest/read_uml.html</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> UML </tag>
            
            <tag> ç±»å›¾ </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RocketMQçš„æ¶ˆè´¹æ¨¡å¼</title>
      <link href="/post/122ee231.html"/>
      <url>/post/122ee231.html</url>
      
        <content type="html"><![CDATA[<p>RocketMQ æ˜¯åŸºäºå‘å¸ƒè®¢é˜…æ¨¡å‹çš„æ¶ˆæ¯ä¸­é—´ä»¶ã€‚æ‰€è°“çš„å‘å¸ƒè®¢é˜…å°±æ˜¯è¯´ï¼Œconsumer è®¢é˜…äº† broker ä¸Šçš„æŸä¸ª topicï¼Œå½“ producer å‘å¸ƒæ¶ˆæ¯åˆ° broker ä¸Šçš„è¯¥ topic æ—¶ï¼Œconsumer å°±èƒ½æ”¶åˆ°è¯¥æ¡æ¶ˆæ¯ã€‚RocketMQé»˜è®¤æ”¯æŒä¸¤ç§æ¶ˆè´¹æ¨¡å¼ï¼Œåˆ†åˆ«æ˜¯é›†ç¾¤æ¶ˆè´¹æ¨¡å¼å’Œå¹¿æ’­æ¶ˆè´¹æ¨¡å¼ï¼Œé»˜è®¤é›†ç¾¤æ¶ˆè´¹æ¨¡å¼ã€‚</p><a id="more"></a><h5 id="é›†ç¾¤"><a href="#é›†ç¾¤" class="headerlink" title="é›†ç¾¤"></a>é›†ç¾¤</h5><p>MQ çº¦å®šä½¿ç”¨ç›¸åŒ Consumer ID çš„è®¢é˜…è€…å±äºåŒä¸€ä¸ªé›†ç¾¤ï¼ŒåŒä¸€ä¸ªé›†ç¾¤ä¸‹çš„è®¢é˜…è€…æ¶ˆè´¹é€»è¾‘å¿…é¡»å®Œå…¨ä¸€è‡´ï¼ˆåŒ…æ‹¬ Tag çš„ä½¿ç”¨ï¼‰ï¼Œè¿™äº›è®¢é˜…è€…åœ¨é€»è¾‘ä¸Šå¯ä»¥è®¤ä¸ºæ˜¯ä¸€ä¸ªæ¶ˆè´¹èŠ‚ç‚¹ã€‚</p><blockquote><p>æ¶ˆè´¹åŒä¸€ç±»æ¶ˆæ¯çš„å¤šä¸ª consumer å®ä¾‹ç»„æˆä¸€ä¸ªæ¶ˆè´¹è€…ç»„ï¼Œä¹Ÿå¯ä»¥ç§°ä¸ºä¸€ä¸ª consumer é›†ç¾¤ï¼Œè¿™äº› consumer å®ä¾‹ä½¿ç”¨åŒä¸€ä¸ª group nameã€‚éœ€è¦æ³¨æ„ä¸€ç‚¹ï¼Œé™¤äº†ä½¿ç”¨åŒä¸€ä¸ª group nameï¼Œè®¢é˜…çš„ tag ä¹Ÿå¿…é¡»æ˜¯ä¸€æ ·çš„ï¼Œåªæœ‰ç¬¦åˆè¿™ä¸¤ä¸ªæ¡ä»¶çš„ consumer å®ä¾‹æ‰èƒ½ç»„æˆ consumer é›†ç¾¤ã€‚</p></blockquote><h5 id="é›†ç¾¤æ¶ˆè´¹æ¨¡å¼"><a href="#é›†ç¾¤æ¶ˆè´¹æ¨¡å¼" class="headerlink" title="é›†ç¾¤æ¶ˆè´¹æ¨¡å¼"></a>é›†ç¾¤æ¶ˆè´¹æ¨¡å¼</h5><p>å½“ä½¿ç”¨é›†ç¾¤æ¶ˆè´¹æ¨¡å¼æ—¶ï¼ŒMQ è®¤ä¸ºä»»æ„ä¸€æ¡æ¶ˆæ¯åªéœ€è¦è¢«é›†ç¾¤å†…çš„ä»»æ„ä¸€ä¸ªæ¶ˆè´¹è€…å¤„ç†å³å¯ã€‚</p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210118233803.png" style="zoom:50%;" alt="é›†ç¾¤æ¶ˆè´¹æ¨¡å¼" /><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">DefaultMQPushConsumer consumer = <span class="keyword">new</span> DefaultMQPushConsumer(<span class="string">"consumer1"</span>);  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// åŒæ ·ä¹Ÿè¦è®¾ç½®NameServeråœ°å€  </span></span><br><span class="line">consumer.setNamesrvAddr(<span class="string">"127.0.0.1:9876;127.0.0.1:9876"</span>);  </span><br><span class="line"><span class="comment">// é»˜è®¤å°±æ˜¯é›†ç¾¤æ¶ˆè´¹æ¨¡å¼</span></span><br><span class="line">consumer.setMessageModel(MessageModel.CLUSTERING); </span><br><span class="line">consumer.setConsumeFromWhere(ConsumeFromWhere.CONSUME_FROM_FIRST_OFFSET);  </span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®consumeræ‰€è®¢é˜…çš„Topicå’ŒTagï¼Œ*ä»£è¡¨å…¨éƒ¨çš„Tag  </span></span><br><span class="line">consumer.subscribe(<span class="string">"TopicTest"</span>, <span class="string">"*"</span>);</span><br></pre></td></tr></table></figure><h6 id="é€‚ç”¨åœºæ™¯-amp-æ³¨æ„äº‹é¡¹"><a href="#é€‚ç”¨åœºæ™¯-amp-æ³¨æ„äº‹é¡¹" class="headerlink" title="é€‚ç”¨åœºæ™¯&amp;æ³¨æ„äº‹é¡¹"></a>é€‚ç”¨åœºæ™¯&amp;æ³¨æ„äº‹é¡¹</h6><ul><li>æ¶ˆè´¹ç«¯é›†ç¾¤åŒ–éƒ¨ç½²ï¼Œæ¯æ¡æ¶ˆæ¯åªéœ€è¦è¢«å¤„ç†ä¸€æ¬¡ã€‚</li><li>ç”±äºæ¶ˆè´¹è¿›åº¦åœ¨æœåŠ¡ç«¯ç»´æŠ¤ï¼Œå¯é æ€§æ›´é«˜ã€‚</li><li>é›†ç¾¤æ¶ˆè´¹æ¨¡å¼ä¸‹ï¼Œæ¯ä¸€æ¡æ¶ˆæ¯éƒ½åªä¼šè¢«åˆ†å‘åˆ°consumeré›†ç¾¤å†…ä»»æ„ä¸€ä¸ªçš„consumerå®ä¾‹æ¶ˆè´¹å¤„ç†ï¼Œå¦‚æœéœ€è¦è¢«é›†ç¾¤ä¸‹æ‰€æœ‰çš„consumerå®ä¾‹æ¶ˆè´¹å¤„ç†ï¼Œè¯·ä½¿ç”¨å¹¿æ’­æ¨¡å¼ã€‚</li><li>é›†ç¾¤æ¶ˆè´¹æ¨¡å¼ä¸‹ï¼Œä¸ä¿è¯æ¶ˆæ¯çš„æ¯ä¸€æ¬¡å¤±è´¥é‡æŠ•ç­‰é€»è¾‘éƒ½èƒ½è·¯ç”±åˆ°åŒä¸€ä¸ªconsumerå®ä¾‹ä¸Šï¼Œå› æ­¤å¤„ç†æ¶ˆæ¯æ—¶ä¸åº”è¯¥åšä»»ä½•ç¡®å®šæ€§å‡è®¾ã€‚</li></ul><h5 id="å¹¿æ’­æ¶ˆè´¹æ¨¡å¼"><a href="#å¹¿æ’­æ¶ˆè´¹æ¨¡å¼" class="headerlink" title="å¹¿æ’­æ¶ˆè´¹æ¨¡å¼"></a>å¹¿æ’­æ¶ˆè´¹æ¨¡å¼</h5><p>å½“ä½¿ç”¨å¹¿æ’­æ¶ˆè´¹æ¨¡å¼æ—¶ï¼ŒMQ ä¼šå°†æ¯æ¡æ¶ˆæ¯æ¨é€ç»™é›†ç¾¤å†…æ‰€æœ‰æ¶ˆè´¹è€…ï¼Œä¿è¯æ¶ˆæ¯è‡³å°‘è¢«æ¯ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹ä¸€æ¬¡ã€‚</p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210118233944.png" alt="å¹¿æ’­æ¶ˆè´¹æ¨¡å¼" style="zoom:50%;" /><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">DefaultMQPushConsumer consumer = <span class="keyword">new</span> DefaultMQPushConsumer(<span class="string">"consumer1"</span>);  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// åŒæ ·ä¹Ÿè¦è®¾ç½®NameServeråœ°å€  </span></span><br><span class="line">consumer.setNamesrvAddr(<span class="string">"127.0.0.1:9876;127.0.0.1:9876"</span>);  </span><br><span class="line"><span class="comment">// è®¾ç½®ä¸ºå¹¿æ’­æ¶ˆè´¹æ¨¡å¼</span></span><br><span class="line">consumer.setMessageModel(MessageModel.BROADCASTING); </span><br><span class="line">consumer.setConsumeFromWhere(ConsumeFromWhere.CONSUME_FROM_FIRST_OFFSET);  </span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®consumeræ‰€è®¢é˜…çš„Topicå’ŒTagï¼Œ*ä»£è¡¨å…¨éƒ¨çš„Tag  </span></span><br><span class="line">consumer.subscribe(<span class="string">"TopicTest"</span>, <span class="string">"*"</span>);</span><br></pre></td></tr></table></figure><h6 id="é€‚ç”¨åœºæ™¯-amp-æ³¨æ„äº‹é¡¹-1"><a href="#é€‚ç”¨åœºæ™¯-amp-æ³¨æ„äº‹é¡¹-1" class="headerlink" title="é€‚ç”¨åœºæ™¯&amp;æ³¨æ„äº‹é¡¹"></a>é€‚ç”¨åœºæ™¯&amp;æ³¨æ„äº‹é¡¹</h6><ul><li>æ¯æ¡æ¶ˆæ¯éƒ½éœ€è¦è¢«consumeré›†ç¾¤å†…æ‰€æœ‰çš„consumer å®ä¾‹æ¶ˆè´¹ä¸€æ¬¡ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯æ¡æ¶ˆæ¯è‡³å°‘è¢«æ¯ä¸€ä¸ªconsumer å®ä¾‹æ¶ˆè´¹ä¸€æ¬¡ã€‚</li><li>æ¶ˆè´¹è¿›åº¦åœ¨å®¢æˆ·ç«¯ç»´æŠ¤ï¼Œå‡ºç°é‡å¤çš„æ¦‚ç‡ç¨å¤§äºé›†ç¾¤æ¨¡å¼ã€‚</li><li>å¹¿æ’­æ¨¡å¼ä¸‹ï¼ŒMQ ä¿è¯æ¯æ¡æ¶ˆæ¯è‡³å°‘è¢«æ¯å°å®¢æˆ·ç«¯æ¶ˆè´¹ä¸€æ¬¡ï¼Œä½†æ˜¯å¹¶ä¸ä¼šå¯¹æ¶ˆè´¹å¤±è´¥çš„æ¶ˆæ¯è¿›è¡Œå¤±è´¥é‡æŠ•ï¼Œå› æ­¤ä¸šåŠ¡æ–¹éœ€è¦å…³æ³¨æ¶ˆè´¹å¤±è´¥çš„æƒ…å†µã€‚</li><li>å¹¿æ’­æ¨¡å¼ä¸‹ï¼Œç¬¬ä¸€æ¬¡å¯åŠ¨æ—¶é»˜è®¤ä»æœ€æ–°æ¶ˆæ¯æ¶ˆè´¹ï¼Œå®¢æˆ·ç«¯çš„æ¶ˆè´¹è¿›åº¦æ˜¯è¢«æŒä¹…åŒ–åœ¨å®¢æˆ·ç«¯æœ¬åœ°çš„éšè—æ–‡ä»¶ä¸­ï¼Œå› æ­¤ä¸å»ºè®®åˆ é™¤è¯¥éšè—æ–‡ä»¶ï¼Œå¦åˆ™ä¼šä¸¢å¤±éƒ¨åˆ†æ¶ˆæ¯ã€‚</li><li>å¹¿æ’­æ¨¡å¼ä¸‹ï¼Œæ¯æ¡æ¶ˆæ¯éƒ½ä¼šè¢«å¤§é‡çš„å®¢æˆ·ç«¯é‡å¤å¤„ç†ï¼Œå› æ­¤æ¨èå°½å¯èƒ½ä½¿ç”¨é›†ç¾¤æ¨¡å¼ã€‚</li><li>å¹¿æ’­æ¨¡å¼ä¸‹æœåŠ¡ç«¯ä¸ç»´æŠ¤æ¶ˆè´¹è¿›åº¦ï¼Œæ‰€ä»¥æœåŠ¡ç«¯ä¸æä¾›å †ç§¯æŸ¥è¯¢å’ŒæŠ¥è­¦åŠŸèƒ½ã€‚</li></ul><blockquote><p>ç›®å‰ä»… Java å®¢æˆ·ç«¯æ”¯æŒå¹¿æ’­æ¨¡å¼ã€‚</p></blockquote><p>è™½ç„¶å¹¿æ’­æ¶ˆè´¹èƒ½ä¿è¯é›†ç¾¤å†…æ¯ä¸ªconsumerå®ä¾‹éƒ½èƒ½æ¶ˆè´¹æ¶ˆæ¯ï¼Œä½†æ˜¯æ¶ˆè´¹è¿›åº¦çš„ç»´æŠ¤ã€ä¸å…·å¤‡æ¶ˆæ¯é‡æŠ•çš„æœºåˆ¶å¤§å¤§å½±å“äº†å®é™…çš„ä½¿ç”¨ã€‚å› æ­¤ï¼Œåœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œæ›´æ¨èä½¿ç”¨é›†ç¾¤æ¶ˆè´¹ï¼Œå› ä¸ºé›†ç¾¤æ¶ˆè´¹ä¸ä»…æ‹¥æœ‰æ¶ˆè´¹è¿›åº¦å­˜å‚¨çš„å¯é æ€§ï¼Œè¿˜å…·æœ‰æ¶ˆæ¯é‡æŠ•çš„æœºåˆ¶ã€‚è€Œä¸”ï¼Œæˆ‘ä»¬é€šè¿‡é›†ç¾¤æ¶ˆè´¹ä¹Ÿå¯ä»¥è¾¾åˆ°å¹¿æ’­æ¶ˆè´¹çš„æ•ˆæœã€‚</p><h5 id="ä½¿ç”¨é›†ç¾¤æ¨¡å¼æ¨¡æ‹Ÿå¹¿æ’­æ¨¡å¼"><a href="#ä½¿ç”¨é›†ç¾¤æ¨¡å¼æ¨¡æ‹Ÿå¹¿æ’­æ¨¡å¼" class="headerlink" title="ä½¿ç”¨é›†ç¾¤æ¨¡å¼æ¨¡æ‹Ÿå¹¿æ’­æ¨¡å¼"></a>ä½¿ç”¨é›†ç¾¤æ¨¡å¼æ¨¡æ‹Ÿå¹¿æ’­æ¨¡å¼</h5><p>æœ‰äº›åœºæ™¯å¸Œæœ›ä¸€ä¸ªæ¶ˆæ¯éœ€è¦å¤šä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹ï¼Œå¹¶ä¸”ä¹Ÿå¸Œæœ›æ¶ˆè´¹è€…æ¶ˆè´¹å¤±è´¥ï¼Œæ¶ˆæ¯èƒ½å¤Ÿé‡æ–°æŠ•é€’ã€‚</p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210118234035.png" alt="é›†ç¾¤æ¨¡å¼æ¨¡æ‹Ÿå¹¿æ’­æ¶ˆè´¹" style="zoom:50%;" /><blockquote><p>è®¢å•æ”¯ä»˜å®Œæˆé€šçŸ¥ä¸‹æ¸¸ç³»ç»Ÿï¼Œç§¯åˆ†æœåŠ¡æ‰£å‡è®¢å•ä½¿ç”¨çš„ç§¯åˆ†ã€ä¼˜æƒ åˆ¸æœåŠ¡å°†ä¼˜æƒ åˆ¸çŠ¶æ€æ›´æ–°ä¸ºå·²ä½¿ç”¨ã€åº“å­˜æœåŠ¡æ‰£å‡å•†å“åº“å­˜ã€ä»“åº“å‡†å¤‡å‘è´§ç­‰ç­‰</p></blockquote><h6 id="é€‚ç”¨åœºæ™¯-amp-æ³¨æ„äº‹é¡¹-2"><a href="#é€‚ç”¨åœºæ™¯-amp-æ³¨æ„äº‹é¡¹-2" class="headerlink" title="é€‚ç”¨åœºæ™¯&amp;æ³¨æ„äº‹é¡¹"></a>é€‚ç”¨åœºæ™¯&amp;æ³¨æ„äº‹é¡¹</h6><ul><li>æ¯æ¡æ¶ˆæ¯éƒ½éœ€è¦è¢«å¤šä¸ªæ¶ˆè´¹è€…å¤„ç†ï¼Œæ¯ä¸ªæ¶ˆè´¹è€…çš„é€»è¾‘å¯ä»¥ç›¸åŒä¹Ÿå¯ä»¥ä¸ä¸€æ ·ã€‚</li><li>æ¶ˆè´¹è¿›åº¦åœ¨æœåŠ¡ç«¯ç»´æŠ¤ï¼Œå¯é æ€§é«˜äºå¹¿æ’­æ¨¡å¼ã€‚</li></ul><p>å¦‚æœä¸šåŠ¡ä¸Šç¡®å®éœ€è¦ä½¿ç”¨å¹¿æ’­æ¶ˆè´¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ›å»ºå¤šä¸ª consumer å®ä¾‹ï¼Œæ¯ä¸ª consumer å®ä¾‹å±äºä¸åŒçš„ consumer groupï¼Œä½†æ˜¯å®ƒä»¬éƒ½è®¢é˜…åŒä¸€ä¸ª topicã€‚</p><blockquote><p>ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬åˆ›å»º 4 ä¸ª consumer å®ä¾‹ï¼Œconsumer1ï¼ˆå±äºconsumerGroup1ï¼‰ã€consumer2ï¼ˆå±äºconsumerGroup 2ï¼‰ã€consumer 3ï¼ˆå±äºconsumerGroup3ï¼‰å’Œ consumer4ï¼ˆå±äºconsumerGroup4ï¼‰ï¼Œå®ƒä»¬éƒ½è®¢é˜…äº† topicA ï¼Œé‚£ä¹ˆå½“ producer å‘é€ä¸€æ¡æ¶ˆæ¯åˆ° topic A ä¸Šæ—¶ï¼Œç”±äº3ä¸ªconsumer å±äºä¸åŒçš„ consumer groupï¼Œæ‰€ä»¥ 3 ä¸ªconsumeréƒ½èƒ½æ”¶åˆ°æ¶ˆæ¯ï¼Œä¹Ÿå°±è¾¾åˆ°äº†å¹¿æ’­æ¶ˆè´¹çš„æ•ˆæœäº†ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¾ç½®ä¸åŒçš„æ¶ˆè´¹ç»„åï¼Œå®ç°é›†ç¾¤æ¨¡å¼æ¨¡æ‹Ÿå¹¿æ’­æ¶ˆè´¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> consumerGroup æ¶ˆè´¹ç»„å</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">consumerMessage</span><span class="params">(String consumerGroup)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isBlank(consumerGroup))&#123;</span><br><span class="line">            consumerGroup = <span class="string">"unique_group_name"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Instantiate with specified consumer group name.</span></span><br><span class="line">        DefaultMQPushConsumer consumer = <span class="keyword">new</span> DefaultMQPushConsumer(consumerGroup);</span><br><span class="line">        <span class="comment">// Specify name server addresses.</span></span><br><span class="line">        consumer.setNamesrvAddr(<span class="string">"127.0.0.1:9876;127.0.0.1:9870"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é‡è¦ï¼šè®¾ç½®æ¶ˆè´¹è€…æ¶ˆæ¯æœ€å¤§é‡è¯•æ¬¡æ•°</span></span><br><span class="line">        <span class="comment">//consumer.setMaxReconsumeTimes(5);</span></span><br><span class="line">        <span class="comment">// Subscribe one more more topics to consume.</span></span><br><span class="line">        consumer.subscribe(<span class="string">"TopicTest"</span>, <span class="string">"*"</span>);</span><br><span class="line">        consumer.setConsumeFromWhere(ConsumeFromWhere.CONSUME_FROM_FIRST_OFFSET);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Register callback to execute on arrival of messages fetched from brokers.</span></span><br><span class="line">        consumer.registerMessageListener((MessageListenerConcurrently) (messages, context) -&gt; &#123;</span><br><span class="line">            <span class="keyword">for</span> (MessageExt message : messages) &#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">int</span> reconsumeTimes = message.getReconsumeTimes();</span><br><span class="line">                String msgId = message.getMsgId();</span><br><span class="line"></span><br><span class="line">                SimpleDateFormat simpleDateFormat = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd HH:mm:ss"</span>);</span><br><span class="line">                String format = simpleDateFormat.format(<span class="keyword">new</span> Date());</span><br><span class="line">                String messageContext = <span class="keyword">new</span> String(message.getBody(), StandardCharsets.UTF_8);</span><br><span class="line">                System.out.println(<span class="string">"æ¶ˆè´¹æ—¶é—´ï¼š"</span> + format + <span class="string">" ,æ¶ˆæ¯æ¶ˆè´¹æ¬¡æ•°="</span> + reconsumeTimes + <span class="string">", msgId="</span> + msgId + <span class="string">", æ¶ˆæ¯å†…å®¹:"</span> + messageContext);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ConsumeConcurrentlyStatus.CONSUME_SUCCESS;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Launch the consumer instance.</span></span><br><span class="line">        consumer.start();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>é™¤æ­¤ä¹‹å¤–ï¼Œæ¯ä¸ª consumer å®ä¾‹çš„æ¶ˆè´¹é€»è¾‘å¯ä»¥ä¸€æ ·ä¹Ÿå¯ä»¥ä¸ä¸€æ ·ï¼Œæ¯ä¸ªconsumer groupè¿˜å¯ä»¥æ ¹æ®éœ€è¦å¢åŠ  consumer å®ä¾‹ï¼Œæ¯”èµ·å¹¿æ’­æ¶ˆè´¹æ¥è¯´æ›´åŠ çµæ´»ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> rocketmq </tag>
            
            <tag> æ¶ˆè´¹æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç³»ç»Ÿçš„æ•°æ®ä¸€è‡´æ€§åˆ°åº•æ˜¯åœ¨è¯´ä»€ä¹ˆ</title>
      <link href="/post/e544327e.html"/>
      <url>/post/e544327e.html</url>
      
        <content type="html"><![CDATA[<p>ä½œä¸ºä¸€åç¨‹åºå‘˜ï¼Œä½ æ˜¯ä¸æ˜¯ç»å¸¸åœ¨å¾ˆå¤šåœºæ™¯ï¼Œä¾‹å¦‚çœ‹åšå®¢ã€èŠå¤©å¹æ°´ç­‰ç­‰æ—¶å€™å¬åˆ°è¿™æ ·ä¸€ä¸ªè¯â€ç³»ç»Ÿæ•°æ®ä¸€è‡´æ€§â€ï¼Œæ˜¯ä¸æ˜¯æœ‰æ—¶å€™æ„Ÿè§‰åˆ°äº†è¿·ç³Šï¼Œä¸çŸ¥é“è¿™ä¸ªâ€ç³»ç»Ÿæ•°æ®ä¸€è‡´æ€§â€åˆ°åº•æ˜¯åœ¨è¯´ä»€ä¹ˆï¼Ÿå…¶å®ï¼Œä½ å¯èƒ½åªæ˜¯ä¸æ˜ç™½è¿™ä¸ªè¯ï¼Œä½†æ˜¯ä½ è‚¯å®šåœ¨å®é™…å·¥ä½œä¸­å‘ç°ã€è§£å†³è¿‡è¿™æ ·çš„é—®é¢˜ã€‚</p><a id="more"></a><h5 id="å•ä½“æ¶æ„ä¸‹ç³»ç»Ÿæ•°æ®ä¸€è‡´æ€§é—®é¢˜"><a href="#å•ä½“æ¶æ„ä¸‹ç³»ç»Ÿæ•°æ®ä¸€è‡´æ€§é—®é¢˜" class="headerlink" title="å•ä½“æ¶æ„ä¸‹ç³»ç»Ÿæ•°æ®ä¸€è‡´æ€§é—®é¢˜"></a>å•ä½“æ¶æ„ä¸‹ç³»ç»Ÿæ•°æ®ä¸€è‡´æ€§é—®é¢˜</h5><p>åœ¨ä¼ ç»Ÿçš„ç³»ç»Ÿåº”ç”¨ä¸­ï¼Œä¸€èˆ¬éƒ½æ˜¯ä½¿ç”¨å•ä½“æ¶æ„æ¥æ„å»ºç³»ç»Ÿçš„ã€‚å³æ‰€æœ‰çš„åŠŸèƒ½æ¨¡å—éƒ½æ”¾åœ¨ä¸€èµ·å®ç°ï¼Œæ‰“æˆä¸€ä¸ªWARåŒ…éƒ¨ç½²åœ¨Tomcatä¸­ï¼Œæ•°æ®ä¸€èˆ¬å­˜æ”¾åœ¨å…³ç³»å‹æ•°æ®åº“ä¸­ï¼Œå¦‚MySQLæ•°æ®åº“ã€‚</p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210117223211.png" style="zoom:50%;" alt="å•ä½“æ¶æ„å›¾" /><p>å‰é¢æˆ‘è¯´è¿‡å³ä½¿è¿™ç§å•ä½“æ¶æ„çš„ç³»ç»Ÿä¹Ÿæ˜¯æ•°æ®ä¸€è‡´æ€§çš„é—®é¢˜çš„ï¼Œä¸¾ä¸€ä¸ªç”µå•†ä¸‹å•çš„ä¾‹å­ï¼Œç”¨æˆ·æäº¤å®Œè®¢å•ï¼Œç³»ç»Ÿï¼Œç³»ç»Ÿåœ¨è®¢å•è¡¨orderè¡¨ä¸­å†™å…¥è®¢å•é‡‘é¢ã€ç”¨æˆ·ç­‰ç›¸å…³æ•°æ®ï¼Œåœ¨è®¢å•æ˜ç»†order_itemè¡¨ä¸­å†™å…¥å•†å“ä»·æ ¼ã€è´­ä¹°çš„æ•°é‡ç­‰æ•°æ®ï¼Œæœ€åæ›´æ–°å•†å“çš„åº“å­˜skuä¿¡æ¯ã€‚ç”¨æˆ·ä¸‹å•æˆåŠŸä¹‹åï¼Œç³»ç»Ÿæ“ä½œäº†orderã€order_itemã€skuè¿™ä¸‰ä¸ªæ•°æ®è¡¨ï¼Œå¯¹äºè¿™ä¸‰ä¸ªè¡¨çš„æ“ä½œæ— è®ºæˆåŠŸä¸å¤±è´¥ï¼Œéƒ½åº”è¯¥æ˜¯åŸå­çš„ï¼Œæ“ä½œæˆåŠŸåˆ™éƒ½è¦æˆåŠŸï¼Œå¤±è´¥åˆ™éƒ½è¦ä¸€èµ·å¤±è´¥ã€‚ä¸ç„¶å°±ä¼šå‡ºç°è„æ•°æ®ï¼Œæ•°æ®ä¸€è‡´æ€§è¢«ç ´åã€‚</p><p>1ã€ å¦‚æœæ“ä½œorderå’Œorder_itemè¡¨æˆåŠŸï¼Œæ“ä½œskuè¡¨å¤±è´¥ï¼Œåˆ™ä¼šå¯¼è‡´æœ¬åº”è¯¥æ‰£å‡çš„åº“å­˜æ²¡æœ‰æ‰£å‡ï¼Œåˆ™å•†å“æœ‰å¯èƒ½å‡ºç°è¶…å–ã€‚</p><p>2ã€å¦‚æœæ“ä½œorderå’Œorder_itemè¡¨å¤±è´¥ï¼Œæ“ä½œskuè¡¨æˆåŠŸï¼Œåˆ™ä¼šå¯¼è‡´æœ¬ä¸åº”è¯¥æ‰£å‡çš„åº“å­˜æ‰£å‡äº†ï¼Œåˆ™å•†å“æœ‰å¯èƒ½å‡ºç°å°‘å–ã€‚</p><p>3ã€å¦‚æœæ“ä½œorderå’Œskuè¡¨æˆåŠŸï¼Œorder_itemæ“ä½œå¤±è´¥ï¼Œåˆ™è¿™ä¸ªè®¢å•æ•°æ®ä¸¢å¤±ï¼Œè®¢å•åç»­çš„æ“ä½œè‚¯å®šä¹Ÿæ˜¯æ“ä½œä¸äº†äº†ã€‚</p><p>ä¸Šé¢åªæ˜¯ç®€å•çš„ä¸¾äº†ä¸‰ç§å¯èƒ½å‡ºç°çš„æƒ…å†µï¼Œä¹Ÿå¯èƒ½ä¼šæœ‰å…¶ä»–çš„æƒ…å†µå‘ç”Ÿã€‚é‚£æˆ‘ä»¬æ€ä¹ˆé¿å…è¿™äº›æƒ…å†µçš„å‘ç”Ÿå‘¢ï¼Ÿå…¶å®è¿™ç§é—®é¢˜ç¨å¾®æœ‰çš„å¼€å‘ç»éªŒçš„åŒå­¦éƒ½ä¼šæƒ³åˆ°è§£å†³æ–¹æ¡ˆï¼Œé‚£å°±æ˜¯ä½¿ç”¨æ•°æ®åº“çš„äº‹åŠ¡ï¼Œäº‹åŠ¡çš„åŸå­æ€§ä¿è¯ä¸Šè¿°çš„æ­¥éª¤æˆåŠŸåˆ™ä¸€èµ·æˆåŠŸï¼Œå¤±è´¥åˆ™ä¸€èµ·å¤±è´¥ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">BEGIN</span>;</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">order</span>;</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> order_item;</span><br><span class="line"><span class="keyword">UPDATE</span> sku;</span><br><span class="line"><span class="keyword">COMMIT</span>; <span class="comment"># ROLLBACK</span></span><br></pre></td></tr></table></figure><p><strong>åœ¨å•ä½“æ¶æ„çš„ç³»ç»Ÿä¸‹è§£å†³å†…éƒ¨æ¨¡å—çš„æ•°æ®ä¸€è‡´æ€§çš„é—®é¢˜ï¼Œç”¨æ•°æ®åº“çš„ACIDç‰¹æ€§å°±èƒ½ä¿è¯ã€‚</strong></p><p>å•ä½“æ¶æ„çš„ä¼˜ç‚¹å°±æ˜¯ç›¸å¯¹åˆ†å¸ƒå¼æ¥è¯´å¼€å‘ç®€å•ï¼ŒåŠŸèƒ½å¯ä»¥é›†ä¸­ç®¡ç†ï¼Œæ¨¡å—ä¹‹é—´é€šä¿¡æ²¡æœ‰æŸè€—ã€‚ä½†éšç€ä¸šåŠ¡è¶Šæ¥è¶Šå¤æ‚ã€éœ€æ±‚è¶Šæ¥è¶Šåºå¤§ï¼Œäººä»¬å¯¹ç³»ç»Ÿå“åº”æ—¶é—´ã€ååé‡å’Œå‡ºç°æ•…éšœçš„æ—¶å€™çš„ç³»ç»Ÿå¯ç”¨æ€§çš„è¦æ±‚ä¹Ÿè¶Šæ¥è¶Šé«˜ï¼ä¼ ç»Ÿçš„å•ä½“æ¶æ„ç³»ç»Ÿåœ¨è¿™ç§æƒ…å†µä¸‹æš´éœ²çš„ç¼ºç‚¹ä¹Ÿè¶Šæ¥è¶Šå¤šï¼Œäººä»¬å¼€å§‹å¯»æ±‚è½¬å˜ã€‚æ—¢ç„¶éƒ¨ç½²åœ¨ä¸€ä¸ªæœåŠ¡å™¨ä¸Šçš„å•ä½“æ¶æ„ç³»ç»Ÿæä¸å®šï¼Œé‚£å°±å¤šéƒ¨ç½²å‡ å°ï¼Œå³ç”¨å¤šå°å•æœºèŠ‚ç‚¹ç»„æˆé›†ç¾¤ï¼Œå†ç”¨è´Ÿè½½å‡è¡¡å‘å¤–æä¾›æœåŠ¡ã€‚</p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210131220214.png" alt="é›†ç¾¤éƒ¨ç½²" style="zoom:20%;" /><p>ä½†æ˜¯è¿™æ ·åšè¿˜æ˜¯è§£å†³ä¸äº†å•ä½“æ¶æ„å­˜åœ¨çš„ä¸€äº›é—®é¢˜ï¼š</p><ul><li>åªèƒ½ä½¿ç”¨åŒç§è¯­è¨€å¼€å‘ï¼Œä¸èƒ½é’ˆå¯¹ä¸åŒä¸šåŠ¡åœºæ™¯åˆ©ç”¨ä¸åŒè¯­è¨€çš„ä¼˜åŠ¿å¼€å‘å¯¹åº”çš„æ¨¡å—ã€‚</li><li>ç³»ç»Ÿæ¨¡å—è€¦åˆæ€§å¤ªå¼ºï¼Œç³»ç»Ÿä¸­æŸä¸€ä¸ªæ¨¡å—å‡ºç°é—®é¢˜ï¼Œä¾‹å¦‚é«˜å¹¶å‘ã€å¤§æ•°æ®åœºæ™¯æˆ–è€…å‡ºç°bugï¼Œæ•´ä¸ªç³»ç»Ÿéƒ½ä¼šå—åˆ°ç‰µè¿ã€‚</li><li>æŸä¸ªæ¨¡å—å‘å¸ƒï¼Œæ•´ä¸ªç³»ç»Ÿéƒ½è¦åœæœºå‘å¸ƒï¼Œç³»ç»Ÿæ‰€æœ‰æ¨¡å—éƒ½ä¸èƒ½å¯¹å¤–æä¾›æœåŠ¡ï¼Œè¿™æ ·æ— æ³•å¿«é€Ÿå“åº”å¸‚åœºéœ€æ±‚ã€‚</li><li>é›†ç¾¤è´Ÿæ‹…å¤§ï¼Œå¦‚æœæƒ³è¦é›†ç¾¤ï¼Œåªèƒ½å¯¹æ•´ä¸ªç³»ç»Ÿè¿›è¡Œé›†ç¾¤ï¼Œå³ä½¿åªæœ‰ä¸€ä¸ªæ¨¡å—æœ‰å‹åŠ›ã€‚</li></ul><blockquote><p>é›†ç¾¤(Cluster)ï¼š ç³»ç»Ÿå•æœºéƒ¨ç½²å¯¹å¤–æœåŠ¡èƒ½åŠ›å‡ºç°ç“¶é¢ˆï¼Œåˆ™å°†ç³»ç»Ÿè¿›è¡Œå¤šæœºéƒ¨ç½²ï¼Œè¿™äº›ç³»ç»Ÿå¯¹å¤–æä¾›ç›¸åŒçš„æœåŠ¡ï¼Œæ¯ä¸ªå•æœºç³»ç»Ÿæˆ‘ä»¬ç§°ä¹‹ä¸ºèŠ‚ç‚¹ï¼Œå¤šä¸ªèŠ‚ç‚¹ç»Ÿä¸€èµ·æ¥åˆ™å¯ä»¥ç§°ä¹‹ä¸ºé›†ç¾¤ã€‚</p></blockquote><h5 id="åˆ†å¸ƒå¼æ¶æ„ä¸‹ç³»ç»Ÿæ•°æ®ä¸€è‡´æ€§é—®é¢˜"><a href="#åˆ†å¸ƒå¼æ¶æ„ä¸‹ç³»ç»Ÿæ•°æ®ä¸€è‡´æ€§é—®é¢˜" class="headerlink" title="åˆ†å¸ƒå¼æ¶æ„ä¸‹ç³»ç»Ÿæ•°æ®ä¸€è‡´æ€§é—®é¢˜"></a>åˆ†å¸ƒå¼æ¶æ„ä¸‹ç³»ç»Ÿæ•°æ®ä¸€è‡´æ€§é—®é¢˜</h5><p>å¤©ä¸‹å¤§äº‹åˆ†ä¹…å¿…åˆã€åˆä¹…å¿…åˆ†ï¼æ—¢ç„¶å•ä½“æ¶æ„è§£å†³ä¸äº†é—®é¢˜ï¼Œé‚£æˆ‘ä»¬å°±å°è¯•æ‹†åˆ†ç³»ç»Ÿï¼Œè®©ä¸“ä¸šçš„äººåšä¸“ä¸šçš„äº‹ï¼Œé‚£å¦‚ä½•è¿›è¡Œæ‹†åˆ†å‘¢ï¼Ÿæ‹†åˆ†ä¸€èˆ¬åˆ†ä¸ºæ°´å¹³æ‹†åˆ†å’Œå‚ç›´æ‹†åˆ†ã€‚è¿™é‡Œè¯´çš„æ‹†åˆ†å¹¶ä¸å•æŒ‡æ•°æ®åº“æ‹†åˆ†ï¼Œè€Œæ˜¯æ‰€æœ‰æ¨¡å—éƒ½è¿›è¡Œæ‹†åˆ†ï¼Œæ¯ä¸ªæ¨¡å—éƒ½æœ‰è‡ªå·±çš„ç¼“å­˜ã€æ•°æ®åº“ç­‰ç­‰ã€‚</p><ul><li>æ°´å¹³æ‹†åˆ†æŒ‡çš„æ˜¯å•ä¸€çš„èŠ‚ç‚¹æ— æ³•æ»¡è¶³æ€§èƒ½çš„éœ€æ±‚ï¼Œéœ€è¦è¿›è¡Œæ•°é‡ä¸Šçš„æ‰©å±•ã€‚æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½å…·æœ‰ç›¸åŒçš„åŠŸèƒ½ï¼Œæ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½è´Ÿè´£ä¸€éƒ¨åˆ†è¯·æ±‚ï¼ŒèŠ‚ç‚¹ä»¬ç»„æˆä¸€ä¸ªé›†ç¾¤ï¼Œå¯¹å¤–è¿›è¡Œæä¾›æœåŠ¡ã€‚</li><li>å‚ç›´æ‹†åˆ†æŒ‡çš„æ˜¯æŒ‰ç…§åŠŸèƒ½è¿›è¡Œæ‹†åˆ†ï¼Œç§‰ç€â€ä¸“ä¸šçš„äººå¹²ä¸“ä¸šçš„äº‹â€ï¼ŒæŠŠå¤æ‚çš„ç³»ç»Ÿæ‹†åˆ†æˆå„ä¸ªæ¨¡å—ã€‚æ¨¡å—ä¹‹é—´é€šè¿‡RPCè¿›è¡Œé€šä¿¡ï¼Œå¯ä»¥åšåˆ°é«˜å†…èšã€ä½è€¦åˆï¼Œæ¯ä¸ªæ¨¡å—ç‹¬ç«‹éƒ¨ç½²å’Œç»´æŠ¤ï¼Œå¯ä»¥å¿«é€Ÿè¿­ä»£å“åº”å¸‚åœºéœ€æ±‚ã€‚<br>å› æ­¤ï¼Œåˆ†å¸ƒå¼æ¶æ„åœ¨è¿™ç§èƒŒæ™¯ä¸‹åº”è¿è€Œç”Ÿã€‚</li></ul><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210131215841.png" alt="åˆ†å¸ƒå¼æ¶æ„" style="zoom:20%;" /><blockquote><p>åˆ†å¸ƒå¼(Distributed)æ¶æ„ï¼šåˆ†å¸ƒå¼ç³»ç»Ÿæ˜¯ç”±é›†ä¸­å¼ç³»ç»Ÿé€æ¸æ¼”å˜è€Œæ¥ã€‚æ‰€è°“çš„é›†ä¸­å¼ç³»ç»Ÿï¼Œå°±æ˜¯æŠŠç³»ç»Ÿä¸­æ‰€ç”¨çš„åŠŸèƒ½éƒ½é›†ä¸­åˆ°ä¸€èµ·ï¼Œä»è€Œå‘å¤–æä¾›æœåŠ¡çš„å•ä½“åº”ç”¨ã€‚</p></blockquote><p>è½¯ä»¶è¡Œä¸šæ˜¯æ²¡æœ‰é“¶å¼¹çš„ï¼Œæ¯ä¸€ä¸ªè¢«å‘æ˜å‡ºæ¥çš„æ–°æŠ€æœ¯ï¼Œéƒ½æ˜¯ä¸€æŠŠåŒåˆƒå‰‘ï¼Œéƒ½æ˜¯åœ¨ç‰¹å®šçš„é¢†åŸŸè§£å†³äº†æŸäº›è€é—®é¢˜ï¼Œä½†æ˜¯åŒæ—¶ä¹Ÿä¼šå¸¦æ¥æ–°çš„é—®é¢˜ã€‚é‚£ä¹ˆå¾®æœåŠ¡è¿™ç§åˆ†å¸ƒå¼æ¶æ„è§£å†³äº†ä»€ä¹ˆè€é—®é¢˜ï¼ŸåŒæ—¶å®ƒåˆå¸¦æ¥äº†å“ªäº›æ–°é—®é¢˜å‘¢ï¼Ÿ</p><h6 id="è§£å†³äº†è€é—®é¢˜"><a href="#è§£å†³äº†è€é—®é¢˜" class="headerlink" title="è§£å†³äº†è€é—®é¢˜"></a>è§£å†³äº†è€é—®é¢˜</h6><p>å¾®æœåŠ¡è¿™ä¸­åˆ†å¸ƒå¼æ¶æ„ä¸»è¦è§£å†³äº†å•ä½“æ¶æ„å­˜åœ¨çš„ä¸€äº›é—®é¢˜ã€‚</p><ul><li>å„ä¸ªæœåŠ¡å¯ä»¥ä½¿ç”¨ä¸åŒçš„è¯­è¨€å¼€å‘ï¼Œå¯ä»¥åˆ©ç”¨ä¸åŒè¯­è¨€çš„ä¼˜åŠ¿å¼€å‘ä¸åŒæ¨¡å—ã€‚</li><li>æœåŠ¡ä¹‹é—´å¯ä»¥åšåˆ°é«˜å†…èšã€ä½è€¦åˆã€‚æ¯ä¸ªæœåŠ¡å¯ä»¥ç‹¬ç«‹ç»´æŠ¤ã€éƒ¨ç½²ï¼Œå¯ä»¥å¿«é€Ÿå“åº”å¸‚åœºéœ€æ±‚ã€‚</li><li>å¯ä»¥å•ç‹¬å¯¹æŸä¸ªæœ‰é«˜å¹¶å‘ã€å¤§æµé‡çš„æœåŠ¡å•ç‹¬è¿›è¡Œä¼˜åŒ–ï¼Œä¸æµªè´¹èµ„æºã€‚</li></ul><h6 id="å¸¦æ¥äº†æ–°é—®é¢˜"><a href="#å¸¦æ¥äº†æ–°é—®é¢˜" class="headerlink" title="å¸¦æ¥äº†æ–°é—®é¢˜"></a>å¸¦æ¥äº†æ–°é—®é¢˜</h6><ul><li>ç³»ç»Ÿçš„ç›‘æ§éš¾åº¦åŠ å¤§ã€‚</li><li>æ•°æ®çš„ä¸€è‡´æ€§æˆä¸ºé—®é¢˜ã€‚</li><li>ç³»ç»Ÿçš„å¤æ‚åº¦æé«˜ï¼Œç³»ç»Ÿçš„ç»´æŠ¤ã€è®¾è®¡æˆæœ¬å¢åŠ ï¼Œè°ƒè¯•ã€çº é”™éš¾åº¦åŠ å¤§ã€‚</li></ul><p>æ–°é—®é¢˜ä¸­çš„ <code>æ•°æ®ä¸€è‡´æ€§é—®é¢˜</code>æ‰æ˜¯æœ¬æ–‡æ¥ä¸‹æ¥çš„é‡ç‚¹ã€‚ </p><h6 id="ä¸ºå•¥ä¼šæœ‰è¿™ä¸ªæ•°æ®ä¸€è‡´æ€§é—®é¢˜å‘¢"><a href="#ä¸ºå•¥ä¼šæœ‰è¿™ä¸ªæ•°æ®ä¸€è‡´æ€§é—®é¢˜å‘¢" class="headerlink" title="ä¸ºå•¥ä¼šæœ‰è¿™ä¸ªæ•°æ®ä¸€è‡´æ€§é—®é¢˜å‘¢"></a>ä¸ºå•¥ä¼šæœ‰è¿™ä¸ªæ•°æ®ä¸€è‡´æ€§é—®é¢˜å‘¢</h6><p>å•ä½“æ¶æ„æŒ‰ç…§æ–‡ä¸­çš„è¯´æ³•ï¼Œæ˜¯ä¸€ç§ä¸å¤ªæ—¶é«¦çš„æ¶æ„æ–¹å¼ï¼Œéƒ½èƒ½è½»æ¾è§£å†³æ•°æ®ä¸€è‡´æ€§é—®é¢˜ï¼Œæ–°å‘æ˜çš„åˆ†å¸ƒå¼æ¶æ„å´åˆæˆäº†ä¸€ä¸ªæ£˜æ‰‹çš„é—®é¢˜ï¼Œè¿™ä¸ªåˆ°åº•æ˜¯æŠ€æœ¯çš„è¿›æ­¥è¿˜æ˜¯æŠ€æœ¯åœ¨é€€æ­¥å‘¢ï¼Ÿå“ˆå“ˆğŸ˜„ğŸ˜„(æˆ‘çš„ä¸€ç‚¹ç‚¹åæ§½)ï¼ï¼æ¥ä¸‹æ¥æˆ‘æ¥è§£é‡Šä¸€ä¸‹ä¸ºå•¥åˆ†å¸ƒå¼ç³»ç»Ÿä¼šæœ‰è¿™æ ·çš„é—®é¢˜ã€‚<br>åˆ†å¸ƒå¼ç³»ç»Ÿæ¯ä¸ªåŠŸèƒ½å¤§éƒ½éƒ¨ç½²åœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼Œéƒ¨ç½²åœ¨ä¸åŒå›½å®¶å’Œåœ°åŒºçš„æœåŠ¡å™¨ä¸­ï¼Œéƒ¨ç½²åœ¨ä¸åŒçš„ç½‘ç»œä¸­ï¼Œéƒ¨ç½²åœ¨ä¸åŒå›½å®¶å’Œåœ°åŒºçš„ç½‘ç»œä¸­ã€‚è¿™æ ·ä¸€ä¸ªéœ€è¦å¤§é‡çš„æœåŠ¡å™¨å…±åŒåä½œï¼Œå‘å¤–æä¾›æœåŠ¡çš„ç³»ç»Ÿï¼Œé¢ä¸´ç€è¯¸å¤šçš„æŒ‘æˆ˜ï¼š</p><ol><li><p>è‰¯è ä¸é½çš„æœåŠ¡å™¨å’Œç³»ç»Ÿèƒ½åŠ›<br>åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æœåŠ¡å™¨ï¼Œå¯èƒ½é…ç½®ä¸ä¸€æ ·ï¼Œå…¶ä¸Šéƒ¨ç½²çš„ç³»ç»Ÿå¯èƒ½ä¹Ÿæ˜¯ç”±ä¸åŒçš„ç¨‹åºè¯­è¨€ã€æ¶æ„å®ç°ï¼Œå› æ­¤å¤„ç†è¯·æ±‚çš„èƒ½åŠ›ä¹Ÿå°±ä¸ä¸€æ ·ã€‚</p></li><li><p>ä¸å¯é çš„ç½‘ç»œ<br>å¦‚ä¸Šæ–‡æ‰€è¯´ï¼Œç³»ç»Ÿä¸­å„ä¸ªæœåŠ¡å¯èƒ½éƒ¨ç½²åœ¨ä¸åŒå›½å®¶å’Œåœ°åŒºï¼Œå„ä¸ªæœåŠ¡é€šè¿‡ç½‘ç»œè¿›è¡Œé€šä¿¡ï¼Œä½†æ˜¯ç½‘ç»œæ˜¯ä¸å¯é çš„ã€‚ç½‘ç»œç»å¸¸ä¼šå‡ºç°æŠ–åŠ¨ã€å»¶æ—¶ã€åˆ†å‰²ã€ä¸¢åŒ…ç­‰é—®é¢˜ã€‚<br>ç½‘ç»œé€šä¿¡ä¸­æœ€è®©äººå¤´ç—›çš„æ˜¯å› ä¸ºç½‘ç»œæŠ–åŠ¨ã€å»¶æ—¶ç­‰é—®é¢˜å¯¼è‡´ç³»ç»Ÿä¹‹é—´çš„é€šä¿¡å‡ºç°è¶…æ—¶ï¼šAæœåŠ¡å‘BæœåŠ¡å‘å‡ºè¯·æ±‚ï¼ŒAæœåŠ¡æ²¡æœ‰åœ¨çº¦å®šçš„æ—¶é—´å†…æ¥å—åˆ°BæœåŠ¡çš„å“åº”ï¼Œä½ ä¸èƒ½ç¡®å®šBæœåŠ¡åˆ°åº•æœ‰æ²¡æœ‰å¤„ç†å®ŒAæœåŠ¡çš„è¯·æ±‚ï¼Œè¿™æ ·çš„ä¸ç¡®å®šæ€§å°±éœ€è¦æˆ‘ä»¬è¿›è¡Œé‡è¯•å¤„ç†ï¼Œé‚£ä¹ˆBæœåŠ¡å°±è¦è§£å†³è¯·æ±‚å¹‚ç­‰æ€§é—®é¢˜ã€‚</p></li></ol><blockquote><p>æ”¯ä»˜å®å‡ºç°è¿‡æœåŠ¡å™¨çš„ç”µç¼†è¢«æŒ–æ–­çš„é—®é¢˜ã€‚<br>æœåŠ¡å™¨çš„æœºæˆ¿å‘ç”Ÿç«ç¾ã€æ–­ç”µç­‰äº‹æ•…ã€‚</p></blockquote><ol start="3"><li>æ™®éå­˜åœ¨çš„å•ç‚¹æ•…éšœ<br>åˆ†å¸ƒå¼ç³»ç»Ÿä¸ºäº†ä¿è¯æ•…éšœå‘ç”Ÿçš„æ—¶å€™ï¼Œç³»ç»Ÿä»ç„¶ä¿è¯å¯ç”¨ï¼Œæ¯ä¸ªæ¨¡å—éƒ½é‡‡ç”¨é›†ç¾¤éƒ¨ç½²ã€‚å•ä¸ªèŠ‚ç‚¹çš„æ•…éšœæ¦‚ç‡è¾ƒä½ï¼Œä½†æ˜¯èŠ‚ç‚¹æ•°é‡è¾¾åˆ°ä¸€å®šè§„æ¨¡æ—¶ï¼Œç³»ç»Ÿä¸­çš„èŠ‚ç‚¹å‡ºç°æ•…éšœçš„æ¦‚ç‡å°±å˜é«˜äº†ã€‚</li></ol><p>åˆ†å¸ƒå¼ç³»ç»Ÿå°±æ˜¯è¿™æ ·ä¸€äº›å¤„åœ¨ä¸åŒåŒºåŸŸã€æœ‰ç€ä¸åŒèƒ½åŠ›å’Œæ‹¥æœ‰å•ä¸€åŠŸèƒ½çš„æœåŠ¡ç»„æˆï¼Œä»–ä»¬é€šåŠ›åˆä½œæ‰èƒ½å‘å¤–æä¾›æœåŠ¡ï¼Œé‚£å¦‚ä½•ä¿è¯ä»–ä»¬çš„çŠ¶æ€ã€ä¿¡æ¯ä¸€è‡´å¹¶ä¸”åè°ƒæœ‰åºå°±æˆäº†ä¸€ä¸ªéš¾é¢˜ã€‚</p><p>åˆ†å¸ƒå¼ç³»ç»Ÿå°±æ˜¯è¦è§£å†³è§£å†³é›†ä¸­å¼çš„å•ä½“æ¶æ„ç³»ç»Ÿçš„å„ç§ç¼ºé™·ï¼Œå®ç°æ•´ä¸ªç³»ç»Ÿçš„ <code>é«˜æ€§èƒ½</code>ã€<code>é«˜å¯ç”¨</code>ã€<code>å¯æ‰©å±•</code>,ä½†æ˜¯è¦å®ç°è¿™ä¸‰ä¸ªç›®æ ‡å¹¶ä¸å®¹æ˜“ï¼Œå°†ç³»ç»Ÿè¿›è¡Œæ‹†åˆ†çš„è¿‡ç¨‹ä¸­ä¼šå‡ºç°ä¸Šæ–‡ä¸­è¯´åˆ°çš„é—®é¢˜ï¼Œä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œè¯ç”Ÿäº†å¾ˆå¤šå…³äºåˆ†å¸ƒå¼çš„åŸºæœ¬ç†è®ºï¼Œæ¯”å¦‚CAPã€BASEç­‰ç­‰ã€‚</p><h6 id="æˆ‘ä»¬å…ˆæ¥è¯´è¯´CAPç†è®º"><a href="#æˆ‘ä»¬å…ˆæ¥è¯´è¯´CAPç†è®º" class="headerlink" title="æˆ‘ä»¬å…ˆæ¥è¯´è¯´CAPç†è®º"></a>æˆ‘ä»¬å…ˆæ¥è¯´è¯´CAPç†è®º</h6><p>è¿™ä¸ªCAPç†è®ºç›¸ä¿¡å¾ˆå¤šäººéƒ½å¬è¯´è¿‡ï¼Œä¸‹é¢è¯·å…è®¸æˆ‘å†™ä¸‹æ•™ç§‘ä¹¦èˆ¬çš„ç†è®ºå†…å®¹ï¼š</p><blockquote><p>CAPåŸåˆ™åˆç§°CAPå®šç†ï¼ŒæŒ‡çš„æ˜¯åœ¨ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼ŒConsistencyï¼ˆä¸€è‡´æ€§ï¼‰ã€ Availabilityï¼ˆå¯ç”¨æ€§ï¼‰ã€Partition toleranceï¼ˆåˆ†åŒºå®¹é”™æ€§ï¼‰ï¼Œä¸‰è€…ä¸å¯å¾—å…¼ã€‚</p><ol><li>ä¸€è‡´æ€§ï¼ˆCï¼‰ï¼šåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æ‰€æœ‰æ•°æ®å¤‡ä»½ï¼Œåœ¨åŒä¸€æ—¶åˆ»æ˜¯å¦åŒæ ·çš„å€¼ã€‚ï¼ˆç­‰åŒäºæ‰€æœ‰èŠ‚ç‚¹è®¿é—®åŒä¸€ä»½æœ€æ–°çš„æ•°æ®å‰¯æœ¬ï¼‰</li><li>å¯ç”¨æ€§ï¼ˆAï¼‰ï¼šä¿è¯æ¯ä¸ªè¯·æ±‚ä¸ç®¡æˆåŠŸæˆ–è€…å¤±è´¥éƒ½æœ‰å“åº”ã€‚</li><li>åˆ†åŒºå®¹å¿æ€§ï¼ˆPï¼‰ï¼šç³»ç»Ÿä¸­ä»»æ„ä¿¡æ¯çš„ä¸¢å¤±æˆ–å¤±è´¥ä¸ä¼šå½±å“ç³»ç»Ÿçš„ç»§ç»­è¿ä½œã€‚</li></ol></blockquote><p>å•¥ç©æ„å•Šä¸Šæ¥å°±å’Œæˆ‘è¯´åˆ†å¸ƒå¼ç³»ç»Ÿåªèƒ½æ»¡è¶³CAPä¸­çš„ä¸¤ç‚¹ï¼Œä¸å¯é±¼å’Œç†ŠæŒå…¼å¾—ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> åˆ†å¸ƒå¼ </tag>
            
            <tag> ä¸€è‡´æ€§ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020å¹´çš„å¹´ç»ˆå°ç»“</title>
      <link href="/post/b4e52eb3.html"/>
      <url>/post/b4e52eb3.html</url>
      
        <content type="html"><![CDATA[<p>2020å¹´çœŸçš„æ˜¯ä¸€ä¸ªç¥å¥‡å¹´åº¦ï¼Œè¿™ä¸€å¹´ä½œä¸ºåƒç“œç¾¤ä¼—çš„æˆ‘ï¼Œè§åˆ°äº†å¤ªå¤šç‰›é¬¼è›‡ç¥ã€‚</p><a id="more"></a><h5 id="å‘¨è¾¹ç¯å¢ƒçš„ä¸å¹³å‡¡"><a href="#å‘¨è¾¹ç¯å¢ƒçš„ä¸å¹³å‡¡" class="headerlink" title="å‘¨è¾¹ç¯å¢ƒçš„ä¸å¹³å‡¡"></a>å‘¨è¾¹ç¯å¢ƒçš„ä¸å¹³å‡¡</h5><p>æ–°å† ç–«æƒ…å¸­å·å…¨çƒï¼Œä¸­å›½æ”¿åºœçš„å°é—­ç®¡ç†æ•ˆæœæ˜¾è‘—ï¼Œç”Ÿäº§æ´»åŠ¨å¾—åˆ°äº†æœ‰åºæ¢å¤ã€‚6æœˆ16æ—¥åœ¨åŠ å‹’ä¸‡æ²³è°·åœ°åŒºä¸­å°å‘ç”Ÿæ‘©æ“¦äº‹ä»¶ï¼Œå°å†›è¢«å¨æ­¦çš„è§£æ”¾å†›æš´æåæ­»äº¡20äººã€‚è€ç¾çš„ç»æµæ³¢åŠ¨ï¼Œè‚¡å¸‚ç ´çºªå½•çš„å››æ¬¡ç†”æ–­ï¼Œå·å»ºå›½çš„ç¾å›½æ€»ç»Ÿä¹‹æ—…åœ¨11æœˆç»“æŸã€‚åŒ—äº¬æ—¶é—´12æœˆ17æ—¥1æ—¶59åˆ†ï¼Œå«¦å¨¥äº”å·è¿”å›å™¨åœ¨å†…è’™å¤å››å­ç‹æ——æˆåŠŸç€é™†ï¼Œæ ‡å¿—ç€æˆ‘å›½é¦–æ¬¡åœ°å¤–å¤©ä½“é‡‡æ ·è¿”å›ä»»åŠ¡åœ†æ»¡å®Œæˆã€‚</p><p><strong>å›½å†…ç–«æƒ…æ¦‚è§ˆ</strong><br><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210111215555.png" alt="å›½å†…ç–«æƒ…æ¦‚è§ˆ" style="zoom:50%;" /></p><p><strong>å›½å¤–ç–«æƒ…æ¦‚è§ˆ</strong></p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210111215635.png" alt="å›½å¤–ç–«æƒ…æ¦‚è§ˆ" style="zoom:50%;" /><h5 id="ä¸ªäººç”Ÿæ´»"><a href="#ä¸ªäººç”Ÿæ´»" class="headerlink" title="ä¸ªäººç”Ÿæ´»"></a>ä¸ªäººç”Ÿæ´»</h5><p>è¶ç€å›½åº†æ”¾å‡åˆå»äº†ä¸€è¶Ÿåˆè‚¥ï¼Œè¿™ä¸€æ¬¡åƒä¸Šäº†ä¸ˆæ¯å¨˜äº²æ‰‹åšçš„çº¢çƒ§é±¿é±¼ï¼Œå‘³é“çœŸæ˜¯ä¸é”™ï¼å›½åº†çš„ç¬¬å››å¤©å’Œå¥³æœ‹å‹å»äº†é»„å±±å¸‚æ—…æ¸¸ï¼Œçˆ¬äº†è²èŠ±å³°ã€å»äº†å¤§å³¡è°·è¿˜åƒäº†è‡­é³œé±¼ã€‚é»„å±±çš„é£æ™¯çœŸæ˜¯ä¸é”™ï¼Œå±±å³°é™¡å³­ã€æ™¯è‰²ç§€ä¸½ã€‚å› ä¸ºæƒ³çœ‹çœ‹é»„å±±çš„æ—¥å‡ºï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨å±±ä¸Šä½äº†ä¸€æ™šã€‚ç¬¬äºŒå¤©æ—©ä¸Šæˆ‘ä»¬æ€¥æ€¥å¿™å¿™çš„èµ·åºŠï¼Œç©¿ä¸Šé…’åº—é‡Œé¢åšåšå¤§å¤§æ£‰è¡£ï¼Œå¤–é¢ä¸‹ç€å°é›¨ã€åˆ®ç€å†·é£è¿˜æœ‰å¤§é›¾ï¼Œè‡ªç„¶ä¹Ÿå°±æ²¡æœ‰çœ‹åˆ°æ—¥å‡ºã€‚å¬å®¾é¦†çš„æœåŠ¡äººå‘˜è¯´å±±ä¸Š365å¤©æœ‰360å¤©éƒ½åœ¨ä¸‹é›¨ï¼Œä½ è¦æ˜¯èƒ½çœ‹åˆ°æ—¥å‡ºï¼Œè¯æ˜ä½ çš„è¿æ°”çœŸæ˜¯çˆ†æ£šï¼<br><strong>è²èŠ±å³°æ‹ç…§ç•™å¿µ</strong><br><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210113221351.png" alt="è²èŠ±å³°æ‹ç…§ç•™å¿µ" style="zoom:50%;" /></p><h5 id="å·¥ä½œ"><a href="#å·¥ä½œ" class="headerlink" title="å·¥ä½œ"></a>å·¥ä½œ</h5><p>åœ¨2020å¹´çš„æœ€åå‡ å¤©æœ‰å¹¸å’Œå‡ ä½å¤§ä½¬èŠäº†èŠï¼Œå‘ç°å¤§ä½¬å°±æ˜¯å¤§ä½¬ï¼Œä¸ç®¡æ˜¯åœ¨æŠ€æœ¯ä¸Šè¿˜æ˜¯åœ¨æ€æƒ³ä¸Šéƒ½è¿œè¿œè¶…è¿‡æˆ‘ã€‚å¤§ä½¬æœ‰å¥è¯å…³äºç³»ç»Ÿè®¾è®¡çš„è¯ï¼Œæˆ‘ç”šæ˜¯èµåŒï¼Œè¯çš„å†…å®¹å¤§è‡´å¦‚ä¸‹ï¼š</p><blockquote><p> ä¸šåŠ¡çš„è¯‰æ±‚è½¬åŒ–æˆäº§å“çš„éœ€æ±‚ï¼Œäº§å“çš„éœ€æ±‚è½¬åŒ–æˆæŠ€æœ¯çš„è¦æ±‚ï¼Œæœ€ç»ˆè½¬æ¢æˆç³»ç»Ÿçš„èƒ½åŠ›ã€‚</p></blockquote><p>ä¸€å¥è¯å°±è¯´å‡ºäº†ç³»ç»Ÿè®¾è®¡çš„è¿‡ç¨‹å’Œç›®çš„ï¼Œè¨€ç®€æ„èµ…å‘€ï¼è°ˆè¯ä¸­å¤§ä½¬è¿˜æŒ‡å‡ºäº†æˆ‘çš„ä¸€äº›é—®é¢˜ï¼Œè®©æˆ‘ä»¥åå¤šå¤šå…³æ³¨ä¸€ä¸‹ç³»ç»Ÿè®¾è®¡ï¼Œè¦æƒ³æ³•å­å»æé«˜è‡ªå·±çš„æ ¸å¿ƒç«äº‰åŠ›ã€‚æˆ‘äº‹åä¹Ÿæƒ³äº†æƒ³ï¼Œæˆ‘åœ¨çŸ¥è¯†æ€»ç»“ã€ç³»ç»Ÿè®¾è®¡å’Œè¯­è¨€ç»„ç»‡èƒ½åŠ›ä¸Šéƒ½æœ‰ä¸è¶³ï¼Œæ–°çš„ä¸€å¹´è¦æ³¨æ„è¿™å‡ ä¸ªæ–¹é¢çš„é”»ç‚¼ã€‚çŸ¥è¯†æ€»ç»“è¿™æ–¹é¢ï¼Œæˆ‘å†³å®šåé¢å¤šå¤šæ€»ç»“ï¼ŒæŠŠçŸ¥è¯†ä¸²è”èµ·æ¥ï¼Œå¤šè¾“å‡ºä¸€äº›åšå®¢ã€‚è¯­è¨€ç»„ç»‡èƒ½åŠ›æˆ‘æƒ³æˆ‘å¹³æ—¶å¤šæ³¨æ„ä¸€ä¸‹ï¼Œç„¶åé€‚å½“çš„é”»ç‚¼é”»ç‚¼åé¢åº”è¯¥ä¼šæ¸æ¸å˜å¥½ã€‚ç³»ç»Ÿè®¾è®¡èƒ½åŠ›è¿™æ–¹é¢çš„è¯ï¼Œåªèƒ½çœ‹çœ‹å·¥ä½œä¸Šæœ‰æ²¡æœ‰ç±»ä¼¼çš„æœºä¼šäº†ï¼Œè¿™ä¸ªå…‰é æƒ³åº”è¯¥ä¸è¡Œï¼Œè¿˜æ˜¯å¾—å®è·µè§çœŸçŸ¥ï¼</p>]]></content>
      
      
      
        <tags>
            
            <tag> å¹´ç»ˆ </tag>
            
            <tag> æ„Ÿæ‚Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·§ç”¨äºŒè¿›åˆ¶è¡¨ç¤ºä¸åŒçš„çŠ¶æ€</title>
      <link href="/post/b7145215.html"/>
      <url>/post/b7145215.html</url>
      
        <content type="html"><![CDATA[<p>æˆ‘ä»¬åœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­ä¼šé‡åˆ°è¿™ç§åœºæ™¯ï¼Œåœ¨ç³»ç»Ÿçš„æƒé™ã€é€‰é¡¹è®¾ç½®ï¼Œåªæœ‰ä¸¤ç§çŠ¶æ€å¼€å¯æˆ–è€…å…³é—­ã€‚</p><a id="more"></a><p>å…·ä½“æˆ‘ä»¬ä»¥å“”å“©å“”å“©çš„éšç§è®¾ç½®ä¸ºä¾‹ï¼š<br><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210106221129.png" alt="éšç§è®¾ç½®" style="zoom:50%;" /></p><p>è¿™ä¹ˆå‡ ç§å¼€å…³ä½ ä¼šæ€ä¹ˆè®¾è®¡æ•°æ®è¡¨ï¼ŸæŒ‰ç…§æ­£å¸¸çš„æ“ä½œé’ˆå¯¹ä¸€ä¸ªå¼€å…³æ·»åŠ å­—æ®µè¿›è¡Œè¡¨ç¤ºã€‚å¯æ˜¯åç»­å°±ä¼šæœ‰ä¸‹é¢çš„è¿™æ ·çš„æƒ…å†µï¼š</p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210106223014.png"  alt="éšç§è®¾ç½®"  style="zoom:50%;" /><p>å“ˆå“ˆï¼Œäº§å“éœ€æ±‚è¿­ä»£å¢åŠ äº†åç»­å‡ ç§å¼€å…³ï¼Œä½ å‡†å¤‡æ€ä¹ˆåšï¼Ÿè¿˜æ˜¯ç»§ç»­å¢åŠ å­—æ®µè¿›è¡Œä¿å­˜ä¹ˆï¼Ÿå¢åŠ å­—æ®µè¿›è¡Œä¿å­˜ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯æ„Ÿè§‰ä¸Šä¼šæœ‰é‚£ä¹ˆä¸€ç‚¹ç‚¹lowï¼æ–°çš„å¼€å…³å‡ºç°å¢åŠ å­—æ®µè¿›è¡Œä¿å­˜ï¼Œæ—¢è¦ä¿®æ”¹è¡¨ç»“æ„ï¼Œåˆè¦æ”¹å®ä½“å±æ€§ï¼Œè¿˜æ˜¯æ¯”è¾ƒéº»çƒ¦çš„ï¼æ‰€ä»¥ï¼Œå¯¹äºè¿™ç§ç±»ä¼¼çš„éœ€æ±‚ï¼Œæˆ‘ä»¬è¦æœ‰ä¸€ä¸ªè‰¯å¥½çš„è®¾è®¡æ¥åº”å¯¹ï¼Œé‚£æˆ‘ä»¬å¦‚ä½•è§£å†³å‘¢ï¼Ÿ</p><p>ç”¨è¿‡linuxç³»ç»Ÿçš„åŒå­¦ä¼šçŸ¥é“è¿™æ ·ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chomd 777 something</span><br><span class="line"><span class="meta">#</span><span class="bash"> å¯è¯»r=4ï¼Œå¯å†™w=2ï¼Œå¯æ‰§è¡Œx=1ï¼Œå³ äºŒè¿›åˆ¶çš„001ä»£è¡¨å¯æ‰§è¡Œï¼Œ010ä»£è¡¨å¯å†™ï¼Œ100ä»£è¡¨å¯è¯»</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„linuxå‘½ä»¤ä»£è¡¨æŠŠsomethingçš„æƒé™ä¿®æ”¹æˆæ‰€æœ‰è€…ã€ç”¨æˆ·ç»„ã€å…¶ä»–ç”¨æˆ·éƒ½å¯ä»¥è¿›è¡Œå¯è¯»ã€å¯å†™ã€å¯æ‰§è¡Œã€‚</p><table><thead><tr><th>æ•°å­—</th><th>æƒé™</th><th>rwx</th><th>äºŒè¿›åˆ¶</th></tr></thead><tbody><tr><td>7</td><td>è¯» + å†™ + æ‰§è¡Œ</td><td>rwx</td><td>111</td></tr><tr><td>6</td><td>è¯» + å†™</td><td>rw-</td><td>110</td></tr><tr><td>5</td><td>è¯» + æ‰§è¡Œ</td><td>r-x</td><td>101</td></tr><tr><td>4</td><td>åªè¯»</td><td>râ€“</td><td>100</td></tr><tr><td>3</td><td>å†™ + æ‰§è¡Œ</td><td>-wx</td><td>011</td></tr><tr><td>2</td><td>åªå†™</td><td>-w-</td><td>010</td></tr><tr><td>1</td><td>åªæ‰§è¡Œ</td><td>â€“x</td><td>001</td></tr><tr><td>0</td><td>æ— </td><td>â€”</td><td>000</td></tr></tbody></table><p>ç”¨çš„æ˜¯äºŒè¿›åˆ¶çš„001ä»£è¡¨å¯æ‰§è¡Œï¼Œ010ä»£è¡¨å¯å†™ï¼Œ100ä»£è¡¨å¯è¯»ï¼Œé‚£ä¹ˆåªéœ€è¦3ä½äºŒè¿›åˆ¶æ•°å³å¯è¡¨ç¤ºè¿™ä¸‰ç§çŠ¶æ€çš„æ··åˆæ­é…ã€‚å€Ÿç”¨è¿™ç§æ€æƒ³ï¼Œæˆ‘ä»¬æ¥è§£å†³ä¸Šè¿°çš„é—®é¢˜ï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªintç±»å‹å­—æ®µå°±å¯ä»¥è¡¨ç¤ºä¸Šè¿°æ‰€æœ‰çš„çŠ¶æ€å¼€å…³ã€‚<strong>ä½¿ç”¨2çš„æ¬¡å¹‚å€¼ä»£è¡¨ä¸€ç§çŠ¶æ€</strong>ï¼Œæ¯”å¦‚æˆ‘ä»¬ç”¨</p><ul><li><p>2çš„é›¶æ¬¡æ–¹ $2^{0}$ = 1 è¡¨ç¤ºæ‰“å¼€æˆ‘çš„æ”¶è—</p></li><li><p>2çš„ä¸€æ¬¡æ–¹ $2^{1}$ = 2 è¡¨ç¤ºæ‰“å¼€è¿½ç•ªè¿½å‰§</p></li><li><p>2çš„äºŒæ¬¡æ–¹ $2^{2}$ = 4 è¡¨ç¤ºæ‰“å¼€è®¢é˜…æ ‡ç­¾</p></li><li><p>2çš„ä¸‰æ¬¡æ–¹ $2^{3}$ = 8 è¡¨ç¤ºæ‰“å¼€æœ€è¿‘æŠ•å¸çš„è§†é¢‘</p></li><li><p>2çš„å››æ¬¡æ–¹ $2^{4}$ = 16 è¡¨ç¤ºæ‰“å¼€ä¸ªäººèµ„æ–™</p></li><li><p>2çš„äº”æ¬¡æ–¹ $2^{5}$ = 32 è¡¨ç¤ºæ‰“å¼€æœ€è¿‘ç©è¿‡çš„æ¸¸æˆ</p><blockquote><p>åšå®¢ä½¿ç”¨hexoæ­å»ºï¼Œé‡‡ç”¨é»˜è®¤çš„landscapeä¸»é¢˜ä¸æ”¯æŒLaTeX å…¬å¼ï¼Œæ‰€ä»¥ä¸Šé¢çš„æ¬¡æ–¹å…¬å¼æ˜¾ç¤ºçš„æœ‰é—®é¢˜ã€‚ </p></blockquote></li></ul><table><thead><tr><th>äºŒè¿›åˆ¶</th><th>æ•°å­—ï¼ˆåè¿›åˆ¶ï¼‰</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>000 000</td><td>0</td><td>å…¨éƒ¨å…³é—­</td></tr><tr><td>000 001</td><td>1</td><td>å¼€å¯æˆ‘çš„æ”¶è—</td></tr><tr><td>000 011</td><td>3</td><td>å¼€å¯æˆ‘çš„æ”¶è—ã€è¿½ç•ªè¿½å‰§</td></tr><tr><td>000 111</td><td>7</td><td>å¼€å¯æˆ‘çš„æ”¶è—ã€è¿½ç•ªè¿½å‰§ã€è®¢é˜…æ ‡ç­¾</td></tr><tr><td>111 111</td><td>63</td><td>å…¨éƒ¨å¼€å¯</td></tr></tbody></table><p><strong>å…¶å®å°±æ˜¯ç”¨bitä½è¡¨ç¤ºå¼€å¯æˆ–è€…å…³é—­ï¼Œå¦‚æœæ˜¯1è¡¨ç¤ºå¼€å¯ï¼Œ0è¡¨ç¤ºå…³é—­ã€‚</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æˆ–è¿ç®—ï¼šbitä½ä¸Šæœ‰1ä¸º1ã€‚ä¾‹å¦‚ï¼š2 | 1 == 0000 0010 | 0000 0001 == 3</span><br><span class="line">ä¸è¿ç®—ï¼šbitä½éƒ½ä¸º1æ‰ä¸º1ã€‚ ä¾‹å¦‚ 5 &amp; 2 == 0000 0101 &amp; 0000 0010 == 0</span><br><span class="line">å¼‚æˆ–è¿ç®—ï¼š0^0=0ï¼›  0^1=1ï¼›  1^0=1ï¼›   1^1=0ï¼›å³ï¼šå‚åŠ è¿ç®—çš„ä¸¤ä¸ªå¯¹è±¡ï¼Œå¦‚æœä¸¤ä¸ªç›¸åº”ä½ä¸ºâ€œå¼‚â€ï¼ˆå€¼ä¸åŒï¼‰ï¼Œåˆ™è¯¥ä½ç»“æœä¸º1ï¼Œå¦åˆ™ä¸º0ã€‚</span><br></pre></td></tr></table></figure><h6 id="é‚£æˆ‘ä»¬å°±æ¥ç¼–ç å®ç°ä¸Šè¿°åŠŸèƒ½ï¼š"><a href="#é‚£æˆ‘ä»¬å°±æ¥ç¼–ç å®ç°ä¸Šè¿°åŠŸèƒ½ï¼š" class="headerlink" title="é‚£æˆ‘ä»¬å°±æ¥ç¼–ç å®ç°ä¸Šè¿°åŠŸèƒ½ï¼š"></a>é‚£æˆ‘ä»¬å°±æ¥ç¼–ç å®ç°ä¸Šè¿°åŠŸèƒ½ï¼š</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ydstudio.flashsale.<span class="keyword">module</span>.business.bit;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Getter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> åˆ˜æ´‹ Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/1/7</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> MemberOption &#123;</span><br><span class="line"></span><br><span class="line">    FAVORITE(<span class="number">1</span>, <span class="string">"æˆ‘çš„æ”¶è—"</span>, <span class="number">1</span>),</span><br><span class="line">    FOLLOW(<span class="number">2</span>, <span class="string">"è¿½ç•ªè¿½å‰§"</span>, <span class="number">2</span>),</span><br><span class="line">    SUBSCRIBE(<span class="number">3</span>, <span class="string">"è®¢é˜…æ ‡ç­¾"</span>, <span class="number">4</span>),</span><br><span class="line">    VIDEO(<span class="number">4</span>, <span class="string">"æœ€è¿‘æŠ•å¸è§†é¢‘"</span>, <span class="number">8</span>),</span><br><span class="line">    PROFILE(<span class="number">5</span>, <span class="string">"ä¸ªäººèµ„æ–™"</span>, <span class="number">16</span>),</span><br><span class="line">    GAME(<span class="number">6</span>, <span class="string">"æœ€è¿‘ç©çš„æ¸¸æˆ"</span>, <span class="number">32</span>),;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æšä¸¾</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer code;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æè¿°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String desc;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * çŠ¶æ€ä½</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer tag;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¯å¦æœ‰æŸä¸ªtag</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> tags æ‹¥æœ‰çš„tagé›†åˆ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasTag</span><span class="params">(<span class="keyword">int</span> tags)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (tags &amp; <span class="keyword">this</span>.tag) == <span class="keyword">this</span>.tag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> tags = <span class="number">37</span>;</span><br><span class="line">        <span class="comment">// true</span></span><br><span class="line">        System.out.println(MemberOption.FAVORITE.hasTag(tags));</span><br><span class="line">        <span class="comment">// true</span></span><br><span class="line">        System.out.println(MemberOption.SUBSCRIBE.hasTag(tags));</span><br><span class="line">        <span class="comment">// false</span></span><br><span class="line">        System.out.println(MemberOption.VIDEO.hasTag(tags));</span><br><span class="line">        <span class="comment">// true</span></span><br><span class="line">        System.out.println(MemberOption.GAME.hasTag(tags));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h6 id="å¼€å¯æˆ‘çš„æ”¶è—å’Œæœ€è¿‘ç©çš„æ¸¸æˆï¼Œå…¶ä»–é€‰é¡¹éƒ½å…³é—­ï¼Œåˆ™è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š"><a href="#å¼€å¯æˆ‘çš„æ”¶è—å’Œæœ€è¿‘ç©çš„æ¸¸æˆï¼Œå…¶ä»–é€‰é¡¹éƒ½å…³é—­ï¼Œåˆ™è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š" class="headerlink" title="å¼€å¯æˆ‘çš„æ”¶è—å’Œæœ€è¿‘ç©çš„æ¸¸æˆï¼Œå…¶ä»–é€‰é¡¹éƒ½å…³é—­ï¼Œåˆ™è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š"></a>å¼€å¯æˆ‘çš„æ”¶è—å’Œæœ€è¿‘ç©çš„æ¸¸æˆï¼Œå…¶ä»–é€‰é¡¹éƒ½å…³é—­ï¼Œåˆ™è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># æˆ‘çš„æ”¶è— tag = 1 æœ€è¿‘ç©çš„æ¸¸æˆ tag = 32</span><br><span class="line">tags = <span class="number">1</span> + <span class="number">32</span> = <span class="number">33</span> </span><br><span class="line">æˆ–è€…é‡‡ç”¨ä½æˆ–è¿ç®— tags = <span class="number">1</span> | <span class="number">32</span> = <span class="number">33</span></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">  * è®¡ç®—çŠ¶æ€ä½</span></span><br><span class="line"><span class="comment">  * tags: å·²æœ‰çŠ¶æ€ä½</span></span><br><span class="line"><span class="comment">  * values: éœ€è¦æ·»åŠ çš„çŠ¶æ€å€¼</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">addTag</span><span class="params">(<span class="keyword">int</span> tags, <span class="keyword">int</span>... values)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> value : values) &#123;</span><br><span class="line">    tags |= value;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> tags;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h6 id="å…³é—­æœ€è¿‘ç©çš„æ¸¸æˆï¼Œåˆ™è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š"><a href="#å…³é—­æœ€è¿‘ç©çš„æ¸¸æˆï¼Œåˆ™è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š" class="headerlink" title="å…³é—­æœ€è¿‘ç©çš„æ¸¸æˆï¼Œåˆ™è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š"></a>å…³é—­æœ€è¿‘ç©çš„æ¸¸æˆï¼Œåˆ™è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">ä¸Šé¢è®¡ç®—çš„tags = <span class="number">33</span> ï¼Œæœ€è¿‘ç©çš„æ¸¸æˆ tag = <span class="number">32</span></span><br><span class="line">å…³é—­æœ€è¿‘ç©çš„æ¸¸æˆï¼Œ</span><br><span class="line">tags = <span class="number">33</span> ^ <span class="number">32</span> = <span class="number">0010</span> <span class="number">0001</span> ^ <span class="number">0010</span> <span class="number">0000</span> = <span class="number">0000</span> <span class="number">0001</span> = <span class="number">1</span></span><br><span class="line">  </span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * ç§»é™¤çŠ¶æ€ä½</span></span><br><span class="line"><span class="comment">   * tags: å·²æœ‰çŠ¶æ€ä½</span></span><br><span class="line"><span class="comment">   * tag: éœ€è¦ç§»é™¤çš„çŠ¶æ€å€¼</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">delTag</span><span class="params">(<span class="keyword">int</span> tags, <span class="keyword">int</span> tag)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// tagså’Œvalueä¸è¿ç®—ä¸ç­‰äºtagï¼Œè¯´æ˜æ²¡æœ‰å¼€å¯tagå¯¹åº”çš„é€‰é¡¹ï¼Œåˆ™ç›´æ¥è¿”å›tags</span></span><br><span class="line">  <span class="keyword">if</span> ((tags &amp; tag) != tag) <span class="keyword">return</span> tags;</span><br><span class="line">  <span class="keyword">return</span> tags ^ tag;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h6 id="åˆ¤æ–­æ˜¯å¦å¼€å¯æœ€è¿‘ç©çš„æ¸¸æˆï¼Œåˆ™è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š"><a href="#åˆ¤æ–­æ˜¯å¦å¼€å¯æœ€è¿‘ç©çš„æ¸¸æˆï¼Œåˆ™è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š" class="headerlink" title="åˆ¤æ–­æ˜¯å¦å¼€å¯æœ€è¿‘ç©çš„æ¸¸æˆï¼Œåˆ™è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š"></a>åˆ¤æ–­æ˜¯å¦å¼€å¯æœ€è¿‘ç©çš„æ¸¸æˆï¼Œåˆ™è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ä¸Šé¢è®¡ç®—çš„tags = <span class="number">33</span> ï¼Œæœ€è¿‘ç©çš„æ¸¸æˆ tag = <span class="number">32</span></span><br><span class="line"> <span class="number">33</span> &amp; <span class="number">32</span> = <span class="number">0010</span> <span class="number">0001</span> &amp; <span class="number">0010</span> <span class="number">0000</span> = <span class="number">0010</span> <span class="number">0000</span> = <span class="number">32</span> (<span class="number">0010</span> <span class="number">0000</span>)</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¯å¦æœ‰æŸä¸ªtag</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> tags æ‹¥æœ‰çš„tagé›†åˆ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> tag å¾…åˆ¤æ–­çš„tag</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasTag</span><span class="params">(<span class="keyword">int</span> tags, <span class="keyword">int</span> tag)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (tags &amp; tag) == tag;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h6 id="å¦‚ä½•ç”¨SQLæŸ¥è¯¢å¼€å¯æœ€è¿‘ç©çš„æ¸¸æˆé€‰é¡¹çš„ç”¨æˆ·"><a href="#å¦‚ä½•ç”¨SQLæŸ¥è¯¢å¼€å¯æœ€è¿‘ç©çš„æ¸¸æˆé€‰é¡¹çš„ç”¨æˆ·" class="headerlink" title="å¦‚ä½•ç”¨SQLæŸ¥è¯¢å¼€å¯æœ€è¿‘ç©çš„æ¸¸æˆé€‰é¡¹çš„ç”¨æˆ·"></a>å¦‚ä½•ç”¨SQLæŸ¥è¯¢å¼€å¯æœ€è¿‘ç©çš„æ¸¸æˆé€‰é¡¹çš„ç”¨æˆ·</h6><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># MySQLä¹Ÿæ˜¯æ”¯æŒä½è¿ç®—çš„ï¼Œå…¶ä»–çš„æ•°æ®åº“åº”è¯¥ä¹Ÿæ˜¯æ”¯æŒçš„</span></span><br><span class="line"><span class="keyword">select</span> member_id <span class="keyword">from</span> table_name <span class="keyword">where</span> member_option &amp; <span class="comment">#&#123;option&#125; = #&#123;option&#125;</span></span><br></pre></td></tr></table></figure><p>å°±è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç”¨ä¸€ä¸ªintå‹å­—æ®µä¿å­˜4*8 = 32ä¸ªçŠ¶æ€ä½ï¼ˆæ— ç¬¦å·çš„æƒ…å†µä¸‹ï¼‰,çœ‹èµ·æ¥è¿˜æ˜¯å¾ˆä¸é”™ï¼Œè¿ç®—çš„æ•ˆç‡é«˜ï¼Œåªç”¨ä¸€ä¸ªå­—æ®µå¯ä»¥ä¿å­˜è¾ƒå¤šçš„çŠ¶æ€ã€‚ç¼ºç‚¹å˜›ä¹Ÿæ˜¯æœ‰çš„ï¼Œå°±æ˜¯å¯è¯»æ€§å·®ï¼Œä¸èƒ½å¾ˆç›´è§‚çš„çœ‹å‡ºåˆ°åº•æœ‰å“ªäº›çŠ¶æ€ã€‚å…¶å®è¿™ç§æ–¹æ³•å¯ä»¥ç”¨ä¸€ä¸ªå­—æ®µè¡¨ç¤ºå¤šç§çŠ¶æ€ï¼Œä¾‹å¦‚ è®¢å•ä¸€èˆ¬æœ‰æ”¯ä»˜çŠ¶æ€ï¼šå¾…æ”¯ä»˜ 1 ã€æ”¯ä»˜ä¸­ 2 ã€æ”¯ä»˜æˆåŠŸ4 ã€æ”¯ä»˜å¤±è´¥8å’Œå‘è´§çŠ¶æ€ï¼šå¾…å‘è´§16ã€å·²å‘è´§32ã€åœ¨é€”64ã€å·²æ”¶è´§128ï¼Œè¿™æ ·çš„è¯ç”¨ä¸€ä¸ªorderStatusæ¥è¡¨ç¤ºè¿™ä¸¤ç§çŠ¶æ€ï¼šæ”¯ä»˜æˆåŠŸ4 + å¾…å‘è´§16 = 4 | 16 = 20ï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ä½†æ˜¯å¦‚ä¸Šé¢æ‰€è¯´ï¼Œä¼˜ç¼ºç‚¹éƒ½æœ‰ï¼Œçœ‹ä½ çš„å®é™…æƒ…å†µè¿›è¡Œé€‰æ‹©äº†ï¼</p>]]></content>
      
      
      
        <tags>
            
            <tag> äºŒè¿›åˆ¶ </tag>
            
            <tag> ä½è¿ç®— </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Luaè„šæœ¬åœ¨ç§’æ€åœºæ™¯ä¸‹çš„ä½¿ç”¨</title>
      <link href="/post/d958d490.html"/>
      <url>/post/d958d490.html</url>
      
        <content type="html"><![CDATA[<p>åœ¨ç§’æ€è¿™ç§é«˜å¹¶å‘ã€å¤§æµé‡çš„åœºæ™¯ä¸‹ï¼Œåˆ©ç”¨æ•°æ®åº“è¿›è¡Œåº“å­˜æ‰£å‡ã€æ•°æ®æŸ¥è¯¢è¿™ç§æƒ³æ³•å°±ä¸è¦è€ƒè™‘äº†ã€‚ä½ è¦æ˜¯æœ‰è¿™ç§æƒ³æ³•ï¼ŒåŠä½ æ—©ç‚¹æ”¾å¼ƒï¼ŒP0äº‹æ•…ä¸€å®šåœ¨ç­‰ç€ä½ ã€‚ä¹‹å‰ç”¨Luaè„šæœ¬å®ç°ç§’æ€åœºæ™¯ä¸‹çš„åº“å­˜æ‰£å‡æ„Ÿè§‰å¾ˆä¸é”™ï¼Œé…åˆRedisç§’æ€æ•ˆæœæ æ çš„ï¼Redis 2.6 ç‰ˆæœ¬é€šè¿‡å†…åµŒæ”¯æŒ Lua ç¯å¢ƒï¼Œä¼šå•çº¿ç¨‹åŸå­æ€§æ‰§è¡Œ Lua è„šæœ¬ï¼Œä¿è¯ Lua è„šæœ¬åœ¨å¤„ç†çš„è¿‡ç¨‹ä¸­ä¸ä¼šè¢«ä»»æ„å…¶å®ƒè¯·æ±‚æ‰“æ–­ã€‚</p><a id="more"></a><p>å…ˆè¯´ä¸€ä¸‹å¤§æ¦‚çš„æƒ…å†µï¼Œåœ¨ä¸Šç§’æ€çš„å•†å“çš„æ—¶å€™ï¼Œå°±ç›´æ¥å°†äº§å“çš„åº“å­˜ã€ç”¨æˆ·æ¯äººçš„é™è´­çš„æ•°é‡ç­‰ä¿¡æ¯ç›´æ¥ç”¨Hashæ•°æ®ç±»å‹ä¿å­˜åœ¨Redisçš„é”®goods_å•†å“IDä¸­ï¼Œä¸è®¾ç½®ç¼“å­˜æœ‰æ•ˆæ—¶é—´ã€‚ç”¨æˆ·çš„è´­ä¹°è®°å½•ç”¨zsetä¿å­˜purchase_goods_å•†å“idä¸­ï¼Œç”¨å•†å“çš„IDä½œä¸ºkeyï¼Œç”¨æˆ·å”¯ä¸€æ ‡è¯†ä¸ºmember,è´­ä¹°çš„æ•°é‡ä¸ºscoreã€‚ç›¸å…³çš„å‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> åˆå§‹åŒ–ä¸€äº›ç§’æ€äº§å“</span></span><br><span class="line">hmset seckill:goods:1000 goodsId 1000 name æˆ´æ£®å¸å°˜å™¨V10Motorheadå…¥é—¨æ¬¾,æ€§ä»·æ¯”ä¹‹é€‰ stock 10 purchaseLimit 1   price 999.99 startSaleTime 1614137304000 endSaleTime 1614140904000  coverImage https://dss2.bdstatic.com/8_V1bjqh_Q23odCf/pacific/1955446237.png</span><br><span class="line"></span><br><span class="line">hmset seckill:goods:2000 goodsId 2000 name æˆ´æ£®æ— å¶é£æ‰‡ stock 15 purchaseLimit 1  price 1999.99 startSaleTime 1640406504000 endSaleTime 1614140904000  coverImage https://dss2.bdstatic.com/8_V1bjqh_Q23odCf/pacific/1957729018.png</span><br><span class="line"></span><br><span class="line">hmset seckill:goods:3000 goodsId 3000 name æˆ´æ£®æ™ºèƒ½ç…§æ˜ç¯ stock 32 purchaseLimit 1 price 299.99 startSaleTime 1640406504000 endSaleTime 1614140904000  coverImage https://dss2.bdstatic.com/8_V1bjqh_Q23odCf/pacific/1947896752.jpg</span><br><span class="line"></span><br><span class="line">hmset seckill:goods:4000 goodsId 4000 name æˆ´æ£®AM10é™¤èŒåŠ æ¹¿å™¨ stock 15  purchaseLimit 1   price 1299.99 startSaleTime 1640752104000 endSaleTime 1610166504000 coverImage https://dss2.bdstatic.com/8_V1bjqh_Q23odCf/pacific/1947896752.jpg</span><br><span class="line"></span><br><span class="line">hmset seckill:goods:5000 goodsId 5000 name è‹¹æœAirPodsMax  stock 13 purchaseLimit 1   price 2099.99 startSaleTime 1640752104000 endSaleTime 1610166504000 coverImage  https://dss2.bdstatic.com/8_V1bjqh_Q23odCf/pacific/1983533493.jpg</span><br></pre></td></tr></table></figure><p>å…·ä½“çš„Luaè„šæœ¬ç¼–å†™è¿‡ç¨‹æ¯”è¾ƒç®€å•ï¼Œç¨å¾®ç†Ÿæ‚‰ä¸€ä¸‹å°±èƒ½çœ‹æ‡‚äº†ï¼Œå…·ä½“å†…å®¹å¦‚ä¸‹ï¼ˆä¸´æ—¶é‡å†™çš„æ²¡æœ‰ä¼˜åŒ–ï¼Œå‡‘åˆç€çœ‹å§ï¼‰ï¼š</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--KEYS[1] å¯¹åº”å•†å“çš„è´­ä¹°è®°å½•:purchase_goods_1000</span></span><br><span class="line"><span class="comment">--KEYS[2] å•†å“çš„key:goods_1000</span></span><br><span class="line"><span class="comment">--ARGV[1] è´­ä¹°äººå”¯ä¸€æ ‡è¯†memberId:2000</span></span><br><span class="line"><span class="comment">--ARGV[2] è´­ä¹°æ•°é‡number: 2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> goodsExists=redis.call(<span class="string">'EXISTS'</span>, KEYS[<span class="number">2</span>])</span><br><span class="line"><span class="keyword">if</span> goodsExists == <span class="number">0</span></span><br><span class="line"><span class="keyword">then</span> </span><br><span class="line"> <span class="comment">-- äº§å“ä¸å­˜åœ¨</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">local</span> goodsStockExists=redis.call(<span class="string">'hexists'</span>, KEYS[<span class="number">2</span>], <span class="string">'stock'</span>)</span><br><span class="line"><span class="keyword">if</span> goodsStockExists == <span class="number">0</span> </span><br><span class="line"><span class="keyword">then</span> </span><br><span class="line">   <span class="comment">-- ä»£è¡¨äº§å“åº“å­˜ä¸å­˜åœ¨</span></span><br><span class="line"> <span class="keyword">return</span> <span class="number">-2</span></span><br><span class="line"><span class="keyword">end</span> </span><br><span class="line"><span class="comment">--ç”¨æˆ·é™è´­æ•°é‡</span></span><br><span class="line"><span class="keyword">local</span> purchaseLimitExists=redis.call(<span class="string">'hexists'</span>, KEYS[<span class="number">2</span>], <span class="string">'purchaseLimit'</span>)</span><br><span class="line"><span class="keyword">if</span> purchaseLimitExists == <span class="number">0</span></span><br><span class="line"><span class="keyword">then</span> </span><br><span class="line"><span class="comment">-- å•†å“é™è´­æ•°é‡ä¸å­˜åœ¨</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">-3</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">--ç”¨æˆ·é™è´­æ•°é‡</span></span><br><span class="line"><span class="keyword">local</span> purchaseLimit=<span class="built_in">tonumber</span>(redis.call(<span class="string">'hget'</span>, KEYS[<span class="number">2</span>], <span class="string">'purchaseLimit'</span>))</span><br><span class="line"><span class="comment">--ç”¨æˆ·å·²ç»è´­ä¹°çš„æ•°é‡</span></span><br><span class="line"><span class="keyword">local</span> purchasedNumber=redis.call(<span class="string">'ZSCORE'</span>, KEYS[<span class="number">1</span>], ARGV[<span class="number">1</span>])</span><br><span class="line"><span class="comment">--è´­ä¹°æ•°é‡ä¸å­˜åœ¨åˆ™é»˜è®¤ä¸º0</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> purchasedNumber</span><br><span class="line"><span class="keyword">then</span> </span><br><span class="line">   purchasedNumber = <span class="number">0</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">-- ç”¨æˆ·ç°åœ¨è¦è´­ä¹°çš„æ•°é‡</span></span><br><span class="line"><span class="keyword">local</span> nowPurchasedNumber = <span class="built_in">tonumber</span>(ARGV[<span class="number">2</span>])</span><br><span class="line"><span class="comment">-- ç”¨æˆ·å°†è¦è´­ä¹°çš„æ€»æ•°é‡</span></span><br><span class="line"><span class="keyword">local</span> totalPurchaseNumber = nowPurchasedNumber+purchasedNumber</span><br><span class="line"><span class="keyword">if</span> purchaseLimit &lt; totalPurchaseNumber</span><br><span class="line"><span class="keyword">then</span> </span><br><span class="line"><span class="comment">-- ç”¨æˆ·è´­ä¹°æ•°é‡è¶…è¿‡äº†é™è´­æ•°é‡</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">-4</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">local</span> stock=<span class="built_in">tonumber</span>(redis.call(<span class="string">'hget'</span>, KEYS[<span class="number">2</span>], <span class="string">'stock'</span>))</span><br><span class="line"><span class="keyword">if</span> stock &lt;= <span class="number">0</span></span><br><span class="line"><span class="keyword">then</span> </span><br><span class="line">  <span class="comment">-- åº“å­˜ä¸º0</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">if</span> stock &lt; nowPurchasedNumber</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line"> <span class="comment">-- åº“å­˜ä¸è¶³</span></span><br><span class="line"> <span class="keyword">return</span> <span class="number">2</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--æ‰£å‡å•†å“åº“å­˜</span></span><br><span class="line">redis.call(<span class="string">'hincrby'</span>, KEYS[<span class="number">2</span>], <span class="string">'stock'</span>, -nowPurchasedNumber)</span><br><span class="line"><span class="comment">-- æ›´æ–°ç”¨æˆ·çš„æ€»è´­ä¹°æ•°é‡</span></span><br><span class="line">redis.call(<span class="string">'zadd'</span>,KEYS[<span class="number">1</span>], totalPurchaseNumber, ARGV[<span class="number">1</span>])</span><br><span class="line"><span class="comment">-- ç”¨æˆ·è´­ä¹°æˆåŠŸ</span></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span></span><br></pre></td></tr></table></figure><blockquote><ol><li>å°½ç®¡Luaä¼šæä¾›å­—ç¬¦ä¸²å’Œæ•°å­—çš„è‡ªåŠ¨è½¬æ¢ï¼Œä½†æ˜¯æ›´å¥½è¿˜æ˜¯è½¬æ¢ä¸€ä¸‹ã€‚tonumberå°±æ˜¯æŠŠå­—ç¬¦ä¸²æ•°å­—è½¬æ¢æˆæ•°å­—çš„å‡½æ•°ã€‚</li><li>redis.callæ˜¯ç”¨æ¥æ‰§è¡Œrediså‡½æ•°çš„æ–¹æ³•ã€‚</li><li>ä¸Šè¿°çš„è„šæœ¬å¯ä»¥é€šè¿‡EVALã€EVALSHAæˆ–è€…redis-cli å‚æ•°çš„å½¢å¼æ‰§è¡Œã€‚ä½†æ˜¯ä¸Šé¢çš„è„šæœ¬å·²ç»æ ¼å¼åŒ–äº†ï¼Œæœ€å¥½è¿˜æ˜¯ä»¥åé¢çš„æ–¹å¼è¿è¡Œã€‚</li><li>Luaçš„æ³¨é‡Šæ˜¯ä»¥ â€“ å¼€å¤´ä½œä¸ºå•è¡Œæ³¨é‡Š</li></ol></blockquote><p>å…·ä½“æ‰§è¡Œæ¼”ç¤ºå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Sam-Mac:Downloads Sam$ rediscli --eval  /Users/sam/Downloads/seckill.lua  purchase_goods_3000 seckill:goods:1000 , 202 1</span><br><span class="line">(integer) 0</span><br><span class="line">Sam-Mac:Downloads Sam$</span><br></pre></td></tr></table></figure><ul><li><p>â€“evalå‚æ•°æ˜¯å‘Šè¯‰rediscli(è¿™ä¸ªæ˜¯è‡ªå®šä¹‰redis-cliå‘½ä»¤çš„åœ°å€)è¯»å–å¹¶è¿è¡Œåé¢çš„Luaè„šæœ¬ã€‚</p></li><li><p>/Users/sam/Downloads/seckill.lua æ˜¯è„šæœ¬çš„ä½ç½®ï¼Œåé¢è·Ÿç€æ˜¯ä¼ ç»™Luaè„šæœ¬çš„å‚æ•°ã€‚</p></li><li><p>é€—å·â€,â€å‰çš„purchase_goods_3000 seckill:goods:1000 æ˜¯è¦æ“ä½œçš„é”®ï¼Œå¯ä»¥åœ¨è„šæœ¬ä¸­ç”¨KEYS[1]ã€KEYS[2]è·å–ï¼Œé€—å·â€,â€åé¢çš„202å’Œ1æ˜¯å‚æ•°ï¼Œåœ¨è„šæœ¬ä¸­èƒ½å¤Ÿä½¿ç”¨ARGV[1]å’ŒARGV[2]è·å¾—ã€‚</p></li></ul><blockquote><p>æ³¨æ„â€,â€é€—å·ä¸¤è¾¹çš„ç©ºæ ¼ä¸èƒ½çœç•¥ï¼Œå¦åˆ™ä¼šå‡ºé”™</p></blockquote><p>åœ¨Redisä¸­è°ƒç”¨Luaè„šæœ¬ï¼Œä¹Ÿæ˜¯å¯ä»¥è°ƒè¯•çš„ã€‚Redis ä» v3.2.0 å¼€å§‹æ”¯æŒ Lua debuggerï¼Œå¯ä»¥åŠ æ–­ç‚¹ã€print å˜é‡ä¿¡æ¯ã€å±•ç¤ºæ­£åœ¨æ‰§è¡Œçš„ä»£ç ã€‚å¯ä»¥åœ¨å‘½ä»¤ä¸­æ·»åŠ â€“ldbè¿›è¡Œè°ƒè¯•ï¼Œè¿™ä¸ªå‚æ•°æ˜¯å¼€å¯ Lua dubegger çš„æ„æ€ï¼Œè¿™ä¸ªæ¨¡å¼ä¸‹Redisä¼š fork ä¸€ä¸ªè¿›ç¨‹è¿›å…¥éš”ç¦»ç¯å¢ƒï¼Œä¸ä¼šå½±å“Redisæ­£å¸¸æä¾›æœåŠ¡ï¼Œä½†è°ƒè¯•æœŸé—´ï¼ŒåŸå§‹ redis æ‰§è¡Œå‘½ä»¤ã€è„šæœ¬çš„ç»“æœä¹Ÿä¸ä¼šä½“ç°åˆ° fork ä¹‹åçš„éš”ç¦»ç¯å¢ƒä¹‹ä¸­ã€‚å› æ­¤å‘¢ï¼Œè¿˜æœ‰å¦å¤–ä¸€ç§è°ƒè¯•æ¨¡å¼ â€“ldb-sync-modeï¼Œä¹Ÿå°±æ˜¯å‰é¢æåˆ°çš„åŒæ­¥æ¨¡å¼ï¼Œè¿™ä¸ªæ¨¡å¼ä¸‹ï¼Œä¼šé˜»å¡ redis ä¸Šæ‰€æœ‰çš„å‘½ä»¤ã€è„šæœ¬ï¼Œç›´åˆ°è„šæœ¬é€€å‡ºï¼Œå®Œå…¨æ¨¡æ‹Ÿäº†æ­£å¼ç¯å¢ƒä½¿ç”¨æ—¶å€™çš„æƒ…å†µï¼Œä½¿ç”¨çš„æ—¶å€™åŠ¡å¿…æ³¨æ„è¿™ç‚¹ã€‚</p><p>æ·»åŠ å’Œåˆ é™¤æ–­ç‚¹å¾ˆç®€å•ï¼Œåªéœ€ä½¿ç”¨<code>b 1 2 3 4</code>åœ¨ç¬¬1,2,3,4è¡Œæ·»åŠ <code>b 0</code>æ–­ç‚¹ã€‚è¯¥å‘½ä»¤å°†åˆ é™¤æ‰€æœ‰æ–­ç‚¹ã€‚å¯ä»¥ä½¿ç”¨aså‚æ•°åˆ é™¤é€‰å®šçš„æ–­ç‚¹ï¼Œå³æˆ‘ä»¬è¦åˆ é™¤çš„æ–­ç‚¹æ‰€åœ¨çš„è¡Œï¼Œä½†å‰ç¼€ä¸ºå‡å·ã€‚ä¾‹å¦‚<code>b -3</code>ï¼Œä»ç¬¬3è¡Œä¸­åˆ é™¤æ–­ç‚¹ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Sam-Mac:Downloads Sam$ rediscli --ldb --eval  /Users/sam/Downloads/seckill.lua  purchase_goods_3000 seckill:goods:1000 , 202 1</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20201224234757.png" alt="è°ƒè¯•Luaè„šæœ¬"></p><p>ä¸Šé¢å°±æ˜¯ä»Šæ—¥æ–‡ç« çš„æ‰€ä»¥å†…å®¹ï¼Œè¿™æ ·çœ‹èµ·æ¥æ˜¯ä¸æ˜¯è§‰å¾—Luaè„šæœ¬ä¹Ÿæ˜¯æŒºå®¹æ˜“çš„å§ï¼</p>]]></content>
      
      
      
        <tags>
            
            <tag> redis </tag>
            
            <tag> lua </tag>
            
            <tag> ç§’æ€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQLçš„IGNOREå…³é”®å­—åœ¨é¿å…é‡å¤æ’å…¥è®°å½•æ—¶å­˜åœ¨çš„é—®é¢˜åŠæœ€ä½³å®è·µ</title>
      <link href="/post/cef7abb0.html"/>
      <url>/post/cef7abb0.html</url>
      
        <content type="html"><![CDATA[<p>æˆ‘ä»¬åœ¨å®é™…å¼€å‘ä¸­æ€»æœ‰è¿™æ ·çš„éœ€æ±‚ï¼Œè¡¨é‡Œçš„æ•°æ®è¦ä¿æŒå”¯ä¸€ï¼Œæ‰€ä»¥æˆ‘ä»¬å¼€å‘ä¸­ç»å¸¸éƒ½æ˜¯å…ˆæŸ¥è¯¢è¿™æ ·çš„æ•°æ®æœ‰æ²¡æœ‰ï¼Œæœ‰çš„è¯è·³è¿‡ï¼Œæ²¡æœ‰çš„è¯å†æ’å…¥ï¼Œç„¶ååœ¨èƒ½è¡¨ç¤ºæ•°æ®è®°å½•å”¯ä¸€çš„åˆ—ä¸ŠåŠ ä¸Šå”¯ä¸€ç´¢å¼•è¿›è¡Œå…œåº•ã€‚è™½ç„¶æœ‰çš„åŒå­¦åŸºæœ¬ä¸Šä¹Ÿæ˜¯è¿™ä¹ˆåšçš„ï¼Œä½†æ˜¯åˆç¨å¾®çš„åšäº†ä¸€ç‚¹å…¶ä»–çš„éªšæ“ä½œğŸ˜„ğŸ˜„ğŸ˜„ã€‚</p><a id="more"></a><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ğŸ˜„ğŸ˜„ğŸ˜„ éªšæ“ä½œ, å½“æœ‰é‡å¤è®°å½•å°±ä¼šå¿½ç•¥é”™è¯¯è¿”å›å½±å“è¡Œæ•°0</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">IGNORE</span> <span class="keyword">INTO</span> tableName <span class="keyword">VALUES</span> ()</span><br></pre></td></tr></table></figure><p>æœ‰çš„åŒå­¦æ˜¯è¿™ä¹ˆæƒ³çš„ï¼Œåœ¨é«˜å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œå…ˆæŸ¥è¯¢å†æ’å…¥çš„è¯æ˜¯æœ‰å¹¶å‘çš„é—®é¢˜çš„ï¼Œæˆ‘ç›´æ¥åœ¨é‡å¤æ’å…¥çš„æ—¶å€™å±è”½é”™è¯¯ï¼Œä¸ç”¨æ•è·æˆ–è€…æŠ›å‡ºå¼‚å¸¸ï¼Œç›´æ¥ç”¨ insert çš„è¿”å›å½±å“è¡Œæ•°æ¥åˆ¤æ–­æ’å…¥æ˜¯å¦æˆåŠŸã€‚è¿™æ ·çš„åšæ³•çœ‹ä¸Šå»æ„Ÿè§‰æ²¡å•¥é—®é¢˜ï¼Œå…¶å®è¿˜æ˜¯æœ‰å¾ˆå¤§çš„é—®é¢˜çš„ã€‚</p><h6 id="è¯­ä¹‰ä¸Šçš„ä¸æ­£ç¡®"><a href="#è¯­ä¹‰ä¸Šçš„ä¸æ­£ç¡®" class="headerlink" title="è¯­ä¹‰ä¸Šçš„ä¸æ­£ç¡®"></a>è¯­ä¹‰ä¸Šçš„ä¸æ­£ç¡®</h6><p>ä½ åœ¨è¡¨ä¸­å®šä¹‰äº†å”¯ä¸€ç´¢å¼•ï¼Œæ’å…¥é‡å¤çš„è®°å½•ç›´æ¥å±è”½äº†é”™è¯¯ï¼Œè¿™å°±é€ æˆå¼‚å¸¸è¢«åæ‰äº†ï¼Œå¯¼è‡´åŠŸèƒ½æœ‰æ•°æ®é‡å¤çš„bugå°±æ— æ³•é€šè¿‡å¼‚å¸¸æ—¥å¿—æ¥å®šä½ã€‚</p><h6 id="ç ´åMySQLä¸»ä»çš„æ•°æ®ä¸€è‡´æ€§"><a href="#ç ´åMySQLä¸»ä»çš„æ•°æ®ä¸€è‡´æ€§" class="headerlink" title="ç ´åMySQLä¸»ä»çš„æ•°æ®ä¸€è‡´æ€§"></a>ç ´åMySQLä¸»ä»çš„æ•°æ®ä¸€è‡´æ€§</h6><p>åœ¨è¯´è¿™ä¸ªIGNOREæ˜¯å¦‚ä½•é€ æˆ MySQL ä¸»ä»æ•°æ®ä¸ä¸€è‡´çš„åŸå› ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆè¯´è¯´ MySQL ä¸­çš„ä¸€ä¸ªä½œä¸ºå¼€å‘å¾ˆå°‘å¬è¯´çš„ä¸€ä¸ªè¡¨çº§é”ï¼š<strong>AUTO-INCé”</strong>ï¼ˆå³è‡ªå¢é”ï¼‰ã€‚</p><p>åœ¨ä½¿ç”¨ MySQL çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºè¡¨çš„æŸä¸€åˆ—æ·»åŠ  AUTO_INCREMENTå±æ€§ï¼Œåœ¨æ’å…¥è®°å½•æ—¶è¯¥åˆ—å¯ä»¥ä¸æŒ‡å®šï¼ŒMySQL ä¼šè‡ªåŠ¨ä¸ºè¯¥åˆ—èµ‹äºˆä¸€ä¸ªé€’å¢çš„å€¼ã€‚MySQL è‡ªåŠ¨ç»™AUTO_INCREMENTä¿®é¥°çš„åˆ—è¿›è¡Œé€’å¢èµ‹å€¼çš„å®ç°æ–¹å¼ä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ä¸ªï¼š</p><ul><li><p>é‡‡ç”¨ AUTO_INCé”ï¼Œåœ¨æ‰§è¡Œæ’å…¥è¯­å¥æ—¶å°±åŠ ä¸€ä¸ªè¡¨çº§åˆ«çš„AUTO_INCé”ï¼Œç„¶åä¸ºæ¯æ¡å¾…æ’å…¥çš„è®°å½•åˆ†é…é€’å¢å€¼ã€‚åœ¨è¯­å¥æ‰§è¡Œç»“æŸåï¼Œå†æŠŠAUTO_INCé”é‡Šæ”¾ã€‚æ‰€ä»¥åœ¨ä¸€ä¸ªäº‹åŠ¡æŒæœ‰AUTO_INCé”çš„è¿‡ç¨‹ä¸­ï¼Œå…¶ä»–æ’å…¥è¯­å¥éƒ½è¦é˜»å¡ï¼Œä»è€Œä¿è¯ä¸€ä¸ªè¯­å¥åˆ†é…çš„é€’å¢å€¼æ˜¯è¿ç»­çš„ã€‚</p></li><li><p>é‡‡ç”¨ä¸€ä¸ªè½»é‡çº§çš„é”ï¼Œåœ¨ä¸ºINSERTè¯­å¥ç”Ÿæˆé€’å¢å€¼æ—¶è·å–è¿™ä¸ªè½»é‡çº§çš„é”ï¼Œç„¶ååœ¨ç”Ÿæˆæœ¬æ¬¡æ’å…¥è¯­å¥éœ€è¦ç”¨åˆ°çš„é€’å¢å€¼åå°±æŠŠè½»é‡çº§é”é‡Šæ”¾æ‰ï¼Œä¸éœ€è¦ç­‰åˆ°æ•´ä¸ªæ’å…¥è¯­å¥æ‰§è¡Œå®Œæ‰é‡Šæ”¾é”ã€‚</p></li></ul><p>å¦‚æœæˆ‘ä»¬çš„æ’å…¥è¯­å¥åœ¨æ‰§è¡Œå‰å°±å¯ä»¥ç¡®å®šå…·ä½“è¦æ’å…¥å¤šå°‘æ¡è®°å½•ï¼Œæ¯”å¦‚ </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">test</span>(a) <span class="keyword">VALUES</span> (<span class="string">'1'</span>),(<span class="string">'b'</span>);</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶æˆ‘ä»¬å¯ä»¥åœ¨æ‰§è¡Œå‰å°±ç¡®å®šè¦æ’å…¥2æ¡è®°å½•ï¼Œé‚£ä¹ˆä¸€èˆ¬é‡‡ç”¨è½»é‡çº§é”çš„æ–¹å¼å¯¹ AUTO_INCREMENTä¿®é¥°çš„åˆ—è¿›è¡Œèµ‹å€¼ï¼Œç”¨è¿™ç§æ–¹å¼å¯ä»¥é¿å…é”å®šè¡¨ï¼Œå¯ä»¥æé«˜æ’å…¥æ€§èƒ½ã€‚</p><blockquote><p>Mysql æä¾›äº†ä¸€ä¸ªåä¸º innodb_atuoinc_lock_mode çš„ç³»ç»Ÿå˜é‡ï¼Œæ¥æ§åˆ¶ MySQLä½¿ç”¨ä¸Šè¿°çš„ä¸¤ç§æ–¹å¼ä¸­çš„å“ªä¸€ä¸­æ¥ä¸º AUTO_INCREMENTä¿®é¥°çš„åˆ—è¿›è¡Œèµ‹å€¼ã€‚</p></blockquote><ul><li>å½“ innodb_atuoinc_lock_mode çš„å€¼ä¸º0æ—¶ï¼Œä¸€å¾‹é‡‡ç”¨AUTO_INCé”ï¼›</li><li>å½“ innodb_atuoinc_lock_mode çš„å€¼ä¸º1æ—¶ï¼Œä¸¤ç§æ–¹å¼æ··åˆä½¿ç”¨ï¼Œæ’å…¥è®°å½•ç¡®å®šæ—¶é‡‡ç”¨è½»é‡çº§é”ï¼Œä¸ç¡®å®šæ—¶ä½¿ç”¨AUTO_INCé”ã€‚</li><li>å½“ innodb_atuoinc_lock_mode çš„å€¼ä¸º2æ—¶ï¼Œä¸€å¾‹é‡‡ç”¨è½»é‡çº§é”ï¼›<blockquote><p>å½“innodb_autoinc_lock_mode=0æ—¶ï¼Œåªæœ‰æ’å…¥æˆåŠŸä¹‹åï¼ŒAUTO_INCREMENT å€¼æ‰ä¼šé€’å¢ï¼Œæ’å…¥å¤±è´¥ä¸ä¼šé€’å¢ã€‚<br>å½“innodb_autoinc_lock_mode=1æ—¶ï¼Œæ— è®ºæ’å…¥æ˜¯å¦æˆåŠŸï¼ŒAUTO_INCREMENTçš„å€¼éƒ½ä¼šé€’å¢ã€‚<br>å½“innodb_atuoinc_lock_modeä¸º2æ—¶ï¼Œå¯èƒ½ä¼šé€ æˆä¸åŒäº‹ç‰©ä¸­çš„æ’å…¥è¯­å¥ä¸ºAUTO_INCREMENTä¿®é¥°çš„åˆ—ç”Ÿçš„å€¼æ˜¯äº¤å‰çš„ï¼Œè¿™åœ¨ä¸»ä»å¤åˆ¶çš„åœºæ™¯æ˜¯ä¸å®‰å…¨çš„ã€‚<sup>[1]</sup></p></blockquote></li></ul><p>æˆ‘æŸ¥çœ‹è¿‡æˆ‘ç›®å‰è´Ÿè´£çš„ç³»ç»Ÿï¼ŒMySQL é‡‡ç”¨çš„æ˜¯ä¸»ä»æ¨¡å¼ï¼Œéš”ç¦»çº§åˆ«è®¾ç½®çš„æ˜¯è¯»å·²æäº¤(Read Committed)ï¼Œbinlogçš„æ ¼å¼è®¾ç½®ä¸º ROWï¼Œ innodb_atuoinc_lock_modeè®¾ç½®çš„æ˜¯1ï¼Œä¹Ÿå°±æ˜¯è¯´æ— è®ºæ’å…¥æˆåŠŸä¸å¦ AUTO_INCREMENT çš„å€¼éƒ½ä¼šé€’å¢ã€‚åœ¨æœ¬åœ°æ­å»ºçš„ä¸»ä»æ¨¡å¼çš„ mysqlï¼ˆå®‰è£…æœ¬äººåšå®¢ä¸­ä¹‹å‰çš„æ–‡ç« æ­å»ºçš„ MySQLä¸»ä»ï¼‰ ä¸­çš„masteråº“ æ–°å»ºä¸€ä¸ªå¦‚ä¸‹çš„è¡¨ï¼š</p><p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20201218232257.png" alt="è¡¨ç»“æ„å’Œå¯¹åº”çš„è‡ªå¢å€¼"></p><p>æŸ¥çœ‹ä¸€ä¸‹ slave3307æ•°æ®åº“ä¸­å¯¹åº”çš„è¡¨ç»“æ„å’Œè‡ªå¢å€¼ï¼šç¡®å®šå’Œ master ä¸€è‡´</p><p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20201218232602.png" alt="slave3307æ•°æ®åº“ä¸­å¯¹åº”çš„è¡¨ç»“æ„å’Œè‡ªå¢å€¼"></p><p>åœ¨ masteråº“ä¸Šæ‰§è¡Œ show master status æŸ¥çœ‹ master çš„binglog ä¿¡æ¯ï¼š</p><p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20201218232902.png" alt="master çš„binglog ä¿¡æ¯"></p><p>åœ¨ master åº“ä¸Šè¿ç»­æ‰§è¡Œä¸‹å›¾çš„ä¸‰ä¸ª SQLï¼Œè§‚å¯Ÿ  master ä¸ salve çš„æƒ…å†µã€‚</p><p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20201218233357.png" alt="ä¸‰ä¸ª SQL"></p><p>master çš„è¡¨çš„AUTO_INCREMENTå€¼å·²ç»å‘ç”Ÿäº†å˜åŒ–ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20201218233623.png" alt="è¡¨çš„è‡ªå¢å€¼å‘ç”Ÿäº†å˜åŒ–"></p><p>master çš„ binglog å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20201218233929.png" alt="master çš„ binglog"></p><p>æˆ‘ä»¬ä»ä¸Šé¢ä¸¤ä¸ªå›¾å¯ä»¥å‘ç°ï¼Œä½¿ç”¨ignoreå…³é”®å­—ï¼Œå°½ç®¡å¾…æ’å…¥çš„è®°å½•å› ä¸ºå”¯ä¸€é”®å†²çªè€Œæ²¡æœ‰æ’å…¥æˆåŠŸï¼Œä½†AUTO_INCREMENTå€¼å´é€’å¢äº†ï¼Œè€Œä¸” binlog ä¸­ä¹Ÿæ²¡æœ‰ INSERT IGNORE è¯­å¥æ—¥å¿—ï¼Œè¿™å¾ˆæ˜æ˜¾å¯¼è‡´æ•°æ®åº“ slave ä¸ä¼šæ‰§è¡Œè¯¥è¯­å¥ï¼Œå¯¼è‡´æ•°æ®åº“ slaveæ•°æ®åº“ä¸­çš„è¡¨çš„ä¸»é”®å’Œ master æ•°æ®åº“ä¸­çš„è¡¨ä¸»é”®ä¸ä¸€è‡´ï¼</p><p>æˆ‘ä»¬ç”±æ­¤å¯ä»¥å¤§èƒ†çš„çŒœæµ‹ä¸€ä¸‹ IGNORE çš„å®ç°æœºåˆ¶ï¼š</p><p>1ã€å°è¯•æŠŠæ–°è¡Œæ’å…¥åˆ°è¡¨ä¸­ ï¼›</p><p>2ã€å¦‚æœæ’å…¥æˆåŠŸåˆ™è¿”å›æ­£å¸¸çš„å½±å“è¡Œæ•°ï¼›å¦‚æœå”¯ä¸€é”®å†²çªï¼ˆé”™è¯¯ï¼‰åˆ™å¿½ç•¥è¯¥é”™è¯¯ï¼Œè¿”å›å½±å“è¡Œæ•°ä¸º0 ï¼›</p><p>åœ¨å®é™…ç”Ÿäº§ç¯å¢ƒä¸­ä¸šåŠ¡ä¸Šæ˜¯éœ€è¦å½“å‡ºç°å”¯ä¸€é”®å†²çªæ—¶å‘ç”Ÿé‡å¤è¦æŠ›å‡ºå¼‚å¸¸è€Œä¸æ˜¯åæ‰å¼‚å¸¸ï¼Œè¿™ä¸ªå‰é¢ä¹Ÿæœ‰è¯´åˆ°ã€‚æ­¤å¤–ï¼Œç”±ä¸Šé¢çš„æ‰§è¡Œè¿‡ç¨‹å¯çŸ¥ï¼Œæˆ‘ä»¬æœŸæœ›æ’å…¥çš„è®°å½•å› ä¸ºå”¯ä¸€é”®å†²çªè€Œæ²¡æœ‰æ’å…¥æˆåŠŸï¼Œä½†AUTO_INCREMENTå­—æ®µå€¼å´é€’å¢äº†ã€‚å› ä¸ºæ’å…¥è¯­å¥å¹¶æœªæ‰§è¡ŒæˆåŠŸï¼Œåœ¨binlogä¸­å¹¶ä¸ä¼šæœ‰æ‰§è¡Œè®°å½•ï¼Œè¿™æ„å‘³ç€ä»åº“çš„AUTO_INCREMENTå­—æ®µå€¼ä¸ä¼šé€’å¢ï¼Œå³ä¸»åº“å’Œä»åº“çš„AUTO_INCREMENTå€¼å‡ºç°äº†ä¸ä¸€è‡´ã€‚è¿™å¸¦æ¥çš„é—®é¢˜æ˜¯ï¼Œåç»­å¦‚æœå› ä¸ºä¸»åº“å‘ç”Ÿæ•…éšœè€Œå‘ç”Ÿä¸»ä»åˆ‡æ¢ï¼Œä»åº“çš„AUTO_INCREMENTå€¼è½åäºä¸»åº“ï¼Œå°±ä¼šå¯¼è‡´ä¸€æ®µæ—¶é—´å†…åœ¨åŸä»åº“ç°ä¸»åº“æ’å…¥çš„æ•°æ®åœ¨åŸä¸»åº“ç°ä»åº“ä¸Šå› ä¸ºAUTO_INCREMENTä¸»é”®å†²çªè€Œå¯¼è‡´æ’å…¥å¤±è´¥ï¼Œè¿™ä¸ªè‚¯å®šæ˜¯ç”¨<code>INSERT IGNORE</code>ä¹‹å‰æ²¡æœ‰æƒ³åˆ°çš„ï¼Œæ‰€ä»¥å»ºè®®åœ¨å®é™…å¼€å‘ä¸­ä¸è¦ä½¿ç”¨æ­¤ç§éªšæ“ä½œğŸ˜„ğŸ˜„ğŸ˜„</p><blockquote><p>InnoDBè¡¨insertè¯­å¥ä¸»è¦åˆ†ä¸ºä¸‰ç§ç±»å‹ï¼š</p><ul><li><p>Simple insert(ç®€å•æ’å…¥)<br>å¯ä»¥é€šè¿‡è¯­å¥é¢„å…ˆåˆ¤æ–­æ’å…¥çš„è¡Œæ•°ã€‚åŒ…æ‹¬ä¸åŒ…å«å­æŸ¥è¯¢çš„å•è¡Œã€å¤šè¡Œ <code>INSERT</code> å’Œ <code>REPLACE</code> è¯­å¥ï¼Œè¿˜æœ‰è¯­å¥<code>INSERT ... ON DUPLICATE KEY UPDATE</code>ã€‚</p></li><li><p>Bulk inserts(å¤§é‡æ’å…¥)<br>æ— æ³•é€šè¿‡è¯­å¥é¢„å…ˆåˆ¤æ–­æ’å…¥çš„è¡Œæ•°ã€‚åŒ…æ‹¬<code>INSERT ... SELECT</code>ã€<code>REPLACE ... SELECT &gt;</code>å’Œ<code>LOAD DATA</code>è¯­å¥ã€‚InnoDBæ¯å¤„ç†ä¸€è¡Œæ‰ä¼šä¸º AUTO_INCREMENT åˆ—åˆ†é…ä¸€ä¸ªå€¼ã€‚</p></li><li><p>Mixed-mode inserts(æ··åˆæ¨¡å¼æ’å…¥)<br>åœ¨ç®€å•æ’å…¥è¯­å¥å½“ä¸­ï¼Œæœ‰çš„è¡Œæœ‰ä¸ºè‡ªå¢åˆ—æŒ‡å®šå€¼ï¼Œè€Œæœ‰çš„è¡Œæ²¡æœ‰ä¸ºè‡ªå¢åˆ—æŒ‡å®šå€¼ã€‚</p></li></ul></blockquote><p><strong>ä¾‹å¦‚:æ··åˆæ¨¡å¼æ’å…¥</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># idåˆ—ä½œä¸ºè‡ªå¢åˆ—</span></span><br><span class="line"> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> t1 (<span class="keyword">id</span>,c1,c2) <span class="keyword">VALUES</span> (<span class="number">1</span>,<span class="number">1</span>,<span class="string">'a'</span>), (<span class="literal">NULL</span>,<span class="literal">NULL</span>,<span class="string">'b'</span>), (<span class="number">10</span>,<span class="number">5</span>,<span class="string">'c'</span>), (<span class="literal">NULL</span>,<span class="literal">NULL</span>,<span class="string">'d'</span>) ;</span><br></pre></td></tr></table></figure><ul><li>[1] <a href="https://ydstudios.gitee.io/post/cef7abb0.html">å‚è€ƒã€ŠMySQLæ˜¯æ€æ ·è¿è¡Œçš„ã€‹411é¡µ</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> mysql </tag>
            
            <tag> ignore </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼å­¦ä¹ ä¹‹æ¨¡æ¿å’Œç­–ç•¥æ¨¡å¼å®æˆ˜</title>
      <link href="/post/c14af19a.html"/>
      <url>/post/c14af19a.html</url>
      
        <content type="html"><![CDATA[<p>å‰é¢æ–‡ç« ç”±æŠ½å¥–æ´»åŠ¨èµ é€ä¸åŒçš„å¥–åŠ±ä»è€Œå¼•å‡ºäº†ç­–ç•¥æ¨¡å¼ï¼Œå®šä¹‰ä¸€ä¸ªç­–ç•¥æ¥å£ï¼Œä¸åŒçš„å¥–åŠ±å‘æ”¾å®ç°ä¸åŒçš„ç­–ç•¥ã€‚å³ä½¿åç»­æ–°å¢åŠ å¥–åŠ±ç§ç±»ï¼Œåªè¦é‡æ–°å®ç°ä¸€ä¸ªç­–ç•¥å³å¯ï¼Œç¬¦åˆäº†è®¾è®¡æ¨¡å¼ä¸­çš„<em>å¼€é—­åŸåˆ™-å¯¹æ‰©å±•å¼€æ”¾å¯¹ä¿®æ”¹å…³é—­</em>ã€‚æˆ‘åœ¨ä¸€æ¬¡è®¢å•æ´»åŠ¨åŠŸèƒ½å¼€å‘ä¸­ä½¿ç”¨åˆ°äº†ç­–ç•¥æ¨¡å¼ï¼Œåœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­å‘ç°ï¼Œè®¢å•ç¬¦åˆæ´»åŠ¨æ¡ä»¶çš„åˆ¤æ–­ã€å‘æ”¾å¥–åŠ±ç»™ç”¨æˆ·ï¼Œå¯ä»¥æå‡åˆ°çˆ¶ç±»å®ç°ï¼Œå…·ä½“çš„æ¡ä»¶åˆ¤æ–­é€»è¾‘å¯ä»¥å»¶è¿Ÿåˆ°å­ç±»å»å®ç°ï¼Œä»è€Œå¼•å‡ºæœ¬ç¯‡æ–‡ç« çš„ä¸»é¢˜ï¼šæ¨¡æ¿æ¨¡å¼ã€‚</p><a id="more"></a><h6 id="æ¨¡æ¿æ¨¡å¼"><a href="#æ¨¡æ¿æ¨¡å¼" class="headerlink" title="æ¨¡æ¿æ¨¡å¼"></a>æ¨¡æ¿æ¨¡å¼</h6><p>åœ¨æ¨¡æ¿æ¨¡å¼ï¼ˆTemplate Patternï¼‰ä¸­ï¼Œä¸€ä¸ªæŠ½è±¡ç±»å…¬å¼€å®šä¹‰äº†æ‰§è¡Œå®ƒçš„æ–¹æ³•çš„æ–¹å¼/æ¨¡æ¿ã€‚å®ƒçš„å­ç±»å¯ä»¥æŒ‰éœ€è¦é‡å†™æ–¹æ³•å®ç°ï¼Œä½†è°ƒç”¨å°†ä»¥æŠ½è±¡ç±»ä¸­å®šä¹‰çš„æ–¹å¼è¿›è¡Œï¼Œè¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºè¡Œä¸ºå‹æ¨¡å¼ã€‚æ¨¡æ¿æ¨¡å¼ä¸­æ¶‰åŠåˆ°åœ¨çˆ¶ç±»å®ç°ç®—æ³•éª¨æ¶ï¼Œå…·ä½“æ­¥éª¤åœ¨å­ç±»å®ç°ï¼Œæ‰€ä»¥å¿…é¡»è¦æœ‰æŠ½è±¡ç±»ï¼ˆJava8ä¸­çš„æ¥å£çš„ default æ–¹æ³•è²Œä¼¼ä¹Ÿå¯ä»¥å®ç°ï¼‰ã€‚</p><h6 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h6><ul><li>æ„å›¾ï¼šå®šä¹‰ä¸€ä¸ªæ“ä½œä¸­çš„ç®—æ³•çš„éª¨æ¶ï¼Œè€Œå°†ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­ã€‚æ¨¡æ¿æ–¹æ³•ä½¿å¾—å­ç±»å¯ä»¥ä¸æ”¹å˜ä¸€ä¸ªç®—æ³•çš„ç»“æ„å³å¯é‡å®šä¹‰è¯¥ç®—æ³•çš„æŸäº›ç‰¹å®šæ­¥éª¤ã€‚</li><li>ä¸»è¦è§£å†³ï¼šä¸€äº›æ–¹æ³•é€šç”¨ï¼Œå´åœ¨æ¯ä¸€ä¸ªå­ç±»éƒ½é‡æ–°å†™äº†è¿™ä¸€æ–¹æ³•ã€‚</li><li>ä½•æ—¶ä½¿ç”¨ï¼šæœ‰ä¸€äº›é€šç”¨çš„æ–¹æ³•ã€‚</li><li>å¦‚ä½•è§£å†³ï¼šå°†è¿™äº›é€šç”¨ç®—æ³•æŠ½è±¡å‡ºæ¥ã€‚</li><li>å…³é”®ä»£ç ï¼šåœ¨æŠ½è±¡ç±»å®ç°ï¼Œå…¶ä»–æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»å®ç°ã€‚</li></ul><h6 id="åº”ç”¨å®ä¾‹ï¼š"><a href="#åº”ç”¨å®ä¾‹ï¼š" class="headerlink" title="åº”ç”¨å®ä¾‹ï¼š"></a>åº”ç”¨å®ä¾‹ï¼š</h6><ul><li>JDKä¸­ ReentrantLockä¸­å…¬å¹³é”å’Œéå…¬å¹³é”çš„å®ç° </li><li>Spring ä¸­å¯¹ Hibernate çš„æ”¯æŒï¼Œå°†ä¸€äº›å·²ç»å®šå¥½çš„æ–¹æ³•å°è£…èµ·æ¥ï¼Œæ¯”å¦‚å¼€å¯äº‹åŠ¡ã€è·å– Sessionã€å…³é—­ Session  ç­‰ï¼Œç¨‹åºå‘˜ä¸é‡å¤å†™é‚£äº›å·²ç»è§„èŒƒå¥½çš„ä»£ç ï¼Œç›´æ¥ä¸¢ä¸€ä¸ªå®ä½“å°±å¯ä»¥ä¿å­˜ã€‚</li></ul><h6 id="ä¼˜ç‚¹ï¼š"><a href="#ä¼˜ç‚¹ï¼š" class="headerlink" title="ä¼˜ç‚¹ï¼š"></a>ä¼˜ç‚¹ï¼š</h6><ul><li>å°è£…ä¸å˜éƒ¨åˆ†ï¼Œæ‰©å±•å¯å˜éƒ¨åˆ†ã€‚ </li><li>æå–å…¬å…±ä»£ç ï¼Œä¾¿äºç»´æŠ¤ã€‚ </li><li>è¡Œä¸ºç”±çˆ¶ç±»æ§åˆ¶ï¼Œå­ç±»å®ç°ã€‚</li></ul><h6 id="ç¼ºç‚¹ï¼š"><a href="#ç¼ºç‚¹ï¼š" class="headerlink" title="ç¼ºç‚¹ï¼š"></a>ç¼ºç‚¹ï¼š</h6><ul><li>æ¯ä¸€ä¸ªä¸åŒçš„å®ç°éƒ½éœ€è¦ä¸€ä¸ªå­ç±»æ¥å®ç°ï¼Œå¯¼è‡´ç±»çš„ä¸ªæ•°å¢åŠ ï¼Œä½¿å¾—ç³»ç»Ÿæ›´åŠ åºå¤§ã€‚</li></ul><h6 id="ä½¿ç”¨åœºæ™¯ï¼š"><a href="#ä½¿ç”¨åœºæ™¯ï¼š" class="headerlink" title="ä½¿ç”¨åœºæ™¯ï¼š"></a>ä½¿ç”¨åœºæ™¯ï¼š</h6><ul><li>æœ‰å¤šä¸ªå­ç±»å…±æœ‰çš„æ–¹æ³•ï¼Œä¸”é€»è¾‘ç›¸åŒã€‚ </li><li>é‡è¦çš„ã€å¤æ‚çš„æ–¹æ³•ï¼Œå¯ä»¥è€ƒè™‘ä½œä¸ºæ¨¡æ¿æ–¹æ³•ã€‚</li></ul><h6 id="æ³¨æ„äº‹é¡¹ï¼š"><a href="#æ³¨æ„äº‹é¡¹ï¼š" class="headerlink" title="æ³¨æ„äº‹é¡¹ï¼š"></a>æ³¨æ„äº‹é¡¹ï¼š</h6><blockquote><p> ä¸ºé˜²æ­¢æ¶æ„æ“ä½œï¼Œä¸€èˆ¬æ¨¡æ¿æ–¹æ³•éƒ½åŠ ä¸Š final å…³é”®è¯ã€‚</p></blockquote><h6 id="æœ¬æ–‡ç¤ºä¾‹UMLå›¾"><a href="#æœ¬æ–‡ç¤ºä¾‹UMLå›¾" class="headerlink" title="æœ¬æ–‡ç¤ºä¾‹UMLå›¾"></a>æœ¬æ–‡ç¤ºä¾‹UMLå›¾</h6><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20201204224522.png" alt="æ¨¡æ¿ã€ç­–ç•¥æ¨¡å¼ UML å›¾" style="zoom:40%;" /><h6 id="ä»£ç ç»“æ„å›¾"><a href="#ä»£ç ç»“æ„å›¾" class="headerlink" title="ä»£ç ç»“æ„å›¾"></a>ä»£ç ç»“æ„å›¾</h6><p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20201207220104.png" alt="ä»£ç ç»“æ„å›¾"></p><h6 id="ç¤ºä¾‹ä»£ç "><a href="#ç¤ºä¾‹ä»£ç " class="headerlink" title="ç¤ºä¾‹ä»£ç "></a>ç¤ºä¾‹ä»£ç </h6><p>1ã€ç­–ç•¥æ¥å£ï¼Œå®šä¹‰äº†ä¸€ä¸ªæ´»åŠ¨ç­–ç•¥éœ€è¦å®ç°çš„æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.ydstudio.flashsale.<span class="keyword">module</span>.pattern.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ydstudio.flashsale.common.Result;</span><br><span class="line"><span class="keyword">import</span> com.ydstudio.flashsale.<span class="keyword">module</span>.pattern.dto.ActiveOrderDto;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * æ´»åŠ¨æ¥å£</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/11/26</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.7.3</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IActiveHandle</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿”å›æ´»åŠ¨çš„ç±»å‹</span></span><br><span class="line"><span class="comment">     * ActiveCategoryEnum æšä¸¾</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">String <span class="title">getCategory</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿”å›æ´»åŠ¨çš„è¯¦ç»†ç±»å‹</span></span><br><span class="line"><span class="comment">     * ActiveCategoryDetailEnum æšä¸¾</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">String <span class="title">getCategoryDetail</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¢å•æ£€æŸ¥</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> temporaryOrderDto ä¸´æ—¶è®¢å•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> Result</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">Result <span class="title">checkOrder</span><span class="params">(ActiveOrderDto temporaryOrderDto)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2ã€æ´»åŠ¨æŠ½è±¡ç±»åŒ…å«è®¢å•è§„åˆ™æ˜¯å¦ç¬¦åˆçš„åˆ¤æ–­ä»¥åŠç¬¦åˆè§„åˆ™ä¹‹åå‘é€å¥–åŠ±çš„ç®—æ³•éª¨æ¶ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ydstudio.flashsale.<span class="keyword">module</span>.pattern.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ydstudio.flashsale.common.Result;</span><br><span class="line"><span class="keyword">import</span> com.ydstudio.flashsale.<span class="keyword">module</span>.pattern.dto.ActiveOrderDto;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ´»åŠ¨æŠ½è±¡ç±»,æŠ½å–å…¬å…±æ–¹æ³•,</span></span><br><span class="line"><span class="comment"> * æŠŠè®¢å•æ˜¯å¦ç¬¦åˆå¥–åŠ±çš„åˆ¤æ–­ä¹‹åå‘é€å¥–åŠ±çš„å…¬å…±é€»è¾‘åœ¨æ­¤å¤„å®ç°,</span></span><br><span class="line"><span class="comment"> * è®¢å•å…·ä½“æ¡ä»¶çš„åˆ¤æ–­å»¶è¿Ÿç”±å­ç±»å»å®ç°.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * ç­–ç•¥å’Œæ¨¡æ¿æ¨¡å¼ç»„åˆä½¿ç”¨</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/11/26</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.7.3</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractActiveHandle</span> <span class="keyword">implements</span> <span class="title">IActiveHandle</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å…¶ä»–æŠ½è±¡æ–¹æ³•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">otherMethod</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">otherMethod1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"å…¶ä»–å…¬ç”¨æ–¹æ³•"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¤–éƒ¨çœŸæ­£è¦è°ƒç”¨çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> temporaryOrderDto è®¢å•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> String <span class="title">handle</span><span class="params">(ActiveOrderDto temporaryOrderDto)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è°ƒç”¨æ¥å£ä¸­éœ€è¦å­ç±»å®ç°çš„æ–¹æ³•</span></span><br><span class="line">        Result result = checkOrder(temporaryOrderDto);</span><br><span class="line">        <span class="keyword">if</span> (!result.isSuccess()) &#123;</span><br><span class="line">            System.out.println(<span class="string">"ä¸ç¬¦åˆå¥–åŠ±å‘æ”¾æ¡ä»¶"</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"ä¸ç¬¦åˆå¥–åŠ±å‘æ”¾æ¡ä»¶"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sendReward(temporaryOrderDto, temporaryOrderDto.getMemberId(), <span class="string">"ç§¯åˆ†"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç»Ÿä¸€çš„å‘é€å¥–åŠ±çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> temporaryOrderDto è®¢å•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> memberId ç”¨æˆ·ID</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> reward å¥–åŠ±</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">sendReward</span><span class="params">(ActiveOrderDto temporaryOrderDto, <span class="keyword">long</span> memberId, String reward)</span> </span>&#123;</span><br><span class="line">        String s = <span class="string">"ç»™ç”¨æˆ·"</span> + memberId + <span class="string">"çš„è®¢å•"</span> + temporaryOrderDto + <span class="string">"å‘é€å¥–åŠ±"</span> + reward;</span><br><span class="line">        System.out.println(s);</span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3ã€ æ´»åŠ¨ç­–ç•¥çš„å®ç°ç±»</p><ul><li><p>ä¼šç±è®¢å•ç­–ç•¥å®ç°ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ydstudio.flashsale.<span class="keyword">module</span>.pattern.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ydstudio.flashsale.common.Result;</span><br><span class="line"><span class="keyword">import</span> com.ydstudio.flashsale.<span class="keyword">module</span>.pattern.dto.ActiveOrderDto;</span><br><span class="line"><span class="keyword">import</span> com.ydstudio.flashsale.<span class="keyword">module</span>.pattern.service.AbstractActiveHandle;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * ä¼šç±è®¢å•çš„å¤„ç†</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/11/26</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.7.3</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LevelOrderActiveHandle</span> <span class="keyword">extends</span> <span class="title">AbstractActiveHandle</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">otherMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"ä¼šç±è®¢å•çš„å®ç°"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getCategory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"2"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getCategoryDetail</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"2"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">checkOrder</span><span class="params">(ActiveOrderDto temporaryOrderDto)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Random random = <span class="keyword">new</span> Random();</span><br><span class="line">        <span class="keyword">int</span> i = random.nextInt(<span class="number">4</span>);</span><br><span class="line">        <span class="keyword">if</span> (i &gt;=<span class="number">2</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> Result();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Result(<span class="string">"ä¸ç¬¦åˆä¼šç±è®¢å•æ´»åŠ¨æ¡ä»¶"</span>,<span class="string">"ä¸ç¬¦åˆä¼šç±è®¢å•æ´»åŠ¨æ¡ä»¶"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>é…’åº—è®¢å•æ´»åŠ¨ç­–ç•¥å®ç°ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ydstudio.flashsale.<span class="keyword">module</span>.pattern.service.impl;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ydstudio.flashsale.common.Result;</span><br><span class="line"><span class="keyword">import</span> com.ydstudio.flashsale.<span class="keyword">module</span>.pattern.dto.ActiveOrderDto;</span><br><span class="line"><span class="keyword">import</span> com.ydstudio.flashsale.<span class="keyword">module</span>.pattern.service.AbstractActiveHandle;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * é…’åº—è®¢å•å¤„ç†</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/11/26</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.7.3</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderActiveHandle</span> <span class="keyword">extends</span> <span class="title">AbstractActiveHandle</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">otherMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"é…’åº—è®¢å•çš„å®ç°"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getCategory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"1"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getCategoryDetail</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"1"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">checkOrder</span><span class="params">(ActiveOrderDto temporaryOrderDto)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Random random = <span class="keyword">new</span> Random();</span><br><span class="line">        <span class="keyword">int</span> i = random.nextInt(<span class="number">4</span>);</span><br><span class="line">        <span class="keyword">if</span> (i&lt;=<span class="number">2</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> Result();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Result(<span class="string">"ä¸ç¬¦åˆé…’åº—è®¢å•æ´»åŠ¨æ¡ä»¶"</span>,<span class="string">"ä¸ç¬¦åˆé…’åº—è®¢å•æ´»åŠ¨æ¡ä»¶"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p>4 ã€ç»Ÿä¸€å…¥å£æä¾›ä¸€ä¸ªContext ç»™å¤–éƒ¨ä½¿ç”¨</p><p>è°ƒç”¨æ–¹ç›´æ¥ä½¿ç”¨@Autowired æ³¨å…¥ActiveHandleContextå³å¯ä½¿ç”¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ydstudio.flashsale.<span class="keyword">module</span>.pattern.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è´Ÿè´£æ‰€æœ‰æ´»åŠ¨å¤„ç†çš„å…¥å£,æ ¹æ® getImpl(String categoryDetail)ç±»å‹æ¥åˆ¤æ–­è°ƒç”¨å…·ä½“çš„æ´»åŠ¨ç­–ç•¥</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/7/13</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.6.8</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ActiveHandleContext</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;AbstractActiveHandle&gt; activeHandleList;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¯¹å¤–çš„ç»Ÿä¸€å…¥å£</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> categoryDetail ç±»å‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> AbstractActiveHandle <span class="title">getImpl</span><span class="params">(String categoryDetail)</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">"å‚æ•° categoryDetail =[&#123;&#125;] è·å–å®ç° "</span>, categoryDetail);</span><br><span class="line">        <span class="keyword">for</span> (AbstractActiveHandle activeHandle : activeHandleList) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (activeHandle.getCategoryDetail().equals(categoryDetail)) &#123;</span><br><span class="line">                <span class="keyword">return</span> activeHandle;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException(<span class="string">"æ²¡æœ‰è¯¥å®ç°"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çˆ¶ç±»AbstractActiveHandleå®ç°æ´»åŠ¨è§„åˆ™åˆ¤æ–­ã€å‘æ”¾å¥–åŠ±çš„ç®—æ³•éª¨æ¶ï¼Œå­ç±»å®ç°å…·ä½“çš„è§„åˆ™åˆ¤æ–­ï¼Œè¿™æ ·å°±å®ç°äº†ä»£ç çš„ä¼˜åŒ–å’Œå…¬ç”¨ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
            <tag> ç­–ç•¥æ¨¡å¼ </tag>
            
            <tag> æ¨¡æ¿æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>IDEA éšè—.ideaä¸.imlæ–‡ä»¶</title>
      <link href="/post/c41bdbee.html"/>
      <url>/post/c41bdbee.html</url>
      
        <content type="html"><![CDATA[<p>åœ¨ IDEA ä¸­ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬åˆ›å»º.idea å’Œ.iml æ–‡ä»¶ï¼Œå…¶å®è¿™ä¸¤ä¸ªæ–‡ä»¶å¯¹æˆ‘ä»¬æ²¡å•¥ç”¨çš„ï¼Œä½†æ˜¯ä¹Ÿä¸èƒ½åˆ æ‰(é¡¹ç›®éœ€è¦è€Œä¸”åˆ äº†åªå¥½è¿˜ä¼šè‡ªåŠ¨åˆ›å»º)ï¼Œé‚£æˆ‘ä»¬åªå¥½æƒ³æ³•å­ç»™ä»–éšè—æ‰ã€‚</p><a id="more"></a><p>Windows ç³»ç»Ÿåˆ™ä¾æ¬¡ç‚¹å‡» File â€”- Setting â€”- Editor â€”- File Types</p><p>Macç³»ç»Ÿä¾æ¬¡ç‚¹å‡»Preferencesâ€”- Editor â€”- File Types</p><p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20201204210639.png" alt="Macç³»ç»Ÿè®¾ç½®"></p><p>åœ¨å›¾ä¸­çº¢æ¡†å¤„æ·»åŠ  .idea å’Œ *imlï¼Œç„¶åä¿å­˜å³å¯ï¼å¿½ç•¥å…¶ä»–ç»“å°¾çš„æ–‡ä»¶ä¹Ÿå¯ä»¥è¿™ä¹ˆæ“ä½œçš„ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> idea </tag>
            
            <tag> å¼€å‘å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼å­¦ä¹ ä¹‹ç­–ç•¥æ¨¡å¼</title>
      <link href="/post/170b3d6a.html"/>
      <url>/post/170b3d6a.html</url>
      
        <content type="html"><![CDATA[<p>ç­–ç•¥æ¨¡å¼ï¼ˆStrategy Patternï¼‰æˆ‘è§‰å¾—åœ¨23ä¸­å¸¸è§çš„è®¾è®¡æ¨¡å¼é‡Œé¢æ˜¯ä¸€ç§æ¯”è¾ƒç®€å•çš„ï¼Œä½¿ç”¨åœºæ™¯ä¹Ÿå¾ˆå¤šã€‚åœ¨ç­–ç•¥æ¨¡å¼ä¸­ï¼Œä¸€ä¸ªç±»çš„è¡Œä¸ºæˆ–å…¶ç®—æ³•å¯ä»¥åœ¨è¿è¡Œæ—¶æ›´æ”¹ã€‚è¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºè¡Œä¸ºå‹æ¨¡å¼ã€‚åœ¨ç­–ç•¥æ¨¡å¼ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºè¡¨ç¤ºå„ç§ç­–ç•¥çš„å¯¹è±¡å’Œä¸€ä¸ªè¡Œä¸ºéšç€ç­–ç•¥å¯¹è±¡æ”¹å˜è€Œæ”¹å˜çš„ context å¯¹è±¡,ç­–ç•¥å¯¹è±¡æ”¹å˜ context å¯¹è±¡çš„æ‰§è¡Œç®—æ³•ã€‚</p><a id="more"></a><h4 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h4><h6 id="æ„å›¾"><a href="#æ„å›¾" class="headerlink" title="æ„å›¾:"></a>æ„å›¾:</h6><p>å®šä¹‰ä¸€ç³»åˆ—çš„ç®—æ³•,æŠŠå®ƒä»¬ä¸€ä¸ªä¸ªå°è£…èµ·æ¥, å¹¶ä¸”ä½¿å®ƒä»¬å¯ç›¸äº’æ›¿æ¢ã€‚</p><h6 id="ä¸»è¦è§£å†³ï¼š"><a href="#ä¸»è¦è§£å†³ï¼š" class="headerlink" title="ä¸»è¦è§£å†³ï¼š"></a>ä¸»è¦è§£å†³ï¼š</h6><p>åœ¨æœ‰å¤šç§ç®—æ³•ç›¸ä¼¼çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨ ifâ€¦else æ‰€å¸¦æ¥çš„å¤æ‚å’Œéš¾ä»¥ç»´æŠ¤ã€‚</p><h6 id="ä½•æ—¶ä½¿ç”¨ï¼š"><a href="#ä½•æ—¶ä½¿ç”¨ï¼š" class="headerlink" title="ä½•æ—¶ä½¿ç”¨ï¼š"></a>ä½•æ—¶ä½¿ç”¨ï¼š</h6><p>ä¸€ä¸ªç³»ç»Ÿæœ‰è®¸å¤šè®¸å¤šç±»ï¼Œè€ŒåŒºåˆ†å®ƒä»¬çš„åªæ˜¯ä»–ä»¬ç›´æ¥çš„è¡Œä¸ºã€‚</p><h6 id="å¦‚ä½•è§£å†³ï¼š"><a href="#å¦‚ä½•è§£å†³ï¼š" class="headerlink" title="å¦‚ä½•è§£å†³ï¼š"></a>å¦‚ä½•è§£å†³ï¼š</h6><p>å°†è¿™äº›ç®—æ³•å°è£…æˆä¸€ä¸ªä¸€ä¸ªçš„ç±»ï¼Œä»»æ„åœ°æ›¿æ¢ã€‚</p><h6 id="å…³é”®ä»£ç ï¼š"><a href="#å…³é”®ä»£ç ï¼š" class="headerlink" title="å…³é”®ä»£ç ï¼š"></a>å…³é”®ä»£ç ï¼š</h6><p>éœ€è¦å®ç°åŒä¸€ä¸ªæ¥å£ã€‚</p><h6 id="åº”ç”¨å®ä¾‹ï¼š"><a href="#åº”ç”¨å®ä¾‹ï¼š" class="headerlink" title="åº”ç”¨å®ä¾‹ï¼š"></a>åº”ç”¨å®ä¾‹ï¼š</h6><ul><li>è¯¸è‘›äº®çš„é”¦å›Šå¦™è®¡ï¼Œæ¯ä¸€ä¸ªé”¦å›Šå°±æ˜¯ä¸€ä¸ªç­–ç•¥ã€‚ </li><li>æ—…è¡Œçš„å‡ºæ¸¸æ–¹å¼ï¼Œé€‰æ‹©éª‘è‡ªè¡Œè½¦ã€åæ±½è½¦ï¼Œæ¯ä¸€ç§æ—…è¡Œæ–¹å¼éƒ½æ˜¯ä¸€ä¸ªç­–ç•¥ã€‚ </li><li>JAVA AWT ä¸­çš„ LayoutManagerã€‚</li></ul><h6 id="ä¼˜ç‚¹ï¼š"><a href="#ä¼˜ç‚¹ï¼š" class="headerlink" title="ä¼˜ç‚¹ï¼š"></a>ä¼˜ç‚¹ï¼š</h6><ul><li>ç®—æ³•å¯ä»¥è‡ªç”±åˆ‡æ¢ã€‚ </li><li>é¿å…ä½¿ç”¨å¤šé‡æ¡ä»¶åˆ¤æ–­ã€‚ </li><li>æ‰©å±•æ€§è‰¯å¥½ã€‚</li></ul><h6 id="ç¼ºç‚¹ï¼š"><a href="#ç¼ºç‚¹ï¼š" class="headerlink" title="ç¼ºç‚¹ï¼š"></a>ç¼ºç‚¹ï¼š</h6><ul><li>ç­–ç•¥ç±»ä¼šå¢å¤šã€‚ </li><li>æ‰€æœ‰ç­–ç•¥ç±»éƒ½éœ€è¦å¯¹å¤–æš´éœ²(è¿™ä¸ªä¹Ÿä¸ä¸€å®š)ã€‚</li></ul><h6 id="ä½¿ç”¨åœºæ™¯ï¼š"><a href="#ä½¿ç”¨åœºæ™¯ï¼š" class="headerlink" title="ä½¿ç”¨åœºæ™¯ï¼š"></a>ä½¿ç”¨åœºæ™¯ï¼š</h6><ul><li>å¦‚æœåœ¨ä¸€ä¸ªç³»ç»Ÿé‡Œé¢æœ‰è®¸å¤šç±»ï¼Œå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«ä»…åœ¨äºå®ƒä»¬çš„è¡Œä¸ºï¼Œé‚£ä¹ˆä½¿ç”¨ç­–ç•¥æ¨¡å¼å¯ä»¥åŠ¨æ€åœ°è®©ä¸€ä¸ªå¯¹è±¡åœ¨è®¸å¤šè¡Œä¸ºä¸­é€‰æ‹©ä¸€ç§è¡Œä¸ºã€‚ </li><li>ä¸€ä¸ªç³»ç»Ÿéœ€è¦åŠ¨æ€åœ°åœ¨å‡ ç§ç®—æ³•ä¸­é€‰æ‹©ä¸€ç§ã€‚ </li><li>å¦‚æœä¸€ä¸ªå¯¹è±¡æœ‰å¾ˆå¤šçš„è¡Œä¸ºï¼Œå¦‚æœä¸ç”¨æ°å½“çš„æ¨¡å¼ï¼Œè¿™äº›è¡Œä¸ºå°±åªå¥½ä½¿ç”¨å¤šé‡çš„æ¡ä»¶é€‰æ‹©è¯­å¥æ¥å®ç°ã€‚</li></ul><blockquote><p>æ³¨æ„ï¼š å¦‚æœä¸€ä¸ªç³»ç»Ÿçš„ç­–ç•¥å¤šäºå››ä¸ªï¼Œå°±éœ€è¦è€ƒè™‘ä½¿ç”¨æ··åˆæ¨¡å¼ï¼Œè§£å†³ç­–ç•¥ç±»è†¨èƒ€çš„é—®é¢˜ã€‚</p></blockquote><h4 id="ä¸šåŠ¡åœºæ™¯"><a href="#ä¸šåŠ¡åœºæ™¯" class="headerlink" title="ä¸šåŠ¡åœºæ™¯"></a>ä¸šåŠ¡åœºæ™¯</h4><p>ä»¥æŠ½å¥–æ´»åŠ¨å‘å¥–ä¸ºä¾‹ï¼Œå¥–å“å¤šç§å¤šæ ·ï¼Œå¯èƒ½æ˜¯ç°é‡‘å¥–ï¼Œè¯è´¹å¥–å“ï¼Œå®ç‰©å¥–ç­‰ç­‰ï¼Œæ¯ç§å¥–å“çš„å‘æ”¾æ–¹å¼éƒ½ä¸ä¸€æ ·ï¼Œæ¯”å¦‚ç°é‡‘æ˜¯ç›´æ¥è½¬è´¦ï¼Œè¯è´¹å¥–å“æ˜¯è°ƒç”¨è¿è¥å•†æä¾›æ¥å£å‘æ”¾ï¼Œå®ç‰©å¥–éœ€è¦äººå·¥å¿«é€’å¯„é€ã€‚åœ¨æœªé‡‡ç”¨ç­–ç•¥æ¨¡å¼ä¹‹å‰ï¼Œå°‘ä¸äº†ä½¿ç”¨ ifâ€¦elseâ€¦æ¥åˆ¤æ–­å‘æ”¾ï¼Œå½“å¢åŠ ä¸€ç§å¥–å“ç±»å‹æ—¶ï¼Œå°±éœ€è¦å¢åŠ  if åˆ¤æ–­ã€‚è€Œé‡‡å–ç­–ç•¥æ¨¡å¼ä¹‹åï¼Œåªéœ€å®ç°ä¸€ä¸ªç­–ç•¥ç±»å³å¯ï¼Œå¯¹åŸæ¥çš„é€»è¾‘æ— éœ€åšä»»ä½•æ”¹åŠ¨ï¼Œä¹Ÿä¸ä¼šå½±å“å…¶ä»–ç­–ç•¥çš„æ­£å¸¸é€»è¾‘ã€‚</p><h4 id="UMLå›¾"><a href="#UMLå›¾" class="headerlink" title="UMLå›¾"></a>UMLå›¾</h4><p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20201025114859.png" alt="ç­–ç•¥æ¨¡å¼UMLå›¾"></p><h4 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h4><p>å®¢æˆ·ç«¯éœ€è¦åˆ¤æ–­è¦ä½¿ç”¨å“ªä¸€ä¸ªå…·ä½“çš„ç­–ç•¥ç±»ï¼Œè‹¥è¿˜æ˜¯æŒ‰ç…§ä¼ ç»Ÿçš„æ–¹æ³• ifâ€¦elseâ€¦æ¥åˆ¤æ–­ç­–ç•¥æ¨¡å¼å°±æ²¡æœ‰æ„ä¹‰äº†ï¼Œå› æ­¤ç­–ç•¥æ¨¡å¼ä¸€èˆ¬éƒ½æ˜¯ç»“åˆå…¶ä»–æ¨¡å¼å…±åŒä½¿ç”¨ã€‚æœ¬æ–‡ä¸­ç­–ç•¥ç±»ä½¿ç”¨ Byte æ¥æ ‡è¯†ï¼Œä¹Ÿå¯ä»¥åœ¨ç­–ç•¥ç±»ä¸­å¢åŠ æŠ½è±¡æ–¹æ³•ï¼Œè¿”å›å€¼ä¸ºæšä¸¾ç±»å‹ã€‚</p><ol><li><p>å®šä¹‰ç­–ç•¥æ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.ydstudio.flashsale.service;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç­–ç•¥æ¥å£</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> åˆ˜æ´‹ Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/10/24</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">RewardSendStrategy</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‘æ”¾å¥–åŠ±çš„ç±»å‹,é€šè¿‡è¿™ä¸ªæ–¹æ³•æ¥æ ‡ç¤ºä¸åŒçš„ç­–ç•¥</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">Byte <span class="title">type</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–¹æ³•å¥–åŠ±çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">sendReward</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>å‘é€ç°é‡‘å¥–åŠ±ç­–ç•¥å®ç°ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.ydstudio.flashsale.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ydstudio.flashsale.common.enums.RewardTypeEnum;</span><br><span class="line"><span class="keyword">import</span> com.ydstudio.flashsale.service.RewardSendStrategy;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å‘é€ç°é‡‘å¥–å“ç­–ç•¥</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> åˆ˜æ´‹ Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/10/24</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CashRewardSendStrategy</span> <span class="keyword">implements</span> <span class="title">RewardSendStrategy</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Byte <span class="title">type</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> RewardTypeEnum.CASH.getCode();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendReward</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"å‘æ”¾ç°é‡‘å¥–å“"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>å‘æ”¾ç§¯åˆ†å¥–å“ç­–ç•¥å®ç°ç±»</p>   <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.ydstudio.flashsale.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ydstudio.flashsale.common.enums.RewardTypeEnum;</span><br><span class="line"><span class="keyword">import</span> com.ydstudio.flashsale.service.RewardSendStrategy;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å‘æ”¾ç§¯åˆ†å¥–å“ç­–ç•¥</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> åˆ˜æ´‹ Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/10/24</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PointRewardSendStrategy</span> <span class="keyword">implements</span> <span class="title">RewardSendStrategy</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Byte <span class="title">type</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> RewardTypeEnum.POINT.getCode();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendReward</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"å‘æ”¾ç§¯åˆ†å¥–å“"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>å‘æ”¾ä¼˜æƒ åˆ¸å¥–å“ç­–ç•¥å®ç°ç±»</p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">    </span><br><span class="line"><span class="keyword">package</span> com.ydstudio.flashsale.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ydstudio.flashsale.common.enums.RewardTypeEnum;</span><br><span class="line"><span class="keyword">import</span> com.ydstudio.flashsale.service.RewardSendStrategy;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å‘é€ä¼˜æƒ åˆ¸ç­–ç•¥</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> åˆ˜æ´‹ Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/10/24</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CouponRewardSendStrategy</span> <span class="keyword">implements</span> <span class="title">RewardSendStrategy</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Byte <span class="title">type</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> RewardTypeEnum.COUPON.getCode();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendReward</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"å‘æ”¾ä¼˜æƒ åˆ¸å¥–å“"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>å‘æ”¾è°¢è°¢å‚ä¸ç­–ç•¥å®ç°ç±»</p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.ydstudio.flashsale.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ydstudio.flashsale.common.enums.RewardTypeEnum;</span><br><span class="line"><span class="keyword">import</span> com.ydstudio.flashsale.service.RewardSendStrategy;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è°¢è°¢å‚ä¸å¥–å“å‘æ”¾ç­–ç•¥</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> åˆ˜æ´‹ Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/10/24</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThankYouRewardSendStrategy</span> <span class="keyword">implements</span> <span class="title">RewardSendStrategy</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Byte <span class="title">type</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> RewardTypeEnum.THANK_YOU.getCode();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendReward</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"è°¢è°¢å‚ä¸"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><ol start="6"><li><p>å®ç°å¯¹æŠ½è±¡ç­–ç•¥å°è£…çš„ä¸Šä¸‹æ–‡å¯¹è±¡</p><p>é€šå¸¸ JavaWeb å¼€å‘ä½¿ç”¨ Spring æ¡†æ¶çš„æ¯”è¾ƒå¤šï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ç”¨Spring æä¾›çš„@Autowiredæ³¨è§£çš„ä¸€ä¸ªå°æŠ€å·§ï¼Œæ¥æ›´æ–¹ä¾¿çš„å®ç°å°è£…ã€‚ä¸ç”¨å†ä½¿ç”¨ <code>java RewardSendStrategyContext</code> å»å®ç° <code>java org.springframework.context.ApplicationContextAware</code> æˆ–è€…æ¯ä¸ªç­–ç•¥ç±»å†å®ç° <code>java org.springframework.beans.factory</code>æ¥å£ç„¶åå°†ç­–ç•¥ç±»æ·»åŠ åˆ° RewardSendStrategyContext ä¸­çš„ </p><p>å±æ€§ä¸­ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.ydstudio.flashsale.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.BeansException;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContextAware;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ConcurrentHashMap;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> åˆ˜æ´‹ Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/10/25</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RewardSendStrategyContext</span> <span class="keyword">implements</span> <span class="title">ApplicationContextAware</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> Map&lt;Byte, RewardSendStrategy&gt; strategyMap = <span class="keyword">new</span> ConcurrentHashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setApplicationContext</span><span class="params">(ApplicationContext applicationContext)</span> <span class="keyword">throws</span> BeansException </span>&#123;</span><br><span class="line"></span><br><span class="line">        Map&lt;String, RewardSendStrategy&gt; beans = applicationContext.getBeansOfType(RewardSendStrategy<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        beans.values().forEach(bean -&gt; strategyMap.put(bean.type(), bean));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šè¿‡ type è·å–å¥–åŠ±å®ç°</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> type</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> RewardSendStrategy <span class="title">getRewardSendStrategy</span><span class="params">(Byte type)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        RewardSendStrategy sendStrategy = strategyMap.get(type);</span><br><span class="line">        <span class="keyword">if</span> (sendStrategy == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException(<span class="string">"æ²¡æœ‰æ­¤ç§å¥–åŠ±çš„å‘æ”¾å®ç°"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> sendStrategy;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>@Autowried</strong> å°æŠ€å·§ï¼Œçœ‹ä¸‹è¿™ä¸ªæ³¨è§£çš„ä¸Šçš„æ³¨é‡Šï¼Œæˆ‘ä¸‹é¢æ¥é€šè¿‡ä¸¾ä¾‹å­è¯´æ˜ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;In case of a &#123;@link java.util.Collection&#125; or &#123;@link java.util.Map&#125;</span></span><br><span class="line"><span class="comment"> * dependency type, the container will autowire all beans matching the</span></span><br><span class="line"><span class="comment"> * declared value type. In case of a Map, the keys must be declared as</span></span><br><span class="line"><span class="comment"> * type String and will be resolved to the corresponding bean names.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Target</span>(&#123;ElementType.CONSTRUCTOR, ElementType.FIELD, ElementType.METHOD, ElementType.ANNOTATION_TYPE&#125;)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Autowired &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Declares whether the annotated dependency is required.</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;Defaults to &#123;<span class="doctag">@code</span> true&#125;.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">required</span><span class="params">()</span> <span class="keyword">default</span> <span class="keyword">true</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹è¯´æ˜ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># è¿™æ ·å®šä¹‰å±æ€§çš„æ—¶å€™ï¼ŒSpring ä¼šè‡ªåŠ¨çš„å°†è¿™ä¸ªæ¥å£çš„å®ç°ç±»beanå…¨éƒ½è‡ªåŠ¨æ·»åŠ åˆ°è¿™ä¸ª rewardSendStrategyList ä¸­</span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> List&lt;RewardSendStrategy&gt; rewardSendStrategyList;</span><br><span class="line"></span><br><span class="line"># è¿™æ ·å®šä¹‰å±æ€§çš„æ—¶å€™ï¼ŒSpring ä¼šè‡ªåŠ¨çš„ä»¥å®ç°ç±» beanName ä½œä¸º keyï¼Œbean ä½œä¸º value æ·»åŠ åˆ°è¿™ä¸ª Map ä¸­</span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span>  Map&lt;String, RewardSendStrategy&gt; strategyMap;</span><br></pre></td></tr></table></figure><p><strong>æ‰€ä»¥ç­–ç•¥ç±»ä¸Šä¸‹æ–‡å¯¹è±¡åº”è¯¥è¿™æ ·å»ç¼–ç å®ç°ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ydstudio.flashsale.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.CollectionUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ConcurrentMap;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.Collectors;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å‘é€å¥–åŠ±çš„ Context ç±»</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> åˆ˜æ´‹ Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/10/25</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RewardSendStrategyContext</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;RewardSendStrategy&gt; rewardSendStrategyList;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šè¿‡ type è·å–å¥–åŠ±å®ç°</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> type</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RewardSendStrategy <span class="title">getRewardSendStrategy</span><span class="params">(Byte type)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (CollectionUtils.isEmpty(rewardSendStrategyList)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"RewardSendStrategy æ³¨å…¥å¤±è´¥"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        ConcurrentMap&lt;Byte, RewardSendStrategy&gt; strategyMap = rewardSendStrategyList.stream()</span><br><span class="line">                .collect(Collectors.toConcurrentMap(RewardSendStrategy::type, RewardSendStrategy -&gt; RewardSendStrategy));</span><br><span class="line"></span><br><span class="line">        RewardSendStrategy sendStrategy = strategyMap.get(type);</span><br><span class="line">        <span class="keyword">if</span> (sendStrategy == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException(<span class="string">"æ²¡æœ‰æ­¤ç§å¥–åŠ±çš„å‘æ”¾å®ç°"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> sendStrategy;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·å†™æ˜¯ä¸æ˜¯å¾ˆä¼˜é›…ï¼ï¼ï¼é‚£è°ƒç”¨æ–¹å¦‚ä½•ä½¿ç”¨å‘¢ï¼Ÿå¾ˆç®€å•çš„ç›´æ¥æ³¨å…¥å°±èƒ½ä½¿ç”¨äº†ï¼Œå“ˆå“ˆ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> RewardSendStrategyContext strategyContext;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">    Byte aByte = <span class="keyword">new</span> Byte(<span class="string">"1"</span>);</span><br><span class="line"></span><br><span class="line">    RewardSendStrategy rewardSendStrategy = strategyContext.getRewardSendStrategy(aByte);</span><br><span class="line">    log.info(<span class="string">"å¥–åŠ±å‘æ”¾å®ç° &#123;&#125;"</span>,sendStrategy);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>åˆ°æ­¤ç­–ç•¥æ¨¡å¼çš„æ¦‚å¿µã€ç»“æ„å’Œä»£ç å®ç°éƒ½è¯´å®Œäº†ï¼Œæ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼å¤§å®¶åœ¨æ’¸ç çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœé‡åˆ°ç±»ä¼¼çš„åœºæ™¯å¯ä»¥ä½¿ç”¨ç­–ç•¥æ¨¡å¼çš„æ—¶å€™ï¼Œä¸€å®šè¦å°è¯•å»ä½¿ç”¨ç­–ç•¥æ¨¡å¼å»ä¼˜åŒ–è‡ªå·±ä»£ç ï¼Œè¿™æ ·æ—¢é”»ç‚¼äº†è‡ªå·±ï¼Œä¹Ÿå†™å‡ºäº†ç‰›é€¼çš„ä»£ç ä½•ä¹è€Œä¸ä¸ºå‘¢ï¼Ÿéš¾é“ä½ ä¸€ç›´æƒ³å½“ CURD boy ä¹ˆï¼Ÿï¼Ÿï¼Ÿï¼Ÿ</p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
            <tag> ç­–ç•¥æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Windowsä¸‹æ­å»ºRocketMQåŒä¸»åŒä»é›†ç¾¤</title>
      <link href="/post/459042a5.html"/>
      <url>/post/459042a5.html</url>
      
        <content type="html"><![CDATA[<p>RocketMQæ˜¯é˜¿é‡Œå·´å·´2016å¹´MQä¸­é—´ä»¶ï¼Œä½¿ç”¨Javaè¯­è¨€å¼€å‘ï¼Œåœ¨é˜¿é‡Œå†…éƒ¨ï¼ŒRocketMQæ‰¿æ¥äº†ä¾‹å¦‚â€œåŒ11â€ç­‰é«˜å¹¶å‘åœºæ™¯çš„æ¶ˆæ¯æµè½¬ï¼Œèƒ½å¤Ÿå¤„ç†ä¸‡äº¿çº§åˆ«çš„æ¶ˆæ¯ã€‚æˆ‘ä»¬ä»Šå¤©å°±åœ¨ windowsä¸‹æ­å»ºRocketMQå¤šMasterå¤šSlaveæ¨¡å¼ï¼ˆåŒæ­¥ï¼‰çš„é›†ç¾¤ã€‚</p><a id="more"></a><h2 id="1-å‡†å¤‡å·¥ä½œ"><a href="#1-å‡†å¤‡å·¥ä½œ" class="headerlink" title="1 å‡†å¤‡å·¥ä½œ"></a>1 å‡†å¤‡å·¥ä½œ</h2><h3 id="1-1-ä¸‹è½½RocketMQ"><a href="#1-1-ä¸‹è½½RocketMQ" class="headerlink" title="1.1 ä¸‹è½½RocketMQ"></a>1.1 ä¸‹è½½RocketMQ</h3><p>RocketMQç‰ˆæœ¬ï¼š4.7.1</p><p><a href="https://www.apache.org/dyn/closer.cgi?path=rocketmq/4.7.1/rocketmq-all-4.7.1-source-release.zip" target="_blank" rel="noopener">ä¸‹è½½åœ°å€</a></p><h3 id="1-2-ç¯å¢ƒè¦æ±‚"><a href="#1-2-ç¯å¢ƒè¦æ±‚" class="headerlink" title="1.2 ç¯å¢ƒè¦æ±‚"></a>1.2 ç¯å¢ƒè¦æ±‚</h3><ul><li><p>Linux64ä½ç³»ç»Ÿ</p></li><li><p>JDK1.8(64ä½)</p></li><li><p>æºç å®‰è£…éœ€è¦å®‰è£…Maven 3.2.x</p></li></ul><h2 id="2-å®‰è£…RocketMQ"><a href="#2-å®‰è£…RocketMQ" class="headerlink" title="2 å®‰è£…RocketMQ"></a>2 å®‰è£…RocketMQ</h2><h3 id="2-1-å®‰è£…æ­¥éª¤"><a href="#2-1-å®‰è£…æ­¥éª¤" class="headerlink" title="2.1 å®‰è£…æ­¥éª¤"></a>2.1 å®‰è£…æ­¥éª¤</h3><p>æœ¬æ•™ç¨‹ä»¥äºŒè¿›åˆ¶åŒ…æ–¹å¼å®‰è£…</p><ol><li>è§£å‹å®‰è£…åŒ…</li><li>è¿›å…¥å®‰è£…ç›®å½•</li></ol><h3 id="2-2-ç›®å½•ä»‹ç»"><a href="#2-2-ç›®å½•ä»‹ç»" class="headerlink" title="2.2 ç›®å½•ä»‹ç»"></a>2.2 ç›®å½•ä»‹ç»</h3><ul><li>binï¼šå¯åŠ¨è„šæœ¬ï¼ŒåŒ…æ‹¬shellè„šæœ¬å’ŒCMDè„šæœ¬</li><li>confï¼šå®ä¾‹é…ç½®æ–‡ä»¶ ï¼ŒåŒ…æ‹¬brokeré…ç½®æ–‡ä»¶ã€logbacké…ç½®æ–‡ä»¶ç­‰</li><li>libï¼šä¾èµ–jaråŒ…ï¼ŒåŒ…æ‹¬Nettyã€commons-langã€FastJSONç­‰</li></ul><h2 id="3-é…ç½®mqnamesrvåŒä¸»"><a href="#3-é…ç½®mqnamesrvåŒä¸»" class="headerlink" title="3 é…ç½®mqnamesrvåŒä¸»"></a>3 é…ç½®mqnamesrvåŒä¸»</h2><p>åœ¨RocketMQ çš„é…ç½®æ–‡ä»¶å¤¹çš„ç›®å½•ä¸‹ï¼Œåˆ†åˆ«åˆ›å»ºæ–‡ä»¶namesrv-a.propertiesã€namesrv-b.properties</p><p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20201010215427.png" alt="namesrvé…ç½®æ–‡ä»¶"></p><p>å†…å®¹åˆ†åˆ«æ˜¯</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">listenPort=9876</span><br><span class="line"></span><br><span class="line">listenPort=9870</span><br></pre></td></tr></table></figure><p>å³è¡¨ç¤ºnamesrv-aç›‘å¬ç«¯å£æ˜¯9876ï¼Œnamesrv-bç›‘å¬ç«¯å£æ˜¯9870.</p><h3 id="3-1-å¯åŠ¨åŒä¸»namesrv"><a href="#3-1-å¯åŠ¨åŒä¸»namesrv" class="headerlink" title="3.1 å¯åŠ¨åŒä¸»namesrv"></a>3.1 å¯åŠ¨åŒä¸»namesrv</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">start mqnamesrv.cmd -c D:/ProgramFiles/rocketmq-all-4.7.1/conf/namesrv/namesrv-a.properties</span><br><span class="line"></span><br><span class="line">start mqnamesrv.cmd -c D:/ProgramFiles/rocketmq-all-4.7.1/conf/namesrv/namesrv-b.properties</span><br></pre></td></tr></table></figure><p>å¯åŠ¨æˆåŠŸä¼šåœ¨ç»ˆç«¯æ‰“å°</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The Name Server boot success serializeType=JSON</span><br></pre></td></tr></table></figure><h2 id="4-é…ç½®brokeråŒä¸»åŒä»"><a href="#4-é…ç½®brokeråŒä¸»åŒä»" class="headerlink" title="4 é…ç½®brokeråŒä¸»åŒä»"></a>4 é…ç½®brokeråŒä¸»åŒä»</h2><p>æ­¤æ¬¡æˆ‘ä»¬é‡‡ç”¨å¤šMasterå¤šSlaveæ¨¡å¼ï¼ˆåŒæ­¥ï¼‰çš„æ–¹å¼ï¼Œæ¯ä¸ªMasteré…ç½®ä¸€ä¸ªSlaveï¼Œæœ‰å¤šå¯¹Master-Slaveï¼ŒHAé‡‡ç”¨åŒæ­¥åŒå†™æ–¹å¼ï¼Œå³åªæœ‰ä¸»å¤‡éƒ½å†™æˆåŠŸï¼Œæ‰å‘åº”ç”¨è¿”å›æˆåŠŸï¼Œè¿™ç§æ¨¡å¼çš„ä¼˜ç¼ºç‚¹å¦‚ä¸‹ï¼š</p><ul><li>ä¼˜ç‚¹ï¼šæ•°æ®ä¸æœåŠ¡éƒ½æ— å•ç‚¹æ•…éšœï¼ŒMasterå®•æœºæƒ…å†µä¸‹ï¼Œæ¶ˆæ¯æ— å»¶è¿Ÿï¼ŒæœåŠ¡å¯ç”¨æ€§ä¸æ•°æ®å¯ç”¨æ€§éƒ½éå¸¸é«˜ï¼›</li><li>ç¼ºç‚¹ï¼šæ€§èƒ½æ¯”å¼‚æ­¥å¤åˆ¶æ¨¡å¼ç•¥ä½ï¼ˆå¤§çº¦ä½10%å·¦å³ï¼‰ï¼Œå‘é€å•ä¸ªæ¶ˆæ¯çš„RTä¼šç•¥é«˜ï¼Œä¸”ç›®å‰ç‰ˆæœ¬åœ¨ä¸»èŠ‚ç‚¹å®•æœºåï¼Œå¤‡æœºä¸èƒ½è‡ªåŠ¨åˆ‡æ¢ä¸ºä¸»æœºã€‚</li></ul><p>namesrvAddr æˆ‘ä»¬å°±ä¸ç›´æ¥å†™åˆ°é…ç½®æ–‡ä»¶é‡Œï¼Œæˆ‘ä»¬é‡‡ç”¨åœ¨å‘½ä»¤è¡Œçš„å½¢å¼æ¥æŒ‡å®š namesrvAddr</p><p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20201010215545.png" alt="é˜Ÿåˆ—çš„æ–‡ä»¶ä¿å­˜è·¯å¾„"></p><h3 id="4-1-broker-a-çš„é…ç½®"><a href="#4-1-broker-a-çš„é…ç½®" class="headerlink" title="4.1 broker-a çš„é…ç½®"></a>4.1 broker-a çš„é…ç½®</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> broker<span class="_">-a</span> çš„é…ç½®</span></span><br><span class="line">brokerClusterName=DefaultCluster</span><br><span class="line"><span class="meta">#</span><span class="bash"> brokeråå­—ï¼Œæ³¨æ„æ­¤å¤„ä¸åŒçš„é…ç½®æ–‡ä»¶å¡«å†™çš„ä¸ä¸€æ ·</span></span><br><span class="line">brokerName=broker-a</span><br><span class="line">brokerId=0</span><br><span class="line"><span class="meta">#</span><span class="bash">nameServeråœ°å€ï¼Œåˆ†å·åˆ†å‰²</span></span><br><span class="line"><span class="meta">#</span><span class="bash">namesrvAddr=127.0.0.1:9876;127.0.0.1:9870</span></span><br><span class="line"><span class="meta">#</span><span class="bash">åœ¨å‘é€æ¶ˆæ¯æ—¶ï¼Œè‡ªåŠ¨åˆ›å»ºæœåŠ¡å™¨ä¸å­˜åœ¨çš„topicï¼Œé»˜è®¤åˆ›å»ºçš„é˜Ÿåˆ—æ•°</span></span><br><span class="line">defaultTopicQueueNums=4</span><br><span class="line"><span class="meta">#</span><span class="bash">æ˜¯å¦å…è®¸ Broker è‡ªåŠ¨åˆ›å»ºTopicï¼Œå»ºè®®çº¿ä¸‹å¼€å¯ï¼Œçº¿ä¸Šå…³é—­</span></span><br><span class="line">autoCreateTopicEnable=true</span><br><span class="line"><span class="meta">#</span><span class="bash">æ˜¯å¦å…è®¸ Broker è‡ªåŠ¨åˆ›å»ºè®¢é˜…ç»„ï¼Œå»ºè®®çº¿ä¸‹å¼€å¯ï¼Œçº¿ä¸Šå…³é—­</span></span><br><span class="line">autoCreateSubscriptionGroup=true</span><br><span class="line"><span class="meta">#</span><span class="bash">Broker å¯¹å¤–æœåŠ¡çš„ç›‘å¬ç«¯å£,</span></span><br><span class="line">listenPort=10911</span><br><span class="line">brokerIP1=127.0.0.1</span><br><span class="line">brokerIP2=127.0.0.1</span><br><span class="line">deleteWhen=04</span><br><span class="line">fileReservedTime=48</span><br><span class="line">brokerRole=SYNC_MASTER</span><br><span class="line">flushDiskType=ASYNC_FLUSH</span><br><span class="line">waitTimeMillsInSendQueue=500</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storePathRootDir=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-a/broker-a</span><br><span class="line"><span class="meta">#</span><span class="bash">commitLog å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storePathCommitLog=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-a/broker-a/commitlog</span><br><span class="line"><span class="meta">#</span><span class="bash">æ¶ˆè´¹é˜Ÿåˆ—å­˜å‚¨è·¯å¾„å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storePathConsumeQueue=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-a/broker-a/consumequeue</span><br><span class="line"><span class="meta">#</span><span class="bash">æ¶ˆæ¯ç´¢å¼•å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storePathIndex=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-a/broker-a/index</span><br><span class="line"><span class="meta">#</span><span class="bash">checkpoint æ–‡ä»¶å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storeCheckpoint=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-a/broker-a/checkpoint</span><br><span class="line"><span class="meta">#</span><span class="bash">abort æ–‡ä»¶å­˜å‚¨è·¯å¾„</span></span><br><span class="line">abortFile=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-a/broker-a/abort</span><br></pre></td></tr></table></figure><h3 id="4-2-broker-a-s-çš„é…ç½®"><a href="#4-2-broker-a-s-çš„é…ç½®" class="headerlink" title="4.2 broker-a-s çš„é…ç½®"></a>4.2 broker-a-s çš„é…ç½®</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> broker<span class="_">-a</span><span class="_">-s</span> çš„é…ç½®</span></span><br><span class="line">brokerClusterName=DefaultCluster</span><br><span class="line">brokerName=broker-a</span><br><span class="line">brokerId=1</span><br><span class="line">listenPort=10931</span><br><span class="line"><span class="meta">#</span><span class="bash">nameServeråœ°å€ï¼Œåˆ†å·åˆ†å‰²</span></span><br><span class="line"><span class="meta">#</span><span class="bash">namesrvAddr=127.0.0.1:9876;127.0.0.1:9870</span></span><br><span class="line">brokerIP1=127.0.0.1</span><br><span class="line">brokerIP2=127.0.0.1</span><br><span class="line">deleteWhen=04</span><br><span class="line">fileReservedTime=48</span><br><span class="line">brokerRole=SLAVE</span><br><span class="line">flushDiskType=ASYNC_FLUSH</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storePathRootDir=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-a-s/broker-a-s</span><br><span class="line"><span class="meta">#</span><span class="bash">commitLog å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storePathCommitLog=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-a-s/broker-a-s/commitlog</span><br><span class="line"><span class="meta">#</span><span class="bash">æ¶ˆè´¹é˜Ÿåˆ—å­˜å‚¨è·¯å¾„å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storePathConsumeQueue=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-a-s/broker-a-s/consumequeue</span><br><span class="line"><span class="meta">#</span><span class="bash">æ¶ˆæ¯ç´¢å¼•å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storePathIndex=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-a-s/broker-a-s/index</span><br><span class="line"><span class="meta">#</span><span class="bash">checkpoint æ–‡ä»¶å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storeCheckpoint=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-a-s/broker-a-s/checkpoint</span><br><span class="line"><span class="meta">#</span><span class="bash">abort æ–‡ä»¶å­˜å‚¨è·¯å¾„</span></span><br><span class="line">abortFile=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-a-s/broker-a-s/abort</span><br></pre></td></tr></table></figure><h3 id="4-3-broker-b-çš„é…ç½®"><a href="#4-3-broker-b-çš„é…ç½®" class="headerlink" title="4.3 broker-b çš„é…ç½®"></a>4.3 broker-b çš„é…ç½®</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> broker-b çš„é…ç½®</span></span><br><span class="line">brokerClusterName=DefaultCluster</span><br><span class="line">brokerName=broker-b</span><br><span class="line">brokerId=0</span><br><span class="line"><span class="meta">#</span><span class="bash">nameServeråœ°å€ï¼Œåˆ†å·åˆ†å‰²</span></span><br><span class="line"><span class="meta">#</span><span class="bash">namesrvAddr=127.0.0.1:9876;127.0.0.1:9870</span></span><br><span class="line"><span class="meta">#</span><span class="bash">åœ¨å‘é€æ¶ˆæ¯æ—¶ï¼Œè‡ªåŠ¨åˆ›å»ºæœåŠ¡å™¨ä¸å­˜åœ¨çš„topicï¼Œé»˜è®¤åˆ›å»ºçš„é˜Ÿåˆ—æ•°</span></span><br><span class="line">defaultTopicQueueNums=4</span><br><span class="line"><span class="meta">#</span><span class="bash">æ˜¯å¦å…è®¸ Broker è‡ªåŠ¨åˆ›å»ºTopicï¼Œå»ºè®®çº¿ä¸‹å¼€å¯ï¼Œçº¿ä¸Šå…³é—­</span></span><br><span class="line">autoCreateTopicEnable=true</span><br><span class="line"><span class="meta">#</span><span class="bash">æ˜¯å¦å…è®¸ Broker è‡ªåŠ¨åˆ›å»ºè®¢é˜…ç»„ï¼Œå»ºè®®çº¿ä¸‹å¼€å¯ï¼Œçº¿ä¸Šå…³é—­</span></span><br><span class="line">autoCreateSubscriptionGroup=true</span><br><span class="line"><span class="meta">#</span><span class="bash">Broker å¯¹å¤–æœåŠ¡çš„ç›‘å¬ç«¯å£,</span></span><br><span class="line">listenPort=10951</span><br><span class="line">brokerIP1=127.0.0.1</span><br><span class="line">brokerIP2=127.0.0.1</span><br><span class="line">deleteWhen=04</span><br><span class="line">fileReservedTime=48</span><br><span class="line">brokerRole=SYNC_MASTER</span><br><span class="line">flushDiskType=ASYNC_FLUSH</span><br><span class="line">waitTimeMillsInSendQueue=500</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storePathRootDir=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-b/broker-b</span><br><span class="line"><span class="meta">#</span><span class="bash">commitLog å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storePathCommitLog=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-b/broker-b/commitlog</span><br><span class="line"><span class="meta">#</span><span class="bash">æ¶ˆè´¹é˜Ÿåˆ—å­˜å‚¨è·¯å¾„å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storePathConsumeQueue=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-b/broker-b/consumequeue</span><br><span class="line"><span class="meta">#</span><span class="bash">æ¶ˆæ¯ç´¢å¼•å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storePathIndex=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-b/broker-b/index</span><br><span class="line"><span class="meta">#</span><span class="bash">checkpoint æ–‡ä»¶å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storeCheckpoint=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-b/broker-b/checkpoint</span><br><span class="line"><span class="meta">#</span><span class="bash">abort æ–‡ä»¶å­˜å‚¨è·¯å¾„</span></span><br><span class="line">abortFile=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-b/broker-b/abort</span><br></pre></td></tr></table></figure><h3 id="4-4-broker-b-s-çš„é…ç½®"><a href="#4-4-broker-b-s-çš„é…ç½®" class="headerlink" title="4.4 broker-b-s çš„é…ç½®"></a>4.4 broker-b-s çš„é…ç½®</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> broker-b<span class="_">-s</span> çš„é…ç½®</span></span><br><span class="line"></span><br><span class="line">brokerClusterName=DefaultCluster</span><br><span class="line">brokerName=broker-b</span><br><span class="line">brokerId=1</span><br><span class="line">listenPort=10971</span><br><span class="line"><span class="meta">#</span><span class="bash">nameServeråœ°å€ï¼Œåˆ†å·åˆ†å‰²</span></span><br><span class="line"><span class="meta">#</span><span class="bash">namesrvAddr=127.0.0.1:9876;127.0.0.1:9870</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> å¯ä»¥ä¸é…ç½®</span></span><br><span class="line">brokerIP1=127.0.0.1</span><br><span class="line">brokerIP2=127.0.0.1</span><br><span class="line">deleteWhen=04</span><br><span class="line">fileReservedTime=48</span><br><span class="line">brokerRole=SLAVE</span><br><span class="line">flushDiskType=ASYNC_FLUSH</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storePathRootDir=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-b-s/broker-b-s</span><br><span class="line"><span class="meta">#</span><span class="bash">commitLog å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storePathCommitLog=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-b-s/broker-b-s/commitlog</span><br><span class="line"><span class="meta">#</span><span class="bash">æ¶ˆè´¹é˜Ÿåˆ—å­˜å‚¨è·¯å¾„å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storePathConsumeQueue=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-b-s/broker-b-s/consumequeue</span><br><span class="line"><span class="meta">#</span><span class="bash">æ¶ˆæ¯ç´¢å¼•å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storePathIndex=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-b-s/broker-b-s/index</span><br><span class="line"><span class="meta">#</span><span class="bash">checkpoint æ–‡ä»¶å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storeCheckpoint=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-b-s/broker-b-s/checkpoint</span><br><span class="line"><span class="meta">#</span><span class="bash">abort æ–‡ä»¶å­˜å‚¨è·¯å¾„</span></span><br><span class="line">abortFile=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-b-s/broker-b-s/abort</span><br></pre></td></tr></table></figure><h3 id="4-5-å¯åŠ¨åŒä¸»åŒä»boker"><a href="#4-5-å¯åŠ¨åŒä¸»åŒä»boker" class="headerlink" title="4.5 å¯åŠ¨åŒä¸»åŒä»boker"></a>4.5 å¯åŠ¨åŒä¸»åŒä»boker</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">start mqbroker.cmd -c D:/ProgramFiles/rocketmq-all-4.7.1/conf/2m-2s-sync/broker-a.properties  -n "127.0.0.1:9876;127.0.0.1:9870"</span><br><span class="line"></span><br><span class="line">start mqbroker.cmd -c D:/ProgramFiles/rocketmq-all-4.7.1/conf/2m-2s-sync/broker-a-s.properties -n "127.0.0.1:9876;127.0.0.1:9870"</span><br><span class="line"></span><br><span class="line">start mqbroker.cmd -c D:/ProgramFiles/rocketmq-all-4.7.1/conf/2m-2s-sync/broker-b.properties  -n "127.0.0.1:9876;127.0.0.1:9870"</span><br><span class="line"></span><br><span class="line">start mqbroker.cmd -c D:/ProgramFiles/rocketmq-all-4.7.1/conf/2m-2s-sync/broker-b-s.properties -n "127.0.0.1:9876;127.0.0.1:9870"</span><br></pre></td></tr></table></figure><h2 id="5-é…ç½®rocketmq-console"><a href="#5-é…ç½®rocketmq-console" class="headerlink" title="5 é…ç½®rocketmq-console"></a>5 é…ç½®rocketmq-console</h2><p><code>RocketMQ</code>æœ‰ä¸€ä¸ªå¯¹å…¶æ‰©å±•çš„å¼€æºé¡¹ç›®<a href="https://github.com/apache/rocketmq-externals" target="_blank" rel="noopener">incubator-rocketmq-externals</a>ï¼Œè¿™ä¸ªé¡¹ç›®ä¸­æœ‰ä¸€ä¸ªå­æ¨¡å—å«<code>rocketmq-console</code>ï¼Œè¿™ä¸ªä¾¿æ˜¯ç®¡ç†æ§åˆ¶å°é¡¹ç›®äº†ï¼Œå…ˆå°†<a href="https://github.com/apache/rocketmq-externals" target="_blank" rel="noopener">incubator-rocketmq-externals</a>æ‹‰åˆ°æœ¬åœ°ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦è‡ªå·±å¯¹<code>rocketmq-console</code>è¿›è¡Œç¼–è¯‘æ‰“åŒ…è¿è¡Œã€‚</p><h3 id="5-1-ä¸‹è½½å¹¶ç¼–è¯‘æ‰“åŒ…"><a href="#5-1-ä¸‹è½½å¹¶ç¼–è¯‘æ‰“åŒ…" class="headerlink" title="5.1 ä¸‹è½½å¹¶ç¼–è¯‘æ‰“åŒ…"></a>5.1 ä¸‹è½½å¹¶ç¼–è¯‘æ‰“åŒ…</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/apache/rocketmq-externals</span><br><span class="line">cd rocketmq-console</span><br><span class="line">mvn clean package -Dmaven.test.skip=true</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šæ‰“åŒ…å‰åœ¨<code>rocketmq-console</code>ä¸­é…ç½®<code>namesrv</code>é›†ç¾¤åœ°å€ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">server.port=80</span><br><span class="line">rocketmq.config.namesrvAddr=127.0.0.1:9876;192.168.25.138:9870</span><br></pre></td></tr></table></figure><p>å¯åŠ¨rocketmq-consoleï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar rocketmq-console-ng-2.0.0.jar</span><br></pre></td></tr></table></figure><p><em>æ³¨æ„</em>  ä½ æ‰§è¡Œä¸Šè¿°å‘½ä»¤ä¹‹åå¯èƒ½å¾—åˆ°çš„ jar åŒ…çš„åå­—å’Œæˆ‘çš„ä¸ä¸€æ ·ï¼Œæ¯•ç«Ÿäººå®¶ä¹Ÿæ˜¯ä¸€ç›´åœ¨æ›´æ–°ç‰ˆæœ¬ï¼Œæ³¨æ„çœ‹è‡ªå·±å¯¹åº”ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œé€‚å½“æ›¿æ¢å°±è¡Œã€‚</p><p>å¯åŠ¨æˆåŠŸåï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡æµè§ˆå™¨è®¿é—®<code>http://localhost:80</code>è¿›å…¥é›†ç¾¤ç•Œé¢äº†å¦‚ä¸‹å›¾ï¼š<br><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20201010215859.png" alt="æ¶ˆæ¯é˜Ÿåˆ—é›†ç¾¤"></p><h2 id="6-åœ¨æ­å»ºè¿‡ç¨‹ä¸­å‡ºç°çš„é—®é¢˜"><a href="#6-åœ¨æ­å»ºè¿‡ç¨‹ä¸­å‡ºç°çš„é—®é¢˜" class="headerlink" title="6 åœ¨æ­å»ºè¿‡ç¨‹ä¸­å‡ºç°çš„é—®é¢˜"></a>6 åœ¨æ­å»ºè¿‡ç¨‹ä¸­å‡ºç°çš„é—®é¢˜</h2><h3 id="6-1-Lock-failed-MQ-already-started"><a href="#6-1-Lock-failed-MQ-already-started" class="headerlink" title="6.1 Lock failed,MQ already started"></a>6.1 Lock failed,MQ already started</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">java.lang.RuntimeException: Lock failed,MQ already started</span><br><span class="line">        at org.apache.rocketmq.store.DefaultMessageStore.start(DefaultMessageStore.java:227)</span><br><span class="line">        at org.apache.rocketmq.broker.BrokerController.start(BrokerController.java:853)</span><br><span class="line">        at org.apache.rocketmq.broker.BrokerStartup.start(BrokerStartup.java:64)</span><br><span class="line">        at org.apache.rocketmq.broker.BrokerStartup.main(BrokerStartup.java:58)</span><br></pre></td></tr></table></figure><p>å‡ºç°è¿™ä¸ªé—®é¢˜ æ˜¯å› ä¸ºæˆ‘ä»¬åœ¨é›†ç¾¤ä¸­masterå’Œslaveå…±ç”¨ä¸€ä¸ªstorePathé€ æˆçš„ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬è¦å¯åŠ¨çš„æ¯ä¸€ä¸ªbrokerè¦æŒ‡å®šä¸ä¸€æ ·çš„storePath è·¯å¾„å°±è¡Œï¼Œä¹Ÿå°±æ˜¯åœ¨æˆ‘ä»¬çš„é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹å³å¯ï¼Œå®Œç¾è§£å†³ã€‚</p><h3 id="6-2-é›†ç¾¤çŠ¶æ€-SLAVE-NOT-AVAILABLE"><a href="#6-2-é›†ç¾¤çŠ¶æ€-SLAVE-NOT-AVAILABLE" class="headerlink" title="6.2 é›†ç¾¤çŠ¶æ€ SLAVE_NOT_AVAILABLE"></a>6.2 é›†ç¾¤çŠ¶æ€ SLAVE_NOT_AVAILABLE</h3><p>ä¸»ä»çš„brokerName ä¸€å®šè¦è®¾ç½®æˆä¸€æ ·çš„ï¼Œä¸»brokerName=broker-a é‚£ä¹ˆä»çš„brokerName=broker-aï¼Œä¸ç„¶å‘é€æ¶ˆæ¯ä¼šå‡ºç° SLAVE_NOT_AVAILABLE</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> brokeråå­—ï¼Œæ³¨æ„æ­¤å¤„ä¸åŒçš„é…ç½®æ–‡ä»¶å¡«å†™çš„ä¸ä¸€æ ·</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> broker<span class="_">-a</span> çš„é…ç½®</span></span><br><span class="line"></span><br><span class="line">brokerClusterName=DefaultCluster</span><br><span class="line">brokerName=broker-a</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> broker<span class="_">-a</span><span class="_">-s</span> çš„é…ç½®</span></span><br><span class="line"></span><br><span class="line">brokerClusterName=DefaultCluster</span><br><span class="line">brokerName=broker-a</span><br></pre></td></tr></table></figure><h3 id="6-3-æ¶ˆæ¯å‘é€å‡ºç°-TIMEOUT-CLEAN-QUEUE-broker-busy"><a href="#6-3-æ¶ˆæ¯å‘é€å‡ºç°-TIMEOUT-CLEAN-QUEUE-broker-busy" class="headerlink" title="6.3 æ¶ˆæ¯å‘é€å‡ºç° [TIMEOUT_CLEAN_QUEUE]broker busy"></a>6.3 æ¶ˆæ¯å‘é€å‡ºç° [TIMEOUT_CLEAN_QUEUE]broker busy</h3> <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">org.apache.rocketmq.client.exception.MQBrokerException: CODE: 2  DESC: [TIMEOUT_CLEAN_QUEUE]broker busy, start flow control for a while, period in queue: 205ms, size of queue: 2</span><br></pre></td></tr></table></figure><p> è§£å†³æ–¹å¼å°±æ˜¯åˆç†è®¾ç½®waitTimeMillsInSendQueueçš„å€¼</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æ¸…é™¤å‘é€çº¿ç¨‹æ± ä»»åŠ¡é˜Ÿåˆ—çš„ç­‰å¾…æ—¶é—´ã€‚å¦‚æœç³»ç»Ÿæ—¶é—´å‡å»ä»»åŠ¡æ”¾å…¥é˜Ÿåˆ—ä¸­çš„æ—¶é—´å°äºwaitTimeMillsInSendQueueï¼Œæœ¬æ¬¡è¯·æ±‚ä»»åŠ¡æš‚æ—¶ä¸ç§»é™¤è¯¥ä»»åŠ¡ é»˜è®¤200ms</span></span><br><span class="line">waitTimeMillsInSendQueue=200</span><br></pre></td></tr></table></figure><p>åˆ°æ­¤RocketMQåŒä¸»åŒä»é›†ç¾¤å°±æ­å»ºå®Œæ¯•ã€‚</p><p><em>å‚è€ƒèµ„æ–™</em><br><a href="https://blog.csdn.net/chenzhong2010/article/details/106749258" target="_blank" rel="noopener">å‚è€ƒ1</a><br><a href="https://blog.csdn.net/vucko/article/details/107487675" target="_blank" rel="noopener">å‚è€ƒ2</a><br><a href="https://blog.csdn.net/jianghuiyun/article/details/77971583" target="_blank" rel="noopener">å‚è€ƒ3</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Windows </tag>
            
            <tag> RocketMQ </tag>
            
            <tag> åŒä¸»åŒä»é›†ç¾¤ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScriptæ¥æ”¶åç«¯Longç±»å‹æ•°æ®ç²¾åº¦ä¸¢å¤±é—®é¢˜</title>
      <link href="/post/175ad151.html"/>
      <url>/post/175ad151.html</url>
      
        <content type="html"><![CDATA[<p>åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œé€šå¸¸æˆ‘ä»¬çš„æ•°æ®åº“ä¸»é”®ä¼šä½¿ç”¨ bigintï¼Œå®ƒå¯¹åº” Java ä¸­çš„ Longï¼Œä½†æ˜¯å½“Longçš„æ•°å€¼è¶…è¿‡ä¸€å®šå€¼æ—¶ä¼ åˆ°å‰ç«¯åä¼šä¸¢å¤±ç²¾åº¦ã€‚åŸå› æ˜¯JavaScriptçš„numberç±»å‹æœ‰ä¸ªå®‰å…¨å€¼ï¼Œå³2çš„53æ¬¡æ–¹ï¼Œä¸º9007199254740991ï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªå€¼ï¼Œé‚£ä¹ˆJavaScriptä¼šå‡ºç°ä¸ç²¾ç¡®çš„é—®é¢˜ã€‚</p><a id="more"></a><p>æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨ä¸­æ‰“å°å‡ºJavaScriptçš„numberç±»å‹æœ‰ä¸ªå®‰å…¨å€¼ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20200826225013.png" alt="JavaScriptçš„numberç±»å‹æœ‰ä¸ªå®‰å…¨å€¼"></p><p>å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿæœ€ç®€å•çš„åŠæ³•å°±æ˜¯ç›´æ¥åå°åœ¨è¿”å›ç»™å‰ç«¯çš„æ—¶å€™ï¼ŒæŠŠ Long ç±»å‹çš„æ•°æ®è½¬æ¢æˆå­—ç¬¦ä¸²å³å¯ã€‚å¦‚æœè‡ªå·±æ‰‹åŠ¨è½¬æˆ‘æƒ³è¿™ä¸ªä¼šæ˜¯ä¸€ä¸ªå·¥ä½œé‡ä¸å°çš„æ´»ï¼Œé‚£æˆ‘ä»¬æ€ä¹ˆå®‰å…¨å¿«é€Ÿçš„è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ</p><ul><li><p>æ–¹æ¡ˆä¸€</p><p>å¦‚æœä½ ä»¬æ˜¯ä½¿ç”¨jacksonæ¡†æ¶çš„è¯ï¼Œå¯ä»¥åœ¨ç›¸åº”çš„å­—æ®µä¸ŠåŠ ä¸Šä»¥ä¸‹çš„æ³¨è§£ï¼ˆè‹¥æ˜¯ç”¨çš„ FastJson ä¹Ÿæœ‰ç›¸åº”çš„æ³¨è§£ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.annotation.JsonSerialize;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.ser.std.ToStringSerializer;</span><br><span class="line"><span class="comment">//åºåˆ—åŒ–æˆStringçš„ä¼ </span></span><br><span class="line"></span><br><span class="line"> <span class="meta">@JsonSerialize</span>(using = ToStringSerializer<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class"> <span class="title">private</span> <span class="title">Long</span> <span class="title">id</span></span>;</span><br></pre></td></tr></table></figure></li><li><p>æ–¹æ¡ˆäºŒ</p><p>å¯ä»¥è‡ªå®šä¹‰Jacksonçš„ObjectMapper</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomJacksonObjectMapper</span> <span class="keyword">extends</span> <span class="title">ObjectMapper</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CustomJacksonObjectMapper</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        <span class="comment">// è®¾ç½®æ—¥æœŸè½¬æ¢yyyy-MM-dd HH:mm:ss</span></span><br><span class="line">        setDateFormat(<span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd HH:mm:ss"</span>));</span><br><span class="line">        <span class="comment">// åºåˆ—æ¢æˆjsonæ—¶,å°†æ‰€æœ‰çš„longå˜æˆstring,å› ä¸ºjsä¸­å¾—æ•°å­—ç±»å‹ä¸èƒ½åŒ…å«æ‰€æœ‰çš„java longå€¼</span></span><br><span class="line">        SimpleModule simpleModule = <span class="keyword">new</span> SimpleModule(<span class="string">"LongModule"</span>, <span class="keyword">new</span> Version(<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="string">""</span>));</span><br><span class="line">        simpleModule.addSerializer(Long<span class="class">.<span class="keyword">class</span>, <span class="title">ToStringSerializer</span>.<span class="title">instance</span>)</span>;</span><br><span class="line">        simpleModule.addSerializer(Long.TYPE, ToStringSerializer.instance);</span><br><span class="line">        registerModule(simpleModule);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æ–¹æ¡ˆä¸‰</p><p>å‰ç«¯è‡ªå·±è§£å†³ï¼Œä½¿ç”¨ç¬¬ä¸‰æ–¹åº“å¦‚json-bigint ç­‰</p></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> JavaScript </tag>
            
            <tag> æ•°æ®ç²¾åº¦ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¼–ç¨‹è¿‡ç¨‹ä¸­æŠ½è±¡ç±»å’Œæ¥å£çš„æŠ‰æ‹©</title>
      <link href="/post/665bcc51.html"/>
      <url>/post/665bcc51.html</url>
      
        <content type="html"><![CDATA[<p>ä½œä¸ºä¸€ä½ç¨‹åºå‘˜åœ¨ç¼–ç çš„è¿‡ç¨‹ä¸­ï¼Œç»ˆä¼šé‡åˆ°è¿™ç§æƒ…å†µï¼šè¿™ä¸ªåŠŸèƒ½æˆ‘åˆ°åº•æ˜¯ç”¨æ¥å£å‘¢ï¼Ÿè¿˜æ˜¯ç”¨æŠ½è±¡ç±»å‘¢ï¼Ÿ</p><a id="more"></a><p>æœ€è¿‘åœ¨é¡¹ç›®ä¸­è´Ÿè´£æ”¯ä»˜åŠŸèƒ½ï¼Œç”±äºé¡¹ç›®æ˜¯åœ¨åŸæœ‰çš„åŸºç¡€ä¸Šï¼Œç”±å°ç¨‹åºæ‰©å……ç»ˆç«¯åˆ°äº†Appï¼Œå°ç¨‹åºä¹‹å‰åˆå¯¹æ¥äº†å¾®ä¿¡çš„ jsapi ï¼Œæ‰€ä»¥ç°åœ¨çš„å¯¹æ¥æ”¯ä»˜å¹³å°çš„æƒ…å†µå˜ä¸ºï¼Œé“¶è”æ”¯ä»˜å®App æ”¯ä»˜ã€æ˜“ä»˜å® Appæ”¯ä»˜ã€å¾®ä¿¡jspaiæ”¯ä»˜ã€å¾®ä¿¡Appæ”¯ä»˜ã€‚ï¼ˆä¸ºå•¥æ²¡æœ‰å¯¹æ¥å°ç¨‹åºæ”¯ä»˜ï¼Œå´å¯¹æ¥äº† jsapi æ”¯ä»˜ï¼Œé‚£æˆ‘å°±ä¸æ™“å¾—äº†ï¼‰ã€‚å¯¹æ¥ä¸€ä¸ªå¹³å°çš„æ”¯ä»˜å°±éœ€è¦å®ç°ä¸‹å•ã€å¼‚æ­¥å›è°ƒå¤„ç†ã€è®¢å•æŸ¥è¯¢ã€è®¢å•é€€æ¬¾ã€è®¢å•é€€æ¬¾æŸ¥è¯¢ï¼Œäºæ˜¯æˆ‘å°±åœ¨æŠ½è±¡ç±»å’Œæ¥å£ä¹‹é—´å¾˜å¾Šï¼Œä¸è¿‡çŸ­æš‚çš„æ€è€ƒè¿‡åæˆ‘è¿˜æ˜¯é€‰æ‹©äº†æ¥å£ã€‚</p><p>é‚£ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æ¥å£ï¼Ÿä»€ä¹ˆæ—¶å€™ä½¿ç”¨æŠ½è±¡ç±»ï¼Ÿ</p><p>ä½¿ç”¨æŠ½è±¡ç±»æ˜¯ä¸ºäº†ä»£ç çš„å¤ç”¨ï¼Œè€Œä½¿ç”¨æ¥å£çš„åŠ¨æœºæ˜¯ä¸ºäº†å®ç°å¤šæ€æ€§ã€‚<br>æŠ½è±¡ç±»é€‚åˆç”¨æ¥å®šä¹‰æŸä¸ªé¢†åŸŸçš„å›ºæœ‰å±æ€§ï¼Œä¹Ÿå°±æ˜¯æœ¬è´¨ï¼Œæ¥å£é€‚åˆç”¨æ¥å®šä¹‰æŸä¸ªé¢†åŸŸçš„æ‰©å±•åŠŸèƒ½ã€‚</p><h4 id="ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æŠ½è±¡ç±»"><a href="#ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æŠ½è±¡ç±»" class="headerlink" title="ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æŠ½è±¡ç±»?"></a>ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æŠ½è±¡ç±»?</h4><ul><li>å½“2ä¸ªæˆ–å¤šä¸ªç±»ä¸­æœ‰é‡å¤éƒ¨åˆ†çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æŠ½è±¡å‡ºæ¥ä¸€ä¸ªåŸºç±»ï¼Œå¦‚æœå¸Œæœ›è¿™ä¸ªåŸºç±»ä¸èƒ½è¢«å®ä¾‹åŒ–ï¼Œå°±å¯ä»¥æŠŠè¿™ä¸ªåŸºç±»è®¾è®¡æˆæŠ½è±¡ç±»ã€‚</li><li>å½“éœ€è¦ä¸ºä¸€äº›ç±»æä¾›å…¬å…±çš„å®ç°ä»£ç æ—¶ï¼Œåº”ä¼˜å…ˆè€ƒè™‘æŠ½è±¡ç±»ã€‚ å› ä¸ºæŠ½è±¡ç±»ä¸­çš„éæŠ½è±¡æ–¹æ³•å¯ä»¥è¢«å­ç±»ç»§æ‰¿ä¸‹æ¥ï¼Œå› ä¸ºæŠ½è±¡ç±»ä¸­çš„éæŠ½è±¡æ–¹æ³•å¯ä»¥è¢«å­ç±»ç»§æ‰¿ä¸‹æ¥ï¼Œä½¿å®ç°åŠŸèƒ½çš„ä»£ç æ›´ç®€å•ã€‚æŠ½è±¡ç±»åªèƒ½æ˜¯å•ç»§æ‰¿çš„ï¼Œä¸èƒ½å¤šç»§æ‰¿ã€‚</li></ul><h4 id="ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æ¥å£ï¼Ÿ"><a href="#ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æ¥å£ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æ¥å£ï¼Ÿ"></a>ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æ¥å£ï¼Ÿ</h4><ul><li>å½“æ³¨é‡ä»£ç çš„æ‰©å±•æ€§è·Ÿå¯ç»´æŠ¤æ€§æ—¶ï¼Œåº”å½“ä¼˜å…ˆé‡‡ç”¨æ¥å£ã€‚</li><li>æ¥å£ä¸å®ç°å®ƒçš„ç±»ä¹‹é—´å¯ä»¥ä¸å­˜åœ¨ä»»ä½•å±‚æ¬¡å…³ç³»ï¼Œæ¥å£å¯ä»¥å®ç°æ¯«ä¸ç›¸å…³ç±»çš„ç›¸åŒè¡Œä¸ºï¼Œæ¯”æŠ½è±¡ç±»çš„ä½¿ç”¨æ›´åŠ æ–¹ä¾¿çµæ´»;</li><li>æ¥å£åªå…³å¿ƒå¯¹è±¡ä¹‹é—´çš„äº¤äº’çš„æ–¹æ³•ï¼Œè€Œä¸å…³å¿ƒå¯¹è±¡æ‰€å¯¹åº”çš„å…·ä½“ç±»ã€‚æ¥å£æ˜¯ç¨‹åºä¹‹é—´çš„ä¸€ä¸ªåè®®ï¼Œæ¯”æŠ½è±¡ç±»çš„ä½¿ç”¨æ›´å®‰å…¨ã€æ¸…æ™°ã€‚ä¸€èˆ¬ä½¿ç”¨æ¥å£çš„æƒ…å†µæ›´å¤šã€‚</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> ç¼–ç¨‹ </tag>
            
            <tag> æŠ½è±¡ç±» </tag>
            
            <tag> æ¥å£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼å­¦ä¹ ä¹‹è´£ä»»é“¾æ¨¡å¼</title>
      <link href="/post/8ec2718b.html"/>
      <url>/post/8ec2718b.html</url>
      
        <content type="html"><![CDATA[<h5 id="è´£ä»»é“¾æ¨¡å¼"><a href="#è´£ä»»é“¾æ¨¡å¼" class="headerlink" title="è´£ä»»é“¾æ¨¡å¼"></a>è´£ä»»é“¾æ¨¡å¼</h5><p>é¡¾åæ€ä¹‰ï¼Œè´£ä»»é“¾æ¨¡å¼ï¼ˆChain of Responsibility Patternï¼‰ä¸ºè¯·æ±‚åˆ›å»ºäº†ä¸€ä¸ªæ¥æ”¶è€…å¯¹è±¡çš„é“¾ã€‚è¿™ç§æ¨¡å¼ç»™äºˆè¯·æ±‚çš„ç±»å‹ï¼Œå¯¹è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…è¿›è¡Œè§£è€¦ã€‚è¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºè¡Œä¸ºå‹æ¨¡å¼ã€‚åœ¨è¿™ç§æ¨¡å¼ä¸­ï¼Œé€šå¸¸æ¯ä¸ªæ¥æ”¶è€…éƒ½åŒ…å«å¯¹å¦ä¸€ä¸ªæ¥æ”¶è€…çš„å¼•ç”¨ã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡ä¸èƒ½å¤„ç†è¯¥è¯·æ±‚ï¼Œé‚£ä¹ˆå®ƒä¼šæŠŠç›¸åŒçš„è¯·æ±‚ä¼ ç»™ä¸‹ä¸€ä¸ªæ¥æ”¶è€…ï¼Œä¾æ­¤ç±»æ¨ã€‚</p><a id="more"></a><h6 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h6><p>æ„å›¾ï¼šé¿å…è¯·æ±‚å‘é€è€…ä¸æ¥æ”¶è€…è€¦åˆåœ¨ä¸€èµ·ï¼Œè®©å¤šä¸ªå¯¹è±¡éƒ½æœ‰å¯èƒ½æ¥æ”¶è¯·æ±‚ï¼Œå°†è¿™äº›å¯¹è±¡è¿æ¥æˆä¸€æ¡é“¾ï¼Œå¹¶ä¸”æ²¿ç€è¿™æ¡é“¾ä¼ é€’è¯·æ±‚ï¼Œç›´åˆ°æœ‰å¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚</p><ul><li>ä¸»è¦è§£å†³ï¼šèŒè´£é“¾ä¸Šçš„å¤„ç†è€…è´Ÿè´£å¤„ç†è¯·æ±‚ï¼Œå®¢æˆ·åªéœ€è¦å°†è¯·æ±‚å‘é€åˆ°èŒè´£é“¾ä¸Šå³å¯ï¼Œæ— é¡»å…³å¿ƒè¯·æ±‚çš„å¤„ç†ç»†èŠ‚å’Œè¯·æ±‚çš„ä¼ é€’ï¼Œæ‰€ä»¥èŒè´£é“¾å°†è¯·æ±‚çš„å‘é€è€…å’Œè¯·æ±‚çš„å¤„ç†è€…è§£è€¦äº†ã€‚</li></ul><ul><li><p>ä½•æ—¶ä½¿ç”¨ ï¼šåœ¨å¤„ç†æ¶ˆæ¯çš„æ—¶å€™ä»¥è¿‡æ»¤å¾ˆå¤šé“ã€‚</p></li><li><p>å¦‚ä½•è§£å†³ï¼šæ‹¦æˆªçš„ç±»éƒ½å®ç°ç»Ÿä¸€æ¥å£ã€‚</p></li></ul><ul><li><p>å…³é”®ä»£ç ï¼šHandler é‡Œé¢èšåˆå®ƒè‡ªå·±ï¼Œåœ¨ HandlerRequest é‡Œåˆ¤æ–­æ˜¯å¦åˆé€‚ï¼Œå¦‚æœæ²¡è¾¾åˆ°æ¡ä»¶åˆ™å‘ä¸‹ä¼ é€’ï¼Œå‘è°ä¼ é€’ä¹‹å‰ set è¿›å»ã€‚</p></li><li><p>åº”ç”¨å®ä¾‹ï¼š 1ã€çº¢æ¥¼æ¢¦ä¸­çš„â€å‡»é¼“ä¼ èŠ±â€ã€‚ 2ã€JS ä¸­çš„äº‹ä»¶å†’æ³¡ã€‚ 3ã€JAVA WEB ä¸­ Apache Tomcat å¯¹ Encoding çš„å¤„ç†ï¼ŒStruts2 çš„æ‹¦æˆªå™¨ï¼Œjsp servlet çš„ Filterã€‚</p></li></ul><h6 id="ä¼˜ç‚¹ï¼š"><a href="#ä¼˜ç‚¹ï¼š" class="headerlink" title="ä¼˜ç‚¹ï¼š"></a>ä¼˜ç‚¹ï¼š</h6><ul><li>é™ä½è€¦åˆåº¦ã€‚å®ƒå°†è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…è§£è€¦ã€‚ </li><li>ç®€åŒ–äº†å¯¹è±¡ã€‚ä½¿å¾—å¯¹è±¡ä¸éœ€è¦çŸ¥é“é“¾çš„ç»“æ„ã€‚ </li><li>å¢å¼ºç»™å¯¹è±¡æŒ‡æ´¾èŒè´£çš„çµæ´»æ€§ã€‚é€šè¿‡æ”¹å˜é“¾å†…çš„æˆå‘˜æˆ–è€…è°ƒåŠ¨å®ƒä»¬çš„æ¬¡åºï¼Œå…è®¸åŠ¨æ€åœ°æ–°å¢æˆ–è€…åˆ é™¤è´£ä»»ã€‚</li><li>å¢åŠ æ–°çš„è¯·æ±‚å¤„ç†ç±»å¾ˆæ–¹ä¾¿ã€‚</li></ul><h6 id="ç¼ºç‚¹ï¼š"><a href="#ç¼ºç‚¹ï¼š" class="headerlink" title="ç¼ºç‚¹ï¼š"></a>ç¼ºç‚¹ï¼š</h6><ul><li><p>ä¸èƒ½ä¿è¯è¯·æ±‚ä¸€å®šè¢«æ¥æ”¶ã€‚ </p></li><li><p>ç³»ç»Ÿæ€§èƒ½å°†å—åˆ°ä¸€å®šå½±å“ï¼Œè€Œä¸”åœ¨è¿›è¡Œä»£ç è°ƒè¯•æ—¶ä¸å¤ªæ–¹ä¾¿ï¼Œå¯èƒ½ä¼šé€ æˆå¾ªç¯è°ƒç”¨ã€‚ </p></li><li><p>å¯èƒ½ä¸å®¹æ˜“è§‚å¯Ÿè¿è¡Œæ—¶çš„ç‰¹å¾ï¼Œæœ‰ç¢äºé™¤é”™ã€‚</p></li></ul><h6 id="ä½¿ç”¨åœºæ™¯ï¼š"><a href="#ä½¿ç”¨åœºæ™¯ï¼š" class="headerlink" title="ä½¿ç”¨åœºæ™¯ï¼š"></a>ä½¿ç”¨åœºæ™¯ï¼š</h6><ul><li>æœ‰å¤šä¸ªå¯¹è±¡å¯ä»¥å¤„ç†åŒä¸€ä¸ªè¯·æ±‚ï¼Œå…·ä½“å“ªä¸ªå¯¹è±¡å¤„ç†è¯¥è¯·æ±‚ç”±è¿è¡Œæ—¶åˆ»è‡ªåŠ¨ç¡®å®šã€‚ </li><li>åœ¨ä¸æ˜ç¡®æŒ‡å®šæ¥æ”¶è€…çš„æƒ…å†µä¸‹ï¼Œå‘å¤šä¸ªå¯¹è±¡ä¸­çš„ä¸€ä¸ªæäº¤ä¸€ä¸ªè¯·æ±‚ã€‚ </li><li>å¯åŠ¨æ€æŒ‡å®šä¸€ç»„å¯¹è±¡å¤„ç†è¯·æ±‚</li></ul><h6 id="å®é™…åœºæ™¯"><a href="#å®é™…åœºæ™¯" class="headerlink" title="å®é™…åœºæ™¯"></a>å®é™…åœºæ™¯</h6><p>æœ¬æ–‡ä»¥å„ç§ç”µå•†ç³»ç»Ÿè®¢å•å®ä»˜é‡‘é¢è®¡ç®—ä¸ºä¾‹ï¼Œè®¢å•æœ€ç»ˆç”¨æˆ·æ‰€éœ€è¦ä»˜çš„é‡‘é¢å¯èƒ½æ˜¯è¿™æ ·çš„ï¼š</p><p><strong>åº”ä»˜é‡‘é¢=è®¢å•é‡‘é¢-ä¼˜æƒ åˆ¸ä¼˜æƒ é‡‘é¢-ä¿ƒé”€æ´»åŠ¨ä¼˜æƒ é‡‘é¢-ä¼šå‘˜æƒç›Šä¼˜æƒ é‡‘é¢</strong></p><p>å½“ç„¶ä¹Ÿæœ‰å¯èƒ½è¿˜ä¼šå¢åŠ å…¶ä»–çš„è®¡ç®—æ­¥éª¤ï¼Œä½¿ç”¨è´£ä»»é“¾æ¨¡å¼æ¥å®ç°è®¢å•é‡‘é¢è®¡ç®—ï¼Œè‹¥å¢åŠ äº†å…¶ä»–è®¡ç®—æ­¥éª¤ï¼Œç›´æ¥å°†æ­¥éª¤åŠ å…¥åˆ°é“¾ä¸­å³å¯ï¼Œè€Œæ— éœ€æ”¹åŠ¨ä»¥å‰çš„ä»£ç ï¼Œæœ€å¤§ç¨‹åº¦å‡å°å‡ºé”™çš„å¯èƒ½æ€§ã€‚è´£ä»»é“¾åˆ†ä¸ºçº¯è´£ä»»é“¾ä¸ä¸çº¯è´£ä»»é“¾ï¼Œåœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œå¾ˆå°‘æœ‰çº¯çš„è´£ä»»é“¾ï¼Œæ‰€è°“çº¯çš„è´£ä»»é“¾ï¼Œå°±æ˜¯å•ä¸ªé“¾ä¸Šå¤„ç†å™¨è¦ä¹ˆç‹¬ç«‹å¤„ç†ï¼Œè¦ä¹ˆå¤„ç†ä¸äº†äº¤ç»™ä¸‹ä¸€ä¸ªå¤„ç†å™¨è¿›è¡Œå¤„ç†ã€‚</p><h6 id="æœ¬æ–‡ç¤ºä¾‹UMLå›¾"><a href="#æœ¬æ–‡ç¤ºä¾‹UMLå›¾" class="headerlink" title="æœ¬æ–‡ç¤ºä¾‹UMLå›¾"></a>æœ¬æ–‡ç¤ºä¾‹UMLå›¾</h6><p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20200512224609.jpg" alt="ç¤ºä¾‹ UML å›¾"></p><p> <strong>ä¸ºäº†ç®€åŒ–ç¤ºä¾‹ï¼Œä»£ç ä¸­å…³äºä¼˜æƒ é‡‘é¢çš„è®¡ç®—éƒ½å†™å›ºå®šå€¼ã€‚</strong></p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å°è£…å¤„ç†å™¨é“¾å¤„ç†å…ƒç´ ä¸Šä¸‹æ–‡ï¼Œå³å¾…å¤„ç†çš„è®¢å•</span></span><br><span class="line"><span class="comment"> * çœç•¥ get/set æ–¹æ³•</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/5/4</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.6.5</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderDto</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å½“å‰å¤„ç†å™¨ä½äºå¤„ç†å™¨ chain ä¸Šçš„ä½ç½®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> pos;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¢å•å·</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String orderNo;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¢å•é‡‘é¢</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Double amount;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * VIP ç­‰çº§</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer vipLevel;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¼˜æƒ åˆ¸</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String couponNo;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  æŠ½è±¡å¤„ç†è€…</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/5/4</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.6.5</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderAbstractHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‡å…é‡‘é¢å¤„ç†</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> orderDto å¾…å¤„ç†è®¢å•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> chain å¤„ç†å™¨é“¾</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">doHandle</span><span class="params">(OrderDto orderDto, OrderHandlerChain chain)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¢å•å¤„ç†å™¨çš„æƒé‡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">int</span> <span class="title">weight</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>è®¢å•å¤„ç†å™¨é“¾<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è®¢å•å¤„ç†å™¨é“¾</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/5/4</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.6.5</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderHandlerChain</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;OrderAbstractHandler&gt; chainList = <span class="keyword">new</span> ArrayList&lt;&gt;(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åˆå§‹åŒ–è®¢å•å¤„ç†å™¨é“¾</span></span><br><span class="line"><span class="comment"> * çœŸå®ç¼–ç çš„æ—¶å€™å°½é‡ä¸è¦è¿™æ ·å†™ï¼Œè¿™æ ·ä¸å¤Ÿä¼˜é›…</span></span><br><span class="line"><span class="comment"> * å¯ä»¥å®ç°  ApplicationContextAware  è¿›è¡Œ bean çš„æ³¨å…¥æˆ–è€…å…¶ä»–æ–¹å¼å®ç°è‡ªåŠ¨æ³¨å…¥å°±å¥½</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">OrderHandlerChain</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        </span><br><span class="line">        chainList.add(<span class="keyword">new</span> CouponOrderHandler());</span><br><span class="line">        chainList.add(<span class="keyword">new</span> VipOrderHandler());</span><br><span class="line">        chainList.add(<span class="keyword">new</span> SalesOrderHandler());</span><br><span class="line">        <span class="comment">// æ ¹æ®å¤„ç†å™¨çš„æƒé‡ï¼Œå¯¹å¤„ç†å™¨é“¾ä¸­å…ƒç´ è¿›è¡Œæ’åº</span></span><br><span class="line">        chainList.sort(Comparator.comparingInt(OrderAbstractHandler::weight));</span><br><span class="line">        System.out.println(<span class="keyword">this</span>.chainList);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(OrderDto context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (context.getPos() &lt; chainList.size()) &#123;</span><br><span class="line">            OrderAbstractHandler handler = chainList.get(context.getPos());</span><br><span class="line">            <span class="comment">// ç§»åŠ¨ä½äºå¤„ç†å™¨é“¾ä¸­çš„ä½ç½®</span></span><br><span class="line">            context.setPos(context.getPos() + <span class="number">1</span>);</span><br><span class="line">            handler.doHandle(context, <span class="keyword">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">`</span><br></pre></td></tr></table></figure></li></ul><h6 id="å…·ä½“å¤„ç†å®ç°"><a href="#å…·ä½“å¤„ç†å®ç°" class="headerlink" title="å…·ä½“å¤„ç†å®ç°"></a>å…·ä½“å¤„ç†å®ç°</h6><ul><li>ä¼˜æƒ åˆ¸å‡å…é‡‘é¢å®ç°</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä¼˜æƒ åˆ¸å‡å…é‡‘é¢</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> åˆ˜æ´‹ Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/5/4</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.6.5</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CouponOrderHandler</span> <span class="keyword">extends</span> <span class="title">OrderAbstractHandler</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doHandle</span><span class="params">(OrderDto context, OrderHandlerChain chain)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (context.getCouponNo() != <span class="keyword">null</span>) &#123;</span><br><span class="line">            context.setAmount(context.getAmount() - <span class="number">10</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è°ƒç”¨ä¸‹ä¸€ä¸ªå¤„ç†å™¨è¿›è¡Œå¤„ç†</span></span><br><span class="line">        chain.handle(context);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">int</span> <span class="title">weight</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ä¼šå‘˜ç­‰çº§å‡å…é‡‘é¢å®ç°<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä¼šå‘˜ç­‰çº§å‡å…é‡‘é¢</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/5/4</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.6.5</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VipOrderHandler</span> <span class="keyword">extends</span> <span class="title">OrderAbstractHandler</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doHandle</span><span class="params">(OrderDto context, OrderHandlerChain chain)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (context.getVipLevel() &gt; <span class="number">2</span>) &#123;</span><br><span class="line">            context.setAmount(context.getAmount() - <span class="number">5</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è°ƒç”¨ä¸‹ä¸€ä¸ªå¤„ç†å™¨è¿›è¡Œå¤„ç†</span></span><br><span class="line">        chain.handle(context);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">int</span> <span class="title">weight</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>ä¿ƒé”€æ´»åŠ¨ä¼˜æƒ é‡‘é¢å®ç°<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä¿ƒé”€æ´»åŠ¨ä¼˜æƒ é‡‘é¢</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/5/4</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.6.5</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SalesOrderHandler</span> <span class="keyword">extends</span> <span class="title">OrderAbstractHandler</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doHandle</span><span class="params">(OrderDto context, OrderHandlerChain chain)</span> </span>&#123;</span><br><span class="line">        Double amount = context.getAmount();</span><br><span class="line">        <span class="keyword">if</span> (amount != <span class="keyword">null</span> &amp;&amp; amount &gt; <span class="number">80</span>d) &#123;</span><br><span class="line">            context.setAmount(amount * <span class="number">0.9</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è°ƒç”¨ä¸‹ä¸€ä¸ªå¤„ç†å™¨è¿›è¡Œå¤„ç†</span></span><br><span class="line">        chain.handle(context);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">int</span> <span class="title">weight</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p><strong>æµ‹è¯•ç»“æœ</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        OrderHandlerChain orderHandlerChain = <span class="keyword">new</span> OrderHandlerChain();</span><br><span class="line">        OrderDto order = <span class="keyword">new</span> OrderDto();</span><br><span class="line">        order.setOrderNo(<span class="string">"123"</span>);</span><br><span class="line">        order.setAmount(<span class="number">100</span>d);</span><br><span class="line">        order.setVipLevel(<span class="number">3</span>);</span><br><span class="line">        order.setCouponNo(<span class="string">"111"</span>);</span><br><span class="line"></span><br><span class="line">        orderHandlerChain.handle(order);</span><br><span class="line">        System.out.println(<span class="string">"è®¢å•æœ€ç»ˆé‡‘é¢ä¸ºï¼š "</span> + order.getAmount());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆè¾“å‡ºç»“æœï¼š è®¢å•æœ€ç»ˆé‡‘é¢ä¸ºï¼š 76.5<br>å¦‚æœåˆ é™¤ä¼˜æƒ åˆ¸ï¼Œè®¢å•çš„å®ä»˜é‡‘é¢å°±åˆå˜åŠ¨äº†ã€‚</p><p><strong>æ€»ç»“ï¼š</strong></p><p>å¤„ç†å™¨é“¾è°ƒç”¨handleæ–¹æ³•ï¼Œé€ä¸ªè°ƒç”¨å¤„ç†å™¨é“¾ä¸­çš„å¤„ç†å™¨çš„doHanleæ–¹æ³•ï¼Œå¯¹è®¢å•è¿›è¡Œå¤„ç†ï¼Œå½“å‰å¤„ç†å™¨å¤„ç†å®Œæ¯•åï¼Œå¯ä»¥é€‰æ‹©æ˜¯å¦ç»§ç»­äº¤ç”±ä¸‹ä¸€ä¸ªå¤„ç†å™¨è¿›è¡Œå¤„ç†ï¼Œå³è®¾ç½®chain.handle(context);ï¼Œå¦‚æœä¸éœ€è¦ç»§ç»­å¾€ä¸‹å¤„ç†ï¼Œä¸è°ƒç”¨æ­¤ä»£ç å³å¯ã€‚ </p><p>ç½‘ä¸Šæµä¼ çš„ä»£ç éƒ½æ˜¯ç›´æ¥åœ¨æŠ½è±¡å¤„ç†å™¨ä¸­åŒ…å«ä¸‹ä¸€ä¸ªå¤„ç†å™¨çš„å¼•ç”¨ï¼Œè¿™æ ·å¯¼è‡´åœ¨å®¢æˆ·ç«¯ä½¿ç”¨çš„æ—¶å€™ï¼Œå°±éœ€è¦æ‰‹åŠ¨å»é€ä¸ªsetä¸‹çº§å¤„ç†å™¨ï¼Œæ‰‹è¯¯å¾ˆå®¹æ˜“é€ æˆå¤„ç†å™¨æ­»å¾ªç¯çš„æƒ…å†µï¼Œä¹Ÿå¯èƒ½å‡ºç°ç¼ºå¤±æŸä¸ªå¤„ç†å™¨çš„æƒ…å†µï¼Œå› è€Œæœ¬æ–‡å‚ç…§Tomcatæºç ä¸­Filterçš„ä½œæ³•ï¼Œå¼•å…¥äº†Chainç±»ï¼Œç»Ÿä¸€å¯¹å¤„ç†å™¨å°è£…ä¸ºé“¾ï¼Œå‡å°‘å®¢æˆ·ç«¯ä½¿ç”¨æ—¶å‡ºé”™çš„å¯èƒ½ã€‚</p><p>é“¾å¼å¤„ç†çš„å¥½å¤„åœ¨äºå¢åŠ å‡å°‘æ–°çš„å¤„ç†å™¨ä¸ä¼šå½±å“å…¶ä»–å¤„ç†å™¨çš„é€»è¾‘ï¼Œå„ä¸ªå¤„ç†å™¨ä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼Œå¯ä»¥å‡å°è€¦åˆå¸¦æ¥çš„å½±å“ã€‚</p><blockquote><p>å‚è€ƒ<a href="http://nullpointer.pw/design-patterns-chain-responsibility.html" target="_blank" rel="noopener">è®¾è®¡æ¨¡å¼ä¹‹è´£ä»»é“¾æ¨¡å¼å®æˆ˜</a></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
            <tag> è´£ä»»é“¾æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQLçš„bin-log</title>
      <link href="/post/d1d9a9.html"/>
      <url>/post/d1d9a9.html</url>
      
        <content type="html"><![CDATA[<h6 id="ä»€ä¹ˆæ˜¯binlogï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯binlogï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯binlogï¼Ÿ"></a>ä»€ä¹ˆæ˜¯binlogï¼Ÿ</h6><p>mysql-binlogæ˜¯MySQLæ•°æ®åº“çš„äºŒè¿›åˆ¶æ—¥å¿—ï¼Œç”¨äºè®°å½•ç”¨æˆ·å¯¹æ•°æ®åº“æ“ä½œçš„SQLè¯­å¥ï¼ˆé™¤äº†æ•°æ®æŸ¥è¯¢è¯­å¥ï¼Œå³è®°å½•insertã€updateã€deleteçš„sqlï¼‰ä¿¡æ¯ã€‚<br>å¯ä»¥ä½¿ç”¨mysqlbinå‘½ä»¤æŸ¥çœ‹äºŒè¿›åˆ¶æ—¥å¿—çš„å†…å®¹ã€‚</p><a id="more"></a><h6 id="MySQL-bin-log-çš„æ ¼å¼"><a href="#MySQL-bin-log-çš„æ ¼å¼" class="headerlink" title="MySQL bin-log çš„æ ¼å¼"></a>MySQL bin-log çš„æ ¼å¼</h6><p>binlogçš„æ ¼å¼ä¹Ÿæœ‰ä¸‰ç§ï¼šSTATEMENTã€ROWã€MIXED </p><ul><li><p>1ã€ STATMENTæ¨¡å¼ï¼šåŸºäºSQLè¯­å¥çš„å¤åˆ¶(statement-based replication, SBR)ï¼Œæ¯ä¸€æ¡ä¼šä¿®æ”¹æ•°æ®çš„sqlè¯­å¥ä¼šè®°å½•åˆ°binlogä¸­ã€‚<br>ä¼˜ç‚¹ï¼šä¸éœ€è¦è®°å½•æ¯ä¸€æ¡SQLè¯­å¥ä¸æ¯è¡Œçš„æ•°æ®å˜åŒ–ï¼Œè¿™æ ·å­binlogçš„æ—¥å¿—ä¹Ÿä¼šæ¯”è¾ƒå°‘ï¼Œå‡å°‘äº†ç£ç›˜IOï¼Œæé«˜æ€§èƒ½ã€‚<br>ç¼ºç‚¹ï¼šåœ¨æŸäº›æƒ…å†µä¸‹ä¼šå¯¼è‡´master-slaveä¸­çš„æ•°æ®ä¸ä¸€è‡´(å¦‚sleep()å‡½æ•°ï¼Œ last_insert_id()ï¼Œä»¥åŠuser-defined functions(udf)ç­‰ä¼šå‡ºç°é—®é¢˜)</p></li><li><p>2ã€ROWæ¨¡å¼ï¼šåŸºäºè¡Œçš„å¤åˆ¶(row-based replication, RBR)ï¼šä¸è®°å½•æ¯ä¸€æ¡SQLè¯­å¥çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œä»…éœ€è®°å½•å“ªæ¡æ•°æ®è¢«ä¿®æ”¹äº†ï¼Œä¿®æ”¹æˆäº†ä»€ä¹ˆæ ·å­äº†ã€‚<br>ä¼˜ç‚¹ï¼šä¸ä¼šå‡ºç°æŸäº›ç‰¹å®šæƒ…å†µä¸‹çš„å­˜å‚¨è¿‡ç¨‹ã€æˆ–functionã€æˆ–triggerçš„è°ƒç”¨å’Œè§¦å‘æ— æ³•è¢«æ­£ç¡®å¤åˆ¶çš„é—®é¢˜ã€‚<br>ç¼ºç‚¹ï¼šä¼šäº§ç”Ÿå¤§é‡çš„æ—¥å¿—ï¼Œå°¤å…¶æ˜¯alter tableçš„æ—¶å€™ä¼šè®©æ—¥å¿—æš´æ¶¨ã€‚</p></li><li><p>3ã€MIXEDæ¨¡å¼ï¼šæ··åˆæ¨¡å¼å¤åˆ¶(mixed-based replication, MBR)ï¼šä»¥ä¸Šä¸¤ç§æ¨¡å¼çš„æ··åˆä½¿ç”¨ï¼Œä¸€èˆ¬çš„å¤åˆ¶ä½¿ç”¨STATEMENTæ¨¡å¼ä¿å­˜binlogï¼Œå¯¹äºSTATEMENTæ¨¡å¼æ— æ³•å¤åˆ¶çš„æ“ä½œä½¿ç”¨ROWæ¨¡å¼ä¿å­˜binlogï¼ŒMySQLä¼šæ ¹æ®æ‰§è¡Œçš„SQLè¯­å¥é€‰æ‹©æ—¥å¿—ä¿å­˜æ–¹å¼ã€‚</p></li></ul><h6 id="æœåŠ¡å™¨ä¸Šç”¨å“ªç§æ¨¡å¼å¥½å‘¢ï¼Ÿ"><a href="#æœåŠ¡å™¨ä¸Šç”¨å“ªç§æ¨¡å¼å¥½å‘¢ï¼Ÿ" class="headerlink" title="æœåŠ¡å™¨ä¸Šç”¨å“ªç§æ¨¡å¼å¥½å‘¢ï¼Ÿ"></a>æœåŠ¡å™¨ä¸Šç”¨å“ªç§æ¨¡å¼å¥½å‘¢ï¼Ÿ</h6><p>æˆ‘ä»¬æ¥ä¸¾ä¾‹å­è¯´æ˜ï¼š</p><ul><li><ol><li>insert into xxtable values (x,y,z)ä¸ºä¾‹</li></ol></li></ul><p>å½±å“ï¼š1è¡Œ,ä¸”ä¸ºæ–°å¢1è¡Œ, å¯¹äºå…¶ä»–è¡Œæ²¡æœ‰å½±å“. è¿™ä¸ªæƒ…å†µ,ç”¨rowæ ¼å¼,ç›´æ¥å¤åˆ¶ç£ç›˜ä¸Š1è¡Œçš„æ–°å¢å˜åŒ–ã€‚</p><ul><li><ol start="2"><li>update xxtable set age=21 where name=â€™sssâ€™ä¸ºä¾‹<br>å½±å“ï¼šä¸€èˆ¬ä¹Ÿåªæ˜¯å½±å“1è¡Œ. ç”¨rowä¹Ÿæ¯”è¾ƒåˆé€‚ã€‚</li></ol></li><li><ol start="3"><li>è¿‡å¹´å‘çº¢åŒ…,å…¨å…¬å¸çš„äºº,éƒ½æ¶¨è–ª100å…ƒ.<br>update xxtable set salary=salary+100;<br>å½±å“: è¿™ä¸ªè¯­å¥å¸¦æ¥çš„å½±å“æ˜¯é’ˆå¯¹æ¯ä¸€è¡Œçš„, å› æ­¤ç£ç›˜ä¸Šå¾ˆå¤šrowéƒ½å‘ç”Ÿäº†å˜åŒ–.æ­¤å¤„é€‚åˆç”¨statmentæ ¼å¼çš„æ—¥å¿—.</li></ol></li></ul><p>MySQLåæ¥åˆæä¾›äº†ä¸€ä¸ªæ–°çš„æ··åˆæ¨¡å¼ï¼ˆMIXEDï¼‰ï¼Œå¾ˆå¥½ç†è§£ä¸ºä¸Šè¿°ä¸¤ç§çš„æ¨¡å¼çš„è‡ªç”±åˆ‡æ¢ã€‚Mysqlä¼šæ ¹æ®æ‰§è¡ŒSQLæ¥é€‰æ‹©ä½¿ç”¨STATEMENTè¿˜æ˜¯ROWæ¨¡å¼ã€‚<br>æ‰€ä»¥æˆ‘ä»¬ç”¨è¿™ç§æ¨¡å¼æ˜¯æœ€å¥½çš„ï¼Œèƒ½å…¼é¡¾ä¸¤è€…çš„ä¼˜ç‚¹ã€‚</p><h6 id="MySQLå¦‚ä½•é…ç½®bin-log"><a href="#MySQLå¦‚ä½•é…ç½®bin-log" class="headerlink" title="MySQLå¦‚ä½•é…ç½®bin-log"></a>MySQLå¦‚ä½•é…ç½®bin-log</h6><p>åœ¨MySQLé…ç½®æ–‡ä»¶my.cnfæ–‡ä»¶ä¸­çš„mysqldèŠ‚ä¸­æ·»åŠ ä¸‹é¢çš„é…ç½®æ–‡ä»¶ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line"><span class="comment">#è®¾ç½®æ—¥å¿—æ ¼å¼</span></span><br><span class="line">binlog_format = mixed</span><br><span class="line"></span><br><span class="line"><span class="comment">#è®¾ç½®æ—¥å¿—è·¯å¾„ï¼Œæ³¨æ„è·¯ç»éœ€è¦mysqlç”¨æˆ·æœ‰æƒé™å†™</span></span><br><span class="line">log-bin = /data/mysql/logs/mysql-bin.log</span><br><span class="line"></span><br><span class="line"><span class="comment">#è®¾ç½®binlogæ¸…ç†æ—¶é—´</span></span><br><span class="line">expire_logs_days = 7</span><br><span class="line"></span><br><span class="line"><span class="comment">#binlogæ¯ä¸ªæ—¥å¿—æ–‡ä»¶å¤§å°</span></span><br><span class="line">max_binlog_size = 100m</span><br><span class="line"></span><br><span class="line"><span class="comment">#binlogç¼“å­˜å¤§å°</span></span><br><span class="line">binlog_cache_size = 4m</span><br><span class="line"></span><br><span class="line"><span class="comment">#æœ€å¤§binlogç¼“å­˜å¤§å°</span></span><br><span class="line">max_binlog_cache_size = 512m</span><br></pre></td></tr></table></figure><p>é‡å¯MySQLç”Ÿæ•ˆï¼Œå¦‚æœä¸æ–¹ä¾¿é‡å¯æœåŠ¡ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä¿®æ”¹å¯¹åº”çš„å˜é‡å³å¯ã€‚</p><h6 id="MySQLçš„bin-logå¦‚ä½•æŸ¥çœ‹"><a href="#MySQLçš„bin-logå¦‚ä½•æŸ¥çœ‹" class="headerlink" title="MySQLçš„bin-logå¦‚ä½•æŸ¥çœ‹"></a>MySQLçš„bin-logå¦‚ä½•æŸ¥çœ‹</h6><p>MySQLçš„bin-logæ˜¯äºŒè¿›åˆ¶æ ¼å¼çš„æ— æ³•ç›´æ¥æŸ¥çœ‹ï¼ŒMySQLæä¾›äº†ä¸¤ç§æ–¹å¼è¿›è¡ŒæŸ¥çœ‹ã€‚</p><ul><li>1ã€ ç®€å•æŸ¥çœ‹ show binlog events<br>è¯­æ³• ï¼š<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">BINLOG</span> <span class="keyword">EVENTS</span></span><br><span class="line">[<span class="keyword">IN</span> <span class="string">'log_name'</span>]</span><br><span class="line">[<span class="keyword">FROM</span> pos]</span><br><span class="line">[<span class="keyword">LIMIT</span> [<span class="keyword">offset</span>,] <span class="keyword">row_count</span>]</span><br></pre></td></tr></table></figure>åœ¨MySQLå®¢æˆ·ç«¯ä¸­æ‰§è¡Œ<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">mysql&gt; show binlog events in 'mysql-bin.000004' \G</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">   Log_name: mysql-bin.000004</span><br><span class="line">        Pos: 4</span><br><span class="line"> Event_type: Format_desc</span><br><span class="line">  Server_id: 1</span><br><span class="line">End_log_pos: 107</span><br><span class="line">       Info: Server ver: 5.5.48-log, Binlog ver: 4</span><br><span class="line">*************************** 2. row ***************************</span><br><span class="line">   Log_name: mysql-bin.000004</span><br><span class="line">        Pos: 107</span><br><span class="line"> Event_type: Query</span><br><span class="line">  Server_id: 1</span><br><span class="line">End_log_pos: 331</span><br><span class="line">       Info: <span class="keyword">use</span> <span class="string">`db01`</span>; <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`student`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="string">`student_name`</span> <span class="built_in">varchar</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8</span><br><span class="line">*************************** <span class="number">3.</span> <span class="keyword">row</span> ***************************</span><br><span class="line">   Log_name: mysql-<span class="keyword">bin</span><span class="number">.000004</span></span><br><span class="line">        Pos: <span class="number">331</span></span><br><span class="line"> Event_type: <span class="keyword">Query</span></span><br><span class="line">  Server_id: <span class="number">1</span></span><br><span class="line">End_log_pos: <span class="number">399</span></span><br><span class="line">       Info: <span class="keyword">BEGIN</span></span><br><span class="line">*************************** <span class="number">4.</span> <span class="keyword">row</span> ***************************</span><br><span class="line">   Log_name: mysql-<span class="keyword">bin</span><span class="number">.000004</span></span><br><span class="line">        Pos: <span class="number">399</span></span><br><span class="line"> Event_type: Intvar</span><br><span class="line">  Server_id: <span class="number">1</span></span><br><span class="line">End_log_pos: <span class="number">427</span></span><br><span class="line">       Info: INSERT_ID=<span class="number">1</span></span><br><span class="line">*************************** <span class="number">5.</span> <span class="keyword">row</span> ***************************</span><br><span class="line">   Log_name: mysql-<span class="keyword">bin</span><span class="number">.000004</span></span><br><span class="line">        Pos: <span class="number">427</span></span><br><span class="line"> Event_type: <span class="keyword">Query</span></span><br><span class="line">  Server_id: <span class="number">1</span></span><br><span class="line">End_log_pos: <span class="number">563</span></span><br><span class="line">       Info: <span class="keyword">use</span> <span class="string">`db01`</span>; <span class="keyword">insert</span> <span class="keyword">into</span> <span class="string">`db01`</span>.<span class="string">`student`</span> ( <span class="string">`id`</span>, <span class="string">`student_name`</span>) <span class="keyword">values</span> ( <span class="string">'0'</span>, <span class="string">'jim'</span>)</span><br><span class="line">*************************** <span class="number">6.</span> <span class="keyword">row</span> ***************************</span><br><span class="line">   Log_name: mysql-<span class="keyword">bin</span><span class="number">.000004</span></span><br><span class="line">        Pos: <span class="number">563</span></span><br><span class="line"> Event_type: Xid</span><br><span class="line">  Server_id: <span class="number">1</span></span><br><span class="line">End_log_pos: <span class="number">590</span></span><br><span class="line">       Info: <span class="keyword">COMMIT</span> <span class="comment">/* xid=22 */</span></span><br><span class="line">*************************** <span class="number">7.</span> <span class="keyword">row</span> ***************************</span><br><span class="line">   Log_name: mysql-<span class="keyword">bin</span><span class="number">.000004</span></span><br><span class="line">        Pos: <span class="number">590</span></span><br><span class="line"> Event_type: <span class="keyword">Query</span></span><br><span class="line">  Server_id: <span class="number">1</span></span><br><span class="line">End_log_pos: <span class="number">842</span></span><br><span class="line">       Info: <span class="keyword">use</span> <span class="string">`db02`</span>; <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`student`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="string">`student_name`</span> <span class="built_in">varchar</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`birthday`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8</span><br><span class="line">*************************** <span class="number">8.</span> <span class="keyword">row</span> ***************************</span><br><span class="line">   Log_name: mysql-<span class="keyword">bin</span><span class="number">.000004</span></span><br><span class="line">        Pos: <span class="number">842</span></span><br><span class="line"> Event_type: <span class="keyword">Query</span></span><br><span class="line">  Server_id: <span class="number">1</span></span><br><span class="line">End_log_pos: <span class="number">910</span></span><br><span class="line">       Info: <span class="keyword">BEGIN</span></span><br><span class="line">*************************** <span class="number">9.</span> <span class="keyword">row</span> ***************************</span><br><span class="line">   Log_name: mysql-<span class="keyword">bin</span><span class="number">.000004</span></span><br><span class="line">        Pos: <span class="number">910</span></span><br><span class="line"> Event_type: Intvar</span><br><span class="line">  Server_id: <span class="number">1</span></span><br><span class="line">End_log_pos: <span class="number">938</span></span><br><span class="line">       Info: INSERT_ID=<span class="number">2</span></span><br><span class="line">*************************** <span class="number">10.</span> <span class="keyword">row</span> ***************************</span><br><span class="line">   Log_name: mysql-<span class="keyword">bin</span><span class="number">.000004</span></span><br><span class="line">        Pos: <span class="number">938</span></span><br><span class="line"> Event_type: <span class="keyword">Query</span></span><br><span class="line">  Server_id: <span class="number">1</span></span><br><span class="line">End_log_pos: <span class="number">1077</span></span><br><span class="line">       Info: <span class="keyword">use</span> <span class="string">`db01`</span>; <span class="keyword">insert</span> <span class="keyword">into</span> <span class="string">`db01`</span>.<span class="string">`student`</span> ( <span class="string">`id`</span>, <span class="string">`student_name`</span>) <span class="keyword">values</span> ( <span class="string">'0'</span>, <span class="string">'åˆ˜æ´‹'</span>)</span><br><span class="line">*************************** <span class="number">11.</span> <span class="keyword">row</span> ***************************</span><br><span class="line">   Log_name: mysql-<span class="keyword">bin</span><span class="number">.000004</span></span><br><span class="line">        Pos: <span class="number">1077</span></span><br><span class="line"> Event_type: Xid</span><br><span class="line">  Server_id: <span class="number">1</span></span><br><span class="line">End_log_pos: <span class="number">1104</span></span><br><span class="line">       Info: <span class="keyword">COMMIT</span> <span class="comment">/* xid=128 */</span></span><br><span class="line">*************************** <span class="number">12.</span> <span class="keyword">row</span> ***************************</span><br><span class="line">   Log_name: mysql-<span class="keyword">bin</span><span class="number">.000004</span></span><br><span class="line">        Pos: <span class="number">1104</span></span><br><span class="line"> Event_type: <span class="keyword">Query</span></span><br><span class="line">  Server_id: <span class="number">1</span></span><br><span class="line">End_log_pos: <span class="number">1172</span></span><br><span class="line">       Info: <span class="keyword">BEGIN</span></span><br><span class="line">*************************** <span class="number">13.</span> <span class="keyword">row</span> ***************************</span><br><span class="line">   Log_name: mysql-<span class="keyword">bin</span><span class="number">.000004</span></span><br><span class="line">        Pos: <span class="number">1172</span></span><br><span class="line"> Event_type: Intvar</span><br><span class="line">  Server_id: <span class="number">1</span></span><br><span class="line">End_log_pos: <span class="number">1200</span></span><br><span class="line">       Info: INSERT_ID=<span class="number">3</span></span><br><span class="line">*************************** <span class="number">14.</span> <span class="keyword">row</span> ***************************</span><br><span class="line">   Log_name: mysql-<span class="keyword">bin</span><span class="number">.000004</span></span><br><span class="line">        Pos: <span class="number">1200</span></span><br><span class="line"> Event_type: <span class="keyword">Query</span></span><br><span class="line">  Server_id: <span class="number">1</span></span><br><span class="line">End_log_pos: <span class="number">1342</span></span><br><span class="line">       Info: <span class="keyword">use</span> <span class="string">`db01`</span>; <span class="keyword">insert</span> <span class="keyword">into</span> <span class="string">`db01`</span>.<span class="string">`student`</span> ( <span class="string">`id`</span>, <span class="string">`student_name`</span>) <span class="keyword">values</span> ( <span class="string">'0'</span>, <span class="string">'å¼ ä»å®¹'</span>)</span><br><span class="line">*************************** <span class="number">15.</span> <span class="keyword">row</span> ***************************</span><br><span class="line">   Log_name: mysql-<span class="keyword">bin</span><span class="number">.000004</span></span><br><span class="line">        Pos: <span class="number">1342</span></span><br><span class="line"> Event_type: Xid</span><br><span class="line">  Server_id: <span class="number">1</span></span><br><span class="line">End_log_pos: <span class="number">1369</span></span><br><span class="line">       Info: <span class="keyword">COMMIT</span> <span class="comment">/* xid=146 */</span></span><br><span class="line"><span class="number">15</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure></li></ul><p>å…¶å®æˆ‘åœ¨14å’Œ15è¡Œä¹‹é—´ï¼Œè¿›è¡Œäº†ä¸€æ¬¡SelectæŸ¥è¯¢ï¼Œä½†æ˜¯è¿™ä¸ªæ“ä½œåœ¨bin-logä¸­å¹¶æ²¡æœ‰å‘ç°ï¼Œå°è¯äº†å¼€å¤´è¯´çš„bin-logä¸è®°å½•SelectæŸ¥è¯¢ã€‚</p><p><strong>ä¸Šè¿°å‡ºç°çš„å‚æ•°è§£é‡Šï¼š</strong></p><ul><li>Log_name:The name of the file that is being listed.</li><li>Posï¼šThe position at which the event occurs.</li><li>Event_typeï¼šAn identifier that describes the event type.</li><li>Server_idï¼šThe server ID of the server on which the event originated.</li><li>End_log_posï¼šThe position at which the next event begins, which is equal to Pos plus the size of the event.</li><li>Infoï¼šMore detailed information about the event type. The format of this information depends on the event type.</li></ul><ul><li><p>1ã€ è¯¦ç»†æŸ¥çœ‹ mysqlbinlog</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¯­æ³•ï¼š mysqlbinlog [bin-log-name]</span><br></pre></td></tr></table></figure></li><li><p>é—®é¢˜1ï¼šæ— æ³•è¯†åˆ«çš„ç¼–ç </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Sam-Mac:data Sam$ /usr/local/mysql/bin/mysqlbinlog  ./mysql-bin.000004</span><br><span class="line">/usr/local/mysql/bin/mysqlbinlog: unknown variable 'default-character-set=utf8'</span><br></pre></td></tr></table></figure><p>åŸå› ï¼š mysqlbinlogè¿™ä¸ªå·¥å…·æ— æ³•è¯†åˆ«binlogä¸­çš„é…ç½®ä¸­çš„default-character-set=utf8mb4è¿™ä¸ªæŒ‡ä»¤ï¼Œä½¿ç”¨å‚æ•°â€“no-defaults</p></li><li><p>é—®é¢˜2ï¼šbin-logæ—¥å¿—æ–‡ä»¶ä¸å­˜åœ¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/mysql/bin/mysqlbinlog: File './mysql-bin.000004' not found (Errcode: 13)</span><br></pre></td></tr></table></figure><p>åŸå› ï¼šæƒé™é—®é¢˜ä½¿ç”¨sudo</p></li></ul><p><strong>æœ€ç»ˆå‘½ä»¤ï¼š sudo /usr/local/mysql/bin/mysqlbinlog â€“no-defaults /usr/local/mysql/data/mysql-bin.000004</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">Sam-Mac:data Sam$ sudo /usr/local/mysql/bin/mysqlbinlog <span class="comment">--no-defaults /usr/local/mysql/data/mysql-bin.000004</span></span><br><span class="line"><span class="comment">/*!50530 SET @@SESSION.PSEUDO_SLAVE_MODE=1*/</span>;</span><br><span class="line"><span class="comment">/*!40019 SET @@session.max_insert_delayed_threads=0*/</span>;</span><br><span class="line"><span class="comment">/*!50003 SET @OLD_COMPLETION_TYPE=@@COMPLETION_TYPE,COMPLETION_TYPE=0*/</span>;</span><br><span class="line">DELIMITER <span class="comment">/*!*/</span>;</span><br><span class="line"><span class="comment"># at 4</span></span><br><span class="line"><span class="comment">#200315 13:18:28 server id 1  end_log_pos 107 Start: binlog v 4, server v 5.5.48-log created 200315 13:18:28 at startup</span></span><br><span class="line"><span class="comment"># Warning: this binlog is either in use or was not closed properly.</span></span><br><span class="line"><span class="keyword">ROLLBACK</span><span class="comment">/*!*/</span>;</span><br><span class="line">BINLOG '</span><br><span class="line">pLptXg8BAAAAZwAAAGsAAAABAAQANS41LjQ4LWxvZwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAACkum1eEzgNAAgAEgAEBAQEEgAAVAAEGggAAAAICAgCAA==</span><br><span class="line">'<span class="comment">/*!*/</span>;</span><br><span class="line"><span class="comment"># at 107</span></span><br><span class="line"><span class="comment">#200315 13:21:09 server id 1  end_log_pos 331 Querythread_id=5exec_time=0error_code=0</span></span><br><span class="line"><span class="keyword">use</span> <span class="string">`db01`</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="keyword">SET</span> <span class="built_in">TIMESTAMP</span>=<span class="number">1584249669</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="keyword">SET</span> @@session.pseudo_thread_id=<span class="number">5</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="keyword">SET</span> @@session.foreign_key_checks=<span class="number">1</span>, @@session.sql_auto_is_null=<span class="number">0</span>, @@session.unique_checks=<span class="number">1</span>, @@session.autocommit=<span class="number">1</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="keyword">SET</span> @@session.sql_mode=<span class="number">0</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="keyword">SET</span> @@session.auto_increment_increment=<span class="number">1</span>, @@session.auto_increment_offset=<span class="number">1</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="comment">/*!\C utf8 */</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="keyword">SET</span> @@session.character_set_client=<span class="number">33</span>,@@session.collation_connection=<span class="number">33</span>,@@session.collation_server=<span class="number">33</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="keyword">SET</span> @@session.lc_time_names=<span class="number">0</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="keyword">SET</span> @@session.collation_database=<span class="keyword">DEFAULT</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`student`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="string">`student_name`</span> <span class="built_in">varchar</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8</span><br><span class="line"><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="comment"># at 331</span></span><br><span class="line"><span class="comment">#200315 13:22:39 server id 1  end_log_pos 399 Querythread_id=59exec_time=0error_code=0</span></span><br><span class="line"><span class="keyword">SET</span> <span class="built_in">TIMESTAMP</span>=<span class="number">1584249759</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="comment"># at 399</span></span><br><span class="line"><span class="comment">#200315 13:22:39 server id 1  end_log_pos 427 Intvar</span></span><br><span class="line"><span class="keyword">SET</span> INSERT_ID=<span class="number">1</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="comment"># at 427</span></span><br><span class="line"><span class="comment">#200315 13:22:39 server id 1  end_log_pos 563 Querythread_id=59exec_time=0error_code=0</span></span><br><span class="line"><span class="keyword">SET</span> <span class="built_in">TIMESTAMP</span>=<span class="number">1584249759</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="string">`db01`</span>.<span class="string">`student`</span> ( <span class="string">`id`</span>, <span class="string">`student_name`</span>) <span class="keyword">values</span> ( <span class="string">'0'</span>, <span class="string">'jim'</span>)</span><br><span class="line"><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="comment"># at 563</span></span><br><span class="line"><span class="comment">#200315 13:22:39 server id 1  end_log_pos 590 Xid = 22</span></span><br><span class="line"><span class="keyword">COMMIT</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="comment"># at 590</span></span><br><span class="line"><span class="comment">#200315 13:25:56 server id 1  end_log_pos 842 Querythread_id=5exec_time=0error_code=0</span></span><br><span class="line"><span class="keyword">use</span> <span class="string">`db02`</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="keyword">SET</span> <span class="built_in">TIMESTAMP</span>=<span class="number">1584249956</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`student`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="string">`student_name`</span> <span class="built_in">varchar</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`birthday`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8</span><br><span class="line"><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="comment"># at 842</span></span><br><span class="line"><span class="comment">#200315 16:36:37 server id 1  end_log_pos 910 Querythread_id=1201exec_time=0error_code=0</span></span><br><span class="line"><span class="keyword">SET</span> <span class="built_in">TIMESTAMP</span>=<span class="number">1584261397</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="comment"># at 910</span></span><br><span class="line"><span class="comment">#200315 16:36:37 server id 1  end_log_pos 938 Intvar</span></span><br><span class="line"><span class="keyword">SET</span> INSERT_ID=<span class="number">2</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="comment"># at 938</span></span><br><span class="line"><span class="comment">#200315 16:36:37 server id 1  end_log_pos 1077 Querythread_id=1201exec_time=0error_code=0</span></span><br><span class="line"><span class="keyword">use</span> <span class="string">`db01`</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="keyword">SET</span> <span class="built_in">TIMESTAMP</span>=<span class="number">1584261397</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="string">`db01`</span>.<span class="string">`student`</span> ( <span class="string">`id`</span>, <span class="string">`student_name`</span>) <span class="keyword">values</span> ( <span class="string">'0'</span>, <span class="string">'åˆ˜æ´‹'</span>)</span><br><span class="line"><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="comment"># at 1077</span></span><br><span class="line"><span class="comment">#200315 16:36:37 server id 1  end_log_pos 1104 Xid = 128</span></span><br><span class="line"><span class="keyword">COMMIT</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="comment"># at 1104</span></span><br><span class="line"><span class="comment">#200315 16:37:09 server id 1  end_log_pos 1172 Querythread_id=1201exec_time=0error_code=0</span></span><br><span class="line"><span class="keyword">SET</span> <span class="built_in">TIMESTAMP</span>=<span class="number">1584261429</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="comment"># at 1172</span></span><br><span class="line"><span class="comment">#200315 16:37:09 server id 1  end_log_pos 1200 Intvar</span></span><br><span class="line"><span class="keyword">SET</span> INSERT_ID=<span class="number">3</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="comment"># at 1200</span></span><br><span class="line"><span class="comment">#200315 16:37:09 server id 1  end_log_pos 1342 Querythread_id=1201exec_time=0error_code=0</span></span><br><span class="line"><span class="keyword">SET</span> <span class="built_in">TIMESTAMP</span>=<span class="number">1584261429</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="string">`db01`</span>.<span class="string">`student`</span> ( <span class="string">`id`</span>, <span class="string">`student_name`</span>) <span class="keyword">values</span> ( <span class="string">'0'</span>, <span class="string">'å¼ ä»å®¹'</span>)</span><br><span class="line"><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="comment"># at 1342</span></span><br><span class="line"><span class="comment">#200315 16:37:09 server id 1  end_log_pos 1369 Xid = 146</span></span><br><span class="line"><span class="keyword">COMMIT</span><span class="comment">/*!*/</span>;</span><br><span class="line">DELIMITER ;</span><br><span class="line"><span class="comment"># End of log file</span></span><br><span class="line"><span class="keyword">ROLLBACK</span> <span class="comment">/* added by mysqlbinlog */</span>;</span><br><span class="line"><span class="comment">/*!50003 SET COMPLETION_TYPE=@OLD_COMPLETION_TYPE*/</span>;</span><br><span class="line"><span class="comment">/*!50530 SET @@SESSION.PSEUDO_SLAVE_MODE=0*/</span>;</span><br><span class="line">Sam-Mac:data Sam$</span><br></pre></td></tr></table></figure><h6 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h6><p>æ— è®ºæ˜¯å¢é‡å¤‡ä»½è¿˜æ˜¯ä¸»ä»å¤åˆ¶ï¼Œéƒ½æ˜¯éœ€è¦å¼€å¯mysql-binlogæ—¥å¿—ï¼Œæœ€å¥½è·Ÿæ•°æ®ç›®å½•è®¾ç½®åˆ°ä¸åŒçš„ç£ç›˜åˆ†åŒºï¼Œå¯ä»¥é™ä½ioç­‰å¾…ï¼Œæå‡æ€§èƒ½ï¼›<br>å¹¶ä¸”åœ¨ç£ç›˜æ•…éšœçš„æ—¶å€™å¯ä»¥åˆ©ç”¨mysql-binlogæ¢å¤æ•°æ®ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> mysql </tag>
            
            <tag> binlog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL åˆ é™¤ relay log çš„æ–¹æ³•</title>
      <link href="/post/da13f861.html"/>
      <url>/post/da13f861.html</url>
      
        <content type="html"><![CDATA[<h6 id="æ–¹æ³•1-ï¼šè‡ªåŠ¨-è®¾ç½®å‚æ•°-relay-log-purge-1"><a href="#æ–¹æ³•1-ï¼šè‡ªåŠ¨-è®¾ç½®å‚æ•°-relay-log-purge-1" class="headerlink" title="æ–¹æ³•1 ï¼šè‡ªåŠ¨ è®¾ç½®å‚æ•° relay_log_purge = 1"></a>æ–¹æ³•1 ï¼šè‡ªåŠ¨ è®¾ç½®å‚æ•° relay_log_purge = 1</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> SET GLOBAL relay_log_purge = 1;</span></span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line">æˆ–è€…åœ¨/etc/my.cnf [mysqld]æ¨¡å—ä¸‹é¢å¢åŠ ä»¥ä¸‹å†…å®¹</span><br><span class="line">relay-log-purge = 1</span><br></pre></td></tr></table></figure><a id="more"></a><p>è¿™ä¸ªå‚æ•°éœ€è¦é‡å¯æ•°æ®åº“æ‰å¯ç”Ÿæ•ˆã€‚é»˜è®¤æƒ…å†µä¸‹relay-log-purge æ˜¯å¼€å¯çš„ã€‚<br>å¦‚æœä½ å¯¹ä»æ•°æ®åº“è¦æ±‚ä¸é«˜ï¼Œå¯ä»¥å°†relay_log_purge = 1ã€‚<br>å¦‚æœæ•°æ®åº“è¦æ‰‹åŠ¨åˆ é™¤relay logè¯·æ‰§è¡Œ SET GLOBAL relay_log_purge=0ã€‚<br>æˆ–è€…åœ¨/etc/my.cnf</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> [mysqld]æ¨¡å—ä¸‹é¢å¢åŠ ä»¥ä¸‹å†…å®¹</span></span><br><span class="line">relay-log-purge = 0</span><br></pre></td></tr></table></figure><p>æ¨¡æ‹Ÿåœºæ™¯ï¼š<br>1ï¼‰ä»åº“æŸ¥çœ‹relay logæƒ…å†µ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@aliyun1212 data]# ll</span><br><span class="line">total 5255240</span><br><span class="line">-rw-r----- 1 mysql mysql         56 Aug 18 15:40 auto.cnf</span><br><span class="line">-rw-r----- 1 mysql mysql        207 Aug 23 16:06 mysqld-relay-bin.000032</span><br><span class="line">-rw-r----- 1 mysql mysql        344 Aug 23 18:14 mysqld-relay-bin.000033</span><br><span class="line">-rw-r----- 1 mysql mysql        207 Aug 23 18:14 mysqld-relay-bin.000034</span><br><span class="line">-rw-r----- 1 mysql mysql        321 Aug 23 18:14 mysqld-relay-bin.000035</span><br><span class="line">-rw-r----- 1 mysql mysql        100 Aug 23 18:14 mysqld-relay-bin.index</span><br></pre></td></tr></table></figure><p>2ï¼‰ä»åº“æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> SET GLOBAL relay_log_purge = 1;</span></span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> show variables like <span class="string">'relay_log_purge'</span>;</span></span><br><span class="line">+-----------------+-------+</span><br><span class="line">| Variable_name   | Value |</span><br><span class="line">+-----------------+-------+</span><br><span class="line">| relay_log_purge | ON    |</span><br><span class="line">+-----------------+-------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure><p>3ï¼‰ä¸»åº“æ‰§è¡Œflush logs;</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> flush logs;</span></span><br><span class="line">Query OK, 0 rows affected (0.12 sec)</span><br></pre></td></tr></table></figure><p>ç”Ÿæˆæ–°çš„binlog<br>4ï¼‰ä»åº“æŸ¥çœ‹relay log æƒ…å†µ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@aliyun1212 data]# ll</span><br><span class="line">total 5255232</span><br><span class="line">-rw-r----- 1 mysql mysql         56 Aug 18 15:40 auto.cnf</span><br><span class="line">-rw-r----- 1 mysql mysql        255 Aug 26 03:16 mysqld-relay-bin.000036</span><br><span class="line">-rw-r----- 1 mysql mysql        369 Aug 26 03:16 mysqld-relay-bin.000037</span><br><span class="line">-rw-r----- 1 mysql mysql         50 Aug 26 03:16 mysqld-relay-bin.index</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ä»åº“çš„relay log è‡ªåŠ¨åˆ é™¤åªä¿ç•™æœ€è¿‘çš„ä¸¤ä¸ªrelay logã€‚è¯´æ˜ä¸‹å¦‚æœä»åº“åŒæ­¥å‡ºç°é—®é¢˜ï¼Œæ²¡æœ‰åº”ç”¨çš„relay log ä¹Ÿä¸ä¼šè‡ªåŠ¨åˆ é™¤relay logã€‚ç›´åˆ°è§£å†³æ‰é”™è¯¯ï¼Œå¦åˆ™relay log ä¼šè¶ŠæŒ¤è¶Šå¤šã€‚</p><h6 id="æ–¹æ³•2ï¼šæ‰‹åŠ¨-rm-rf-åˆ é™¤reloy-log"><a href="#æ–¹æ³•2ï¼šæ‰‹åŠ¨-rm-rf-åˆ é™¤reloy-log" class="headerlink" title="æ–¹æ³•2ï¼šæ‰‹åŠ¨ rm -rf åˆ é™¤reloy log"></a>æ–¹æ³•2ï¼šæ‰‹åŠ¨ rm -rf åˆ é™¤reloy log</h6><p>1ï¼‰æŸ¥çœ‹ä»åº“</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@aliyun1212 data]# ll</span><br><span class="line">total 5255256</span><br><span class="line">-rw-r----- 1 mysql mysql         56 Aug 18 15:40 auto.cnf</span><br><span class="line">-rw-r----- 1 mysql mysql        255 Aug 26 03:16 mysqld-relay-bin.000036</span><br><span class="line">-rw-r----- 1 mysql mysql        422 Aug 26 03:27 mysqld-relay-bin.000037</span><br><span class="line">-rw-r----- 1 mysql mysql        255 Aug 26 03:27 mysqld-relay-bin.000038</span><br><span class="line">-rw-r----- 1 mysql mysql        683 Aug 26 03:27 mysqld-relay-bin.000039</span><br><span class="line">-rw-r----- 1 mysql mysql        255 Aug 26 03:27 mysqld-relay-bin.000040</span><br><span class="line">-rw-r----- 1 mysql mysql        683 Aug 26 03:27 mysqld-relay-bin.000041</span><br><span class="line">-rw-r----- 1 mysql mysql        255 Aug 26 03:27 mysqld-relay-bin.000042</span><br><span class="line">-rw-r----- 1 mysql mysql        369 Aug 26 03:27 mysqld-relay-bin.000043</span><br><span class="line">-rw-r----- 1 mysql mysql        200 Aug 26 03:27 mysqld-relay-bin.index</span><br></pre></td></tr></table></figure><p>2ï¼‰ä»åº“æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@aliyun1212 data]# rm -rf mysqld-relay-bin.000036 mysqld-relay-bin.37 mysqld-relay-bin.38</span><br><span class="line">[root@aliyun1212 data]# ll</span><br><span class="line">total 5255244</span><br><span class="line">-rw-r----- 1 mysql mysql         56 Aug 18 15:40 auto.cnf</span><br><span class="line">-rw-r----- 1 mysql mysql        683 Aug 26 03:27 mysqld-relay-bin.000039</span><br><span class="line">-rw-r----- 1 mysql mysql        255 Aug 26 03:27 mysqld-relay-bin.000040</span><br><span class="line">-rw-r----- 1 mysql mysql        683 Aug 26 03:27 mysqld-relay-bin.000041</span><br><span class="line">-rw-r----- 1 mysql mysql        255 Aug 26 03:27 mysqld-relay-bin.000042</span><br><span class="line">-rw-r----- 1 mysql mysql        369 Aug 26 03:27 mysqld-relay-bin.000043</span><br><span class="line">-rw-r----- 1 mysql mysql        200 Aug 26 03:27 mysqld-relay-bin.index</span><br></pre></td></tr></table></figure><p>ä»åº“æ“ä½œç³»ç»Ÿå±‚é¢rm relay log ä¸»åº“æ›´æ–°æ•°æ®ä»åº“å¯ä»¥ç»§ç»­åŒæ­¥ï¼š<br>ä¸»åº“æ“ä½œï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> insert into <span class="built_in">test</span> values(13,<span class="string">'ff'</span>);</span></span><br><span class="line">Query OK, 1 row affected (0.44 sec)</span><br></pre></td></tr></table></figure><p>ä»åº“å¯ä»¥çœ‹åˆ°æ•°æ®è¢«åŒæ­¥</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> select * from <span class="built_in">test</span>;</span></span><br><span class="line">+----+------+</span><br><span class="line">| id | name |</span><br><span class="line">+----+------+</span><br><span class="line">|  1 | abc  |</span><br><span class="line">|  4 | cc   |</span><br><span class="line">|  5 | dd   |</span><br><span class="line">|  6 | ee   |</span><br><span class="line">|  7 | ee   |</span><br><span class="line">|  8 | ee   |</span><br><span class="line">|  9 | ff   |</span><br><span class="line">| 10 | ff   |</span><br><span class="line">| 11 | ff   |</span><br><span class="line">| 12 | ff   |</span><br><span class="line">| 13 | ff   |</span><br><span class="line">+----+------+</span><br></pre></td></tr></table></figure><p>å¦‚æœæ­¤æ—¶ stop slave<br>ç„¶ååœ¨æ‰§è¡Œstart slave ,ä¼šæç¤ºä»¥ä¸‹é”™è¯¯ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> start slave;</span></span><br><span class="line">ERROR 1872 (HY000): Slave failed to initialize relay log info structure from the repository</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶è¦æ‰§è¡Œæ­¥éª¤3<br>3ï¼‰ç¼–è¾‘æ–‡ä»¶mysqld-relay-bin.index åˆ é™¤åˆšæ‰åˆ é™¤çš„relay log mysqld-relay-bin.000039ä¹‹å‰çš„ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@aliyun1212 data]# vi mysqld-relay-bin.index </span><br><span class="line">./mysqld-relay-bin.000039</span><br><span class="line">./mysqld-relay-bin.000040</span><br><span class="line">./mysqld-relay-bin.000041</span><br><span class="line">./mysqld-relay-bin.000042</span><br><span class="line">./mysqld-relay-bin.000043</span><br></pre></td></tr></table></figure><p>å†æ¬¡å¯åŠ¨start slave</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> start slave;</span></span><br><span class="line">ERROR 1872 (HY000): Slave failed to initialize relay log info structure from the repository</span><br></pre></td></tr></table></figure><p>è¿˜æ˜¯ä¼šæŠ¥é”™ã€‚<br>æ­¤æ—¶å¿…é¡»é‡å¯ä»åº“mysql æ•°æ®åº“</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@aliyun1212 ~]# service mysql restart</span><br><span class="line">Shutting down MySQL..                                      [  OK  ]</span><br><span class="line">Starting MySQL....                                         [  OK  ]</span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ä»åº“çŠ¶æ€æ­£å¸¸</span></span><br><span class="line"></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> show slave status/G</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> mysql </tag>
            
            <tag> relay-log </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ©ç”¨Macç”µè„‘è‡ªå¸¦åº”ç”¨å°†iPhoneæŠ•å±åˆ°Macç”µè„‘çš„æ•™ç¨‹</title>
      <link href="/post/29afd8a9.html"/>
      <url>/post/29afd8a9.html</url>
      
        <content type="html"><![CDATA[<p>ä½ åªéœ€è¦å‡†å¤‡ä¸€æ ¹USBæ•°æ®çº¿ï¼Œä¹Ÿå°±æ˜¯æ‰‹æœºçš„å……ç”µçº¿å³å¯ï¼Œæœ€å¥½æ˜¯åŸè£…çš„USBçº¿ã€‚</p><a id="more"></a><h4 id="æ‰‹æœºé€šè¿‡USBçº¿è¿æ¥ç”µè„‘"><a href="#æ‰‹æœºé€šè¿‡USBçº¿è¿æ¥ç”µè„‘" class="headerlink" title="æ‰‹æœºé€šè¿‡USBçº¿è¿æ¥ç”µè„‘"></a>æ‰‹æœºé€šè¿‡USBçº¿è¿æ¥ç”µè„‘</h4><p>å¦‚æœæ‰‹æœºæ˜¯ç¬¬ä¸€æ¬¡æ’ä¸Šè¿™å°ç”µè„‘å¯èƒ½ä¼šå¼¹å‡ºä¿¡ä»»ç­‰å¼¹æ¡†ï¼Œæ‰‹æœºç«¯ç‚¹å‡»ã€ä¿¡ä»»ã€‘ï¼Œç”µè„‘ç«¯ç‚¹å‡»ã€ç»§ç»­ã€‘ã€‚<br>æ€»çš„æ¥è¯´ï¼Œå°±æ˜¯å…è®¸ç”µè„‘è®¿é—®æ‰‹æœºã€‚</p><h4 id="æ‰“å¼€Mac-ç³»ç»Ÿè‡ªå¸¦çš„æ’­æ”¾å™¨QuickTime-Player"><a href="#æ‰“å¼€Mac-ç³»ç»Ÿè‡ªå¸¦çš„æ’­æ”¾å™¨QuickTime-Player" class="headerlink" title="æ‰“å¼€Mac ç³»ç»Ÿè‡ªå¸¦çš„æ’­æ”¾å™¨QuickTime Player"></a>æ‰“å¼€Mac ç³»ç»Ÿè‡ªå¸¦çš„æ’­æ”¾å™¨QuickTime Player</h4><p>ç›´æ¥command + ç©ºæ ¼é”® è°ƒå‡ºSpotLight æœç´¢ â€œQuickTimeâ€ï¼Œå³å¯è°ƒå‡ºQuickTime Playeræ’­æ”¾å™¨ã€‚</p><h4 id="èœå•æ ã€æ–‡ä»¶ã€‘â€“-gt-ã€æ–°å»ºå½±ç‰‡å½•åˆ¶ã€‘"><a href="#èœå•æ ã€æ–‡ä»¶ã€‘â€“-gt-ã€æ–°å»ºå½±ç‰‡å½•åˆ¶ã€‘" class="headerlink" title="èœå•æ ã€æ–‡ä»¶ã€‘â€“&gt;ã€æ–°å»ºå½±ç‰‡å½•åˆ¶ã€‘"></a>èœå•æ ã€æ–‡ä»¶ã€‘â€“&gt;ã€æ–°å»ºå½±ç‰‡å½•åˆ¶ã€‘</h4><p>æ‰“å¼€ã€QuickTime Playerã€‘åï¼Œåœ¨å·¦ä¸Šè§’çš„èœå•æ ä¸­ã€æ–‡ä»¶ã€‘èœå•ï¼Œæ‰¾åˆ°ç¬¬ä¸€é¡¹ã€æ–°å»ºå½±ç‰‡å½•åˆ¶ã€‘ã€‚</p><h4 id="æ›´æ”¹æ‘„åƒå¤´é€‰é¡¹ï¼Œé€‰ä¸­æ‰‹æœºå³å¯ã€‚"><a href="#æ›´æ”¹æ‘„åƒå¤´é€‰é¡¹ï¼Œé€‰ä¸­æ‰‹æœºå³å¯ã€‚" class="headerlink" title="æ›´æ”¹æ‘„åƒå¤´é€‰é¡¹ï¼Œé€‰ä¸­æ‰‹æœºå³å¯ã€‚"></a>æ›´æ”¹æ‘„åƒå¤´é€‰é¡¹ï¼Œé€‰ä¸­æ‰‹æœºå³å¯ã€‚</h4><p>ç‚¹å‡»ã€æ–°å»ºå½±ç‰‡å½•åˆ¶ã€‘åï¼Œæ­¤æ—¶é»˜è®¤æ˜¯æ‰“å¼€çš„ç”µè„‘è‡ªå¸¦çš„æ‘„åƒå¤´ï¼Œæ­¤æ—¶å¯ä»¥æ›´æ–°æ‘„åƒå¤´çš„æ¥æºå’Œéº¦å…‹é£æ¥æºã€‚<br>æ¨èç›¸æœºé€‰æ‹©iPhoneçš„ï¼Œéº¦å…‹é£é€‰æ‹©å†…ç½®éº¦å…‹é£ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> MAC </tag>
            
            <tag> iPhone </tag>
            
            <tag> æŠ•å± </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JVMé…ç½®å‚æ•°çš„ç±»å‹</title>
      <link href="/post/ea8be9c5.html"/>
      <url>/post/ea8be9c5.html</url>
      
        <content type="html"><![CDATA[<h5 id="å‚æ•°åç§°çš„è¯´æ˜"><a href="#å‚æ•°åç§°çš„è¯´æ˜" class="headerlink" title="å‚æ•°åç§°çš„è¯´æ˜"></a>å‚æ•°åç§°çš„è¯´æ˜</h5><p>JVMé…ç½®å‚æ•°åˆ†åˆ«ç”¨äºè·Ÿè¸ªç›‘æ§JVMçŠ¶æ€ï¼Œåˆ†é…å †å†…å­˜ä»¥åŠåˆ†é…æ ˆå†…å­˜ã€‚æŒ‰ç…§ç±»å‹åˆ†ä¸ºä¸‰ç±»æ ‡å‡†å‚æ•°ã€éæ ‡å‡†å‚æ•°å’Œéç¨³å®šå‚æ•°</p><a id="more"></a><h6 id="æ ‡å‡†å‚æ•°"><a href="#æ ‡å‡†å‚æ•°" class="headerlink" title="æ ‡å‡†å‚æ•°(-)"></a>æ ‡å‡†å‚æ•°(-)</h6><p>æ‰€æœ‰ JVM éƒ½å¿…é¡»æ”¯æŒè¿™äº›å‚æ•°çš„åŠŸèƒ½, è€Œä¸”å‘åå…¼å®¹, å¦‚:</p><ul><li><p>-client : è®¾ç½® JVM ä½¿ç”¨ client æ¨¡å¼, ç‰¹ç‚¹æ˜¯å¯åŠ¨é€Ÿåº¦æ¯”è¾ƒå¿«, ä½†è¿è¡Œæ—¶æ€§èƒ½å’Œå†…å­˜ç®¡ç†æ•ˆç‡ä¸é«˜. é€šå¸¸ç”¨äºå®¢æˆ·ç«¯åº”ç”¨ç¨‹åºæˆ–å¼€å‘è°ƒè¯•; åœ¨32ä½ç¯å¢ƒä¸‹ç›´æ¥è¿è¡Œ Java ç¨‹åºé»˜è®¤å¯ç”¨è¯¥æ¨¡å¼.</p></li><li><p>-server : è®¾ç½® JVM ä½¿ server æ¨¡å¼, ç‰¹ç‚¹æ˜¯å¯åŠ¨é€Ÿåº¦æ¯”è¾ƒæ…¢, ä½†è¿è¡Œæ—¶æ€§èƒ½å’Œå†…å­˜ç®¡ç†æ•ˆç‡å¾ˆé«˜, é€‚ç”¨äºç”Ÿäº§ç¯å¢ƒ; åœ¨å…·æœ‰64ä½èƒ½åŠ›çš„JDKç¯å¢ƒä¸‹é»˜è®¤å¯ç”¨è¯¥æ¨¡å¼.</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Sam-Mac:hexo-blog Sam$ java -version</span><br><span class="line">java version <span class="string">"1.8.0_74"</span></span><br><span class="line">Java(TM) SE Runtime Environment (build 1.8.0_74-b02)</span><br><span class="line">Java HotSpot(TM) 64-Bit Server VM (build 25.74-b02, mixed mode)</span><br><span class="line">Sam-Mac:hexo-blog Sam$</span><br></pre></td></tr></table></figure><h6 id="éæ ‡å‡†å‚æ•°-X"><a href="#éæ ‡å‡†å‚æ•°-X" class="headerlink" title="éæ ‡å‡†å‚æ•°(-X)"></a>éæ ‡å‡†å‚æ•°(-X)</h6><p>å„ JVM å‚å•†åº”è¯¥éƒ½å®ç°è¿™äº›å‚æ•°çš„åŠŸèƒ½, ä½†æ˜¯å¹¶ä¸ä¿è¯æ‰€æœ‰çš„ JVM å®ç°éƒ½æ»¡è¶³, ä¸”ä¸ä¿è¯å‘åå…¼å®¹ã€‚è¿™äº›ç”¨çš„ä¸å¤šï¼Œçœ‹çœ‹å°±å¥½ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// è§£é‡Šæ‰§è¡Œ</span><br><span class="line">-Xint</span><br><span class="line"></span><br><span class="line">// ç¬¬ä¸€æ¬¡ä½¿ç”¨å°±ç¼–è¯‘æˆæœ¬åœ°ä»£ç </span><br><span class="line">-Xcomp</span><br><span class="line"></span><br><span class="line">// æ··åˆæ¨¡å¼</span><br><span class="line">-Xmixed</span><br></pre></td></tr></table></figure><h6 id="éç¨³å®šå‚æ•°-XX"><a href="#éç¨³å®šå‚æ•°-XX" class="headerlink" title="éç¨³å®šå‚æ•°(-XX)"></a>éç¨³å®šå‚æ•°(-XX)</h6><p>æ­¤ç±»å‚æ•°å„ä¸ªJVMå®ç°ä¼šæœ‰æ‰€ä¸åŒ, å°†æ¥å¯èƒ½ä¼šä¸è¢«æ”¯æŒ, éœ€è¦æ…é‡ä½¿ç”¨ã€‚è¿™ç§ç±»å‹çš„å‚æ•°è‡ªå·±åˆå¯åˆ†ä¸ºä¸¤ç§ï¼Œåˆ†åˆ«å¦‚ä¸‹ï¼š</p><ul><li><p>å¸ƒå°”ç±»å‹ã€‚ -XX:+ æˆ–è€… - æŸä¸ªå±æ€§å€¼ï¼Œ+ è¡¨ç¤ºå¼€å¯ï¼Œ-è¡¨ç¤ºå…³é—­ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// æ‰“å°GCè¯¦ç»†ä¿¡æ¯</span><br><span class="line">-XX:+PrintGCDetails</span><br><span class="line"></span><br><span class="line">// ä¸æ‰“å°GCè¯¦ç»†ä¿¡æ¯</span><br><span class="line">-XX:-PrintGCDetails</span><br></pre></td></tr></table></figure></li><li><p>KVç±»å‹ã€‚-XX:å±æ€§key=å±æ€§å€¼valueï¼Œä¾‹å¦‚ï¼š</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// è®¾ç½®Metaspaceçš„å¤§å°</span><br><span class="line">-XX:MetaspaceSize=1024m</span><br></pre></td></tr></table></figure><p>æ³¨æ„: åœ¨â€-XX:â€åçš„å‚æ•°è‹¥ä¸éœ€è¦èµ‹å€¼, å³åªæ˜¯ç”¨æ¥é…ç½®å¼€å¯æˆ–å…³é—­ç›¸åº”é€‰é¡¹, åˆ™éœ€è¦æœ‰ â€œ+â€ (å¼€å¯) æˆ– â€œ-â€œ (ç¦æ­¢) , å¦åˆ™åº”ç”¨ç¨‹åºå°†åœ¨æ—¥å¿—æ–‡ä»¶ (å¦‚ Tomcat çš„æ—¥å¿—æ–‡ä»¶ catalina.out ) ä¸­æŠ›å‡ºå¦‚ä¸‹é”™è¯¯:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Missing +/- setting <span class="keyword">for</span> VM option <span class="string">'UseConcMarkSweepGC'</span>. </span><br><span class="line">Error: Could not create the Java Virtual Machine.</span><br><span class="line">Error: A fatal exception has occurred. Program will <span class="built_in">exit</span>.</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡º, è¿™é‡Œç¼ºå°‘äº† â€œ+/-â€œ ç¬¦å·, å¯¼è‡´è™šæ‹Ÿæœºå¯åŠ¨å¼‚å¸¸, ä¿®æ”¹åå³å¯æ­£å¸¸å¯åŠ¨.</p><p>æˆ‘ä»¬å¸¸è®¾ç½®çš„JVMå‚æ•°Xmså’ŒXmx,å±äºå“ªç§ç±»å‹çš„JVMå‚æ•°ï¼Ÿ-Xmsç­‰ä»·äº-XX:InitialHeapSize,-Xmxç­‰ä»·äº-XX:MaxHeapSizeï¼Œæ‰€ä»¥ä»–ä»¬éƒ½æ˜¯XXç±»å‹å‚æ•°ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Jvm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Springé…ç½®æ–‡ä»¶ä¸­çš„classpath:å’Œclasspath*:çš„åŒºåˆ«</title>
      <link href="/post/38b6491c.html"/>
      <url>/post/38b6491c.html</url>
      
        <content type="html"><![CDATA[<p> classpathæ˜¯springçš„å†™æ³•ï¼Œclasspathæ˜¯æŒ‡WEB-INFæ–‡ä»¶å¤¹ä¸‹çš„classesç›®å½•ï¼Œå¯¹åº”æºä»£ç srcç›®å½•ï¼Œç”¨äºå­˜æ”¾ä»srcä¸­æ‹·è´è¿‡å»çš„å„ç§é…ç½®æ–‡ä»¶ï¼Œä»¥åŠç¼–è¯‘è¿‡åçš„classæ–‡ä»¶ã€‚Springå¯ä»¥é€šè¿‡æŒ‡å®šclasspath*:ä¸classpath:å‰ç¼€åŠ ä¸Šè·¯å¾„çš„æ–¹å¼ä»classpathåŠ è½½é…ç½®æ–‡ä»¶ã€‚</p><a id="more"></a><h5 id="classpath-çš„å…·ä½“å«ä¹‰"><a href="#classpath-çš„å…·ä½“å«ä¹‰" class="headerlink" title="classpath: çš„å…·ä½“å«ä¹‰"></a>classpath: çš„å…·ä½“å«ä¹‰</h5><p>classpath:è¡¨ç¤ºä»ç±»è·¯å¾„ä¸­åŠ è½½èµ„æºï¼Œclasspath:å’Œclasspath:/æ˜¯ç­‰ä»·çš„ï¼Œéƒ½æ˜¯ç›¸å¯¹äºç±»çš„æ ¹è·¯å¾„ã€‚èµ„æºæ–‡ä»¶åº“æ ‡å‡†çš„åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œä¹Ÿå¯ä»¥åœ¨JARæˆ–ZIPçš„ç±»åŒ…ä¸­ã€‚</p><h5 id="classpath-çš„å…·ä½“å«ä¹‰-1"><a href="#classpath-çš„å…·ä½“å«ä¹‰-1" class="headerlink" title="classpath*: çš„å…·ä½“å«ä¹‰"></a>classpath*: çš„å…·ä½“å«ä¹‰</h5><p>classpath*:ï¼šå‡è®¾å¤šä¸ªJARåŒ…æˆ–æ–‡ä»¶ç³»ç»Ÿç±»è·¯å¾„éƒ½æœ‰ä¸€ä¸ªç›¸åŒçš„é…ç½®æ–‡ä»¶ï¼Œclasspath:åªä¼šåœ¨ç¬¬ä¸€ä¸ªåŠ è½½çš„ç±»è·¯å¾„ä¸‹æŸ¥æ‰¾ï¼Œè€Œclasspath:ä¼šæ‰«ææ‰€æœ‰è¿™äº›JARåŒ…åŠç±»è·¯å¾„ä¸‹å‡ºç°çš„åŒåæ–‡ä»¶ã€‚</p><h5 id="å…·ä½“ä¾‹å­å¦‚ä¸‹"><a href="#å…·ä½“ä¾‹å­å¦‚ä¸‹" class="headerlink" title="å…·ä½“ä¾‹å­å¦‚ä¸‹"></a>å…·ä½“ä¾‹å­å¦‚ä¸‹</h5><ul><li>classpath:applicationContext.xmlï¼ŒåŒ¹é…classpathä¸‹çš„æŒ‡å®šæ–‡ä»¶         </li><li>classpath:/spring/applicationContext.xmlï¼ŒåŒ¹é…classpathå­ç›®å½•ä¸‹çš„æŒ‡å®šæ–‡ä»¶</li><li>classpath:spring-*.xmlï¼ŒåŒ¹é…classpathä¸‹çš„æŒ‡å®šå‰ç¼€çš„æ–‡ä»¶</li><li>classpath:<em>*/spring-</em>.xmlï¼ŒåŒ¹é…classpathä¸‹æ‰€æœ‰ç›®å½•ä¸‹çš„æŒ‡å®šå‰ç¼€çš„æ–‡ä»¶</li><li>classpath<em>:**/spring-</em>.xmlï¼ŒåŒ¹é…å½“å‰classpathå’Œjarä¸­classpathä¸‹æ‰€æœ‰ç›®å½•ä¸‹çš„æŒ‡å®šå‰ç¼€çš„æ–‡ä»¶</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> spring </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ©ç”¨Docker Composeç®¡ç†æœåŠ¡</title>
      <link href="/post/a5d4c4d4.html"/>
      <url>/post/a5d4c4d4.html</url>
      
        <content type="html"><![CDATA[<h5 id="docker-compose-ç®€ä»‹"><a href="#docker-compose-ç®€ä»‹" class="headerlink" title="docker-compose ç®€ä»‹"></a>docker-compose ç®€ä»‹</h5><p>Composeæ˜¯ç”¨äºå®šä¹‰å’Œè¿è¡Œå¤šå®¹å™¨Dockeråº”ç”¨ç¨‹åºçš„å·¥å…·ã€‚é€šè¿‡Composeï¼Œæ‚¨å¯ä»¥ä½¿ç”¨YMLæ–‡ä»¶æ¥é…ç½®åº”ç”¨ç¨‹åºéœ€è¦çš„æ‰€æœ‰æœåŠ¡ã€‚ç„¶åï¼Œä½¿ç”¨ä¸€ä¸ªå‘½ä»¤ï¼Œå°±å¯ä»¥ä» YML æ–‡ä»¶é…ç½®ä¸­åˆ›å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡ã€‚</p><a id="more"></a><h5 id="docker-compose-ä½¿ç”¨çš„ä¸‰ä¸ªæ­¥éª¤ï¼š"><a href="#docker-compose-ä½¿ç”¨çš„ä¸‰ä¸ªæ­¥éª¤ï¼š" class="headerlink" title="docker-compose ä½¿ç”¨çš„ä¸‰ä¸ªæ­¥éª¤ï¼š"></a>docker-compose ä½¿ç”¨çš„ä¸‰ä¸ªæ­¥éª¤ï¼š</h5><ul><li>ä½¿ç”¨ Dockerfile å®šä¹‰åº”ç”¨ç¨‹åºçš„ç¯å¢ƒã€‚</li><li>ä½¿ç”¨ docker-compose.yml å®šä¹‰æ„æˆåº”ç”¨ç¨‹åºçš„æœåŠ¡ï¼Œè¿™æ ·å®ƒä»¬å¯ä»¥åœ¨éš”ç¦»ç¯å¢ƒä¸­ä¸€èµ·è¿è¡Œã€‚</li><li>æ‰§è¡Œ docker-compose up å‘½ä»¤æ¥å¯åŠ¨å¹¶è¿è¡Œæ•´ä¸ªåº”ç”¨ç¨‹åºã€‚</li></ul><h5 id="docker-compose-å®‰è£…"><a href="#docker-compose-å®‰è£…" class="headerlink" title="docker-compose å®‰è£…"></a>docker-compose å®‰è£…</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#ä»¥centosä¸ºä¾‹</span></span><br><span class="line">yum install -y docker-compose</span><br></pre></td></tr></table></figure><h5 id="ä½¿ç”¨docker-composeç¼–æ’ä¸€ä¸ªjdk8ã€tomcat7ã€mysql5-7å’Œredis3-2çš„å®ä¾‹"><a href="#ä½¿ç”¨docker-composeç¼–æ’ä¸€ä¸ªjdk8ã€tomcat7ã€mysql5-7å’Œredis3-2çš„å®ä¾‹" class="headerlink" title="ä½¿ç”¨docker-composeç¼–æ’ä¸€ä¸ªjdk8ã€tomcat7ã€mysql5.7å’Œredis3.2çš„å®ä¾‹"></a>ä½¿ç”¨docker-composeç¼–æ’ä¸€ä¸ªjdk8ã€tomcat7ã€mysql5.7å’Œredis3.2çš„å®ä¾‹</h5><p>å‡†å¤‡çš„ææ–™å’Œç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p><p>â”œâ”€â”€ docker-compose.yml<br>â””â”€â”€ tomcat7<br>    â”œâ”€â”€ apache-tomcat-7.0.99.zip<br>    â”œâ”€â”€ Dockerfile<br>    â”œâ”€â”€ jdk-8u131-linux-x64.tar.gz<br>    â””â”€â”€ my.cnf</p><p>#æŒ‚åœ¨åˆ°å®¹å™¨çš„ç›®å½•<br>â”œâ”€â”€ mysql<br>â”‚   â”œâ”€â”€ conf<br>â”‚   â”‚   â””â”€â”€ my.cnf<br>â”‚   â”œâ”€â”€ data<br>â”‚   â”œâ”€â”€ init<br>â”‚   â”‚   â”œâ”€â”€ init.sh<br>â”‚   â”‚   â””â”€â”€ mysql_init.sql<br>â”‚   â””â”€â”€ log<br>â””â”€â”€ tomcat7<br>    â”œâ”€â”€ conf<br>    â”‚   â”œâ”€â”€ Catalina<br>    â”‚   â”‚   â””â”€â”€ localhost<br>    â”‚   â”œâ”€â”€ catalina.policy<br>    â”‚   â”œâ”€â”€ catalina.properties<br>    â”‚   â”œâ”€â”€ context.xml<br>    â”‚   â”œâ”€â”€ logging.properties<br>    â”‚   â”œâ”€â”€ server.xml<br>    â”‚   â”œâ”€â”€ tomcat-users.xml<br>    â”‚   â”œâ”€â”€ tomcat-users.xsd<br>    â”‚   â””â”€â”€ web.xml<br>    â”œâ”€â”€ data<br>    â”œâ”€â”€ logs<br>    â””â”€â”€ webapps</p><p>docker-compose.yml çš„å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">"3"</span></span><br><span class="line"><span class="attr">services:</span> </span><br><span class="line">  <span class="attr">samjavawebenv:</span> </span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">javawebenv</span></span><br><span class="line">    <span class="attr">build:</span></span><br><span class="line">       <span class="attr">context:</span> <span class="string">./tomcat7/</span></span><br><span class="line">       <span class="attr">dockerfile:</span> <span class="string">Dockerfile</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">compose-javawebenv:v1</span></span><br><span class="line">    <span class="attr">depends_on:</span> </span><br><span class="line">      <span class="bullet">-</span> <span class="string">mysql</span></span><br><span class="line">    <span class="attr">links:</span> </span><br><span class="line">      <span class="bullet">-</span> <span class="string">mysql</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">redis</span></span><br><span class="line">    <span class="attr">ports:</span> </span><br><span class="line">      <span class="bullet">-</span> <span class="string">"80:80"</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">"443:443"</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">"8080:8080"</span></span><br><span class="line">    <span class="attr">privileged:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">environment:</span> </span><br><span class="line">      <span class="bullet">-</span> <span class="string">Dspring.profiles.active=prod</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">volumes:</span> </span><br><span class="line">      <span class="bullet">-</span> <span class="string">"../../docker-compose/tomcat7/conf:/usr/local/tomcat7/conf"</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">"../../docker-compose/tomcat7/data:/usr/local/tomcat7/data"</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">"../../docker-compose/tomcat7/logs:/usr/local/tomcat7/logs"</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">"../../docker-compose/tomcat7/webapps:/usr/local/tomcat7/webapps"</span></span><br><span class="line">  <span class="attr">mysql:</span> </span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">mysql5.7</span></span><br><span class="line">    <span class="attr">environment:</span> </span><br><span class="line">      <span class="attr">MYSQL_ROOT_HOST:</span> <span class="string">"%"</span></span><br><span class="line">      <span class="attr">MYSQL_HOST:</span> <span class="string">"localhost"</span></span><br><span class="line">      <span class="attr">MYSQL_ROOT_PASSWORD:</span> <span class="string">"xxxx"</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">"mysql:5.7"</span></span><br><span class="line">    <span class="attr">ports:</span> </span><br><span class="line">      <span class="bullet">-</span> <span class="string">"3306:3306"</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">volumes:</span> </span><br><span class="line">      <span class="bullet">-</span> <span class="string">"../../docker-compose/mysql/data:/var/lib/mysql"</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">"../../docker-compose/mysql/conf:/etc/mysql/conf.d"</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">"../../docker-compose/mysql/init:/docker-entrypoint-initdb.d"</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">--default-authentication-plugin=mysql_native_password</span></span><br><span class="line">  <span class="attr">redis:</span> </span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">redis3.2</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">"redis:3.2"</span></span><br><span class="line">    <span class="attr">ports:</span> </span><br><span class="line">      <span class="bullet">-</span> <span class="string">"6380:6379"</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">"redis-server --appendonly yes"</span></span><br></pre></td></tr></table></figure><p>init.shä¸­çš„å†…å®¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">mysql -uroot -pxxx &lt;&lt; EOF</span><br><span class="line"><span class="built_in">source</span> /docker-entrypoint-initdb.d/mysql_init.sql;</span><br></pre></td></tr></table></figure><p>mysql_init.sqlä¸­çš„å†…å®¹</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">use</span> mysql;</span><br><span class="line"><span class="keyword">update</span> <span class="keyword">user</span> <span class="keyword">set</span> authentication_string=<span class="keyword">password</span>(<span class="string">'xxxx'</span>) <span class="keyword">where</span> <span class="keyword">user</span>=<span class="string">'root'</span> <span class="keyword">and</span> host=<span class="string">'localhost'</span>; </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`mysql`</span>.<span class="string">`user`</span> (<span class="string">`Host`</span>, <span class="string">`User`</span>, <span class="string">`Select_priv`</span>, <span class="string">`Insert_priv`</span>, <span class="string">`Update_priv`</span>, <span class="string">`Delete_priv`</span>, <span class="string">`Create_priv`</span>, <span class="string">`Drop_priv`</span>, <span class="string">`Reload_priv`</span>, <span class="string">`Shutdown_p</span></span><br><span class="line"><span class="string">riv`</span>, <span class="string">`Process_priv`</span>, <span class="string">`File_priv`</span>, <span class="string">`Grant_priv`</span>, <span class="string">`References_priv`</span>, <span class="string">`Index_priv`</span>, <span class="string">`Alter_priv`</span>, <span class="string">`Show_db_priv`</span>, <span class="string">`Super_priv`</span>, <span class="string">`Create_tmp_table_priv`</span>, <span class="string">`Lock_t</span></span><br><span class="line"><span class="string">ables_priv`</span>, <span class="string">`Execute_priv`</span>, <span class="string">`Repl_slave_priv`</span>, <span class="string">`Repl_client_priv`</span>, <span class="string">`Create_view_priv`</span>, <span class="string">`Show_view_priv`</span>, <span class="string">`Create_routine_priv`</span>, <span class="string">`Alter_routine_priv`</span>, <span class="string">`Create</span></span><br><span class="line"><span class="string">_user_priv`</span>, <span class="string">`Event_priv`</span>, <span class="string">`Trigger_priv`</span>, <span class="string">`Create_tablespace_priv`</span>, <span class="string">`ssl_type`</span>, <span class="string">`ssl_cipher`</span>, <span class="string">`x509_issuer`</span>, <span class="string">`x509_subject`</span>, <span class="string">`max_questions`</span>, <span class="string">`max_updates`</span>, </span><br><span class="line"><span class="string">`max_connections`</span>, <span class="string">`max_user_connections`</span>, <span class="string">`plugin`</span>, <span class="string">`authentication_string`</span>, <span class="string">`password_expired`</span>, <span class="string">`password_last_changed`</span>, <span class="string">`password_lifetime`</span>, <span class="string">`account_locke</span></span><br><span class="line"><span class="string">d`</span>) <span class="keyword">VALUES</span> (<span class="string">'%'</span>, <span class="string">'xx'</span>, <span class="string">'Y'</span>, <span class="string">'Y'</span>, <span class="string">'Y'</span>, <span class="string">'Y'</span>, <span class="string">'Y'</span>, <span class="string">'Y'</span>, <span class="string">'Y'</span>, <span class="string">'Y'</span>, <span class="string">'Y'</span>, <span class="string">'Y'</span>, <span class="string">'Y'</span>, <span class="string">'Y'</span>, <span class="string">'Y'</span>, <span class="string">'Y'</span>, <span class="string">'Y'</span>, <span class="string">'Y'</span>, <span class="string">'Y'</span>, <span class="string">'Y'</span>, <span class="string">'Y'</span>, <span class="string">'Y'</span>, <span class="string">'Y'</span>, <span class="string">'Y'</span>, <span class="string">'Y'</span>, <span class="string">'Y'</span>, <span class="string">'Y'</span>, <span class="string">'Y'</span>, <span class="string">'Y</span></span><br><span class="line"><span class="string">'</span>, <span class="string">'Y'</span>, <span class="string">'Y'</span>, <span class="string">''</span>, <span class="string">''</span>, <span class="string">''</span>, <span class="string">''</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'mysql_native_password'</span>, <span class="keyword">password</span>(<span class="string">'xxx'</span>), <span class="string">'N'</span>, <span class="string">'2020-01-09 11:41:17'</span>, <span class="literal">NULL</span>, <span class="string">'N'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">flush</span> <span class="keyword">privileges</span>;</span><br></pre></td></tr></table></figure><p>å®¹å™¨é—´è®¿é—®mysqlå’Œredisçš„é“¾æ¥åœ°å€è¦ä¿®æ”¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŠŠä¸»æœºåœ°å€æ¢æˆserviceçš„åå­—</span></span><br><span class="line">jbdc.url=jdbc:mysql://mysql:3306/flash_sale?useUnicode=<span class="literal">true</span>&amp;characterEncoding=utf-8</span><br><span class="line"></span><br><span class="line"><span class="comment">#mysqlçš„ç”¨æˆ·ä¸»æœºä¸º javawebenv.compose_default å³ container_name + compose_default</span></span><br></pre></td></tr></table></figure><h6 id="docker-compose-å‘½ä»¤"><a href="#docker-compose-å‘½ä»¤" class="headerlink" title="docker-compose å‘½ä»¤"></a>docker-compose å‘½ä»¤</h6><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ„å»º</span></span><br><span class="line">docker-compose build</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨</span></span><br><span class="line">docker-compose up</span><br><span class="line"></span><br><span class="line"><span class="comment">#å¦‚æœä½ æƒ³åœ¨åå°æ‰§è¡Œè¯¥æœåŠ¡å¯ä»¥åŠ ä¸Š -d å‚æ•°</span></span><br><span class="line">docker-compose up -d</span><br><span class="line"></span><br><span class="line"><span class="comment">#å…³é—­</span></span><br><span class="line">docker-compose stop</span><br><span class="line"></span><br><span class="line"><span class="comment">#åˆ é™¤</span></span><br><span class="line">docker-compose rm</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šçš„docker-composeå‘½ä»¤éƒ½æ˜¯åœ¨ docker-compose.yml æ–‡ä»¶ç›®å½•ä¸‹æ‰§è¡Œ</p>]]></content>
      
      
      
        <tags>
            
            <tag> docker </tag>
            
            <tag> docker-compose </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æˆ‘å¸¸ç”¨çš„dockeråŸºæœ¬å‘½ä»¤</title>
      <link href="/post/c9b0a620.html"/>
      <url>/post/c9b0a620.html</url>
      
        <content type="html"><![CDATA[<p>docker å®¢æˆ·ç«¯éå¸¸ç®€å• ,æˆ‘ä»¬å¯ä»¥ç›´æ¥è¾“å…¥ docker å‘½ä»¤æ¥æŸ¥çœ‹åˆ° Docker å®¢æˆ·ç«¯çš„æ‰€æœ‰å‘½ä»¤é€‰é¡¹ã€‚å¯ä»¥é€šè¿‡å‘½ä»¤ docker command â€“help æ›´æ·±å…¥çš„äº†è§£æŒ‡å®šçš„ Docker å‘½ä»¤ä½¿ç”¨æ–¹æ³•ã€‚<br>ä¾‹å¦‚æˆ‘ä»¬è¦æŸ¥çœ‹ docker stats æŒ‡ä»¤çš„å…·ä½“ä½¿ç”¨æ–¹æ³•ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker stats --<span class="built_in">help</span></span><br></pre></td></tr></table></figure><a id="more"></a><h6 id="dockeræŸ¥æ‰¾é•œåƒ"><a href="#dockeræŸ¥æ‰¾é•œåƒ" class="headerlink" title="dockeræŸ¥æ‰¾é•œåƒ"></a>dockeræŸ¥æ‰¾é•œåƒ</h6><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥è¯¢é•œåƒ</span></span><br><span class="line">docker search é•œåƒåç§°</span><br><span class="line"></span><br><span class="line"><span class="comment">#dockeræŸ¥æ‰¾å®˜æ–¹åŸç‰ˆé•œåƒ</span></span><br><span class="line">docker search --filter <span class="string">"is-official=true"</span> centos</span><br><span class="line"><span class="comment">#æˆ–è€…</span></span><br><span class="line">docker search -f is-official=<span class="literal">true</span> centos</span><br></pre></td></tr></table></figure><h5 id="docker-å®‰è£…é•œåƒ"><a href="#docker-å®‰è£…é•œåƒ" class="headerlink" title="docker å®‰è£…é•œåƒ"></a>docker å®‰è£…é•œåƒ</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å‘½ä»¤è¯­æ³•</span></span><br><span class="line">docker pull é•œåƒåç§°:æ ‡ç­¾</span><br><span class="line"></span><br><span class="line"><span class="comment">#å®‰è£… tomcat8 </span></span><br><span class="line">docker pull tomcat:8</span><br><span class="line"></span><br><span class="line"><span class="comment">#å®‰è£… mysql5.7 </span></span><br><span class="line">docker pull mysql:5.7</span><br></pre></td></tr></table></figure><h5 id="åˆ é™¤images"><a href="#åˆ é™¤images" class="headerlink" title="åˆ é™¤images"></a>åˆ é™¤images</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#è‹¥åˆ é™¤ä¸æ‰ï¼Œè¯´æ˜æœ‰å®¹å™¨æ­£åœ¨ä½¿ç”¨æ­¤ images</span></span><br><span class="line">docker rmi imgId</span><br><span class="line"></span><br><span class="line"><span class="comment">#å…ˆæ‰§è¡Œ </span></span><br><span class="line">docker rm containerId</span><br><span class="line"></span><br><span class="line"><span class="comment">#å†æ‰§è¡Œ </span></span><br><span class="line">docker rmi imgId</span><br></pre></td></tr></table></figure><h5 id="å¯åŠ¨å®¹å™¨"><a href="#å¯åŠ¨å®¹å™¨" class="headerlink" title="å¯åŠ¨å®¹å™¨"></a>å¯åŠ¨å®¹å™¨</h5><p>ä»¥ä¸‹å‘½ä»¤ä½¿ç”¨ ubuntu é•œåƒå¯åŠ¨ä¸€ä¸ªå®¹å™¨ï¼Œå‚æ•°ä¸ºä»¥å‘½ä»¤è¡Œæ¨¡å¼è¿›å…¥è¯¥å®¹å™¨ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#å‘½ä»¤è¯­æ³•</span></span><br><span class="line"></span><br><span class="line">docker run &lt;ç›¸å…³å‚æ•°&gt; &lt;é•œåƒ ID&gt; &lt;åˆå§‹å‘½ä»¤&gt; </span><br><span class="line">docker run -itd --name è‡ªå®šä¹‰å®¹å™¨åç§° é•œåƒåç§°:æ ‡ç­¾ shell</span><br><span class="line"></span><br><span class="line"><span class="comment">#è¿è¡Œtomcat8 </span></span><br><span class="line">docker run -p 8080:8080 --name mytomcat tomcat:8</span><br><span class="line"></span><br><span class="line"><span class="comment">#è¿è¡Œubuntué•œåƒ</span></span><br><span class="line">docker run -itd ubuntu /bin/bash</span><br></pre></td></tr></table></figure><h6 id="å‚æ•°è¯´æ˜ï¼š"><a href="#å‚æ•°è¯´æ˜ï¼š" class="headerlink" title="å‚æ•°è¯´æ˜ï¼š"></a>å‚æ•°è¯´æ˜ï¼š</h6><ul><li>-i: äº¤äº’å¼æ“ä½œã€‚</li><li>-t: ç»ˆç«¯ã€‚</li><li>-dï¼šæŒ‡å®šå®¹å™¨çš„è¿è¡Œæ¨¡å¼ä¸ºåå°è¿è¡Œã€‚</li><li>-P:æ˜¯å®¹å™¨å†…éƒ¨ç«¯å£éšæœºæ˜ å°„åˆ°ä¸»æœºçš„é«˜ç«¯å£ã€‚</li><li>-p: æ˜¯å®¹å™¨å†…éƒ¨ç«¯å£ç»‘å®šåˆ°æŒ‡å®šçš„ä¸»æœºç«¯å£ã€‚</li><li>â€“name: æ ‡è¯†æ¥å‘½åå®¹å™¨ã€‚</li><li>ubuntu: ubuntu é•œåƒã€‚</li><li>/bin/bashï¼šæ”¾åœ¨é•œåƒååçš„æ˜¯å‘½ä»¤ï¼Œè¿™é‡Œæˆ‘ä»¬å¸Œæœ›æœ‰ä¸ªäº¤äº’å¼ Shellï¼Œå› æ­¤ç”¨çš„æ˜¯ /bin/bashã€‚</li><li>-vï¼šè¡¨ç¤ºéœ€è¦å°†æœ¬åœ°å“ªä¸ªç›®å½•æŒ‚è½½åˆ°å®¹å™¨ä¸­ï¼Œæ ¼å¼ï¼š-v &lt;å®¿ä¸»æœºç›®å½•&gt;:&lt;å®¹å™¨ç›®å½•&gt;</li></ul><p>éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œä¸ä¸€å®šè¦ä½¿ç”¨â€œé•œåƒ IDâ€ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨â€œä»“åº“å:æ ‡ç­¾åâ€ï¼Œä¾‹å¦‚ï¼šcentos:latestã€‚<br>åˆå§‹å‘½ä»¤è¡¨ç¤ºä¸€æ—¦å®¹å™¨å¯åŠ¨ï¼Œéœ€è¦è¿è¡Œçš„å‘½ä»¤ï¼Œæ­¤æ—¶ä½¿ç”¨â€œ/bin/bashâ€ï¼Œè¡¨ç¤ºä»€ä¹ˆä¹Ÿä¸åšï¼Œåªéœ€è¿›å…¥å‘½ä»¤è¡Œå³å¯ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name mysql5.7 -p 3306:3306 -v /usr/<span class="built_in">local</span>/mysql/data:/var/lib/mysql </span><br><span class="line">-v /usr/<span class="built_in">local</span>/mysql/conf.d:/etc/mysql/conf.d -e MYSQL_ROOT_PASSWORD=123456 mysql:5.7.25</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#å°†windowsä¸‹Fç›˜çš„ç›®å½•javaResourceæŒ‚è½½åˆ°dockerä¸­centosä¸­çš„/usr/local/srcä¸‹ï¼Œdockerä¸­å¯ä»¥å…ˆè®¾ç½®åˆ†äº«ç›˜ç¬¦</span></span><br><span class="line">docker run -it --privileged=<span class="literal">true</span> -v /F/javaResource/:/usr/<span class="built_in">local</span>/src/ 5e35e350aded  /bin/bash</span><br></pre></td></tr></table></figure><h6 id="è¦é€€å‡ºç»ˆç«¯ï¼Œç›´æ¥è¾“å…¥-exit"><a href="#è¦é€€å‡ºç»ˆç«¯ï¼Œç›´æ¥è¾“å…¥-exit" class="headerlink" title="è¦é€€å‡ºç»ˆç«¯ï¼Œç›´æ¥è¾“å…¥ exit:"></a>è¦é€€å‡ºç»ˆç«¯ï¼Œç›´æ¥è¾“å…¥ exit:</h6><h5 id="é€šè¿‡-docker-inspect-å‘½ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥è·å–é•œåƒçš„è¯¦ç»†ä¿¡æ¯ï¼Œå…¶ä¸­ï¼ŒåŒ…æ‹¬åˆ›å»ºè€…ï¼Œå„å±‚çš„æ•°å­—æ‘˜è¦ç­‰ã€‚"><a href="#é€šè¿‡-docker-inspect-å‘½ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥è·å–é•œåƒçš„è¯¦ç»†ä¿¡æ¯ï¼Œå…¶ä¸­ï¼ŒåŒ…æ‹¬åˆ›å»ºè€…ï¼Œå„å±‚çš„æ•°å­—æ‘˜è¦ç­‰ã€‚" class="headerlink" title="é€šè¿‡ docker inspect å‘½ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥è·å–é•œåƒçš„è¯¦ç»†ä¿¡æ¯ï¼Œå…¶ä¸­ï¼ŒåŒ…æ‹¬åˆ›å»ºè€…ï¼Œå„å±‚çš„æ•°å­—æ‘˜è¦ç­‰ã€‚"></a>é€šè¿‡ docker inspect å‘½ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥è·å–é•œåƒçš„è¯¦ç»†ä¿¡æ¯ï¼Œå…¶ä¸­ï¼ŒåŒ…æ‹¬åˆ›å»ºè€…ï¼Œå„å±‚çš„æ•°å­—æ‘˜è¦ç­‰ã€‚</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker inspect repository:tag</span><br><span class="line">docker inspect mysql:5.7</span><br><span class="line"></span><br><span class="line">docker inspect è¿”å›çš„æ˜¯ JSON æ ¼å¼çš„ä¿¡æ¯ï¼Œå¦‚æœæ‚¨æƒ³è·å–å…¶ä¸­æŒ‡å®šçš„ä¸€é¡¹å†…å®¹ï¼Œå¯ä»¥é€šè¿‡ -f æ¥æŒ‡å®šï¼Œå¦‚è·å–é•œåƒå¤§å°ï¼š</span><br><span class="line"></span><br><span class="line">docker inspect -f &#123;&#123;<span class="string">".Size"</span>&#125;&#125; mysql:5.7</span><br></pre></td></tr></table></figure><h5 id="å®¹å™¨å…¶ä»–å‘½ä»¤"><a href="#å®¹å™¨å…¶ä»–å‘½ä»¤" class="headerlink" title="å®¹å™¨å…¶ä»–å‘½ä»¤"></a>å®¹å™¨å…¶ä»–å‘½ä»¤</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨</span></span><br><span class="line">docker ps</span><br><span class="line"></span><br><span class="line"><span class="comment">#æŸ¥çœ‹æ‰€æœ‰çš„å®¹å™¨</span></span><br><span class="line">docker ps -a</span><br><span class="line"></span><br><span class="line"><span class="comment">#åœæ­¢å®¹å™¨</span></span><br><span class="line">docker stop containerId</span><br><span class="line"></span><br><span class="line"><span class="comment">#å¯åŠ¨å®¹å™¨</span></span><br><span class="line">docker start containerId</span><br><span class="line"></span><br><span class="line"><span class="comment">#é‡å¯å®¹å™¨</span></span><br><span class="line">docker restart containerId</span><br></pre></td></tr></table></figure><h6 id="è¿›å…¥å®¹å™¨"><a href="#è¿›å…¥å®¹å™¨" class="headerlink" title="è¿›å…¥å®¹å™¨"></a>è¿›å…¥å®¹å™¨</h6><p>åœ¨ä½¿ç”¨ -d å‚æ•°æ—¶ï¼Œå®¹å™¨å¯åŠ¨åä¼šè¿›å…¥åå°ã€‚æ­¤æ—¶æƒ³è¦è¿›å…¥å®¹å™¨ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æŒ‡ä»¤è¿›å…¥ï¼š</p><ul><li>docker attach</li><li>docker execï¼šæ¨èå¤§å®¶ä½¿ç”¨ docker exec å‘½ä»¤ï¼Œå› ä¸ºæ­¤é€€å‡ºå®¹å™¨ç»ˆç«¯ï¼Œä¸ä¼šå¯¼è‡´å®¹å™¨çš„åœæ­¢ã€‚</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it mytomcat bash <span class="comment">#åœ¨è¿™é‡Œç”¨åˆ°äº†ä¸Šé¢æåˆ°çš„å®¹å™¨åˆ«åmytomcat</span></span><br></pre></td></tr></table></figure><h6 id="ä»€ä¹ˆæ˜¯-Dockerfile"><a href="#ä»€ä¹ˆæ˜¯-Dockerfile" class="headerlink" title="ä»€ä¹ˆæ˜¯ Dockerfile"></a>ä»€ä¹ˆæ˜¯ Dockerfile</h6><p>Dockerfile æ˜¯ä¸€ä¸ªç”¨æ¥æ„å»ºé•œåƒçš„æ–‡æœ¬æ–‡ä»¶ï¼Œæ–‡æœ¬å†…å®¹åŒ…å«äº†ä¸€æ¡æ¡æ„å»ºé•œåƒæ‰€éœ€çš„æŒ‡ä»¤å’Œè¯´æ˜ã€‚</p><ul><li>FROM å’Œ RUN æŒ‡ä»¤çš„ä½œç”¨</li></ul><p>FROMï¼šå®šåˆ¶çš„é•œåƒéƒ½æ˜¯åŸºäº FROM çš„é•œåƒï¼Œè¿™é‡Œçš„ nginx å°±æ˜¯å®šåˆ¶éœ€è¦çš„åŸºç¡€é•œåƒã€‚åç»­çš„æ“ä½œéƒ½æ˜¯åŸºäº nginxã€‚</p><p>RUNï¼šç”¨äºæ‰§è¡Œåé¢è·Ÿç€çš„å‘½ä»¤è¡Œå‘½ä»¤ã€‚æœ‰ä»¥ä¸‹ä¿©ç§æ ¼å¼ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#shellæ ¼å¼</span></span><br><span class="line">RUN &lt;å‘½ä»¤è¡Œå‘½ä»¤&gt;</span><br><span class="line"><span class="comment"># &lt;å‘½ä»¤è¡Œå‘½ä»¤&gt; ç­‰åŒäºï¼Œåœ¨ç»ˆç«¯æ“ä½œçš„ shell å‘½ä»¤ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#exec æ ¼å¼</span></span><br><span class="line">RUN [<span class="string">"å¯æ‰§è¡Œæ–‡ä»¶"</span>, <span class="string">"å‚æ•°1"</span>, <span class="string">"å‚æ•°2"</span>]</span><br><span class="line"><span class="comment"># ä¾‹å¦‚ï¼š</span></span><br><span class="line"><span class="comment"># RUN ["./test.php", "dev", "offline"] ç­‰ä»·äº RUN ./test.php dev offline</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šDockerfile çš„æŒ‡ä»¤æ¯æ‰§è¡Œä¸€æ¬¡éƒ½ä¼šåœ¨ docker ä¸Šæ–°å»ºä¸€å±‚ã€‚æ‰€ä»¥è¿‡å¤šæ— æ„ä¹‰çš„å±‚ï¼Œä¼šé€ æˆé•œåƒè†¨èƒ€è¿‡å¤§ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">FROM centos</span><br><span class="line">RUN yum install wget</span><br><span class="line">RUN wget -O redis.tar.gz <span class="string">"http://download.redis.io/releases/redis-5.0.3.tar.gz"</span></span><br><span class="line">RUN tar -xvf redis.tar.gz</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šæ‰§è¡Œä¼šåˆ›å»º 3 å±‚é•œåƒã€‚å¯ç®€åŒ–ä¸ºä»¥ä¸‹æ ¼å¼ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">FROM centos</span><br><span class="line">RUN yum install wget \</span><br><span class="line">    &amp;&amp; wget -O redis.tar.gz <span class="string">"http://download.redis.io/releases/redis-5.0.3.tar.gz"</span> \</span><br><span class="line">    &amp;&amp; tar -xvf redis.tar.gz</span><br></pre></td></tr></table></figure><p>å¦‚ä¸Šï¼Œä»¥ &amp;&amp; ç¬¦å·è¿æ¥å‘½ä»¤ï¼Œè¿™æ ·æ‰§è¡Œåï¼Œåªä¼šåˆ›å»º 1 å±‚é•œåƒã€‚</p><h5 id="å¼€å§‹æ„å»ºé•œåƒ"><a href="#å¼€å§‹æ„å»ºé•œåƒ" class="headerlink" title="å¼€å§‹æ„å»ºé•œåƒ"></a>å¼€å§‹æ„å»ºé•œåƒ</h5><p>åœ¨ Dockerfile æ–‡ä»¶çš„å­˜æ”¾ç›®å½•ä¸‹ï¼Œæ‰§è¡Œæ„å»ºåŠ¨ä½œã€‚</p><p>ä»¥ä¸‹ç¤ºä¾‹ï¼Œé€šè¿‡ç›®å½•ä¸‹çš„ Dockerfile æ„å»ºä¸€ä¸ª tomcatå’Œjdkæ•´åˆçš„é•œåƒ:v1ï¼ˆé•œåƒåç§°:é•œåƒæ ‡ç­¾ï¼‰<br>æ³¨ï¼šæœ€åçš„ . ä»£è¡¨æœ¬æ¬¡æ‰§è¡Œçš„ä¸Šä¸‹æ–‡è·¯å¾„ï¼Œä¸‹ä¸€èŠ‚ä¼šä»‹ç»ã€‚</p><h1 id="æ„å»ºé•œåƒå‘½ä»¤"><a href="#æ„å»ºé•œåƒå‘½ä»¤" class="headerlink" title="æ„å»ºé•œåƒå‘½ä»¤"></a>æ„å»ºé•œåƒå‘½ä»¤</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å‘½ä»¤è¯­æ³• </span></span><br><span class="line">docker build -t name:tag .</span><br><span class="line">-t é•œåƒçš„åå­—åŠæ ‡ç­¾ï¼Œé€šå¸¸ name:tag æˆ–è€… name æ ¼å¼ï¼›å¯ä»¥åœ¨ä¸€æ¬¡æ„å»ºä¸­ä¸ºä¸€ä¸ªé•œåƒè®¾ç½®å¤šä¸ªæ ‡ç­¾ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¾‹å¦‚</span></span><br><span class="line">docker build -t javawebenv:v1 .</span><br></pre></td></tr></table></figure><h1 id="Dockerfileå†…å®¹"><a href="#Dockerfileå†…å®¹" class="headerlink" title="Dockerfileå†…å®¹"></a>Dockerfileå†…å®¹</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">FROM centos:7 <span class="comment">#ä½¿ç”¨centos7æœ€æ–°çš„å®˜æ–¹é•œåƒ</span></span><br><span class="line">MAINTAINER samdockerdeveloper</span><br><span class="line">RUN mkdir  -p /usr/<span class="built_in">local</span>/tomcat7 \</span><br><span class="line">&amp;&amp;mkdir -p /usr/<span class="built_in">local</span>/jdk8</span><br><span class="line">WORKDIR   /usr/<span class="built_in">local</span>/src/  <span class="comment">#ä½¿ç”¨è¯¥ç›®å½•ä½œä¸ºå·¥ä½œç›®å½•</span></span><br><span class="line">COPY apache-tomcat-7.0.99.zip /usr/<span class="built_in">local</span>/src/</span><br><span class="line">COPY jdk-8u131-linux-x64.tar.gz /usr/<span class="built_in">local</span>/src/</span><br><span class="line">COPY my.cnf /usr/<span class="built_in">local</span>/src/</span><br><span class="line">RUN yum update -y \</span><br><span class="line">&amp;&amp;yum install -y unzip \</span><br><span class="line">&amp;&amp;unzip apache-tomcat-7.0.99.zip \</span><br><span class="line">&amp;&amp;rpm --import /etc/pki/rpm-gpg/RPM* \</span><br><span class="line">&amp;&amp;cp -R apache-tomcat-7.0.99/* /usr/<span class="built_in">local</span>/tomcat7 \</span><br><span class="line">&amp;&amp;chmod +x /usr/<span class="built_in">local</span>/tomcat7/bin/*.sh \</span><br><span class="line">&amp;&amp;tar -xf jdk-8u131-linux-x64.tar.gz  -C /usr/<span class="built_in">local</span>/jdk8 --strip-components 1 <span class="comment"># æ”¾å¼ƒä¸Šçº§ç›®å½•è§£å‹åˆ°/usr/local/jdk8ç›®å½•ä¸‹</span></span><br><span class="line">ENV JAVA_HOME /usr/<span class="built_in">local</span>/jdk8</span><br><span class="line">ENV CLASSPATH <span class="variable">$JAVA_HOME</span>/lib/dt.jar:<span class="variable">$JAVA_HOME</span>/lib/tools.jar</span><br><span class="line">ENV CATALINA_HOME /usr/<span class="built_in">local</span>/tomcat7</span><br><span class="line">ENV CATALINA_BASE /usr/<span class="built_in">local</span>/tomcat7</span><br><span class="line">ENV PATH <span class="variable">$PATH</span>:<span class="variable">$JAVA_HOME</span>/bin:<span class="variable">$CATALINA_HOME</span>/lib:<span class="variable">$CATALINA_HOME</span>/bin</span><br><span class="line">EXPOSE 8080 <span class="comment">#æš´éœ²8080ç«¯å£</span></span><br><span class="line">ENTRYPOINT [<span class="string">"/usr/local/tomcat7/bin/catalina.sh"</span>,<span class="string">"run"</span>]</span><br></pre></td></tr></table></figure><p>ä¸Šä¸‹æ–‡è·¯å¾„ï¼Œæ˜¯æŒ‡ docker åœ¨æ„å»ºé•œåƒï¼Œæœ‰æ—¶å€™æƒ³è¦ä½¿ç”¨åˆ°æœ¬æœºçš„æ–‡ä»¶ï¼ˆæ¯”å¦‚å¤åˆ¶ï¼‰ï¼Œdocker build å‘½ä»¤å¾—çŸ¥è¿™ä¸ªè·¯å¾„åï¼Œä¼šå°†è·¯å¾„ä¸‹çš„æ‰€æœ‰å†…å®¹æ‰“åŒ…ã€‚</p><p>è§£æï¼šç”±äº docker çš„è¿è¡Œæ¨¡å¼æ˜¯ C/Sã€‚æˆ‘ä»¬æœ¬æœºæ˜¯ Cï¼Œdockerå¼•æ“æ˜¯Sã€‚å®é™…çš„æ„å»ºè¿‡ç¨‹æ˜¯åœ¨dockerå¼•æ“ä¸‹å®Œæˆçš„ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™æ— æ³•ç”¨åˆ°æˆ‘ä»¬æœ¬æœºçš„æ–‡ä»¶ã€‚è¿™å°±éœ€è¦æŠŠæˆ‘ä»¬æœ¬æœºçš„æŒ‡å®šç›®å½•ä¸‹çš„æ–‡ä»¶ä¸€èµ·æ‰“åŒ…æä¾›ç»™ docker å¼•æ“ä½¿ç”¨ã€‚</p><p>å¦‚æœæœªè¯´æ˜æœ€åä¸€ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆé»˜è®¤ä¸Šä¸‹æ–‡è·¯å¾„å°±æ˜¯ Dockerfile æ‰€åœ¨çš„ä½ç½®ã€‚<br>æ³¨æ„ï¼šä¸Šä¸‹æ–‡è·¯å¾„ä¸‹ä¸è¦æ”¾æ— ç”¨çš„æ–‡ä»¶ï¼Œå› ä¸ºä¼šä¸€èµ·æ‰“åŒ…å‘é€ç»™ docker å¼•æ“ï¼Œå¦‚æœæ–‡ä»¶è¿‡å¤šä¼šé€ æˆè¿‡ç¨‹ç¼“æ…¢ã€‚</p><h6 id="ä½¿ç”¨çš„è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜"><a href="#ä½¿ç”¨çš„è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜" class="headerlink" title="ä½¿ç”¨çš„è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜"></a>ä½¿ç”¨çš„è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜</h6><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">DockeræŠ¥é”™â€œDockerfile parse error line 1: FROM requires either one or three argumentsâ€ çœ‹å®˜æ–¹æ–‡æ¡£Formatï¼š</span><br><span class="line">ä»¥<span class="string">'#'</span> å¼€å¤´ä¸€è¡Œè¢«è§†ä¸ºè¯„è®ºï¼Œå‡ºç°åœ¨å…¶ä»–ä½ç½®è§†ä¸ºå‚æ•°,ä¹Ÿå°±ä¸éš¾ç†è§£æŠ¥é”™åŸå› ï¼šå°†å†™åœ¨åŒä¸€è¡Œçš„æ³¨é‡Šè§†ä¸ºå‚æ•°äº†ã€‚</span><br><span class="line"></span><br><span class="line">Failed to get D-Bus connection: Operation not permitted /etc/init.d/mysqld:</span><br><span class="line">å¯åŠ¨å‘½ä»¤ docker run -d -p 8080:8080 -v /root/webapps:/usr/<span class="built_in">local</span>/tomcat7/webapps --name mycentos mycentos:7 /bin/bash</span><br><span class="line"></span><br><span class="line">ä»¥ç‰¹æƒæ¨¡å¼è¿è¡Œå®¹å™¨</span><br><span class="line">å¯åŠ¨å‘½ä»¤æ”¹æˆ docker run -d -p 8080:8080 -v /root/webapps:/usr/<span class="built_in">local</span>/tomcat7/webapps --name mycentos mycentos:7 /usr/sbin/init</span><br><span class="line"></span><br><span class="line">/etc/sysconfig/network æ–‡ä»¶å¤¹ä¸å­˜åœ¨</span><br><span class="line">ç¼–è¾‘/etc/init.d/mysqld ä¸­çš„ . /etc/sysconfig/network</span><br><span class="line">ä¿®æ”¹æˆ/etc/sysconfig/network-scripts/ifcfg-loæˆ–è€…ç”¨è½¯è¿æ¥ ln -s /etc/sysconfig/network-scripts/ifcfg-lo /etc/sysconfig/network</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä»¥centos7é•œåƒä¸ºåŸºç¡€æ„å»ºä¸€ä¸ªjdk8å’Œtomcat7çš„é•œåƒ</title>
      <link href="/post/97b746d3.html"/>
      <url>/post/97b746d3.html</url>
      
        <content type="html"><![CDATA[<p>é¦–å…ˆæˆ‘ç®€å•è¯´ä¸€ä¸‹å®¹å™¨çš„ä¸€äº›çŸ¥è¯†ç‚¹</p><ul><li>ä¸€ä¸ªå®¹å™¨åªè·‘ä¸€ä¸ªè¿›ç¨‹ï¼Œå¹¶ä¸”è¯¥è¿›ç¨‹åªèƒ½å‰å°è¿è¡Œã€‚</li><li>å®¹å™¨æœ‰å±‚çš„æ¦‚å¿µï¼Œå¦‚æœéœ€è¦å®šåˆ¶å®¹å™¨ï¼Œåº”è¯¥å°½é‡é€šè¿‡Dockerfileæ¥æ„å»ºå®¹å™¨ã€‚<a id="more"></a><h5 id="ä»€ä¹ˆæ˜¯-Dockerfile"><a href="#ä»€ä¹ˆæ˜¯-Dockerfile" class="headerlink" title="ä»€ä¹ˆæ˜¯ Dockerfile"></a>ä»€ä¹ˆæ˜¯ Dockerfile</h5></li><li>Dockerfile æ˜¯ä¸€ä¸ªç”¨æ¥æ„å»ºé•œåƒçš„æ–‡æœ¬æ–‡ä»¶ï¼Œæ–‡æœ¬å†…å®¹åŒ…å«äº†ä¸€æ¡æ¡æ„å»ºé•œåƒæ‰€éœ€çš„æŒ‡ä»¤å’Œè¯´æ˜ã€‚</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">FROM centos:7 </span><br><span class="line">MAINTAINERsamdockerdeveloper</span><br><span class="line">RUN mkdir  -p /usr/<span class="built_in">local</span>/tomcat7 \</span><br><span class="line">&amp;&amp;mkdir -p /usr/<span class="built_in">local</span>/jdk8</span><br><span class="line">WORKDIR   /usr/<span class="built_in">local</span>/src/</span><br><span class="line">COPY apache-tomcat-7.0.99.zip /usr/<span class="built_in">local</span>/src/</span><br><span class="line">COPY jdk-8u131-linux-x64.tar.gz /usr/<span class="built_in">local</span>/src/</span><br><span class="line">RUN yum update -y \</span><br><span class="line">&amp;&amp;yum install -y unzip  \</span><br><span class="line">&amp;&amp;unzip apache-tomcat-7.0.99.zip \</span><br><span class="line">&amp;&amp;cp -R apache-tomcat-7.0.99/* /usr/<span class="built_in">local</span>/tomcat7 \</span><br><span class="line">&amp;&amp;chmod +x  /usr/<span class="built_in">local</span>/tomcat7/bin/*.sh \</span><br><span class="line">&amp;&amp;tar -xf jdk-8u131-linux-x64.tar.gz  -C /usr/<span class="built_in">local</span>/jdk8 --strip-components 1</span><br><span class="line">ENV JAVA_HOME /usr/<span class="built_in">local</span>/jdk8 \</span><br><span class="line">ENV CLASSPATH <span class="variable">$JAVA_HOME</span>/lib/dt.jar:<span class="variable">$JAVA_HOME</span>/lib/tools.jar \</span><br><span class="line">ENV CATALINA_HOME /usr/<span class="built_in">local</span>/tomcat7 \</span><br><span class="line">ENV CATALINA_BASE /usr/<span class="built_in">local</span>/tomcat7 \</span><br><span class="line">ENV PATH <span class="variable">$PATH</span>:<span class="variable">$JAVA_HOME</span>/bin:<span class="variable">$CATALINA_HOME</span>/lib:<span class="variable">$CATALINA_HOME</span>/bin</span><br><span class="line">EXPOSE 8080</span><br><span class="line">ENTRYPOINT [<span class="string">"/usr/local/tomcat7/bin/catalina.sh"</span>,<span class="string">"run"</span>]</span><br></pre></td></tr></table></figure><p>åœ¨DockerfileåŒçº§ç›®å½•é‡Œå­˜æ”¾å·²ç»ä¸‹è½½å¥½çš„apache-tomcat-7.0.99.zipã€jdk-8u131-linux-x64.tar.gzã€‚</p><p><strong>æ³¨æ„</strong>ï¼šDockerfile çš„æŒ‡ä»¤æ¯æ‰§è¡Œä¸€æ¬¡éƒ½ä¼šåœ¨ docker ä¸Šæ–°å»ºä¸€å±‚ã€‚æ‰€ä»¥è¿‡å¤šæ— æ„ä¹‰çš„å±‚ï¼Œä¼šé€ æˆé•œåƒè†¨èƒ€è¿‡å¤§ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">FROM centos</span><br><span class="line">RUN yum install wget</span><br><span class="line">RUN wget -O redis.tar.gz <span class="string">"http://download.redis.io/releases/redis-5.0.3.tar.gz"</span></span><br><span class="line">RUN tar -xvf redis.tar.gz</span><br><span class="line">ä»¥ä¸Šæ‰§è¡Œä¼šåˆ›å»º 3 å±‚é•œåƒã€‚å¯ç®€åŒ–ä¸ºä»¥ä¸‹æ ¼å¼ï¼š</span><br><span class="line">FROM centos</span><br><span class="line">RUN yum install wget \</span><br><span class="line">    &amp;&amp; wget -O redis.tar.gz <span class="string">"http://download.redis.io/releases/redis-5.0.3.tar.gz"</span> \</span><br><span class="line">    &amp;&amp; tar -xvf redis.tar.gz</span><br></pre></td></tr></table></figure><p> å¦‚ä¸Šï¼Œä»¥ &amp;&amp; ç¬¦å·è¿æ¥å‘½ä»¤ï¼Œè¿™æ ·æ‰§è¡Œåï¼Œåªä¼šåˆ›å»º 1 å±‚é•œåƒã€‚</p><h5 id="å¼€å§‹æ„å»ºé•œåƒ"><a href="#å¼€å§‹æ„å»ºé•œåƒ" class="headerlink" title="å¼€å§‹æ„å»ºé•œåƒ"></a>å¼€å§‹æ„å»ºé•œåƒ</h5><p>åœ¨ Dockerfile æ–‡ä»¶çš„å­˜æ”¾ç›®å½•ä¸‹ï¼Œæ‰§è¡Œæ„å»ºåŠ¨ä½œã€‚</p><p>ä»¥ä¸‹ç¤ºä¾‹ï¼Œé€šè¿‡ç›®å½•ä¸‹çš„ Dockerfile æ„å»ºä¸€ä¸ª samjavawebenv:v2ï¼ˆé•œåƒåç§°:é•œåƒæ ‡ç­¾ï¼‰ã€‚</p><p><strong>æ³¨</strong>ï¼šæœ€åçš„ . ä»£è¡¨æœ¬æ¬¡æ‰§è¡Œçš„ä¸Šä¸‹æ–‡è·¯å¾„</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># docker build -t  name:tag  .</span></span><br><span class="line">docker build -t  samjavawebenv:v2  .</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SpringMvcä½¿ç”¨@Asyncæ³¨è§£å®ç°æœ‰è¿”å›å€¼å’Œæ— è¿”å›å€¼çš„å¼‚æ­¥å¤„ç†</title>
      <link href="/post/e7e78673.html"/>
      <url>/post/e7e78673.html</url>
      
        <content type="html"><![CDATA[<h5 id="1-SpringMvcä½¿ç”¨-Asyncæ³¨è§£å®ç°æœ‰è¿”å›å€¼å’Œæ— è¿”å›å€¼çš„å¼‚æ­¥å¤„ç†"><a href="#1-SpringMvcä½¿ç”¨-Asyncæ³¨è§£å®ç°æœ‰è¿”å›å€¼å’Œæ— è¿”å›å€¼çš„å¼‚æ­¥å¤„ç†" class="headerlink" title="1. SpringMvcä½¿ç”¨@Asyncæ³¨è§£å®ç°æœ‰è¿”å›å€¼å’Œæ— è¿”å›å€¼çš„å¼‚æ­¥å¤„ç†"></a>1. SpringMvcä½¿ç”¨@Asyncæ³¨è§£å®ç°æœ‰è¿”å›å€¼å’Œæ— è¿”å›å€¼çš„å¼‚æ­¥å¤„ç†</h5><p> å¼‚æ­¥è°ƒç”¨å¯¹åº”çš„æ˜¯åŒæ­¥è°ƒç”¨ï¼ŒåŒæ­¥è°ƒç”¨æŒ‡ç¨‹åºæŒ‰ç…§å®šä¹‰é¡ºåºä¾æ¬¡æ‰§è¡Œï¼Œæ¯ä¸€è¡Œç¨‹åºéƒ½å¿…é¡»ç­‰å¾…ä¸Šä¸€è¡Œç¨‹åºæ‰§è¡Œå®Œæˆä¹‹åæ‰èƒ½æ‰§è¡Œï¼›å¼‚æ­¥è°ƒç”¨æŒ‡ç¨‹åºåœ¨é¡ºåºæ‰§è¡Œæ—¶ï¼Œä¸ç­‰å¾…å¼‚æ­¥è°ƒç”¨çš„è¯­å¥è¿”å›ç»“æœå°±æ‰§è¡Œåé¢çš„ç¨‹åºã€‚<br> <a id="more"></a></p><h6 id="1-1-åŒæ­¥æ–¹å¼è°ƒç”¨ä»£ç "><a href="#1-1-åŒæ­¥æ–¹å¼è°ƒç”¨ä»£ç " class="headerlink" title="1.1 åŒæ­¥æ–¹å¼è°ƒç”¨ä»£ç "></a>1.1 åŒæ­¥æ–¹å¼è°ƒç”¨ä»£ç </h6><ul><li><p>ç›¸å…³ä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TaskService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doTaskOne</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">System.out.println(<span class="string">"å¼€å§‹åšä»»åŠ¡ä¸€"</span>);</span><br><span class="line"><span class="keyword">long</span> start = System.currentTimeMillis();</span><br><span class="line">Thread.sleep(<span class="number">2000</span>);</span><br><span class="line"><span class="keyword">long</span> end = System.currentTimeMillis();</span><br><span class="line">System.out.println(<span class="string">"å®Œæˆä»»åŠ¡äºŒï¼Œè€—æ—¶ï¼š%s"</span> , (end - start) + <span class="string">"æ¯«ç§’"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doTaskTwo</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">System.out.println(<span class="string">"å¼€å§‹åšä»»åŠ¡äºŒ"</span>);</span><br><span class="line"><span class="keyword">long</span> start = System.currentTimeMillis();</span><br><span class="line">Thread.sleep(<span class="number">3000</span>);</span><br><span class="line"><span class="keyword">long</span> end = System.currentTimeMillis();</span><br><span class="line">System.out.println(<span class="string">"å®Œæˆä»»åŠ¡äºŒï¼Œè€—æ—¶ï¼š%s"</span> , (end - start) + <span class="string">"æ¯«ç§’"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doTaskThree</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">System.out.println(<span class="string">"å¼€å§‹åšä»»åŠ¡ä¸‰"</span>);</span><br><span class="line"><span class="keyword">long</span> start = System.currentTimeMillis();</span><br><span class="line">Thread.sleep(<span class="number">4000</span>);</span><br><span class="line"><span class="keyword">long</span> end = System.currentTimeMillis();</span><br><span class="line">System.out.println(<span class="string">"å®Œæˆä»»åŠ¡äºŒï¼Œè€—æ—¶ï¼š%s"</span> , (end - start) + <span class="string">"æ¯«ç§’"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>åŒæ­¥è°ƒç”¨</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> TaskService task;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">task.doTaskOne();</span><br><span class="line">task.doTaskTwo();</span><br><span class="line">task.doTaskThree();</span><br><span class="line">&#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯è¿è¡Œç»“æœï¼Œå¯ä»¥çœ‹åˆ°ä¸‰ä¸ªæ–¹æ³•æ˜¯ä¾æ¬¡æ‰§è¡Œçš„ï¼Œåˆ†åˆ«è€—æ—¶2ç§’ã€3ç§’ã€4ç§’ã€æ€»è€—æ—¶9ç§’</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">å¼€å§‹åšä»»åŠ¡ä¸€</span><br><span class="line">å®Œæˆä»»åŠ¡ä¸€ï¼Œè€—æ—¶ï¼š2001æ¯«ç§’</span><br><span class="line">å¼€å§‹åšä»»åŠ¡äºŒ</span><br><span class="line">å®Œæˆä»»åŠ¡äºŒï¼Œè€—æ—¶ï¼š3000æ¯«ç§’</span><br><span class="line">å¼€å§‹åšä»»åŠ¡ä¸‰</span><br><span class="line">å®Œæˆä»»åŠ¡ä¸‰ï¼Œè€—æ—¶ï¼š4001æ¯«ç§’</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„åŒæ­¥è°ƒç”¨ï¼Œè™½ç„¶é¡ºåˆ©åœ°å®Œæˆäº†ä¸‰ä¸ªä»»åŠ¡ï¼Œä½†æ˜¯æ‰§è¡Œæ—¶é—´æ¯”è¾ƒé•¿ï¼Œå¦‚æœè¿™ä¸‰ä¸ªä»»åŠ¡æ²¡æœ‰ä¾èµ–å…³ç³»ï¼Œå¯ä»¥å¹¶å‘æ‰§è¡Œçš„è¯ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨å¼‚æ­¥è°ƒç”¨çš„æ–¹æ³•ã€‚</p><h6 id="2-å¼‚æ­¥æ–¹å¼è°ƒç”¨ä»£ç æ— è¿”å›å€¼"><a href="#2-å¼‚æ­¥æ–¹å¼è°ƒç”¨ä»£ç æ— è¿”å›å€¼" class="headerlink" title="2. å¼‚æ­¥æ–¹å¼è°ƒç”¨ä»£ç æ— è¿”å›å€¼"></a>2. å¼‚æ­¥æ–¹å¼è°ƒç”¨ä»£ç æ— è¿”å›å€¼</h6><ul><li>é¦–å…ˆåœ¨springä¸­é…ç½®ç›¸å…³å‚æ•°å¼€å¯å¼‚æ­¥è°ƒç”¨</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:task</span>=<span class="string">"http://www.springframework.org/schema/task"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/task</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/task/spring-task.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">task:annotation-driven</span> <span class="attr">executor</span>=<span class="string">"taskExecutor"</span>  /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">task:executor</span> <span class="attr">id</span>=<span class="string">"taskExecutor"</span>  <span class="attr">pool-size</span>=<span class="string">"20"</span> <span class="attr">queue-capacity</span>=<span class="string">"1000"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¦‚æœç›´æ¥æŒ‰ç…§ä¸‹é¢çš„æ–¹å¼é…ç½®ï¼Œåˆ™ Spring ä¼šä½¿ç”¨é»˜è®¤çš„çº¿ç¨‹æ±  <code>org.springframework.core.task.SimpleAsyncTaskExecutor</code><br>ä½†è¿™ä¸ª SimpleAsyncTaskExecutor ä¸æ˜¯çœŸçš„çº¿ç¨‹æ± ï¼Œè¿™ä¸ªç±»ä¸é‡ç”¨çº¿ç¨‹ï¼Œæ¯æ¬¡è°ƒç”¨éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">task:annotation-driven</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"># è¯¦è§spring-context-4.1.7.RELEASE.jar/org/springframework/scheduling/config/spring-task-4.0.xsd çš„æè¿°</span><br><span class="line"><span class="tag">&lt;<span class="name">xsd:attribute</span> <span class="attr">name</span>=<span class="string">"executor"</span> <span class="attr">type</span>=<span class="string">"xsd:string"</span> <span class="attr">use</span>=<span class="string">"optional"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">xsd:annotation</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">xsd:documentation</span>&gt;</span>&lt;![CDATA[</span><br><span class="line">Specifies the java.util.Executor instance to use when invoking asynchronous methods.</span><br><span class="line">If not provided, an instance of org.springframework.core.task.SimpleAsyncTaskExecutor</span><br><span class="line">will be used by default.</span><br><span class="line">Note that as of Spring 3.1.2, individual @Async methods may qualify which executor to</span><br><span class="line">use, meaning that the executor specified here acts as a default for all non-qualified</span><br><span class="line">@Async methods.</span><br><span class="line">]]&gt;<span class="tag">&lt;/<span class="name">xsd:documentation</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xsd:annotation</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>åœ¨æ–¹æ³•ä¸ŠåŠ ä¸Š @Async æ³¨è§£å°±èƒ½å°†åŒæ­¥å‡½æ•°å˜æˆå¼‚æ­¥å‡½æ•°ï¼Œæ”¹é€ åçš„ä»£ç </li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.concurrent.Future;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TaskService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Async</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doTaskOne</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">System.out.println(<span class="string">"å¼€å§‹åšä»»åŠ¡ä¸€"</span>);</span><br><span class="line"><span class="keyword">long</span> start = System.currentTimeMillis();</span><br><span class="line">Thread.sleep(<span class="number">2000</span>);</span><br><span class="line"><span class="keyword">long</span> end = System.currentTimeMillis();</span><br><span class="line">System.out.println(<span class="string">"å®Œæˆä»»åŠ¡äºŒï¼Œè€—æ—¶ï¼š%s"</span> , (end - start) + <span class="string">"æ¯«ç§’"</span>);</span><br><span class="line">&#125;</span><br><span class="line">    <span class="meta">@Async</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doTaskTwo</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">System.out.println(<span class="string">"å¼€å§‹åšä»»åŠ¡äºŒ"</span>);</span><br><span class="line"><span class="keyword">long</span> start = System.currentTimeMillis();</span><br><span class="line">Thread.sleep(<span class="number">3000</span>);</span><br><span class="line"><span class="keyword">long</span> end = System.currentTimeMillis();</span><br><span class="line">System.out.println(<span class="string">"å®Œæˆä»»åŠ¡äºŒï¼Œè€—æ—¶ï¼š%s"</span> , (end - start) + <span class="string">"æ¯«ç§’"</span>);</span><br><span class="line">&#125;</span><br><span class="line">    <span class="meta">@Async</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doTaskThree</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">System.out.println(<span class="string">"å¼€å§‹åšä»»åŠ¡ä¸‰"</span>);</span><br><span class="line"><span class="keyword">long</span> start = System.currentTimeMillis();</span><br><span class="line">Thread.sleep(<span class="number">4000</span>);</span><br><span class="line"><span class="keyword">long</span> end = System.currentTimeMillis();</span><br><span class="line">System.out.println(<span class="string">"å®Œæˆä»»åŠ¡äºŒï¼Œè€—æ—¶ï¼š%s"</span> , (end - start) + <span class="string">"æ¯«ç§’"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>é‡æ–°è°ƒç”¨ä¹‹åçš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">å¼€å§‹åšä»»åŠ¡ä¸‰</span><br><span class="line">å¼€å§‹åšä»»åŠ¡äºŒ</span><br><span class="line">å¼€å§‹åšä»»åŠ¡ä¸€</span><br><span class="line">å®Œæˆä»»åŠ¡ä¸€ï¼Œè€—æ—¶ï¼š2000æ¯«ç§’</span><br><span class="line">å®Œæˆä»»åŠ¡äºŒï¼Œè€—æ—¶ï¼š3001æ¯«ç§’</span><br><span class="line">å®Œæˆä»»åŠ¡ä¸‰ï¼Œè€—æ—¶ï¼š4000æ¯«ç§’</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„äº‹é¡¹</strong></p><ul><li><p>@Async æ‰€ä¿®é¥°çš„å‡½æ•°ä¸è¦å®šä¹‰ä¸º static ç±»å‹ï¼Œè¿™æ ·å¼‚æ­¥è°ƒç”¨ä¸ä¼šç”Ÿæ•ˆã€‚</p></li><li><p>è°ƒç”¨æ–¹æ³•å’Œå¼‚æ­¥å‡½æ•°ä¸èƒ½åœ¨ä¸€ä¸ª class ä¸­ã€‚</p></li><li><p>å¯ä»¥åœ¨ä½¿ç”¨çš„æ—¶å€™è‡ªå®šä¹‰çº¿ç¨‹æ±  <code>@Async(&quot;poolTaskExecutor&quot;)</code></p></li></ul><h6 id="3-å¼‚æ­¥æ–¹å¼è°ƒç”¨ä»£ç æœ‰è¿”å›å€¼"><a href="#3-å¼‚æ­¥æ–¹å¼è°ƒç”¨ä»£ç æœ‰è¿”å›å€¼" class="headerlink" title="3. å¼‚æ­¥æ–¹å¼è°ƒç”¨ä»£ç æœ‰è¿”å›å€¼"></a>3. å¼‚æ­¥æ–¹å¼è°ƒç”¨ä»£ç æœ‰è¿”å›å€¼</h6><p>å¦‚æœæƒ³çŸ¥é“å¼‚æ­¥å‡½æ•°ä»€ä¹ˆæ—¶å€™æ‰§è¡Œå®Œï¼Œé‚£å°±éœ€è¦ä½¿ç”¨ Future (AsyncResultæ˜¯Futureçš„å­ç±»)æ¥è¿”å›å¼‚æ­¥è°ƒç”¨çš„ç»“æœã€‚<br>æ”¹é€ åçš„ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TaskService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Async</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Future&lt;String&gt; <span class="title">doTaskOne</span><span class="params">()</span> </span>&#123;</span><br><span class="line">System.out.println(<span class="string">"å¼€å§‹åšä»»åŠ¡ä¸€"</span>);</span><br><span class="line"><span class="keyword">long</span> start = System.currentTimeMillis();</span><br><span class="line">Thread.sleep(<span class="number">2000</span>);</span><br><span class="line"><span class="keyword">long</span> end = System.currentTimeMillis();</span><br><span class="line">System.out.println(<span class="string">"å®Œæˆä»»åŠ¡äºŒï¼Œè€—æ—¶ï¼š%s"</span> , (end - start) + <span class="string">"æ¯«ç§’"</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> AsyncResult&lt;&gt;(<span class="string">"ä»»åŠ¡ä¸€å®Œæˆ"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Async</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Future&lt;String&gt; <span class="title">doTaskTwo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">System.out.println(<span class="string">"å¼€å§‹åšä»»åŠ¡äºŒ"</span>);</span><br><span class="line"><span class="keyword">long</span> start = System.currentTimeMillis();</span><br><span class="line">Thread.sleep(<span class="number">3000</span>);</span><br><span class="line"><span class="keyword">long</span> end = System.currentTimeMillis();</span><br><span class="line">System.out.println(<span class="string">"å®Œæˆä»»åŠ¡äºŒï¼Œè€—æ—¶ï¼š%s"</span> , (end - start) + <span class="string">"æ¯«ç§’"</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> AsyncResult&lt;&gt;(<span class="string">"ä»»åŠ¡äºŒå®Œæˆ"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Async</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Future&lt;String&gt; <span class="title">doTaskThree</span><span class="params">()</span> </span>&#123;</span><br><span class="line">System.out.println(<span class="string">"å¼€å§‹åšä»»åŠ¡ä¸‰"</span>);</span><br><span class="line"><span class="keyword">long</span> start = System.currentTimeMillis();</span><br><span class="line">Thread.sleep(<span class="number">4000</span>);</span><br><span class="line"><span class="keyword">long</span> end = System.currentTimeMillis();</span><br><span class="line">System.out.println(<span class="string">"å®Œæˆä»»åŠ¡äºŒï¼Œè€—æ—¶ï¼š%s"</span> , (end - start) + <span class="string">"æ¯«ç§’"</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> AsyncResult&lt;&gt;(<span class="string">"ä»»åŠ¡ä¸‰å®Œæˆ"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å¼‚æ­¥æ–¹å¼è°ƒç”¨ä»£ç æœ‰è¿”å›å€¼</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> TaskService task;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">List&lt;String&gt; result = <span class="keyword">new</span> ArrayList(<span class="number">16</span>);</span><br><span class="line">StopWatch stopWatch = <span class="keyword">new</span> StopWatch();</span><br><span class="line">stopWatch.start(<span class="string">"æ¥å£é€Ÿåº¦ç»Ÿè®¡"</span>);</span><br><span class="line"><span class="comment">// 3ç§’è¶…æ—¶</span></span><br><span class="line">    <span class="keyword">int</span> timeout = <span class="number">3</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">Future&lt;String&gt; task1 = task.doTaskOne();</span><br><span class="line">        Future&lt;String&gt; task2 = task.doTaskTwo();</span><br><span class="line">        Future&lt;String&gt; task3 = task.doTaskThree();</span><br><span class="line"></span><br><span class="line">String taskString1= task1.get(timeout, TimeUnit.SECONDS);</span><br><span class="line">String taskString2= task2.get(timeout, TimeUnit.SECONDS);</span><br><span class="line">String taskString3= task3.get(timeout, TimeUnit.SECONDS);</span><br><span class="line"></span><br><span class="line">result.add(taskString1);</span><br><span class="line">result.add(taskString2);</span><br><span class="line">result.add(taskString3);</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">catch</span> (TimeoutException | InterruptedException | ExecutionException e)&#123;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">stopWatch.stop();</span><br><span class="line">log.info(stopWatch.prettyPrint());</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">å¼€å§‹åšä»»åŠ¡ä¸‰</span><br><span class="line">å¼€å§‹åšä»»åŠ¡äºŒ</span><br><span class="line">å¼€å§‹åšä»»åŠ¡ä¸€</span><br><span class="line">å®Œæˆä»»åŠ¡ä¸€ï¼Œè€—æ—¶ï¼š2001æ¯«ç§’</span><br><span class="line">å®Œæˆä»»åŠ¡äºŒï¼Œè€—æ—¶ï¼š3000æ¯«ç§’</span><br><span class="line">å®Œæˆä»»åŠ¡ä¸‰ï¼Œè€—æ—¶ï¼š4001æ¯«ç§’</span><br><span class="line"></span><br><span class="line">StopWatch <span class="string">''</span>: running time (millis) = 248</span><br><span class="line">-----------------------------------------</span><br><span class="line">ms     %     Task name</span><br><span class="line">-----------------------------------------</span><br><span class="line">04036  100%  æ¥å£é€Ÿåº¦ç»Ÿè®¡</span><br></pre></td></tr></table></figure><p>åˆšå¼€å§‹æƒ³åˆ©ç”¨CountDownLatchæ¥å®ç°ç­‰å¾…æ‰€æœ‰çº¿ç¨‹ç»“æŸæ•´åˆç»“æœï¼Œåæ¥è°ƒæ•´ä¸º Future çš„ get(long timeout, TimeUnit unit) æ¥å®ç°çº¿ç¨‹çš„è¶…æ—¶æ§åˆ¶ï¼Œæˆ‘çœ‹æœ‰äº›çš„ä¾‹å­ä½¿ç”¨æ­»å¾ªç¯æ¥é˜»å¡æ•´åˆçº¿ç¨‹çš„æ‰§è¡Œç»“æœï¼Œè¿™æ ·åšæ˜¯æœ‰äº›é—®é¢˜çš„ï¼Œå¦‚æœæœ‰ä¸ªçº¿ç¨‹ä¸€ç›´æ²¡æœ‰ç»“æŸè¿è¡Œï¼Œé‚£å°±å®ŒçŠŠå­äº†ï¼</p><p>è¿™æ˜¯ä¸€ç§å¸¸è§çš„åœºæ™¯å°†ä¸€ä¸ªå¤§çš„ä»»åŠ¡åˆ‡åˆ†ä¸ºæ•°ä¸ªå­ä»»åŠ¡ï¼Œå¹¶è¡Œå¤„ç†æ‰€æœ‰å­ä»»åŠ¡ï¼Œå½“æ‰€æœ‰å­ä»»åŠ¡éƒ½æˆåŠŸç»“æŸæ—¶å†ç»§ç»­å¤„ç†åé¢çš„é€»è¾‘ã€‚è¿˜æœ‰ä¸€ç§åšæ³•æ˜¯åˆ©ç”¨CountDownLatch, ä¸»çº¿ç¨‹æ„é€ countDownLatchå¯¹è±¡ï¼Œlatchçš„å¤§å°ä¸ºå­ä»»åŠ¡çš„æ€»æ•°ï¼Œæ¯ä¸€ä¸ªä»»åŠ¡æŒæœ‰countDownLatchçš„å¼•ç”¨ï¼Œä»»åŠ¡å®Œæˆæ—¶å¯¹latchå‡1ï¼Œä¸»çº¿ç¨‹é˜»å¡åœ¨countDownLatch.awaitæ–¹æ³•ä¸Šï¼Œå½“æ‰€æœ‰å­ä»»åŠ¡éƒ½æˆåŠŸæ‰§è¡Œå®Œåï¼Œlatch=0, ä¸»çº¿ç¨‹ç»§ç»­æ‰§è¡Œã€‚</p><h5 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h5><p>å¼‚æ­¥è°ƒç”¨å¯ä»¥æå‡æ¥å£æ€§èƒ½ã€‚æ¯”å¦‚å¯¼å‡ºä¸‹è½½ã€å‘é€é‚®ä»¶çŸ­ä¿¡ç­‰ä»£ç ï¼Œå¯ä»¥ä½¿ç”¨å¼‚æ­¥æ‰§è¡Œã€‚</p><p><a href="https://blog.csdn.net/qqfo24/article/details/81383022" target="_blank" rel="noopener">å‚è€ƒ https://blog.csdn.net/qqfo24/article/details/81383022</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> SpringMvc </tag>
            
            <tag> Async </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åœ¨CentOS7ä¸Šä½¿ç”¨yumå®‰è£…Docker</title>
      <link href="/post/ef24ce2b.html"/>
      <url>/post/ef24ce2b.html</url>
      
        <content type="html"><![CDATA[<p>ç›®å‰åœ¨ Linux æ“ä½œç³»ç»Ÿä¸Šå®‰è£… Dockerï¼Œå¯¹ç³»ç»Ÿç‰ˆæœ¬æœ‰ä»¥ä¸‹è¦æ±‚ï¼š</p><ul><li>CentOSï¼š7</li><li>Debianï¼š7.7ï¼ˆWheezy LTSï¼‰ã€8.0ï¼ˆJessie LTSï¼‰ã€9ï¼ˆStretchï¼‰</li><li>Fedoraï¼š24ã€25</li><li>Ubuntuï¼š16.04ï¼ˆXenial LTSï¼‰ã€14.04ï¼ˆTrusty LTSï¼‰ã€17.04ï¼ˆZestyï¼‰</li></ul><a id="more"></a><h5 id="ä½¿ç”¨-yum-è¿›è¡Œå®‰è£…"><a href="#ä½¿ç”¨-yum-è¿›è¡Œå®‰è£…" class="headerlink" title="ä½¿ç”¨ yum è¿›è¡Œå®‰è£…"></a>ä½¿ç”¨ yum è¿›è¡Œå®‰è£…</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># step 1: å®‰è£…å¿…è¦çš„ä¸€äº›ç³»ç»Ÿå·¥å…·</span></span><br><span class="line">sudo yum install -y yum-utils device-mapper-persistent-data lvm2</span><br><span class="line"><span class="comment"># Step 2: æ·»åŠ è½¯ä»¶æºä¿¡æ¯</span></span><br><span class="line">sudo yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br><span class="line"><span class="comment"># Step 3: æ›´æ–°å¹¶å®‰è£…Docker-CE</span></span><br><span class="line">sudo yum makecache fast</span><br><span class="line">sudo yum -y install docker-ce</span><br><span class="line"><span class="comment"># Step 4: å¼€å¯DockeræœåŠ¡</span></span><br><span class="line">sudo service docker start</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼€æœºå¯åŠ¨</span></span><br><span class="line">systemctl <span class="built_in">enable</span> docker</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ³¨æ„ï¼š</span></span><br><span class="line"><span class="comment"># å®˜æ–¹è½¯ä»¶æºé»˜è®¤å¯ç”¨äº†æœ€æ–°çš„è½¯ä»¶ï¼Œæ‚¨å¯ä»¥é€šè¿‡ç¼–è¾‘è½¯ä»¶æºçš„æ–¹å¼è·å–å„ä¸ªç‰ˆæœ¬çš„è½¯ä»¶åŒ…ã€‚</span></span><br><span class="line"><span class="comment"># ä¾‹å¦‚å®˜æ–¹å¹¶æ²¡æœ‰å°†æµ‹è¯•ç‰ˆæœ¬çš„è½¯ä»¶æºç½®ä¸ºå¯ç”¨ï¼Œæ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å¼€å¯ã€‚åŒç†å¯ä»¥å¼€å¯å„ç§æµ‹è¯•ç‰ˆæœ¬ç­‰ã€‚</span></span><br><span class="line"><span class="comment"># vim /etc/yum.repos.d/docker-ee.repo</span></span><br><span class="line"><span class="comment">#   å°†[docker-ce-test]ä¸‹æ–¹çš„enabled=0ä¿®æ”¹ä¸ºenabled=1</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># å®‰è£…æŒ‡å®šç‰ˆæœ¬çš„Docker-CE:</span></span><br><span class="line"><span class="comment"># Step 1: æŸ¥æ‰¾Docker-CEçš„ç‰ˆæœ¬:</span></span><br><span class="line"><span class="comment"># yum list docker-ce.x86_64 --showduplicates | sort -r</span></span><br><span class="line"><span class="comment">#   Loading mirror speeds from cached hostfile</span></span><br><span class="line"><span class="comment">#   Loaded plugins: branch, fastestmirror, langpacks</span></span><br><span class="line"><span class="comment">#   docker-ce.x86_64            17.03.1.ce-1.el7.centos            docker-ce-stable</span></span><br><span class="line"><span class="comment">#   docker-ce.x86_64            17.03.1.ce-1.el7.centos            @docker-ce-stable</span></span><br><span class="line"><span class="comment">#   docker-ce.x86_64            17.03.0.ce-1.el7.centos            docker-ce-stable</span></span><br><span class="line"><span class="comment">#   Available Packages</span></span><br><span class="line"><span class="comment"># Step2: å®‰è£…æŒ‡å®šç‰ˆæœ¬çš„Docker-CE: (VERSIONä¾‹å¦‚ä¸Šé¢çš„17.03.0.ce.1-1.el7.centos)</span></span><br><span class="line"><span class="comment"># sudo yum -y install docker-ce-[VERSION]</span></span><br></pre></td></tr></table></figure><h5 id="å®‰è£…æ ¡éªŒ"><a href="#å®‰è£…æ ¡éªŒ" class="headerlink" title="å®‰è£…æ ¡éªŒ"></a>å®‰è£…æ ¡éªŒ</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">[root@izuf6gp8l1zfgu3hmvia6gz ~]<span class="comment"># docker version</span></span><br><span class="line">Client: Docker Engine - Community</span><br><span class="line"> Version:           19.03.5</span><br><span class="line"> API version:       1.40</span><br><span class="line"> Go version:        go1.12.12</span><br><span class="line"> Git commit:        633a0ea</span><br><span class="line"> Built:             Wed Nov 13 07:25:41 2019</span><br><span class="line"> OS/Arch:           linux/amd64</span><br><span class="line"> Experimental:      <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">Server: Docker Engine - Community</span><br><span class="line"> Engine:</span><br><span class="line">  Version:          19.03.5</span><br><span class="line">  API version:      1.40 (minimum version 1.12)</span><br><span class="line">  Go version:       go1.12.12</span><br><span class="line">  Git commit:       633a0ea</span><br><span class="line">  Built:            Wed Nov 13 07:24:18 2019</span><br><span class="line">  OS/Arch:          linux/amd64</span><br><span class="line">  Experimental:     <span class="literal">false</span></span><br><span class="line"> containerd:</span><br><span class="line">  Version:          1.2.10</span><br><span class="line">  GitCommit:        b34a5c8af56e510852c35414db4c1f4fa6172339</span><br><span class="line"> runc:</span><br><span class="line">  Version:          1.0.0-rc8+dev</span><br><span class="line">  GitCommit:        3e425f80a8c931f88e6d94a8c831b9d5aa481657</span><br><span class="line"> docker-init:</span><br><span class="line">  Version:          0.18.0</span><br><span class="line">  GitCommit:        fec3683</span><br></pre></td></tr></table></figure><p>è‡³æ­¤dockerå®‰è£…å®Œæˆã€‚</p><p><a href="https://help.aliyun.com/document_detail/60742.html#title-8ov-nf9-t1l" target="_blank" rel="noopener">å‚è€ƒèµ„æ–™</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> docker </tag>
            
            <tag> centos </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Macä¸‹å®‰è£…zookeeper</title>
      <link href="/post/d97b6c63.html"/>
      <url>/post/d97b6c63.html</url>
      
        <content type="html"><![CDATA[<p>ä»<a href="https://archive.apache.org/dist/zookeeper/zookeeper-3.5.6/" target="_blank" rel="noopener">zookeeper</a>ä¸‹è½½ï¼Œæ³¨æ„ä¸‹è½½å¸¦-binåç¼€çš„å®‰è£…åŒ…ï¼Œä¸ç„¶å®‰è£…ä¹‹åå¯åŠ¨ä¼šå‡ºç°ä»¥ä¸‹çš„é”™è¯¯ã€‚</p><a id="more"></a><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">é”™è¯¯: æ‰¾ä¸åˆ°æˆ–æ— æ³•åŠ è½½ä¸»ç±»org.apache.zookeeper.server.quorum.QuorumPeerMain</span><br></pre></td></tr></table></figure><p>è§£å†³æ–¹æ¡ˆ<br>åŸæ¥æ˜¯å› ä¸ºä»ç‰ˆæœ¬3.5.5å¼€å§‹ï¼Œå¸¦æœ‰binåç§°çš„åŒ…æ‰æ˜¯æˆ‘ä»¬æƒ³è¦çš„ä¸‹è½½å¯ä»¥ç›´æ¥ä½¿ç”¨çš„é‡Œé¢æœ‰ç¼–è¯‘åçš„äºŒè¿›åˆ¶çš„åŒ…ï¼Œè€Œä¹‹å‰çš„æ™®é€šçš„tar.gzçš„åŒ…é‡Œé¢æ˜¯åªæ˜¯æºç çš„åŒ…æ— æ³•ç›´æ¥ä½¿ç”¨ã€‚</p><p>å°†ä¸‹è½½åçš„å®‰è£…åŒ…è§£å‹åˆ° /usr/local/zookeeper ç›®å½•ä¸‹ï¼Œè¿›è¡Œåç»­çš„å®‰è£…é…ç½®ã€‚</p><h5 id="ç¼–è¾‘é…ç½®æ–‡ä»¶"><a href="#ç¼–è¾‘é…ç½®æ–‡ä»¶" class="headerlink" title="ç¼–è¾‘é…ç½®æ–‡ä»¶"></a>ç¼–è¾‘é…ç½®æ–‡ä»¶</h5><p>åœ¨confç›®å½•ä¸‹æ‹·è´ zoo_sample.cfg æ–‡ä»¶æ–°å»º zoo.cfgé…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹æˆ–è€…æ–°åŠ ä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># The number of milliseconds of each tick</span></span><br><span class="line">tickTime=2000</span><br><span class="line"><span class="comment"># The number of ticks that the initial </span></span><br><span class="line"><span class="comment"># synchronization phase can take</span></span><br><span class="line">initLimit=10</span><br><span class="line"><span class="comment"># The number of ticks that can pass between </span></span><br><span class="line"><span class="comment"># sending a request and getting an acknowledgement</span></span><br><span class="line">syncLimit=5</span><br><span class="line"><span class="comment"># the directory where the snapshot is stored.</span></span><br><span class="line"><span class="comment"># do not use /tmp for storage, /tmp here is just </span></span><br><span class="line"><span class="comment"># example sakes.</span></span><br><span class="line">dataDir=/usr/<span class="built_in">local</span>/zookeeper/data</span><br><span class="line"><span class="comment"># the port at which the clients will connect</span></span><br><span class="line">clientPort=2181</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#tickTime: zookeeperä¸­ä½¿ç”¨çš„åŸºæœ¬æ—¶é—´å•ä½, æ¯«ç§’å€¼.</span></span><br><span class="line"><span class="comment">#dataDir: æ•°æ®ç›®å½•. å¯ä»¥æ˜¯ä»»æ„ç›®å½•.</span></span><br><span class="line"><span class="comment">#dataLogDir: logç›®å½•, åŒæ ·å¯ä»¥æ˜¯ä»»æ„ç›®å½•. å¦‚æœæ²¡æœ‰è®¾ç½®è¯¥å‚æ•°, å°†ä½¿ç”¨å’Œ#dataDirç›¸åŒçš„è®¾ç½®.æ­¤ç›®å½•å¯ä»¥ä¸åŠ </span></span><br><span class="line"><span class="comment">#clientPort: ç›‘å¬clientè¿æ¥çš„ç«¯å£å·.</span></span><br></pre></td></tr></table></figure><h5 id="å°†zookeeperåŠ å…¥ç³»ç»Ÿç¯å¢ƒå˜é‡ä¸­"><a href="#å°†zookeeperåŠ å…¥ç³»ç»Ÿç¯å¢ƒå˜é‡ä¸­" class="headerlink" title="å°†zookeeperåŠ å…¥ç³»ç»Ÿç¯å¢ƒå˜é‡ä¸­"></a>å°†zookeeperåŠ å…¥ç³»ç»Ÿç¯å¢ƒå˜é‡ä¸­</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/profile</span><br><span class="line"></span><br><span class="line">PATH=<span class="variable">$PATH</span>:/usr/<span class="built_in">local</span>/sphinx/bin:/usr/<span class="built_in">local</span>/elasticsearch/bin:/usr/<span class="built_in">local</span>/mycat/bin:/usr/<span class="built_in">local</span>/zookeeper/bin</span><br><span class="line"><span class="built_in">export</span> PATH</span><br><span class="line"></span><br><span class="line"><span class="comment">#è®©ç¯å¢ƒå˜é‡ç«‹é©¬ç”Ÿæ•ˆ</span></span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨</span></span><br><span class="line">Sam-Mac-2:~ Sam$ zkServer.sh start</span><br><span class="line">/usr/bin/java</span><br><span class="line">ZooKeeper JMX enabled by default</span><br><span class="line">Using config: /usr/<span class="built_in">local</span>/zookeeper/bin/../conf/zoo.cfg</span><br><span class="line">Starting zookeeper ... STARTED</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…³é—­</span></span><br><span class="line">Sam-Mac-2:~ Sam$ zkServer.sh stop</span><br><span class="line">/usr/bin/java</span><br><span class="line">ZooKeeper JMX enabled by default</span><br><span class="line">Using config: /usr/<span class="built_in">local</span>/zookeeper/bin/../conf/zoo.cfg</span><br><span class="line">Stopping zookeeper ... STOPPED</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> zookeeper </tag>
            
            <tag> mac </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/post/4a17b156.html"/>
      <url>/post/4a17b156.html</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p><a id="more"></a><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html" target="_blank" rel="noopener">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>è§£å†³nested exception is java.lang.IllegalArgumentException Could not resolve placeholder alipay.appId in string value  $ {alipay.appId}</title>
      <link href="/post/cf36aee2.html"/>
      <url>/post/cf36aee2.html</url>
      
        <content type="html"><![CDATA[<p>å¼€å‘çš„æ—¶å€™å‡ºç°äº†è¿™ç§é”™è¯¯ </p><p>nested exception is java .lang.IllegalArgumentException: Could not resolve placeholder â€˜alipay.appIdâ€™ in string value<br> â€œ${alipay.appId}â€</p><a id="more"></a><p>å¤§æ„æ˜¯Springä¸èƒ½å¤„ç†ç¬¬äºŒä¸ªå±æ€§æ–‡ä»¶ä¸­çš„é…ç½®ä¿¡æ¯ï¼Œå› ä¸ºSpringä¸å…è®¸å®šä¹‰å¤šä¸ªPropertyPlaceholderConfigureræˆ–context:property-placeholderã€‚<br>Springç”¨åå°„æ‰«æçš„å‘ç°æœºåˆ¶ï¼Œåœ¨æ¢æµ‹åˆ°Springå®¹å™¨ä¸­æœ‰ä¸€ä¸ªorg.springframework.beans.factory.config.PropertyPlaceholderConfigurerçš„<br>Beanå°±ä¼šåœæ­¢å¯¹å‰©ä½™PropertyPlaceholderConfigurerçš„æ‰«æï¼ˆSpring 3.1å·²ç»ä½¿ç”¨PropertySourcesPlaceholderConfigureræ›¿ä»£ PropertyPlaceholderConfigureräº†ï¼‰ã€‚<br>æ¢å¥è¯è¯´ï¼Œå³Springå®¹å™¨ä»…å…è®¸æœ€å¤šå®šä¹‰ä¸€ä¸ªPropertyPlaceholderConfigurer(æˆ–context:property-placeholder)ï¼Œå…¶ä½™çš„ä¼šè¢«Springå¿½ç•¥æ‰ï¼ˆå…¶å®Springå¦‚æœæä¾›ä¸€ä¸ªè­¦å‘Šå°±å¥½äº†ï¼‰ã€‚ </p><h4 id="é—®é¢˜çš„è§£å†³æ–¹æ¡ˆ"><a href="#é—®é¢˜çš„è§£å†³æ–¹æ¡ˆ" class="headerlink" title="é—®é¢˜çš„è§£å†³æ–¹æ¡ˆ"></a>é—®é¢˜çš„è§£å†³æ–¹æ¡ˆ</h4><ol><li><p>é€šé…ç¬¦è§£å†³ã€é€—å·åˆ†éš”</p><ul><li>ä½¿ç”¨é€šé…ç¬¦è®©springä¸€æ¬¡æ€§è¯»å–å¤šä¸ªå±æ€§æ–‡ä»¶åˆ°ä¸€ä¸ª PropertyPlaceholderConfigurer beanä¸­<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span>  <span class="attr">location</span>=<span class="string">"classpath:conf/*.properties"</span>/&gt;</span></span><br></pre></td></tr></table></figure></li></ul><p>æˆ–è€…ä½¿ç”¨ </p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">"classpath:conf/db.properties,conf/alipay.properties"</span>/&gt;</span></span><br></pre></td></tr></table></figure></li></ol><ul><li>ä½¿ç”¨å¤šä¸ª<a href="context:property-placeholder" target="_blank" rel="noopener">context:property-placeholder</a> åˆ†å¼€å®šä¹‰ï¼Œæ³¨æ„è¦åŠ ä¸Š <strong>ignore-unresolvable</strong>  å±æ€§<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">"classpath:conf/db.properties"</span> <span class="attr">ignore-unresolvable</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">"classpath:conf/alipay.properties"</span> <span class="attr">ignore-unresolvable</span>=<span class="string">"true"</span>/&gt;</span></span><br></pre></td></tr></table></figure>åœ¨æ¯ä¸ªPropertySourcesPlaceholderConfigureré…ç½®ä¸­æ·»åŠ   <property name="ignoreUnresolvablePlaceholders" value="true"/>  æˆ–è€…åœ¨æ¯ä¸ªcontext:property-placeholderä¸­éƒ½åŠ ä¸Šignore-unresolvable=â€trueâ€  å› ä¸ºåœ¨ä½ ä½¿ç”¨@Value(â€œ${xx}â€)<br>æˆ–åœ¨xmlä¸­ä½¿ç”¨${xx}è·å–å±æ€§æ—¶ï¼ŒSpringä¼šåœ¨ç¬¬ä¸€ä¸ªè¯»å–åˆ°çš„å±æ€§æ–‡ä»¶ä¸­å»æ‰¾ï¼Œå¦‚æœæ²¡æœ‰å°±ç›´æ¥æŠ›å‡ºå¼‚å¸¸ï¼Œè€Œä¸ä¼šç»§ç»­å»ç¬¬äºŒä¸ªå±æ€§æ–‡ä»¶ä¸­æ‰¾</li></ul><ol start="2"><li>ä¸€ä¸ªPropertySourcesPlaceholderConfigurerä¸­åŒ…å«å¤šä¸ªå±æ€§æ–‡ä»¶ï¼Œå’Œæ–¹æ¡ˆ1åŸç†ç›¸åŒ<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"propertyConfigurer"</span> <span class="attr">class</span>=<span class="string">"org.springframework.context.support.PropertySourcesPlaceholderConfigurer"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"locations"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>classpath:db.properties<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>classpath:alipay.properties<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> spring </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaè·å–ä¸€å¤©çš„æœ€å¤§æ—¶é—´23:59:59å’Œæœ€å°æ—¶é—´00:00:00</title>
      <link href="/post/1ef2d20f.html"/>
      <url>/post/1ef2d20f.html</url>
      
        <content type="html"><![CDATA[<p>Javaè·å–ä¸€å¤©çš„æœ€å¤§æ—¶é—´23:59:59å’Œæœ€å°æ—¶é—´00:00:00</p><a id="more"></a><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span>  </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åŠ ä¸Šæ¯«ç§’æ•°</span></span><br><span class="line">        SimpleDateFormat sDateFormat=<span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd HH:mm:ss.SSS"</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(sDateFormat.format(getAfterYearDateMaxTime(<span class="number">3</span>)));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è‹¥å¹²å¹´ä¹‹åçš„23:59:59</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> year</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getAfterYearDateMaxTime</span><span class="params">(<span class="keyword">int</span> year)</span></span>&#123;</span><br><span class="line">        Calendar calendarEnd = Calendar.getInstance();</span><br><span class="line">        calendarEnd.setTime(<span class="keyword">new</span> Date());</span><br><span class="line">        calendarEnd.add(Calendar.YEAR,year);</span><br><span class="line">        calendarEnd.set(Calendar.HOUR_OF_DAY, <span class="number">23</span>);</span><br><span class="line">        calendarEnd.set(Calendar.MINUTE, <span class="number">59</span>);</span><br><span class="line">        calendarEnd.set(Calendar.SECOND, <span class="number">59</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// MySQLæ•°æ®åº“å¯¹äºæ¯«ç§’å¤§äº500çš„æ•°æ®è¿›è¡Œè¿›ä½ï¼Œæ‰€æœ‰å°±é€ æˆçš„MySQLä¸­çš„æ—¶é—´å¤šä¸€ç§’,é˜²æ­¢mysqlè‡ªåŠ¨åŠ ä¸€ç§’,æ¯«ç§’è®¾ä¸º0</span></span><br><span class="line">        calendarEnd.set(Calendar.MILLISECOND, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> calendarEnd.getTime();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å½“å¤©çš„æœ€å¤§æ—¶é—´23:59:59</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getDayMaxTime</span><span class="params">()</span></span>&#123;</span><br><span class="line">        Calendar calendarEnd = Calendar.getInstance();</span><br><span class="line">        calendarEnd.setTime(<span class="keyword">new</span> Date());</span><br><span class="line">        calendarEnd.set(Calendar.HOUR_OF_DAY, <span class="number">23</span>);</span><br><span class="line">        calendarEnd.set(Calendar.MINUTE, <span class="number">59</span>);</span><br><span class="line">        calendarEnd.set(Calendar.SECOND, <span class="number">59</span>);</span><br><span class="line"></span><br><span class="line">         <span class="comment">// MySQLæ•°æ®åº“å¯¹äºæ¯«ç§’å¤§äº500çš„æ•°æ®è¿›è¡Œè¿›ä½ï¼Œæ‰€æœ‰å°±é€ æˆçš„MySQLä¸­çš„æ—¶é—´å¤šä¸€ç§’,é˜²æ­¢mysqlè‡ªåŠ¨åŠ ä¸€ç§’,æ¯«ç§’è®¾ä¸º0</span></span><br><span class="line">        calendarEnd.set(Calendar.MILLISECOND, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> calendarEnd.getTime();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å½“å¤©çš„æœ€å°æ—¶é—´00:00:00</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getDayMinTime</span><span class="params">()</span></span>&#123;</span><br><span class="line">        Calendar calendarEnd = Calendar.getInstance();</span><br><span class="line">        calendarEnd.setTime(<span class="keyword">new</span> Date());</span><br><span class="line">        calendarEnd.set(Calendar.HOUR_OF_DAY, <span class="number">00</span>);</span><br><span class="line">        calendarEnd.set(Calendar.MINUTE, <span class="number">00</span>);</span><br><span class="line">        calendarEnd.set(Calendar.SECOND, <span class="number">00</span>);</span><br><span class="line"></span><br><span class="line">         <span class="comment">// MySQLæ•°æ®åº“å¯¹äºæ¯«ç§’å¤§äº500çš„æ•°æ®è¿›è¡Œè¿›ä½ï¼Œæ‰€æœ‰å°±é€ æˆçš„MySQLä¸­çš„æ—¶é—´å¤šä¸€ç§’,é˜²æ­¢mysqlè‡ªåŠ¨åŠ ä¸€ç§’,æ¯«ç§’è®¾ä¸º0</span></span><br><span class="line">        calendarEnd.set(Calendar.MILLISECOND, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> calendarEnd.getTime();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è·å–3å¹´åçš„23:59:59ï¼Œæ¯«ç§’æ•°è®¾ç½®æˆ0</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2022</span>-<span class="number">09</span>-<span class="number">04</span> <span class="number">23</span>:<span class="number">59</span>:<span class="number">59.000</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>IDEAä¸‹tomcatå¯åŠ¨å serverä¹±ç ï¼ŒTomcat Catalina Logå’ŒTomcat Localhost Logä¹±ç é—®é¢˜çš„è§£å†³ </title>
      <link href="/post/35c3eddf.html"/>
      <url>/post/35c3eddf.html</url>
      
        <content type="html"><![CDATA[<h4 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h4><p>ä¸æ”¹çš„è¯ï¼Œä¸å½±å“ä½¿ç”¨ï¼Œå› ä¸ºæŠ¥é”™åŸºæœ¬éƒ½æ˜¯è‹±æ–‡æ˜¾ç¤ºçš„ã€‚ä½†æ˜¯è¿™å‡ ä¸ªä¸­æ–‡å­—ä¹±ç çš„çœ‹ç€éš¾å—ã€‚</p><p>ä¹±ç çš„æ ¹æœ¬åŸå› ï¼š</p><p>Windowsç³»ç»Ÿçš„cmdæ˜¯GBKç¼–ç çš„ï¼Œæ‰€ä»¥IDEAçš„ä¸‹æ–¹logè¾“å‡ºçš„éƒ¨åˆ†çš„ç¼–ç ä¹Ÿæ˜¯GBKçš„ï¼Œç„¶è€ŒTomcat 9.0 ç‰ˆæœ¬é»˜è®¤logè¾“å‡ºæ˜¯UTF-8ç¼–ç çš„ï¼Œé‡‡ç”¨äº†ä¸¤ç§ä¸åŒçš„ç¼–ç æ–¹å¼å°±ä¼šå¯¼è‡´ä¹±ç ã€‚</p><a id="more"></a><h4 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h4><h5 id="æ–¹æ³•ä¸€-ä¿®æ”¹Tomcat-æ—¥å¿—è¾“å‡ºä¸ºGBKç¼–ç "><a href="#æ–¹æ³•ä¸€-ä¿®æ”¹Tomcat-æ—¥å¿—è¾“å‡ºä¸ºGBKç¼–ç " class="headerlink" title="æ–¹æ³•ä¸€ ä¿®æ”¹Tomcat æ—¥å¿—è¾“å‡ºä¸ºGBKç¼–ç "></a>æ–¹æ³•ä¸€ ä¿®æ”¹Tomcat æ—¥å¿—è¾“å‡ºä¸ºGBKç¼–ç </h5><p>å…ˆæ‰“å¼€tomcatçš„å®‰è£…ç›®å½•</p><p>ç¼–è¾‘ conf ç›®å½•ä¸‹çš„ logging.properties,æŠŠé‡Œé¢çš„UTF-8 é€šé€šæ”¹æˆ GBK,ä¿å­˜ï¼Œé‡å¯Tomcatï¼Œå³å¯ç”Ÿæ•ˆã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"># Licensed to the Apache Software Foundation (ASF) under one or more</span><br><span class="line"># contributor license agreements.  See the NOTICE file distributed with</span><br><span class="line"># this work for additional information regarding copyright ownership.</span><br><span class="line"># The ASF licenses this file to You under the Apache License, Version 2.0</span><br><span class="line"># (the "License"); you may not use this file except in compliance with</span><br><span class="line"># the License.  You may obtain a copy of the License at</span><br><span class="line">#</span><br><span class="line">#     http://www.apache.org/licenses/LICENSE-2.0</span><br><span class="line">#</span><br><span class="line"># Unless required by applicable law or agreed to in writing, software</span><br><span class="line"># distributed under the License is distributed on an "AS IS" BASIS,</span><br><span class="line"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span><br><span class="line"># See the License for the specific language governing permissions and</span><br><span class="line"># limitations under the License.</span><br><span class="line"></span><br><span class="line">handlers = 1catalina.org.apache.juli.FileHandler, 2localhost.org.apache.juli.FileHandler, 3manager.org.apache.juli.FileHandler, 4host-manager.org.apache.juli.FileHandler, java.util.logging.ConsoleHandler</span><br><span class="line"></span><br><span class="line">.handlers = 1catalina.org.apache.juli.FileHandler, java.util.logging.ConsoleHandler</span><br><span class="line"></span><br><span class="line">############################################################</span><br><span class="line"># Handler specific properties.</span><br><span class="line"># Describes specific configuration info for Handlers.</span><br><span class="line">############################################################</span><br><span class="line"></span><br><span class="line">1catalina.org.apache.juli.FileHandler.level = FINE</span><br><span class="line">1catalina.org.apache.juli.FileHandler.directory = $&#123;catalina.base&#125;/logs</span><br><span class="line">1catalina.org.apache.juli.FileHandler.prefix = catalina.</span><br><span class="line">1catalina.org.apache.juli.FileHandler.encoding = UTF-8</span><br><span class="line"></span><br><span class="line">2localhost.org.apache.juli.FileHandler.level = FINE</span><br><span class="line">2localhost.org.apache.juli.FileHandler.directory = $&#123;catalina.base&#125;/logs</span><br><span class="line">2localhost.org.apache.juli.FileHandler.prefix = localhost.</span><br><span class="line">2localhost.org.apache.juli.FileHandler.encoding = UTF-8</span><br><span class="line"></span><br><span class="line">3manager.org.apache.juli.FileHandler.level = FINE</span><br><span class="line">3manager.org.apache.juli.FileHandler.directory = $&#123;catalina.base&#125;/logs</span><br><span class="line">3manager.org.apache.juli.FileHandler.prefix = manager.</span><br><span class="line">3manager.org.apache.juli.FileHandler.encoding = UTF-8</span><br><span class="line"></span><br><span class="line">4host-manager.org.apache.juli.FileHandler.level = FINE</span><br><span class="line">4host-manager.org.apache.juli.FileHandler.directory = $&#123;catalina.base&#125;/logs</span><br><span class="line">4host-manager.org.apache.juli.FileHandler.prefix = host-manager.</span><br><span class="line">4host-manager.org.apache.juli.FileHandler.encoding = UTF-8</span><br><span class="line"></span><br><span class="line">java.util.logging.ConsoleHandler.level = FINE</span><br><span class="line">java.util.logging.ConsoleHandler.formatter = java.util.logging.SimpleFormatter</span><br><span class="line">java.util.logging.ConsoleHandler.encoding = UTF-8</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">############################################################</span><br><span class="line"># Facility specific properties.</span><br><span class="line"># Provides extra control for each logger.</span><br><span class="line">############################################################</span><br><span class="line"></span><br><span class="line">org.apache.catalina.core.ContainerBase.[Catalina].[localhost].level = INFO</span><br><span class="line">org.apache.catalina.core.ContainerBase.[Catalina].[localhost].handlers = 2localhost.org.apache.juli.FileHandler</span><br><span class="line"></span><br><span class="line">org.apache.catalina.core.ContainerBase.[Catalina].[localhost].[/manager].level = INFO</span><br><span class="line">org.apache.catalina.core.ContainerBase.[Catalina].[localhost].[/manager].handlers = 3manager.org.apache.juli.FileHandler</span><br><span class="line"></span><br><span class="line">org.apache.catalina.core.ContainerBase.[Catalina].[localhost].[/host-manager].level = INFO</span><br><span class="line">org.apache.catalina.core.ContainerBase.[Catalina].[localhost].[/host-manager].handlers = 4host-manager.org.apache.juli.FileHandler</span><br><span class="line"></span><br><span class="line"># For example, set the org.apache.catalina.util.LifecycleBase logger to log</span><br><span class="line"># each component that extends LifecycleBase changing state:</span><br><span class="line">#org.apache.catalina.util.LifecycleBase.level = FINE</span><br><span class="line"></span><br><span class="line"># To see debug messages in TldLocationsCache, uncomment the following line:</span><br><span class="line">#org.apache.jasper.compiler.TldLocationsCache.level = FINE</span><br><span class="line"></span><br><span class="line">java.util.logging.ConsoleHandler.encoding = UTF-8</span><br></pre></td></tr></table></figure><h5 id="æ–¹æ³•äºŒ-ä¿®æ”¹IDEAä¸ºUTF-8ç¼–ç "><a href="#æ–¹æ³•äºŒ-ä¿®æ”¹IDEAä¸ºUTF-8ç¼–ç " class="headerlink" title="æ–¹æ³•äºŒ ä¿®æ”¹IDEAä¸ºUTF-8ç¼–ç "></a>æ–¹æ³•äºŒ ä¿®æ”¹IDEAä¸ºUTF-8ç¼–ç </h5><p>idea.exe.vmoptionsã€idea64.exe.vmoptions</p><p>ä¿®æ”¹idea.exe.vmoptionså’Œidea64.exe.vmoptionsè¿™ä¸¤ä¸ªæ–‡ä»¶</p><p>åˆ†åˆ«åœ¨è¿™ä¸¤ä¸ªæ–‡ä»¶çš„æœ€åï¼Œæ·»åŠ ä¸€è¡Œ -Dfile.encoding=UTF-8</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">-Xms128m</span><br><span class="line">-Xmx750m</span><br><span class="line">-XX:ReservedCodeCacheSize=<span class="number">240</span>m</span><br><span class="line">-XX:+UseConcMarkSweepGC</span><br><span class="line">-XX:SoftRefLRUPolicyMSPerMB=<span class="number">50</span></span><br><span class="line">-ea</span><br><span class="line">-Dsun.io.useCanonCaches=<span class="keyword">false</span></span><br><span class="line">-Djava.net.preferIPv4Stack=<span class="keyword">true</span></span><br><span class="line">-Djdk.http.auth.tunneling.disabledSchemes=<span class="string">""</span></span><br><span class="line">-XX:+HeapDumpOnOutOfMemoryError</span><br><span class="line">-XX:-OmitStackTraceInFastThrow</span><br><span class="line"></span><br><span class="line">-Dfile.encoding=UTF-<span class="number">8</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå‚æ•°çš„ä½œç”¨æ˜¯å¼ºåˆ¶ç³»ç»Ÿæ–‡ä»¶ä½¿ç”¨UTF-8ç¼–ç ,æ”¹å®Œä¹‹åä¿å­˜ï¼Œé‡å¯IDEAå³å¯ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> tomcat </tag>
            
            <tag> idea </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScriptå¦‚ä½•é¢å‘å¯¹è±¡</title>
      <link href="/post/d7445999.html"/>
      <url>/post/d7445999.html</url>
      
        <content type="html"><![CDATA[<p>å…³äºJavaScriptç¼–å†™ç±»çš„æ–¹å¼ï¼Œæ€»ç»“ä¸€ä¸‹JavaScriptç¼–å†™ç±»çš„å‡ ç§å†™æ³•ä»¥åŠè¿™å‡ ç§å†™æ³•çš„ä¼˜ç¼ºç‚¹ã€‚</p><a id="more"></a><h4 id="æ„é€ å‡½æ•°æ–¹å¼"><a href="#æ„é€ å‡½æ•°æ–¹å¼" class="headerlink" title="æ„é€ å‡½æ•°æ–¹å¼"></a>æ„é€ å‡½æ•°æ–¹å¼</h4><p>åŸºæœ¬è¯­æ³•ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> ç±»å(<span class="params"></span>)</span>&#123;</span><br><span class="line">     <span class="keyword">this</span>.å±æ€§å;<span class="comment">//å…¬å…±å±æ€§</span></span><br><span class="line">     <span class="keyword">var</span> å±æ€§å;<span class="comment">//ç§æœ‰å±æ€§</span></span><br><span class="line">    <span class="comment">/*å‡¡æ˜¯å®šä¹‰ç±»çš„å…¬å…±å±æ€§å’Œå…¬å…±æ–¹æ³•éƒ½è¦ä½¿ç”¨this*/</span></span><br><span class="line">    <span class="comment">//å®šä¹‰ç±»çš„å…¬å…±å‡½æ•°</span></span><br><span class="line">    <span class="keyword">this</span>.å‡½æ•°å=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            ..... </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å®šä¹‰ç±»çš„ç§æœ‰å‡½æ•°</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> å‡½æ•°å(<span class="params"></span>)</span>&#123;</span><br><span class="line">ã€€ã€€ã€€ã€€......</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/*å®šä¹‰ä¸€ä¸ªPersonç±»*/</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">_name,_age,_salary</span>)</span>&#123;</span><br><span class="line">        <span class="comment">//Personç±»çš„å…¬å¼€å±æ€§ï¼Œç±»çš„å…¬å¼€å±æ€§çš„å®šä¹‰æ–¹å¼æ˜¯ï¼šâ€this.å±æ€§åâ€œ</span></span><br><span class="line">        <span class="keyword">this</span>.name=_name;</span><br><span class="line">        <span class="comment">//Personç±»çš„ç§æœ‰å±æ€§ï¼Œç±»çš„ç§æœ‰å±æ€§çš„å®šä¹‰æ–¹å¼æ˜¯ï¼šâ€var å±æ€§åâ€œ</span></span><br><span class="line">        <span class="keyword">var</span> age=_age;<span class="comment">//ç§æœ‰å±æ€§</span></span><br><span class="line">        <span class="keyword">var</span> salary=_salary;<span class="comment">//ç§æœ‰å±æ€§</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">/*å®šä¹‰ç§æœ‰å±æ€§Ageçš„å¯¹å¤–å…¬å¼€è®¿é—®æ–¹æ³•*/</span></span><br><span class="line">        <span class="keyword">this</span>.setAge = <span class="function"><span class="keyword">function</span>(<span class="params">intAge</span>) </span>&#123;</span><br><span class="line">            age = intAge;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/*å®šä¹‰ç§æœ‰å±æ€§Ageçš„å¯¹å¤–å…¬å¼€è®¿é—®æ–¹æ³•*/</span></span><br><span class="line">        <span class="keyword">this</span>.getAge = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> age;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å®šä¹‰Personç±»çš„å…¬å¼€æ–¹æ³•(ç‰¹æƒæ–¹æ³•)ï¼Œç±»çš„å…¬å¼€æ–¹æ³•çš„å®šä¹‰æ–¹å¼æ˜¯ï¼šâ€this.functionName=function()&#123;.....&#125;â€œ</span></span><br><span class="line">        <span class="keyword">this</span>.Show=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="built_in">document</span>.writeln(<span class="string">"åœ¨å…¬å¼€æ–¹æ³•é‡Œé¢è®¿é—®ç±»çš„ç§æœ‰å±æ€§æ˜¯å…è®¸çš„ï¼Œage="</span>+age+<span class="string">"\t"</span>+<span class="string">"salary="</span>+salary);<span class="comment">//åœ¨å…¬å¼€æ–¹æ³•é‡Œé¢è®¿é—®ç±»çš„ç§æœ‰å±æ€§æ˜¯å…è®¸çš„</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//å…¬å…±æ–¹æ³•</span></span><br><span class="line">        <span class="keyword">this</span>.publicMethod = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="built_in">document</span>.writeln(<span class="string">"åœ¨å…¬å¼€æ–¹æ³•é‡Œé¢è®¿é—®ç±»çš„ç§æœ‰æ–¹æ³•æ˜¯å…è®¸çš„"</span>);</span><br><span class="line">            privateFn();<span class="comment">//åœ¨å…¬å¼€æ–¹æ³•é‡Œé¢è°ƒç”¨ç±»çš„ç§æœ‰æ–¹æ³•</span></span><br><span class="line">            privateFn2();<span class="comment">//åœ¨å…¬å¼€æ–¹æ³•é‡Œé¢è°ƒç”¨ç±»çš„ç§æœ‰æ–¹æ³•</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        å®šä¹‰Personç±»çš„ç§æœ‰æ–¹æ³•(å†…éƒ¨æ–¹æ³•)ï¼Œ</span></span><br><span class="line"><span class="comment">        ç±»çš„ç§æœ‰æ–¹æ³•çš„å®šä¹‰æ–¹å¼æ˜¯ï¼šâ€function functionName()&#123;.....&#125;â€œï¼Œ</span></span><br><span class="line"><span class="comment">        æˆ–è€… var functionName=function()&#123;....&#125;</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">privateFn</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="built_in">document</span>.writeln(<span class="string">"æˆ‘æ˜¯Personç±»çš„ç§æœ‰å‡½æ•°privateFn"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> privateFn2=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="built_in">document</span>.writeln(<span class="string">"æˆ‘æ˜¯Personç±»çš„ç§æœ‰å‡½æ•°privateFn2"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•Personç±»</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> Person(<span class="string">"å­¤å‚²è‹ç‹¼"</span>,<span class="number">24</span>,<span class="number">2300</span>);</span><br><span class="line">    <span class="keyword">var</span> p2 = <span class="keyword">new</span> Person(<span class="string">"ç™½è™ç¥çš‡"</span>,<span class="number">24</span>,<span class="number">2300</span>);</span><br><span class="line">    <span class="built_in">document</span>.write(<span class="string">"&lt;pre&gt;"</span>);</span><br><span class="line">    <span class="built_in">document</span>.writeln(<span class="string">"p1 instanceof Personçš„ç»“æœæ˜¯ï¼š"</span>+(p1 <span class="keyword">instanceof</span> Person));<span class="comment">//p1æ˜¯Personç±»çš„å®ä¾‹ï¼Œç»“æœæ˜¯true</span></span><br><span class="line">    <span class="built_in">document</span>.writeln(<span class="string">"p2 instanceof Personçš„ç»“æœæ˜¯ï¼š"</span>+(p2 <span class="keyword">instanceof</span> Person));<span class="comment">//p2æ˜¯Personç±»çš„å®ä¾‹ï¼Œç»“æœæ˜¯true</span></span><br><span class="line">    <span class="comment">//å½“==ä¸¤è¾¹çš„å†…å®¹æ˜¯å¯¹è±¡æˆ–è€…æ˜¯å¯¹è±¡çš„å‡½æ•°å±æ€§æ—¶ï¼Œåˆ™æ¯”è¾ƒå†…å­˜åœ°å€æ˜¯å¦ç›¸ç­‰</span></span><br><span class="line">    <span class="built_in">document</span>.writeln(<span class="string">"å½“==ä¸¤è¾¹çš„å†…å®¹æ˜¯å¯¹è±¡æˆ–è€…æ˜¯å¯¹è±¡çš„å‡½æ•°å±æ€§æ—¶ï¼Œåˆ™æ¯”è¾ƒå†…å­˜åœ°å€æ˜¯å¦ç›¸ç­‰"</span>);</span><br><span class="line">    <span class="built_in">document</span>.writeln(<span class="string">"æ¯”è¾ƒp1å’Œp2è¿™ä¸¤ä¸ªå¯¹è±¡çš„showæ–¹æ³•çš„å†…å­˜åœ°å€æ˜¯å¦ä¸€æ ·ï¼šp1.show== p2.showçš„ç»“æœæ˜¯ï¼š"</span>+(p1.show == p2.show));<span class="comment">//false</span></span><br><span class="line">    <span class="built_in">document</span>.writeln(<span class="string">"p1.show == p2.showçš„ç»“æœæ˜¯ï¼š"</span>+(p1.show == p2.show)+<span class="string">"ï¼Œè¿™è¯æ˜p1å¯¹è±¡å’Œp2å¯¹è±¡ä¸æ˜¯å…±äº«ä¸€ä¸ªshowæ–¹æ³•ï¼Œåœ¨å†…å­˜ä¸­showæ–¹æ³•çš„ä»£ç æœ‰2ä»½ï¼Œå­˜æ”¾åœ¨ä¸¤å—å†…å­˜åŒºåŸŸ"</span>);</span><br><span class="line">    <span class="built_in">document</span>.writeln(<span class="string">"nameæ˜¯Personç±»å®šä¹‰çš„publicå±æ€§ï¼Œå¯ä»¥ä½¿ç”¨ç±»çš„å¯¹è±¡å»ç›´æ¥è®¿é—®ç±»çš„publicå±æ€§"</span>);</span><br><span class="line">    <span class="built_in">document</span>.writeln(<span class="string">"p1.name="</span>+p1.name);<span class="comment">//è®¿é—®å…¬æœ‰å±æ€§ï¼Œè¿™æ˜¯å¯ä»¥æ­£å¸¸è®¿é—®çš„</span></span><br><span class="line">    <span class="built_in">document</span>.writeln(<span class="string">"ageå’Œsalaryæ˜¯Personç±»å®šä¹‰çš„privateå±æ€§ï¼Œä¸èƒ½ä½¿ç”¨ç±»çš„å¯¹è±¡å»ç›´æ¥è®¿é—®ç±»ç§æœ‰å±æ€§ï¼Œè¿™æ˜¯è®¿é—®ä¸äº†çš„ï¼Œç»“æœéƒ½æ˜¯undefined"</span>);</span><br><span class="line">    <span class="built_in">document</span>.writeln(<span class="string">"p1.age="</span>+p1.age+<span class="string">"ï¼Œ"</span>+<span class="string">"p1.salary="</span>+p1.salary)<span class="comment">//ä¸èƒ½ä½¿ç”¨ç±»çš„å¯¹è±¡å»ç›´æ¥è®¿é—®ç±»ç§æœ‰å±æ€§ï¼Œè¿™æ˜¯è®¿é—®ä¸äº†çš„ï¼Œç»“æœéƒ½æ˜¯undefined</span></span><br><span class="line">    p1.show();<span class="comment">//è°ƒç”¨ç±»çš„å…¬å…±å‡½æ•°ï¼Œè¿™æ¬¡å…è®¸çš„</span></span><br><span class="line">    p1.publicMethod();<span class="comment">//è°ƒç”¨ç±»çš„å…¬å…±å‡½æ•°ï¼Œè¿™æ¬¡å…è®¸çš„</span></span><br><span class="line">    p1.setAge(<span class="number">24</span>);<span class="comment">//ä½¿ç”¨publicæ–¹æ³•setAgeæ–¹æ³•ä¸ºç§æœ‰å±æ€§ageèµ‹å€¼</span></span><br><span class="line">    <span class="built_in">document</span>.writeln(<span class="string">"ä½¿ç”¨publicæ–¹æ³•getAgeæ–¹æ³•è·å–ç§æœ‰å±æ€§ageçš„å€¼ï¼Œp1.getAge()="</span>+p1.getAge());<span class="comment">//ä½¿ç”¨getAgeæ–¹æ³•è·å–ç§æœ‰å±æ€§ageçš„å€¼</span></span><br><span class="line">    <span class="comment">//document.writeln("p1.privateFn()ï¼š"+p1.privateFn()+"&amp;nbsp;p1.privateFn2()ï¼š"+p1.privateFn2());//ä¸èƒ½ä½¿ç”¨ç±»çš„å¯¹è±¡å»è°ƒç”¨ç±»çš„ç§æœ‰æ–¹æ³•ï¼Œè¿™é‡Œä¼šæŠ¥é”™â€å¯¹è±¡ä¸æ”¯æŒæ­¤å±æ€§æˆ–è€…æ–¹æ³•</span></span><br><span class="line">    <span class="built_in">document</span>.write(<span class="string">"&lt;/pre&gt;"</span>);</span><br></pre></td></tr></table></figure><p>è¿™ç§æ–¹å¼çš„ä¼˜ç‚¹æ˜¯ï¼šå¯ä»¥æ ¹æ®å‚æ•°æ¥æ„é€ ä¸åŒçš„å¯¹è±¡å®ä¾‹ ï¼Œæ¯ä¸ªå¯¹è±¡çš„å±æ€§ä¸€èˆ¬æ˜¯ä¸ç›¸åŒçš„ï¼Œç¼ºç‚¹æ˜¯æ„é€ æ¯ä¸ªå®ä¾‹å¯¹è±¡æ—¶ï¼Œæ–¹æ³•ä¸èƒ½å…±äº«ï¼ŒPersonç±»é‡Œé¢å®šä¹‰çš„é‚£äº›æ–¹æ³•ï¼Œp1å¯¹è±¡æœ‰ä¸€ä»½ï¼Œp2ä¹Ÿæœ‰ä¸€ä»½ï¼Œé‚£ä¹ˆåœ¨å†…å­˜ä¸­å°±å¾—å¼€è¾Ÿä¸¤å—å†…å­˜ç©ºé—´æ¥åˆ†åˆ«å­˜å‚¨p1çš„æ–¹æ³•å’Œp2çš„æ–¹æ³•ï¼Œè¿™æ ·å°±é€ æˆäº†å†…å­˜çš„æµªè´¹ã€‚å¯¹äºä¸€ä¸ªç±»çš„ä¸åŒå®ä¾‹å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡çš„å±æ€§ä¸€èˆ¬æ˜¯ä¸ç›¸åŒçš„ï¼Œä½†æ˜¯æ–¹æ³•æ˜¯ç›¸åŒçš„ï¼Œæ‰€ä»¥èŠ‚çº¦å†…å­˜çš„åšæ³•å°±æ˜¯æŠŠæ–¹æ³•æ”¾åˆ°å†…å­˜çš„ä¸€å—åŒºåŸŸä¸­å­˜æ”¾ï¼Œç„¶åæ¯ä¸ªå®ä¾‹å¯¹è±¡éƒ½ä»è¿™å—å†…å­˜ä¸­å–å‡ºæ–¹æ³•ã€‚</p><h4 id="åŸå‹æ–¹å¼"><a href="#åŸå‹æ–¹å¼" class="headerlink" title="åŸå‹æ–¹å¼"></a>åŸå‹æ–¹å¼</h4><p>éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œä½¿ç”¨åŸå‹æ–¹å¼ç¼–å†™JavaScriptç±»æ˜¯æ— æ³•ç»™ç±»æ·»åŠ ç§æœ‰å±æ€§å’Œç§æœ‰æ–¹æ³•çš„ï¼Œä½¿ç”¨åŸå‹æ–¹å¼æ·»åŠ çš„å±æ€§å’Œæ–¹æ³•éƒ½æ˜¯publicçš„ã€‚</p><ul><li><p>å†™æ³•ä¸€</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/*å®šä¹‰ä¸€ä¸ªPersonç±»*/</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">_name,_age,_weight,_height</span>)</span>&#123;</span><br><span class="line">       <span class="keyword">this</span>.init(_name,_age,_weight,_height);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*ä½¿ç”¨åŸå‹çš„æ–¹å¼å®šä¹‰Personç±»çš„publicå±æ€§ï¼šname,age,weight,heightï¼Œä½¿ç”¨åŸå‹çš„æ–¹å¼æ·»åŠ çš„å±æ€§éƒ½æ˜¯publicçš„*/</span></span><br><span class="line">    Person.prototype.name;</span><br><span class="line">    Person.prototype.age;</span><br><span class="line">    Person.prototype.weight;</span><br><span class="line">    Person.prototype.height;</span><br><span class="line">    <span class="comment">/*ä½¿ç”¨åŸå‹çš„æ–¹å¼ç»™Personç±»æ·»åŠ publicæ–¹æ³•ï¼Œä½¿ç”¨åŸå‹çš„æ–¹å¼æ·»åŠ çš„æ–¹æ³•éƒ½æ˜¯publicçš„*/</span></span><br><span class="line">    <span class="comment">/*ä½¿ç”¨åŸå‹çš„æ–¹å¼ç»™Personç±»æ·»åŠ initæ–¹æ³•*/</span></span><br><span class="line">    Person.prototype.init = <span class="function"><span class="keyword">function</span>(<span class="params">_name,_age,_weight,_height</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(_name != <span class="literal">undefined</span> &amp;&amp; _age!=<span class="literal">undefined</span> &amp;&amp; _weight!=<span class="literal">undefined</span> &amp;&amp; _height!=<span class="literal">undefined</span>)&#123;</span><br><span class="line">            <span class="keyword">this</span>.name = _name;</span><br><span class="line">            <span class="keyword">this</span>.age = _age;</span><br><span class="line">            <span class="keyword">this</span>.weight=_weight;</span><br><span class="line">            <span class="keyword">this</span>.height=_height;</span><br><span class="line">            <span class="built_in">document</span>.writeln(<span class="string">"this.name="</span>+<span class="keyword">this</span>.name+<span class="string">",this.age="</span>+<span class="keyword">this</span>.age+<span class="string">",this.weight="</span>+<span class="keyword">this</span>.weight+<span class="string">",this.height="</span>+<span class="keyword">this</span>.height);</span><br><span class="line">        &#125;</span><br><span class="line">         </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*ä½¿ç”¨åŸå‹çš„æ–¹å¼ç»™Personç±»æ·»åŠ showæ–¹æ³•*/</span></span><br><span class="line">    Person.prototype.show = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">document</span>.writeln(<span class="string">"show method"</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.write(<span class="string">"&lt;pre&gt;"</span>);</span><br><span class="line">    <span class="keyword">var</span> p1 = <span class="keyword">new</span> Person(<span class="string">"å­¤å‚²è‹ç‹¼"</span>,<span class="number">24</span>,<span class="number">115</span>,<span class="number">160</span>);</span><br><span class="line">    <span class="keyword">var</span> p2 = <span class="keyword">new</span> Person(<span class="string">"ç™½è™ç¥çš‡"</span>,<span class="number">25</span>,<span class="number">120</span>,<span class="number">170</span>);</span><br><span class="line">    <span class="keyword">var</span> p3 = <span class="keyword">new</span> Person();</span><br><span class="line">    p3.init(<span class="string">"ç„å¤©é‚ªå¸"</span>,<span class="number">26</span>,<span class="number">130</span>,<span class="number">180</span>);<span class="comment">//è°ƒç”¨publicæ–¹æ³•initåˆå§‹åŒ–p3å¯¹è±¡</span></span><br><span class="line">    <span class="built_in">document</span>.writeln(<span class="string">"p1 instanceof Personçš„ç»“æœæ˜¯ï¼š"</span>+(p1 <span class="keyword">instanceof</span> Person));<span class="comment">//p1æ˜¯Personç±»çš„å®ä¾‹ï¼Œç»“æœæ˜¯true</span></span><br><span class="line">    <span class="built_in">document</span>.writeln(<span class="string">"p2 instanceof Personçš„ç»“æœæ˜¯ï¼š"</span>+(p2 <span class="keyword">instanceof</span> Person));<span class="comment">//p2æ˜¯Personç±»çš„å®ä¾‹ï¼Œç»“æœæ˜¯true</span></span><br><span class="line">    <span class="built_in">document</span>.writeln(<span class="string">"p3 instanceof Personçš„ç»“æœæ˜¯ï¼š"</span>+(p3 <span class="keyword">instanceof</span> Person));<span class="comment">//p3æ˜¯Personç±»çš„å®ä¾‹ï¼Œç»“æœæ˜¯true</span></span><br><span class="line">    <span class="comment">//å½“==ä¸¤è¾¹çš„å†…å®¹æ˜¯å¯¹è±¡æˆ–è€…æ˜¯å¯¹è±¡çš„å‡½æ•°å±æ€§æ—¶ï¼Œåˆ™æ¯”è¾ƒå†…å­˜åœ°å€æ˜¯å¦ç›¸ç­‰</span></span><br><span class="line">    <span class="built_in">document</span>.writeln(<span class="string">"å½“==ä¸¤è¾¹çš„å†…å®¹æ˜¯å¯¹è±¡æˆ–è€…æ˜¯å¯¹è±¡çš„å‡½æ•°å±æ€§æ—¶ï¼Œåˆ™æ¯”è¾ƒå†…å­˜åœ°å€æ˜¯å¦ç›¸ç­‰"</span>);</span><br><span class="line">    <span class="built_in">document</span>.writeln(<span class="string">"æ¯”è¾ƒp1å’Œp2è¿™ä¸¤ä¸ªå¯¹è±¡çš„showæ–¹æ³•çš„å†…å­˜åœ°å€æ˜¯å¦ä¸€æ ·ï¼šp1.show == p2.showçš„ç»“æœæ˜¯ï¼š"</span>+(p1.show == p2.show));<span class="comment">//true</span></span><br><span class="line">    <span class="built_in">document</span>.writeln(<span class="string">"p1.show == p2.showçš„ç»“æœæ˜¯ï¼š"</span>+(p1.show == p2.show)+<span class="string">"ï¼Œè¿™è¯æ˜p1å¯¹è±¡å’Œp2å¯¹è±¡å…±äº«ä¸€ä¸ªshowæ–¹æ³•ï¼Œåœ¨å†…å­˜ä¸­showæ–¹æ³•çš„ä»£ç åªæœ‰ä¸€ä»½ï¼Œå­˜æ”¾åœ¨å†…å­˜çš„ä¸€å—åŒºåŸŸ"</span>);<span class="comment">//true</span></span><br><span class="line">    <span class="built_in">document</span>.writeln(<span class="string">"p1.name="</span>+p1.name+<span class="string">"ï¼Œp1.age="</span>+p1.age+<span class="string">"ï¼Œp1.weight="</span>+p1.weight+<span class="string">"ï¼Œp1.height="</span>+p1.height);<span class="comment">//è®¿é—®å…¬æœ‰å±æ€§ï¼Œè¿™æ˜¯å¯ä»¥æ­£å¸¸è®¿é—®çš„</span></span><br><span class="line">    <span class="built_in">document</span>.writeln(<span class="string">"p2.name="</span>+p2.name+<span class="string">"ï¼Œp2.age="</span>+p2.age+<span class="string">"ï¼Œp2.weight="</span>+p2.weight+<span class="string">"ï¼Œp2.height="</span>+p2.height);<span class="comment">//è®¿é—®å…¬æœ‰å±æ€§ï¼Œè¿™æ˜¯å¯ä»¥æ­£å¸¸è®¿é—®çš„</span></span><br><span class="line">    p3.name=<span class="string">"ç­ä¸–é­”å°Š"</span>;<span class="comment">//ä¸ºå…¬å…±å±æ€§é‡æ–°èµ‹å€¼</span></span><br><span class="line">    <span class="built_in">document</span>.writeln(<span class="string">"p3.name="</span>+p3.name);<span class="comment">//è®¿é—®å…¬æœ‰å±æ€§ï¼Œè¿™æ˜¯å¯ä»¥æ­£å¸¸è®¿é—®çš„</span></span><br><span class="line">    p1.show();<span class="comment">//è°ƒç”¨ç±»çš„å…¬å…±å‡½æ•°ï¼Œè¿™æ¬¡å…è®¸çš„</span></span><br><span class="line">    <span class="built_in">document</span>.write(<span class="string">"&lt;/pre&gt;"</span>);</span><br></pre></td></tr></table></figure></li><li><p>å†™æ³•äºŒ<br>ä½¿ç”¨åŸå‹æ–¹å¼ç»™ç±»å®šä¹‰publicå±æ€§å’Œpublicæ–¹æ³•æ›´åŠ ä¼˜é›…çš„å†™æ³•ï¼Œæˆ‘ä¸ªäººæ¨èä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œè¿™ç§æ–¹å¼çœ‹èµ·æ¥æ¯”è¾ƒèˆ’æœ</p></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*å®šä¹‰ç±»Person2*/</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">Person2</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*ä½¿ç”¨åŸå‹æ–¹å¼ç»™ç±»å®šä¹‰publicå±æ€§å’Œpublicæ–¹æ³•æ›´åŠ ä¼˜é›…çš„å†™æ³•*/</span></span><br><span class="line">    Person2.prototype = &#123;</span><br><span class="line">        name:<span class="string">""</span>,<span class="comment">//publicå±æ€§</span></span><br><span class="line">        age:<span class="number">0</span>,<span class="comment">//publicå±æ€§</span></span><br><span class="line">        weight:<span class="number">0</span>,<span class="comment">//publicå±æ€§</span></span><br><span class="line">        height:<span class="number">0</span>,<span class="comment">//publicå±æ€§</span></span><br><span class="line">        <span class="comment">/*publicæ–¹æ³•*/</span></span><br><span class="line">        init:<span class="function"><span class="keyword">function</span>(<span class="params">_name,_age,_weight,_height</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.name = _name;</span><br><span class="line">            <span class="keyword">this</span>.age = _age;</span><br><span class="line">            <span class="keyword">this</span>.weight=_weight;</span><br><span class="line">            <span class="keyword">this</span>.height=_height;</span><br><span class="line">            <span class="built_in">document</span>.writeln(<span class="string">"this.name="</span>+<span class="keyword">this</span>.name+<span class="string">",this.age="</span>+<span class="keyword">this</span>.age+<span class="string">",this.weight="</span>+<span class="keyword">this</span>.weight+<span class="string">",this.height="</span>+<span class="keyword">this</span>.height);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">/*publicæ–¹æ³•*/</span></span><br><span class="line">        show:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="built_in">document</span>.writeln(<span class="string">"show method"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ä»£ç ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">document</span>.write(<span class="string">"&lt;pre&gt;"</span>);</span><br><span class="line">    <span class="keyword">var</span> p2_1 = <span class="keyword">new</span> Person2();</span><br><span class="line">    <span class="keyword">var</span> p2_2 = <span class="keyword">new</span> Person2();</span><br><span class="line">    p2_1.init(<span class="string">"å­¤å‚²è‹ç‹¼"</span>,<span class="number">24</span>,<span class="number">115</span>,<span class="number">160</span>);</span><br><span class="line">    p2_2.init(<span class="string">"ç™½è™ç¥çš‡"</span>,<span class="number">25</span>,<span class="number">120</span>,<span class="number">170</span>);</span><br><span class="line">    <span class="built_in">document</span>.writeln(<span class="string">"p2_1.name="</span>+p2_1.name+<span class="string">"ï¼Œp2_1.age="</span>+p2_1.age+<span class="string">"ï¼Œp2_1.weight="</span>+p2_1.weight+<span class="string">"ï¼Œp2_1.height="</span>+p2_1.height);<span class="comment">//è®¿é—®å…¬æœ‰å±æ€§ï¼Œè¿™æ˜¯å¯ä»¥æ­£å¸¸è®¿é—®çš„</span></span><br><span class="line">    <span class="built_in">document</span>.writeln(<span class="string">"p2_2.name="</span>+p2_2.name+<span class="string">"ï¼Œp2_2.age="</span>+p2_2.age+<span class="string">"ï¼Œp2_2.weight="</span>+p2_2.weight+<span class="string">"ï¼Œp2_2.height="</span>+p2_2.height);<span class="comment">//è®¿é—®å…¬æœ‰å±æ€§ï¼Œè¿™æ˜¯å¯ä»¥æ­£å¸¸è®¿é—®çš„</span></span><br><span class="line">    <span class="built_in">document</span>.writeln(<span class="string">"p2_1 instanceof Person2çš„ç»“æœæ˜¯ï¼š"</span>+(p2_1 <span class="keyword">instanceof</span> Person2));<span class="comment">//p2_1æ˜¯Person2ç±»çš„å®ä¾‹ï¼Œç»“æœæ˜¯true</span></span><br><span class="line">    <span class="built_in">document</span>.writeln(<span class="string">"p2_2 instanceof Person2çš„ç»“æœæ˜¯ï¼š"</span>+(p2_2 <span class="keyword">instanceof</span> Person2));<span class="comment">//p2_2æ˜¯Person2ç±»çš„å®ä¾‹ï¼Œç»“æœæ˜¯true</span></span><br><span class="line">    <span class="comment">//å½“==ä¸¤è¾¹çš„å†…å®¹æ˜¯å¯¹è±¡æˆ–è€…æ˜¯å¯¹è±¡çš„å‡½æ•°å±æ€§æ—¶ï¼Œåˆ™æ¯”è¾ƒå†…å­˜åœ°å€æ˜¯å¦ç›¸ç­‰</span></span><br><span class="line">    <span class="built_in">document</span>.writeln(<span class="string">"å½“==ä¸¤è¾¹çš„å†…å®¹æ˜¯å¯¹è±¡æˆ–è€…æ˜¯å¯¹è±¡çš„å‡½æ•°å±æ€§æ—¶ï¼Œåˆ™æ¯”è¾ƒå†…å­˜åœ°å€æ˜¯å¦ç›¸ç­‰"</span>);</span><br><span class="line">    <span class="built_in">document</span>.writeln(<span class="string">"æ¯”è¾ƒp2_1å’Œp2_2è¿™ä¸¤ä¸ªå¯¹è±¡çš„initæ–¹æ³•çš„å†…å­˜åœ°å€æ˜¯å¦ä¸€æ ·ï¼šp2_1.init == p2_2.initçš„ç»“æœæ˜¯ï¼š"</span>+(p2_1.init == p2_2.init));<span class="comment">//true</span></span><br><span class="line">    p2_1.name=<span class="string">"ç­ä¸–é­”å°Š"</span>;<span class="comment">//ä¸ºå…¬å…±å±æ€§é‡æ–°èµ‹å€¼</span></span><br><span class="line">    <span class="built_in">document</span>.writeln(<span class="string">"p2_1.name="</span>+p2_1.name);<span class="comment">//è®¿é—®å…¬æœ‰å±æ€§ï¼Œè¿™æ˜¯å¯ä»¥æ­£å¸¸è®¿é—®çš„</span></span><br><span class="line">    p2_1.show();<span class="comment">//è°ƒç”¨ç±»çš„å…¬å…±å‡½æ•°ï¼Œè¿™æ¬¡å…è®¸çš„</span></span><br><span class="line">    <span class="built_in">document</span>.write(<span class="string">"&lt;/pre&gt;"</span>);</span><br></pre></td></tr></table></figure><h4 id="æ„é€ å‡½æ•°-åŸå‹"><a href="#æ„é€ å‡½æ•°-åŸå‹" class="headerlink" title="æ„é€ å‡½æ•°+åŸå‹"></a>æ„é€ å‡½æ•°+åŸå‹</h4><p>ã€€æ„é€ å‡½æ•°æ–¹å¼å’ŒåŸå‹æ–¹å¼éƒ½æœ‰å„è‡ªçš„ä¼˜ç¼ºç‚¹ï¼Œå› æ­¤å¯ä»¥æŠŠè¿™ä¸¤ç§æ–¹å¼åˆå¹¶èµ·æ¥ï¼Œç”¨æ„é€ å‡½æ•°æ–¹å¼æ¥å®šä¹‰ç±»çš„å±æ€§(publicå±æ€§ï¼Œprivateå±æ€§)ï¼Œç”¨åŸå‹æ–¹å¼æ¥å®šä¹‰ç±»çš„æ–¹æ³•(publicæ–¹æ³•)ã€‚äº’è¡¥ä¸è¶³ï¼Œè¿™å°±æœ‰äº†ç¬¬ä¸‰ç§å†™æ³•ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*å®šä¹‰ä¸€ä¸ªPersonç±»*/</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">_name,_age,_salary</span>)</span>&#123;</span><br><span class="line">        <span class="comment">//åœ¨Personç±»å†…éƒ¨å®šä¹‰ç±»çš„publicå±æ€§å’Œprivateå±æ€§ä»¥åŠprivateæ–¹æ³•</span></span><br><span class="line">        <span class="comment">//Personç±»çš„å…¬å¼€å±æ€§ï¼Œç±»çš„å…¬å¼€å±æ€§çš„å®šä¹‰æ–¹å¼æ˜¯ï¼šâ€this.å±æ€§åâ€œ</span></span><br><span class="line">        <span class="keyword">this</span>.name=_name;</span><br><span class="line">        <span class="comment">//Personç±»çš„ç§æœ‰å±æ€§ï¼Œç±»çš„ç§æœ‰å±æ€§çš„å®šä¹‰æ–¹å¼æ˜¯ï¼šâ€var å±æ€§åâ€œ</span></span><br><span class="line">        <span class="keyword">var</span> age=_age;<span class="comment">//ç§æœ‰å±æ€§ï¼Œåªèƒ½åœ¨ç±»å†…éƒ¨ä½¿ç”¨</span></span><br><span class="line">        <span class="keyword">var</span> salary=_salary;<span class="comment">//ç§æœ‰å±æ€§ï¼Œåªèƒ½åœ¨ç±»å†…éƒ¨ä½¿ç”¨</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        å®šä¹‰Personç±»çš„ç§æœ‰æ–¹æ³•(å†…éƒ¨æ–¹æ³•)ï¼Œåªèƒ½åœ¨ç±»å†…éƒ¨ä½¿ç”¨</span></span><br><span class="line"><span class="comment">        ç±»çš„ç§æœ‰æ–¹æ³•çš„å®šä¹‰æ–¹å¼æ˜¯ï¼šâ€function functionName()&#123;.....&#125;â€œï¼Œ</span></span><br><span class="line"><span class="comment">        æˆ–è€… var functionName=function()&#123;....&#125;</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">privateFn</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="built_in">document</span>.write(<span class="string">"&lt;pre&gt;"</span>);</span><br><span class="line">            <span class="built_in">document</span>.writeln(<span class="string">"æˆ‘æ˜¯Personç±»çš„ç§æœ‰å±æ€§ageï¼Œåªèƒ½åœ¨Personç±»å†…éƒ¨ä½¿ç”¨ï¼Œåˆå§‹åŒ–åage="</span>+age);</span><br><span class="line">            <span class="built_in">document</span>.writeln(<span class="string">"æˆ‘æ˜¯Personç±»çš„ç§æœ‰å‡½æ•°privateFnï¼Œåªèƒ½åœ¨Personç±»å†…éƒ¨ä½¿ç”¨"</span>);</span><br><span class="line">            <span class="built_in">document</span>.write(<span class="string">"&lt;/pre&gt;"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> privateFn2=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="built_in">document</span>.write(<span class="string">"&lt;pre&gt;"</span>);</span><br><span class="line">            <span class="built_in">document</span>.writeln(<span class="string">"æˆ‘æ˜¯Personç±»çš„ç§æœ‰å±æ€§salaryï¼Œåªèƒ½åœ¨Personç±»å†…éƒ¨ä½¿ç”¨ï¼Œåˆå§‹åŒ–åsalary="</span>+salary);</span><br><span class="line">            <span class="built_in">document</span>.writeln(<span class="string">"æˆ‘æ˜¯Personç±»çš„ç§æœ‰å‡½æ•°privateFn2ï¼Œåªèƒ½åœ¨Personç±»å†…éƒ¨ä½¿ç”¨"</span>);</span><br><span class="line">            <span class="built_in">document</span>.write(<span class="string">"&lt;/pre&gt;"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        privateFn();<span class="comment">//åœ¨Personç±»å†…éƒ¨è°ƒç”¨ç§æœ‰æ–¹æ³•</span></span><br><span class="line">        privateFn2();<span class="comment">//åœ¨Personç±»å†…éƒ¨è°ƒç”¨ç§æœ‰æ–¹æ³•</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä½¿ç”¨prototypeåŸå‹æ–¹å¼å®šä¹‰çš„æ–¹æ³•(publicæ–¹æ³•)æ˜¯æ— æ³•è®¿é—®ç±»çš„ç§æœ‰å±æ€§å’Œç§æœ‰æ–¹æ³•çš„</span></span><br><span class="line">    <span class="comment">//ä½¿ç”¨prototypeåŸå‹æ–¹å¼å®šä¹‰Personç±»çš„æ–¹publicæ–¹æ³•</span></span><br><span class="line">    Person.prototype=&#123;</span><br><span class="line">        setName:<span class="function"><span class="keyword">function</span>(<span class="params">_name</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.name = _name;</span><br><span class="line">            <span class="comment">//privateFn();//ä¸èƒ½è°ƒç”¨Personç±»å®šä¹‰çš„ç§æœ‰æ–¹æ³•privateFn()ï¼Œä¼šæŠ¥é”™ï¼šç¼ºå°‘å¯¹è±¡</span></span><br><span class="line">        &#125;,</span><br><span class="line">        getName:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.name;</span><br><span class="line">        &#125;,</span><br><span class="line">        show:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="built_in">document</span>.writeln(<span class="string">"å…¬å¼€æ–¹æ³•show"</span>);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">//å…¬å…±æ–¹æ³•</span></span><br><span class="line">        publicMethod:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="built_in">document</span>.writeln(<span class="string">"å…¬å¼€æ–¹æ³•publicMethod"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ä»£ç ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> Person(<span class="string">"å­¤å‚²è‹ç‹¼"</span>,<span class="number">24</span>,<span class="number">2300</span>);</span><br><span class="line">    <span class="keyword">var</span> p2 = <span class="keyword">new</span> Person(<span class="string">"ç™½è™ç¥çš‡"</span>,<span class="number">25</span>,<span class="number">3000</span>);</span><br><span class="line">    <span class="built_in">document</span>.write(<span class="string">"&lt;pre&gt;"</span>);</span><br><span class="line">    <span class="built_in">document</span>.writeln(<span class="string">"p1 instanceof Personçš„ç»“æœæ˜¯ï¼š"</span>+(p1 <span class="keyword">instanceof</span> Person));<span class="comment">//p1æ˜¯Personç±»çš„å®ä¾‹ï¼Œç»“æœæ˜¯true</span></span><br><span class="line">    <span class="built_in">document</span>.writeln(<span class="string">"p2 instanceof Personçš„ç»“æœæ˜¯ï¼š"</span>+(p2 <span class="keyword">instanceof</span> Person));<span class="comment">//p2æ˜¯Personç±»çš„å®ä¾‹ï¼Œç»“æœæ˜¯true</span></span><br><span class="line">    <span class="comment">//å½“==ä¸¤è¾¹çš„å†…å®¹æ˜¯å¯¹è±¡æˆ–è€…æ˜¯å¯¹è±¡çš„å‡½æ•°å±æ€§æ—¶ï¼Œåˆ™æ¯”è¾ƒå†…å­˜åœ°å€æ˜¯å¦ç›¸ç­‰</span></span><br><span class="line">    <span class="built_in">document</span>.writeln(<span class="string">"å½“==ä¸¤è¾¹çš„å†…å®¹æ˜¯å¯¹è±¡æˆ–è€…æ˜¯å¯¹è±¡çš„å‡½æ•°å±æ€§æ—¶ï¼Œåˆ™æ¯”è¾ƒå†…å­˜åœ°å€æ˜¯å¦ç›¸ç­‰"</span>);</span><br><span class="line">    <span class="built_in">document</span>.writeln(<span class="string">"æ¯”è¾ƒp1å’Œp2è¿™ä¸¤ä¸ªå¯¹è±¡çš„showæ–¹æ³•çš„å†…å­˜åœ°å€æ˜¯å¦ä¸€æ ·ï¼šp1.show== p2.showçš„ç»“æœæ˜¯ï¼š"</span>+(p1.show == p2.show));<span class="comment">//true</span></span><br><span class="line">    <span class="built_in">document</span>.writeln(<span class="string">"p1.show == p2.showçš„ç»“æœæ˜¯ï¼š"</span>+(p1.show == p2.show)+<span class="string">"ï¼Œè¿™è¯æ˜p1å¯¹è±¡å’Œp2å¯¹è±¡å…±äº«ä¸€ä¸ªshowæ–¹æ³•ï¼Œåœ¨å†…å­˜ä¸­showæ–¹æ³•çš„ä»£ç æœ‰1ä»½ï¼Œå­˜æ”¾åœ¨1å—å†…å­˜åŒºåŸŸ"</span>);</span><br><span class="line">    <span class="built_in">document</span>.writeln(<span class="string">"nameæ˜¯Personç±»å®šä¹‰çš„publicå±æ€§ï¼Œå¯ä»¥ä½¿ç”¨ç±»çš„å¯¹è±¡å»ç›´æ¥è®¿é—®ç±»çš„publicå±æ€§"</span>);</span><br><span class="line">    <span class="built_in">document</span>.writeln(<span class="string">"p1.name="</span>+p1.name);<span class="comment">//è®¿é—®å…¬æœ‰å±æ€§ï¼Œè¿™æ˜¯å¯ä»¥æ­£å¸¸è®¿é—®çš„</span></span><br><span class="line">    <span class="built_in">document</span>.writeln(<span class="string">"ageå’Œsalaryæ˜¯Personç±»å®šä¹‰çš„privateå±æ€§ï¼Œä¸èƒ½ä½¿ç”¨ç±»çš„å¯¹è±¡å»ç›´æ¥è®¿é—®ç±»ç§æœ‰å±æ€§ï¼Œè¿™æ˜¯è®¿é—®ä¸äº†çš„ï¼Œç»“æœéƒ½æ˜¯undefined"</span>);</span><br><span class="line">    <span class="built_in">document</span>.writeln(<span class="string">"p1.age="</span>+p1.age+<span class="string">"ï¼Œ"</span>+<span class="string">"p1.salary="</span>+p1.salary)<span class="comment">//ä¸èƒ½ä½¿ç”¨ç±»çš„å¯¹è±¡å»ç›´æ¥è®¿é—®ç±»ç§æœ‰å±æ€§ï¼Œè¿™æ˜¯è®¿é—®ä¸äº†çš„ï¼Œç»“æœéƒ½æ˜¯undefined</span></span><br><span class="line">    p1.show();<span class="comment">//è°ƒç”¨ç±»çš„å…¬å…±å‡½æ•°ï¼Œè¿™æ¬¡å…è®¸çš„</span></span><br><span class="line">    p1.publicMethod();<span class="comment">//è°ƒç”¨ç±»çš„å…¬å…±å‡½æ•°ï¼Œè¿™æ¬¡å…è®¸çš„</span></span><br><span class="line">    p1.setName(<span class="string">"ç„å¤©é‚ªå¸"</span>);<span class="comment">//è°ƒç”¨ç±»çš„å…¬å…±å‡½æ•°è®¾ç½®ä¸ºnameå±æ€§é‡æ–°èµ‹å€¼</span></span><br><span class="line">    <span class="built_in">document</span>.writeln(<span class="string">"p1.getName="</span>+p1.getName());</span><br><span class="line">    <span class="comment">//document.writeln("p1.privateFn()ï¼š"+p1.privateFn()+"&amp;nbsp;p1.privateFn2()ï¼š"+p1.privateFn2());//ä¸èƒ½ä½¿ç”¨ç±»çš„å¯¹è±¡å»è°ƒç”¨ç±»çš„ç§æœ‰æ–¹æ³•ï¼Œè¿™é‡Œä¼šæŠ¥é”™â€å¯¹è±¡ä¸æ”¯æŒæ­¤å±æ€§æˆ–è€…æ–¹æ³•</span></span><br><span class="line">    <span class="built_in">document</span>.write(<span class="string">"&lt;/pre&gt;"</span>);</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰ç§æ–¹å¼é€šè¿‡å‰ä¸¤ç§æ–¹å¼çš„ç»“åˆï¼Œç®—æ˜¯è¾¾åˆ°äº†ä¸€ä¸ªæ¯”è¾ƒç†æƒ³çš„å†™æ³•äº†ï¼Œå¯ä»¥é€šè¿‡ä¼ å‚æ„é€ å¯¹è±¡å®ä¾‹ï¼Œå¯¹è±¡å®ä¾‹éƒ½å…±äº«åŒä¸€ä»½æ–¹æ³•ä¸é€ æˆå†…å­˜æµªè´¹ã€‚ç¬¬ä¸‰ç§æ–¹å¼åœ¨å¼€å‘ä¸­ç”¨å¾—æœ€å¤šï¼Œæˆ‘æœ¬äººä¹Ÿæ˜¯é‡‡ç”¨è¿™ç§æ–¹å¼æ¥ç¼–å†™JavaScriptç±»ã€‚</p><p><a href="https://www.cnblogs.com/xdp-gacl/p/3700840.html" target="_blank" rel="noopener">æŸ¥çœ‹åŸæ–‡</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> oop </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Dubboæ¶ˆè´¹è€…consumeræ•æ‰æœåŠ¡æä¾›è€…provideræŠ›å‡ºçš„è‡ªå®šä¹‰å¼‚å¸¸</title>
      <link href="/post/2e0453a7.html"/>
      <url>/post/2e0453a7.html</url>
      
        <content type="html"><![CDATA[<p>æˆ‘ä»¬åœ¨è‡ªå·±çš„ä¸šåŠ¡ç³»ç»Ÿä¸­ï¼Œé€šå¸¸ä¼šç”¨åˆ°è‡ªå®šä¹‰çš„ä¸šåŠ¡å¼‚å¸¸ç±»ï¼Œè¿™ä¸ªå¼‚å¸¸ä¼šç»§æ‰¿extends RuntimeExceptionï¼Œå½“å‘ç”Ÿä¸šåŠ¡é™åˆ¶çš„æ—¶å€™ï¼Œä¼šthrowå‡ºæ¥ã€‚ä½†æ˜¯åœ¨ä½¿ç”¨dubboè¿›è¡Œsoaæ²»ç†çš„æ—¶å€™ï¼Œä¼šå‘ç°provideræŠ›å‡ºçš„å¼‚å¸¸ï¼Œåœ¨customç«¯å¹¶ä¸èƒ½æ­£ç¡®çš„æ•è·ã€‚å³ä¾¿æˆ‘ä»¬åœ¨providerå’Œcustoméƒ½æœ‰å¯¼å…¥ç›¸åŒframework.jarä¸‹é¢çš„BusinessExceptionå¼‚å¸¸ï¼Œå¹¶ä¸”æŠ›å‡ºè¿™ä¸ªå¼‚å¸¸ï¼Œåœ¨Consumerç«¯åªä¼šæ‰“å°ä¸€è¡Œå¼‚å¸¸ä¿¡æ¯ï¼Œè·å–ä¸åˆ°æ­£å¸¸çš„å¼‚å¸¸ã€‚ç™¾åº¦æ‰çŸ¥é“Dubboå¯¹æŠ›å‡ºå¾—å¼‚å¸¸ç”¨ä¸€ä¸ªExceptionFilterçš„ç±»è¿›è¡Œæ‹¦æˆªã€‚</p><a id="more"></a><p>åœ¨ä¸€ä¸ªå…¬å…±åŒ…é‡Œå®šä¹‰ä¸€ä¸ªå¼‚å¸¸ç±»ï¼Œç»§æ‰¿è‡ªRuntimeExceptionã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BusinessException</span> <span class="keyword">extends</span> <span class="title">RuntimeException</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¼‚å¸¸code</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String code;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BusinessException</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BusinessException</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(message);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BusinessException</span><span class="params">(String code, String message)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(message);</span><br><span class="line">        <span class="keyword">this</span>.code = code;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BusinessException</span><span class="params">(String message, Throwable cause)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(message, cause);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BusinessException</span><span class="params">(String code, String message, Throwable cause)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(message, cause);</span><br><span class="line">        <span class="keyword">this</span>.code = code;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BusinessException</span><span class="params">(Throwable cause)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(cause);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> code;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCode</span><span class="params">(String code)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.code = code;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨æœåŠ¡æä¾›è€…çš„Dubboé…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä¸‹é¢çš„å†…å®¹ï¼Œä¸»è¦å°±æ˜¯è‡ªå®šä¹‰exceptionFilterï¼Œç„¶åæ’å‡ºdubboè‡ªå¸¦çš„exceptionFilter</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag"><span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xmlns:dubbo</span>=<span class="string">"http://code.alibabatech.com/schema/dubbo"</span></span></span><br><span class="line"><span class="tag"><span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans </span></span></span><br><span class="line"><span class="tag"><span class="string">http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">     http://code.alibabatech.com/schema/dubbo</span></span></span><br><span class="line"><span class="tag"><span class="string"> http://code.alibabatech.com/schema/dubbo/dubbo.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- http://dubbo.apache.org/schema/dubbo/dubbo.xsd ä¸Šé¢é…ç½®ä¸ºè¿™ä¸ªä¸€ç›´æŠ¥é”™ï¼Œæ”¹ä¸º http://code.alibabatech.com/schema/dubbo/dubbo.xsd --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--ç”¨äºé…ç½®å½“å‰åº”ç”¨ä¿¡æ¯ï¼Œä¸ç®¡è¯¥åº”ç”¨æ˜¯æä¾›è€…è¿˜æ˜¯æ¶ˆè´¹è€… --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dubbo:application</span>  <span class="attr">name</span>=<span class="string">"dubbo-web-provide"</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- ç”¨äºé…ç½®è¿æ¥æ³¨å†Œä¸­å¿ƒç›¸å…³ä¿¡æ¯ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dubbo:registry</span> <span class="attr">address</span>=<span class="string">"zookeeper://localhost:2181"</span> <span class="attr">timeout</span>=<span class="string">"30000"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--é…ç½®redisè¿æ¥å‚æ•° --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å…·ä½“å‚æ•°é…ç½®è§com.alibaba.dubbo.registry.redis.RedisRegistry.class --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dubbo:parameter</span> <span class="attr">key</span>=<span class="string">"max.idle"</span> <span class="attr">value</span>=<span class="string">"10"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dubbo:parameter</span> <span class="attr">key</span>=<span class="string">"min.idle"</span> <span class="attr">value</span>=<span class="string">"5"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dubbo:parameter</span> <span class="attr">key</span>=<span class="string">"max.active"</span> <span class="attr">value</span>=<span class="string">"20"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dubbo:parameter</span> <span class="attr">key</span>=<span class="string">"max.total"</span> <span class="attr">value</span>=<span class="string">"100"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dubbo:registry</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">æœ€é‡è¦çš„å°±æ˜¯ä¸‹é¢çš„é…ç½®ï¼šè‡ªå®šä¹‰exceptionFilterï¼Œç„¶åæ’å‡ºdubboè‡ªå¸¦çš„exceptionFilter</span></span><br><span class="line"><span class="comment">payload è®¾ç½®ä¼ è¾“çš„æœ€å¤§å€¼</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dubbo:provider</span> <span class="attr">filter</span>=<span class="string">"dubboExceptionFilter,-exception"</span> <span class="attr">payload</span>=<span class="string">"123886080"</span> &gt;</span><span class="tag">&lt;/<span class="name">dubbo:provider</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- ç”¨äºé…ç½®æä¾›æœåŠ¡çš„åè®®ä¿¡æ¯ï¼Œåè®®ç”±æä¾›æ–¹æŒ‡å®šï¼Œæ¶ˆè´¹æ–¹è¢«åŠ¨æ¥å— --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dubbo:protocol</span> <span class="attr">name</span>=<span class="string">"dubbo"</span> <span class="attr">port</span>=<span class="string">"20880"</span> <span class="attr">accesslog</span>=<span class="string">"true"</span> <span class="attr">serialization</span>=<span class="string">"hessian2"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- å®ç°ç±» --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"helloService"</span> <span class="attr">class</span>=<span class="string">"cn.ydstudio.dubbo.web.provide.serviceimpl.HelloServiceImpl"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"goodsService"</span> <span class="attr">class</span>=<span class="string">"cn.ydstudio.dubbo.web.provide.serviceimpl.GoodsServiceImpl"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"goodsService2"</span> <span class="attr">class</span>=<span class="string">"cn.ydstudio.dubbo.web.provide.serviceimpl.GoodsServiceImpl2"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"goodsOrderServiceRemoteImpl"</span> <span class="attr">class</span>=<span class="string">"cn.ydstudio.dubbo.web.provide.serviceimpl.GoodsOrderServiceRemoteImpl"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--å®šä¹‰æš´éœ²æœåŠ¡çš„æ¥å£ï¼Œç”¨äºæš´éœ²ä¸€ä¸ªæœåŠ¡ï¼Œå®šä¹‰æœåŠ¡çš„å…ƒä¿¡æ¯ï¼Œä¸€ä¸ªæœåŠ¡å¯ä»¥ç”¨å¤šä¸ªåè®®æš´éœ²ï¼Œä¸€ä¸ªæœåŠ¡ä¹Ÿå¯ä»¥æ³¨å†Œåˆ°å¤šä¸ªæ³¨å†Œä¸­å¿ƒ --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--æ¯ä¸ªæ¥å£éƒ½åº”å®šä¹‰ç‰ˆæœ¬å·ï¼Œä¸ºåç»­ä¸å…¼å®¹å‡çº§æä¾›å¯èƒ½ --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--refï¼šæœåŠ¡çš„çœŸæ­£å®ç°ç±» --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dubbo:service</span> <span class="attr">interface</span>=<span class="string">"cn.ydstudio.dubbo.rpc.service.HelloService"</span> <span class="attr">ref</span>=<span class="string">"helloService"</span> <span class="attr">version</span>=<span class="string">"1.0.0"</span> <span class="attr">retries</span>=<span class="string">"1"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dubbo:service</span> <span class="attr">interface</span>=<span class="string">"cn.ydstudio.dubbo.rpc.service.GoodsService"</span> <span class="attr">ref</span>=<span class="string">"goodsService"</span> <span class="attr">version</span>=<span class="string">"1.0.0"</span> <span class="attr">retries</span>=<span class="string">"1"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dubbo:service</span> <span class="attr">interface</span>=<span class="string">"cn.ydstudio.dubbo.rpc.service.GoodsService"</span> <span class="attr">ref</span>=<span class="string">"goodsService2"</span> <span class="attr">version</span>=<span class="string">"2.0.0"</span> <span class="attr">retries</span>=<span class="string">"1"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:service</span> <span class="attr">interface</span>=<span class="string">"cn.ydstudio.dubbo.rpc.service.GoodsOrderServiceRemote"</span> <span class="attr">ref</span>=<span class="string">"goodsOrderServiceRemoteImpl"</span> <span class="attr">version</span>=<span class="string">"1.0.0"</span> <span class="attr">retries</span>=<span class="string">"0"</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dubbo:method</span> <span class="attr">name</span>=<span class="string">"querGoodsOrderList"</span> <span class="attr">timeout</span>=<span class="string">"1000000"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dubbo:service</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--ç›‘æ§ä¸­å¿ƒé…ç½® ç›‘æ§ä¸­å¿ƒåè®®ï¼Œå¦‚æœä¸ºprotocol="registry"ï¼Œè¡¨ç¤ºä»æ³¨å†Œä¸­å¿ƒå‘ç°ç›‘æ§ä¸­å¿ƒåœ°å€ï¼Œå¦åˆ™ç›´è¿ç›‘æ§ä¸­å¿ƒã€‚ --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--&lt;dubbo:monitor protocol="registry"&gt;&lt;/dubbo:monitor&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- ç›´è¿ç›‘æ§ä¸­å¿ƒæœåŠ¡å™¨åœ°å€ --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- &lt;dubbo:monitor address="localhost:6379"&gt;&lt;/dubbo:monitor&gt; --&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æœ€é‡è¦çš„ç»§æ‰¿ExceptionFilterï¼Œç„¶åé‡å†™invokeæ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.ydstudio.dubbo.web.provide.filter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.ydstudio.common.tools.exception.BizException;</span><br><span class="line"><span class="keyword">import</span> cn.ydstudio.common.tools.exception.BusinessException;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.common.logger.Logger;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.common.logger.LoggerFactory;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.common.utils.ReflectUtils;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.common.utils.StringUtils;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.rpc.*;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.rpc.filter.ExceptionFilter;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.rpc.service.GenericService;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åŠŸèƒ½æè¿°:&lt;br/&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2019/4/30 18:02</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DubboExceptionFilter</span> <span class="keyword">extends</span> <span class="title">ExceptionFilter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Logger logger;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DubboExceptionFilter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>(LoggerFactory.getLogger(com.alibaba.dubbo.rpc.filter.ExceptionFilter<span class="class">.<span class="keyword">class</span>))</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DubboExceptionFilter</span><span class="params">(Logger logger)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.logger = logger;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">invoke</span><span class="params">(Invoker&lt;?&gt; invoker, Invocation invocation)</span> <span class="keyword">throws</span> RpcException </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Result result = invoker.invoke(invocation);</span><br><span class="line">            <span class="keyword">if</span> (result.hasException() &amp;&amp; GenericService<span class="class">.<span class="keyword">class</span> !</span>= invoker.getInterface()) &#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    Throwable exception = result.getException();</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// è‡ªå®šä¹‰çš„å¼‚å¸¸</span></span><br><span class="line">                    <span class="keyword">if</span> (exception <span class="keyword">instanceof</span> BizException || exception <span class="keyword">instanceof</span> BusinessException)&#123;</span><br><span class="line">                        <span class="keyword">return</span> result;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (!(exception <span class="keyword">instanceof</span> RuntimeException) &amp;&amp; exception <span class="keyword">instanceof</span> Exception) &#123;</span><br><span class="line">                        <span class="keyword">return</span> result;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">try</span> &#123;</span><br><span class="line">                            Method method = invoker.getInterface().getMethod(invocation.getMethodName(), invocation.getParameterTypes());</span><br><span class="line">                            Class&lt;?&gt;[] exceptionClassses = method.getExceptionTypes();</span><br><span class="line">                            Class[] arr$ = exceptionClassses;</span><br><span class="line">                            <span class="keyword">int</span> len$ = exceptionClassses.length;</span><br><span class="line"></span><br><span class="line">                            <span class="keyword">for</span> (<span class="keyword">int</span> i$ = <span class="number">0</span>; i$ &lt; len$; ++i$) &#123;</span><br><span class="line">                                Class&lt;?&gt; exceptionClass = arr$[i$];</span><br><span class="line">                                <span class="keyword">if</span> (exception.getClass().equals(exceptionClass)) &#123;</span><br><span class="line">                                    <span class="keyword">return</span> result;</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (NoSuchMethodException var11) &#123;</span><br><span class="line">                            <span class="keyword">return</span> result;</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">this</span>.logger.error(<span class="string">"Got unchecked and undeclared exception which called by "</span> + RpcContext.getContext().getRemoteHost() + <span class="string">". service: "</span> + invoker.getInterface().getName() + <span class="string">", method: "</span> + invocation.getMethodName() + <span class="string">", exception: "</span> + exception.getClass().getName() + <span class="string">": "</span> + exception.getMessage(), exception);</span><br><span class="line">                        String serviceFile = ReflectUtils.getCodeBase(invoker.getInterface());</span><br><span class="line">                        String exceptionFile = ReflectUtils.getCodeBase(exception.getClass());</span><br><span class="line">                        <span class="keyword">if</span> (serviceFile != <span class="keyword">null</span> &amp;&amp; exceptionFile != <span class="keyword">null</span> &amp;&amp; !serviceFile.equals(exceptionFile)) &#123;</span><br><span class="line"></span><br><span class="line">                            String className = exception.getClass().getName();</span><br><span class="line">                            <span class="keyword">if</span> (!className.startsWith(<span class="string">"java."</span>) &amp;&amp; !className.startsWith(<span class="string">"javax."</span>)) &#123;</span><br><span class="line">                                <span class="keyword">return</span> (Result) (exception <span class="keyword">instanceof</span> RpcException ? result : <span class="keyword">new</span> RpcResult(<span class="keyword">new</span> RuntimeException(StringUtils.toString(exception))));</span><br><span class="line">                            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                <span class="keyword">return</span> result;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            <span class="keyword">return</span> result;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Throwable var12) &#123;</span><br><span class="line">                    <span class="keyword">this</span>.logger.warn(<span class="string">"Fail to ExceptionFilter when called by "</span> + RpcContext.getContext().getRemoteHost() + <span class="string">". service: "</span> + invoker.getInterface().getName() + <span class="string">", method: "</span> + invocation.getMethodName() + <span class="string">", exception: "</span> + var12.getClass().getName() + <span class="string">": "</span> + var12.getMessage(), var12);</span><br><span class="line">                    <span class="keyword">return</span> result;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> result;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (RuntimeException var13) &#123;</span><br><span class="line">            <span class="keyword">this</span>.logger.error(<span class="string">"Got unchecked and undeclared exception which called by "</span> + RpcContext.getContext().getRemoteHost() + <span class="string">". service: "</span> + invoker.getInterface().getName() + <span class="string">", method: "</span> + invocation.getMethodName() + <span class="string">", exception: "</span> + var13.getClass().getName() + <span class="string">": "</span> + var13.getMessage(), var13);</span><br><span class="line">            <span class="keyword">throw</span> var13;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨providerå¯ä»¥ç›´æ¥æŠ›å‡ºå¼‚å¸¸ï¼Œåœ¨consumerå¯ä»¥ç›´æ¥æ•æ‰åˆ°ã€‚consumeræœåŠ¡æ¶ˆè´¹ç«¯å¯ä»¥æ–°å»ºä¸€ä¸ªå…¨å±€å¼‚å¸¸å¤„ç†çš„æ§åˆ¶å™¨ï¼Œå¯ä»¥æ ¼å¼åŒ–åè¾“å‡ºç»™å‰ç«¯ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> dubbo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å°è¯•é˜¿é‡Œå·´å·´EasyExcelå¯¼å‡ºExcel</title>
      <link href="/post/76eb7bfd.html"/>
      <url>/post/76eb7bfd.html</url>
      
        <content type="html"><![CDATA[<h4 id="æ·»åŠ easyexcelçš„mavenä¾èµ–"><a href="#æ·»åŠ easyexcelçš„mavenä¾èµ–" class="headerlink" title="æ·»åŠ easyexcelçš„mavenä¾èµ–"></a>æ·»åŠ easyexcelçš„mavenä¾èµ–</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>easyexcel<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><a id="more"></a><h4 id="å¯¼å‡ºçš„æ¨¡å‹éœ€è¦ç»§æ‰¿BaseRowModelï¼Œç„¶åå¯ä»¥åœ¨æ¯ä¸ªå±æ€§ä¸Šè®¾ç½®æ‰€åœ¨çš„åˆ—å’Œä¸€äº›format"><a href="#å¯¼å‡ºçš„æ¨¡å‹éœ€è¦ç»§æ‰¿BaseRowModelï¼Œç„¶åå¯ä»¥åœ¨æ¯ä¸ªå±æ€§ä¸Šè®¾ç½®æ‰€åœ¨çš„åˆ—å’Œä¸€äº›format" class="headerlink" title="å¯¼å‡ºçš„æ¨¡å‹éœ€è¦ç»§æ‰¿BaseRowModelï¼Œç„¶åå¯ä»¥åœ¨æ¯ä¸ªå±æ€§ä¸Šè®¾ç½®æ‰€åœ¨çš„åˆ—å’Œä¸€äº›format"></a>å¯¼å‡ºçš„æ¨¡å‹éœ€è¦ç»§æ‰¿BaseRowModelï¼Œç„¶åå¯ä»¥åœ¨æ¯ä¸ªå±æ€§ä¸Šè®¾ç½®æ‰€åœ¨çš„åˆ—å’Œä¸€äº›format</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GoodsOrderExportDto</span> <span class="keyword">extends</span> <span class="title">BaseRowModel</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExcelProperty</span>(value = <span class="string">"è®¢å•åºå·"</span>,index = <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">private</span> Long orderId;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExcelProperty</span>(value = <span class="string">"è®¢å•ç¼–å·"</span>,index = <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">private</span> String orderCode;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExcelProperty</span>(value = <span class="string">"å•†å“åºå·"</span>,index = <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">private</span> Long goodsId;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExcelProperty</span>(value = <span class="string">"å•†å“åç§°"</span>,index = <span class="number">3</span>)</span><br><span class="line">    <span class="keyword">private</span> String goodsTitle;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExcelProperty</span>(value = <span class="string">"å•†å“é“¾æ¥"</span>,index = <span class="number">4</span>)</span><br><span class="line">    <span class="keyword">private</span> String goodsDetailsUrl;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExcelProperty</span>(value = <span class="string">"å•†å“å›¾ç‰‡"</span>,index = <span class="number">5</span>)</span><br><span class="line">    <span class="keyword">private</span> String goodsPhoto;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExcelProperty</span>(value = <span class="string">"å•†å“æ•°é‡"</span>,index = <span class="number">6</span>)</span><br><span class="line">    <span class="keyword">private</span> Long goodsNum;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExcelProperty</span>(value = <span class="string">"å•†å“ä»·æ ¼"</span>,index = <span class="number">7</span>)</span><br><span class="line">    <span class="keyword">private</span> BigDecimal goodsAmt;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExcelProperty</span>(value = <span class="string">"åŒºåŸŸå…¬å¸"</span>,index = <span class="number">8</span>)</span><br><span class="line">    <span class="keyword">private</span> Long areaComp;</span><br><span class="line">   </span><br><span class="line">    <span class="meta">@ExcelProperty</span>(value = <span class="string">"ä»˜æ¬¾æ—¶é—´"</span>,index = <span class="number">12</span>,format = <span class="string">"yy-MM-dd hh:mm:ss"</span>)</span><br><span class="line">    <span class="keyword">private</span> Date payTime;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æœ€ååœ¨æ§åˆ¶å™¨è¾“å‡º"><a href="#æœ€ååœ¨æ§åˆ¶å™¨è¾“å‡º" class="headerlink" title="æœ€ååœ¨æ§åˆ¶å™¨è¾“å‡º"></a>æœ€ååœ¨æ§åˆ¶å™¨è¾“å‡º</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@RequestMapping</span>(value = <span class="string">"export"</span>,method = RequestMethod.GET)</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">exportExcel</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">       List&lt;GoodsOrderDto&gt; orderDtoList = goodsOrderServiceRemote.querGoodsOrderList();</span><br><span class="line">       List&lt;GoodsOrderExportDto&gt; orderExportDtoList = Collections.emptyList();</span><br><span class="line">       <span class="keyword">if</span> (CollectionUtils.isNotEmpty(orderDtoList))&#123;</span><br><span class="line">           orderExportDtoList = <span class="keyword">new</span> ArrayList&lt;&gt;(orderDtoList.size());</span><br><span class="line">           <span class="keyword">for</span> (GoodsOrderDto goodsOrderDto : orderDtoList) &#123;</span><br><span class="line">               GoodsOrderExportDto goodsOrderExportDto = <span class="keyword">new</span> GoodsOrderExportDto();</span><br><span class="line">               BeanUtils.copyProperties(goodsOrderDto,goodsOrderExportDto);</span><br><span class="line"></span><br><span class="line">               orderExportDtoList.add(goodsOrderExportDto);</span><br><span class="line">           &#125;</span><br><span class="line">           orderDtoList.clear();</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// è®¾å®šè¾“å‡ºæ–‡ä»¶å¤´</span></span><br><span class="line">       response.setHeader(<span class="string">"Content-disposition"</span>, <span class="string">"attachment; filename="</span> + URLEncoder.encode(<span class="string">"è®¢å•å¯¼å‡º.xls"</span>, <span class="string">"UTF-8"</span>));</span><br><span class="line">       <span class="comment">// å®šä¹‰è¾“å‡ºç±»å‹</span></span><br><span class="line">       response.setContentType(<span class="string">"application/msexcel"</span>);</span><br><span class="line"></span><br><span class="line">       OutputStream outputStream = response.getOutputStream();</span><br><span class="line"></span><br><span class="line">       ExcelWriter excelWriter = <span class="keyword">new</span> ExcelWriter(outputStream, ExcelTypeEnum.XLS);</span><br><span class="line"></span><br><span class="line">       Sheet sheet = <span class="keyword">new</span> Sheet(<span class="number">1</span>, <span class="number">0</span>, GoodsOrderExportDto<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">       excelWriter.write(orderExportDtoList,sheet);</span><br><span class="line"></span><br><span class="line">       outputStream.flush();</span><br><span class="line">       excelWriter.finish();</span><br><span class="line">       outputStream.close();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> EasyExcel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æŸ¥çœ‹ä¾èµ–ç¬¬ä¸‰æ–¹jaræœ€ä½è¦æ±‚è¿è¡Œçš„jdkç‰ˆæœ¬</title>
      <link href="/post/58af8f82.html"/>
      <url>/post/58af8f82.html</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨æ¯”è¾ƒé˜¿é‡Œå·´å·´çš„easyexcelå’Œeasypoiçš„excelå¯¼å‡ºåŠŸèƒ½å“ªä¸ªå¼ºå¤§ã€‚ä¸¤è€…çš„demoæˆ‘éƒ½æ˜¯å†™åœ¨åŒä¸€ä¸ªå·¥ç¨‹é‡Œé¢çš„ï¼Œeasyexcelçš„demoæ˜¯å…ˆå†™çš„ï¼Œä½¿ç”¨èµ·æ¥æ–¹ä¾¿ç®€æ´ã€‚ç„¶åå¼€å§‹å†™easypoiçš„demoæ—¶ï¼Œé¦–å…ˆå‡ºç°äº†ä¾èµ–ä¸‹è½½ä¸äº†ï¼Œä¾èµ–èƒ½ä¸‹è½½ä¹‹åï¼Œè¿˜å‡ºç°äº†ä¸‹é¢çš„ä¹±ä¸ƒå…«ç³Ÿçš„é—®é¢˜ï¼š</p><a id="more"></a><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Handler dispatch failed; nested exception is java.lang.NoClassDefFoundError: cn/afterturn/easypoi/excel/entity/ExportParams</span><br><span class="line"></span><br><span class="line">Unsupported major.minor version <span class="number">52.0</span></span><br></pre></td></tr></table></figure><p>åˆšå¼€å§‹æˆ‘æ˜¯ä»¥ä¸ºeasypoiçš„ä¾èµ–åŒ…æ²¡æœ‰å®Œæ•´ä¸‹ä¸‹æ¥ï¼Œåæ¥æ£€æŸ¥å‘ç°åº”è¯¥å…¨éƒ¨ä¸‹è½½äº†ã€‚åæ¥æˆ‘æƒ³æ˜¯ä¸æ˜¯ä¾èµ–æ²¡æœ‰æ·»åŠ å…¨ï¼Œå»easypoiçš„å®˜æ–¹ç½‘ç«™çœ‹ï¼Œæˆ‘çš„ä¾èµ–ä½¿ç”¨åº”è¯¥æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯æŠŠeasypoiçš„ç‰ˆæœ¬ä»4.0.0é™åˆ°äº†3.30ï¼Œä½†æ˜¯demoè¿è¡Œèµ·æ¥è¿˜æ˜¯æŠ¥é”™ã€‚åæ¥æˆ‘æƒ³åˆ°easyexcelä¹Ÿæ˜¯ä¾èµ–poiçš„ï¼Œæ˜¯ä¸æ˜¯ä»–ä¿©åˆç‰ˆæœ¬ä¾èµ–çš„å†²çªã€‚äºæ˜¯æˆ‘æŠŠeasyexcelç»™æ³¨é‡Šäº†ï¼Œäºæ˜¯æˆ‘å°±æˆåŠŸäº†ï¼<del>~</del>æˆ‘å˜ä¸ªå»ï¼ï¼ï¼ï¼ï¼<br>å‡ºç°ç¬¬ä¸€ä¸ªé”™è¯¯å°±æ˜¯å› ä¸ºeasyexcelå’Œeasypoiçš„ä¾èµ–æœ‰å†²çªã€‚å‡ºç°ç¬¬äºŒä¸ªé”™è¯¯æ˜¯è‹±æ–‡ï¼Œä½¿ç”¨çš„easypoiçš„ç‰ˆæœ¬è¿‡é«˜ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯easypoi4.0.0,ä»–éœ€è¦çš„jdkçš„ç‰ˆæœ¬æ˜¯jdk8ä»¥ä¸Šçš„ã€‚</p><h4 id="é‚£å¦‚ä½•æŸ¥çœ‹ç¬¬ä¸‰æ–¹ä¾èµ–æœ€ä½è¦æ±‚è¿è¡Œçš„jdkç‰ˆæœ¬å‘¢ï¼Ÿ"><a href="#é‚£å¦‚ä½•æŸ¥çœ‹ç¬¬ä¸‰æ–¹ä¾èµ–æœ€ä½è¦æ±‚è¿è¡Œçš„jdkç‰ˆæœ¬å‘¢ï¼Ÿ" class="headerlink" title="é‚£å¦‚ä½•æŸ¥çœ‹ç¬¬ä¸‰æ–¹ä¾èµ–æœ€ä½è¦æ±‚è¿è¡Œçš„jdkç‰ˆæœ¬å‘¢ï¼Ÿ"></a>é‚£å¦‚ä½•æŸ¥çœ‹ç¬¬ä¸‰æ–¹ä¾èµ–æœ€ä½è¦æ±‚è¿è¡Œçš„jdkç‰ˆæœ¬å‘¢ï¼Ÿ</h4><ul><li><p>åœ¨ç¬¬ä¸‰æ–¹jaråŒ…ä¸‹ä¼šå­˜åœ¨ä¸€ä¸ªMETA-INFç›®å½•ï¼Œè¯¥ç›®å½•ä¸‹æœ‰ä¸€ä¸ªMANIFEST.MFæ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶ä»¥é”®å€¼å¯¹çš„å½¢å¼å­˜å‚¨ä¸€äº›å…³äºjaråŒ…çš„å…³é”®ä¿¡æ¯ã€‚<br>ä¸‹é¢æˆ‘ä»¥easypoi-baseçš„MANIFEST.MFæ–‡ä»¶åšä¸ºç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Manifest-Version: <span class="number">1.0</span></span><br><span class="line">Archiver-Version: Plexus Archiver</span><br><span class="line">Built-By: jueyue</span><br><span class="line">Created-By: Apache Maven <span class="number">3.1</span><span class="number">.1</span></span><br><span class="line">Build-Jdk: <span class="number">1.8</span><span class="number">.0_144</span></span><br></pre></td></tr></table></figure><p>å¯æ˜¯ä¸€ä¸ª.jaræ–‡ä»¶ä¸­ï¼Œå¦‚æœæ²¡æœ‰è¿™ä¸ªå­—æ®µï¼Œå°±å¿…é¡»é€šè¿‡ä¸‹é¢ä¸€ç§æ–¹æ³•æ¥æŸ¥çœ‹</p></li><li><p>é€šè¿‡åç¼–è¯‘.classæ–‡ä»¶æ¥æŸ¥çœ‹<br>è§£å‹.jaråŒ…ï¼Œèƒ½å¾—åˆ°.classæ–‡ä»¶ã€‚ç”¨JDKè‡ªå¸¦çš„javapåç¼–è¯‘.classæ–‡ä»¶ï¼Œç”¨å¦‚ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">javap -verbose Configuration<span class="class">.<span class="keyword">class</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">#æŸ¥çœ‹å¾—åˆ°çš„ä¿¡æ¯ä¸­ï¼Œ<span class="title">major</span> <span class="title">version</span>å±æ€§çš„å†…å®¹ï¼Œå¦‚ä¸‹</span></span><br><span class="line">major version: 52</span><br></pre></td></tr></table></figure><p>è¯´æ˜è¿™ä¸ª.classæ–‡ä»¶æ˜¯ç”±JDK1.8ç¼–è¯‘å¾—åˆ°çš„ã€‚ </p></li><li><p>Java 9 uses major version 53</p></li><li><p>J2SE 8.0 = 52(0x33 hex)</p></li><li><p>J2SE 7.0 = 51(0x32 hex) </p></li><li><p>J2SE 6.0 = 50 (0x32 hex)</p></li><li><p>J2SE 5.0 = 49 (0x31 hex)</p></li><li><p>JDK 1.4 = 48 (0x30 hex)</p></li><li><p>JDK 1.3 = 47 (0x2F hex)</p></li><li><p>JDK 1.2 = 46 (0x2E hex)</p></li><li><p>JDK 1.1 = 45 (0x2D hex)</p></li></ul><p>æ³¨æ„ï¼šä¸€ä¸ª.jaråŒ…ä¸­å¯èƒ½æœ‰å¤šä¸ª.classæ–‡ä»¶ï¼Œæ¯ä¸ª.classçš„JDKç‰ˆæœ¬å¯èƒ½ä¼šä¸ä¸€æ ·ï¼ˆç¼–è¯‘å™¨å¤šä¸ªé¡¹ç›®è®¾ç½®ä¸åŒï¼‰</p><p>æˆ‘ç”µè„‘ä¸Šå®‰è£…çš„æ˜¯jdk7ã€‚æ‰€ä»¥è§£å†³åŠæ³•æ˜¯åˆ æ‰easyexcelçš„ä¾èµ–ï¼Œä½¿ç”¨easypoiè¿è¡Œå’Œè‡ªå·±jdkç›¸åŒç‰ˆæœ¬çš„å°±è¡Œäº†</p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Dubboå‡ºç°ExceedPayloadLimitException: Data length too largeçš„é”™è¯¯</title>
      <link href="/post/45135675.html"/>
      <url>/post/45135675.html</url>
      
        <content type="html"><![CDATA[<p>åœ¨ä½¿ç”¨dubboçš„æ—¶å€™ï¼Œä¸€æ¬¡è¯·æ±‚çš„æ•°æ®é‡è¿‡å¤§çš„æ—¶å€™ï¼Œä¼šå‡ºç°ä¸‹é¢çš„é—®é¢˜ã€‚</p><a id="more"></a><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">com.alibaba.dubbo.remoting.transport.ExceedPayloadLimitException: Data length too large: <span class="number">12470880</span>, max payload: <span class="number">8388608</span>, channel: NettyChannel [channel=[id: <span class="number">0x78767b1e</span>, /<span class="number">10.23</span><span class="number">.144</span><span class="number">.194</span>:<span class="number">54414</span> =&gt; /<span class="number">10.23</span><span class="number">.144</span><span class="number">.194</span>:<span class="number">20880</span>]]</span><br><span class="line">at com.alibaba.dubbo.remoting.transport.AbstractCodec.checkPayload(AbstractCodec.java:<span class="number">44</span>) ~[dubbo-<span class="number">2.6</span><span class="number">.2</span>.jar:<span class="number">2.6</span><span class="number">.2</span>]</span><br><span class="line">at com.alibaba.dubbo.remoting.exchange.codec.ExchangeCodec.encodeResponse(ExchangeCodec.java:<span class="number">288</span>) [dubbo-<span class="number">2.6</span><span class="number">.2</span>.jar:<span class="number">2.6</span><span class="number">.2</span>]</span><br><span class="line">at com.alibaba.dubbo.remoting.exchange.codec.ExchangeCodec.encode(ExchangeCodec.java:<span class="number">73</span>) [dubbo-<span class="number">2.6</span><span class="number">.2</span>.jar:<span class="number">2.6</span><span class="number">.2</span>]</span><br><span class="line">at com.alibaba.dubbo.rpc.protocol.dubbo.DubboCountCodec.encode(DubboCountCodec.java:<span class="number">38</span>) [dubbo-<span class="number">2.6</span><span class="number">.2</span>.jar:<span class="number">2.6</span><span class="number">.2</span>]</span><br><span class="line">at com.alibaba.dubbo.remoting.transport.netty.NettyCodecAdapter$InternalEncoder.encode(NettyCodecAdapter.java:<span class="number">80</span>) [dubbo-<span class="number">2.6</span><span class="number">.2</span>.jar:<span class="number">2.6</span><span class="number">.2</span>]</span><br><span class="line">at org.jboss.netty.handler.codec.oneone.OneToOneEncoder.handleDownstream(OneToOneEncoder.java:<span class="number">66</span>) [netty-<span class="number">3.2</span><span class="number">.5</span>.Final.jar:na]</span><br><span class="line">at org.jboss.netty.channel.DefaultChannelPipeline.sendDownstream(DefaultChannelPipeline.java:<span class="number">591</span>) [netty-<span class="number">3.2</span><span class="number">.5</span>.Final.jar:na]</span><br><span class="line">at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendDownstream(DefaultChannelPipeline.java:<span class="number">776</span>) [netty-<span class="number">3.2</span><span class="number">.5</span>.Final.jar:na]</span><br><span class="line">at org.jboss.netty.channel.SimpleChannelHandler.writeRequested(SimpleChannelHandler.java:<span class="number">304</span>) [netty-<span class="number">3.2</span><span class="number">.5</span>.Final.jar:na]</span><br><span class="line">at com.alibaba.dubbo.remoting.transport.netty.NettyHandler.writeRequested(NettyHandler.java:<span class="number">98</span>) [dubbo-<span class="number">2.6</span><span class="number">.2</span>.jar:<span class="number">2.6</span><span class="number">.2</span>]</span><br><span class="line">at org.jboss.netty.channel.SimpleChannelHandler.handleDownstream(SimpleChannelHandler.java:<span class="number">266</span>) [netty-<span class="number">3.2</span><span class="number">.5</span>.Final.jar:na]</span><br><span class="line">at org.jboss.netty.channel.DefaultChannelPipeline.sendDownstream(DefaultChannelPipeline.java:<span class="number">591</span>) [netty-<span class="number">3.2</span><span class="number">.5</span>.Final.jar:na]</span><br><span class="line">at org.jboss.netty.channel.DefaultChannelPipeline.sendDownstream(DefaultChannelPipeline.java:<span class="number">582</span>) [netty-<span class="number">3.2</span><span class="number">.5</span>.Final.jar:na]</span><br><span class="line">at org.jboss.netty.channel.Channels.write(Channels.java:<span class="number">611</span>) [netty-<span class="number">3.2</span><span class="number">.5</span>.Final.jar:na]</span><br><span class="line">at org.jboss.netty.channel.Channels.write(Channels.java:<span class="number">578</span>) [netty-<span class="number">3.2</span><span class="number">.5</span>.Final.jar:na]</span><br><span class="line">at org.jboss.netty.channel.AbstractChannel.write(AbstractChannel.java:<span class="number">251</span>) [netty-<span class="number">3.2</span><span class="number">.5</span>.Final.jar:na]</span><br><span class="line">at com.alibaba.dubbo.remoting.transport.netty.NettyChannel.send(NettyChannel.java:<span class="number">100</span>) [dubbo-<span class="number">2.6</span><span class="number">.2</span>.jar:<span class="number">2.6</span><span class="number">.2</span>]</span><br><span class="line">at com.alibaba.dubbo.remoting.transport.AbstractPeer.send(AbstractPeer.java:<span class="number">53</span>) [dubbo-<span class="number">2.6</span><span class="number">.2</span>.jar:<span class="number">2.6</span><span class="number">.2</span>]</span><br><span class="line">at com.alibaba.dubbo.remoting.exchange.support.header.HeaderExchangeHandler.received(HeaderExchangeHandler.java:<span class="number">173</span>) [dubbo-<span class="number">2.6</span><span class="number">.2</span>.jar:<span class="number">2.6</span><span class="number">.2</span>]</span><br><span class="line">at com.alibaba.dubbo.remoting.transport.DecodeHandler.received(DecodeHandler.java:<span class="number">51</span>) [dubbo-<span class="number">2.6</span><span class="number">.2</span>.jar:<span class="number">2.6</span><span class="number">.2</span>]</span><br><span class="line">at com.alibaba.dubbo.remoting.transport.dispatcher.ChannelEventRunnable.run(ChannelEventRunnable.java:<span class="number">80</span>) [dubbo-<span class="number">2.6</span><span class="number">.2</span>.jar:<span class="number">2.6</span><span class="number">.2</span>]</span><br><span class="line">at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:<span class="number">1145</span>) [na:<span class="number">1.7</span><span class="number">.0_80</span>]</span><br><span class="line">at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:<span class="number">615</span>) [na:<span class="number">1.7</span><span class="number">.0_80</span>]</span><br><span class="line">at java.lang.Thread.run(Thread.java:<span class="number">745</span>) [na:<span class="number">1.7</span><span class="number">.0_80</span>]</span><br><span class="line"></span><br><span class="line"><span class="number">2019</span>-<span class="number">05</span>-<span class="number">14</span> <span class="number">10</span>:<span class="number">27</span>:<span class="number">30.194</span>  WARN <span class="number">10424</span> --- [:<span class="number">20880</span>-thread-<span class="number">4</span>] c.a.d.r.exchange.codec.ExchangeCodec     :  [DUBBO] Data length too large: <span class="number">12470880</span>, max payload: <span class="number">8388608</span>, channel: NettyChannel [channel=[id: <span class="number">0x78767b1e</span>, /<span class="number">10.23</span><span class="number">.144</span><span class="number">.194</span>:<span class="number">54414</span> =&gt; /<span class="number">10.23</span><span class="number">.144</span><span class="number">.194</span>:<span class="number">20880</span>]], dubbo version: <span class="number">2.6</span><span class="number">.2</span>, current host: <span class="number">10.23</span><span class="number">.144</span><span class="number">.194</span></span><br></pre></td></tr></table></figure><p>å½“DubboæœåŠ¡æä¾›è€…å‘æ¶ˆè´¹è€…ä¼ è¾“å¤§æ•°æ®å®¹é‡çš„å¯¹è±¡æ—¶ï¼Œä¼šå—åˆ°Dubboçš„é™åˆ¶ï¼ŒæŠ›å‡ºä¸Šé¢çš„Data length too largeå¼‚å¸¸<br>ç¼–è¾‘dubbo.xml,æ·»åŠ payloadé…ç½®ï¼Œé»˜è®¤æ˜¯8Mï¼Œæˆ‘ç»™æ”¹æˆ80Mã€‚è¿™æ ·åšç®€å•ç²—æš´ï¼Œå…¶å®ä¸å¤ªç¬¦åˆDubboçš„è®¾è®¡ç†å¿µã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dubbo:provider</span> <span class="attr">filter</span>=<span class="string">"dubboExceptionFilter,-exception"</span> <span class="attr">payload</span>=<span class="string">"83886080"</span> &gt;</span><span class="tag">&lt;/<span class="name">dubbo:provider</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> dubbo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MyBatis Generatoré…ç½®æ–‡ä»¶--æŒ‡å®šç”Ÿæˆå®ä½“ç±»ä½¿ç”¨å®é™…çš„è¡¨åˆ—åä½œä¸ºå®ä½“ç±»çš„å±æ€§å</title>
      <link href="/post/f1ed0391.html"/>
      <url>/post/f1ed0391.html</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¤©åœ¨ç”¨MyBatis Generatorç”Ÿæˆè¡¨å®ä½“çš„æ—¶å€™ï¼Œå‘ç°æ•°æ®åº“ä¸­çš„è¡¨å­—æ®µä½¿ç”¨çš„æ˜¯å°é©¼å³°å‘½åè§„åˆ™ï¼Œç”Ÿæˆå‡ºæ¥çš„å®ä½“å±æ€§éƒ½æ˜¯å°å†™äº†ï¼Œæ²¡æœ‰è½¬æˆå°é©¼å³°ï¼Œä¸€ç•ªæœç´¢å¾—çŸ¥å¯ä»¥åœ¨MyBatis Generatorçš„é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹ã€‚</p><a id="more"></a><p>tableæ ‡ç­¾ä¸‹çš„è®¾ç½®å±æ€§useActualColumnNamesç”¨äºæŒ‡å®šç”Ÿæˆå®ä½“ç±»æ—¶æ˜¯å¦ä½¿ç”¨å®é™…çš„åˆ—åä½œä¸ºå®ä½“ç±»çš„å±æ€§åï¼Œå–å€¼trueæˆ–falseã€‚</p><p>trueï¼šMyBatis Generatorä¼šä½¿ç”¨æ•°æ®åº“ä¸­å®é™…çš„å­—æ®µåå­—ä½œä¸ºç”Ÿæˆçš„å®ä½“ç±»çš„å±æ€§åã€‚</p><p>falseï¼šè¿™æ˜¯é»˜è®¤å€¼ã€‚å¦‚æœè®¾ç½®ä¸ºfalse,åˆ™MyBatis Generatorä¼šå°†æ•°æ®åº“ä¸­å®é™…çš„å­—æ®µåå­—è½¬æ¢ä¸ºCamel Caseé£æ ¼ä½œä¸ºç”Ÿæˆçš„å®ä½“ç±»çš„å±æ€§åã€‚</p><p>å¦‚æœæ˜ç¡®çš„ä½¿ç”¨columnOverrideå…ƒç´ æŒ‡å®šäº†å­—æ®µå¯¹åº”çš„å®ä½“çš„å±æ€§å,é‚£ä¹ˆuseActualColumnNamesä¼šè¢«å¿½ç•¥ã€‚</p><p>å‡è®¾è¡¨æœ‰ä¸€ä¸ªå­—æ®µåä¸ºstart_date,å¦‚æœè¿™ä¸ªå±æ€§è®¾ç½®ä¸ºtrue,åˆ™ç”Ÿæˆçš„å®ä½“ç±»çš„å±æ€§åä¸ºstart_date,ç”Ÿæˆçš„setter/getterä¸ºã€€setStart_date/getStart_dateã€‚å¦‚æœuseActualColumnNamesè®¾ç½®ä¸ºfalse,åˆ™ç”Ÿæˆçš„å®ä½“ç±»çš„å±æ€§åä¸ºstartDate,ç”Ÿæˆçš„setter/getterä¸ºsetStartDate/getStartDateã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">"dobbo_goods_order"</span> <span class="attr">domainObjectName</span>=<span class="string">"GoodsOrder"</span> <span class="attr">enableCountByExample</span>=<span class="string">"false"</span> <span class="attr">enableUpdateByExample</span>=<span class="string">"false"</span></span></span><br><span class="line"><span class="tag">              <span class="attr">enableDeleteByExample</span>=<span class="string">"false"</span> <span class="attr">enableSelectByExample</span>=<span class="string">"false"</span> <span class="attr">selectByExampleQueryId</span>=<span class="string">"false"</span> &gt;</span></span><br><span class="line">           <span class="comment">&lt;!-- tableæ ‡ç­¾ä¸‹çš„è®¾ç½®å±æ€§useActualColumnNamesç”¨äºæŒ‡å®šç”Ÿæˆå®ä½“ç±»æ—¶æ˜¯å¦ä½¿ç”¨å®é™…çš„åˆ—åä½œä¸ºå®ä½“ç±»çš„å±æ€§åï¼Œå–å€¼trueæˆ–false--&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"useActualColumnNames"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> mybatis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Dubboç”±äºè¿æ¥ä¸ä¸Šmonitorç›‘æ§ä¸­å¿ƒæŠ¥é”™</title>
      <link href="/post/9008dc8b.html"/>
      <url>/post/9008dc8b.html</url>
      
        <content type="html"><![CDATA[<p>dubbboä½¿ç”¨æ—¶å€™æ²¡æœ‰å¯åŠ¨ç›‘æ§ä¸­å¿ƒï¼Œä¸èƒ½é…äº†ç›‘æ§åœ°å€ã€‚</p><a id="more"></a><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">com.alibaba.dubbo.rpc.RpcException: Failed to invoke the method collect in the service com.alibaba.dubbo.monitor.MonitorService. No provider available <span class="keyword">for</span> the service com.alibaba.dubbo.monitor.MonitorService from registry localhost:<span class="number">2181</span> on the consumer <span class="number">10.23</span><span class="number">.144</span><span class="number">.194</span> using the dubbo version <span class="number">2.6</span><span class="number">.2</span>. Please check <span class="keyword">if</span> the providers have been started and registered.</span><br><span class="line">at com.alibaba.dubbo.rpc.cluster.support.AbstractClusterInvoker.checkInvokers(AbstractClusterInvoker.java:<span class="number">257</span>) ~[dubbo-<span class="number">2.6</span><span class="number">.2</span>.jar:<span class="number">2.6</span><span class="number">.2</span>]</span><br><span class="line">at com.alibaba.dubbo.rpc.cluster.support.FailoverClusterInvoker.doInvoke(FailoverClusterInvoker.java:<span class="number">56</span>) ~[dubbo-<span class="number">2.6</span><span class="number">.2</span>.jar:<span class="number">2.6</span><span class="number">.2</span>]</span><br><span class="line">at com.alibaba.dubbo.rpc.cluster.support.AbstractClusterInvoker.invoke(AbstractClusterInvoker.java:<span class="number">238</span>) ~[dubbo-<span class="number">2.6</span><span class="number">.2</span>.jar:<span class="number">2.6</span><span class="number">.2</span>]</span><br><span class="line">at com.alibaba.dubbo.rpc.cluster.support.wrapper.MockClusterInvoker.invoke(MockClusterInvoker.java:<span class="number">75</span>) ~[dubbo-<span class="number">2.6</span><span class="number">.2</span>.jar:<span class="number">2.6</span><span class="number">.2</span>]</span><br><span class="line">at com.alibaba.dubbo.rpc.proxy.InvokerInvocationHandler.invoke(InvokerInvocationHandler.java:<span class="number">52</span>) ~[dubbo-<span class="number">2.6</span><span class="number">.2</span>.jar:<span class="number">2.6</span><span class="number">.2</span>]</span><br><span class="line">at com.alibaba.dubbo.common.bytecode.proxy0.collect(proxy0.java) ~[dubbo-<span class="number">2.6</span><span class="number">.2</span>.jar:<span class="number">2.6</span><span class="number">.2</span>]</span><br><span class="line">at com.alibaba.dubbo.monitor.dubbo.DubboMonitor.send(DubboMonitor.java:<span class="number">112</span>) ~[dubbo-<span class="number">2.6</span><span class="number">.2</span>.jar:<span class="number">2.6</span><span class="number">.2</span>]</span><br><span class="line">at com.alibaba.dubbo.monitor.dubbo.DubboMonitor$<span class="number">1</span>.run(DubboMonitor.java:<span class="number">69</span>) ~[dubbo-<span class="number">2.6</span><span class="number">.2</span>.jar:<span class="number">2.6</span><span class="number">.2</span>]</span><br><span class="line">at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:<span class="number">471</span>) [na:<span class="number">1.7</span><span class="number">.0_80</span>]</span><br><span class="line">at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:<span class="number">304</span>) [na:<span class="number">1.7</span><span class="number">.0_80</span>]</span><br><span class="line">at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$<span class="number">301</span>(ScheduledThreadPoolExecutor.java:<span class="number">178</span>) [na:<span class="number">1.7</span><span class="number">.0_80</span>]</span><br><span class="line">at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:<span class="number">293</span>) [na:<span class="number">1.7</span><span class="number">.0_80</span>]</span><br><span class="line">at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:<span class="number">1145</span>) [na:<span class="number">1.7</span><span class="number">.0_80</span>]</span><br><span class="line">at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:<span class="number">615</span>) [na:<span class="number">1.7</span><span class="number">.0_80</span>]</span><br><span class="line">at java.lang.Thread.run(Thread.java:<span class="number">745</span>) [na:<span class="number">1.7</span><span class="number">.0_80</span>]</span><br></pre></td></tr></table></figure><p>è§£å†³æ–¹æ¡ˆï¼š<br>è¿™æ˜¯å› ä¸ºæ²¡æœ‰å¯åŠ¨ç›‘æ§ä¸­å¿ƒï¼Œå´é…äº†ç›‘æ§åœ°å€ï¼ŒæŠŠç›‘æ§ä¸­å¿ƒå¯åŠ¨ï¼Œæˆ–è€…æŠŠxmlé…ç½®ä¸­çš„&lt;dubbo:monitor protocol=â€registryâ€&gt;</dubbo:monitor>æˆ–propertiesé…ç½®ä¸­çš„dubbo.monitor.protocol=registryå»æ‰ï¼Œå³å¯ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> dubbo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaä¸­ListIteratorå’ŒIteratorçš„å¼‚åŒ</title>
      <link href="/post/5da32797.html"/>
      <url>/post/5da32797.html</url>
      
        <content type="html"><![CDATA[<p>åœ¨ä½¿ç”¨Javaé›†åˆçš„æ—¶å€™ï¼Œéƒ½éœ€è¦ä½¿ç”¨Iteratorã€‚ä½†æ˜¯javaé›†åˆä¸­è¿˜æœ‰ä¸€ä¸ªè¿­ä»£å™¨ListIterator,åœ¨ä½¿ç”¨Listã€ArrayListã€LinkedListå’ŒVectorçš„æ—¶å€™å¯ä»¥ä½¿ç”¨ã€‚è¿™ä¸¤ç§è¿­ä»£å™¨æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿä¸‹é¢æˆ‘ä»¬è¯¦ç»†åˆ†æã€‚è¿™é‡Œæœ‰ä¸€ç‚¹éœ€è¦æ˜ç¡®çš„æ—¶å€™ï¼Œè¿­ä»£å™¨æŒ‡å‘çš„ä½ç½®æ˜¯å…ƒç´ ä¹‹å‰çš„ä½ç½®ã€‚</p><a id="more"></a><p>é¦–å…ˆçœ‹ä¸€ä¸‹Iteratorå’ŒListIteratorè¿­ä»£å™¨çš„æ–¹æ³•æœ‰å“ªäº›ã€‚</p><p>Iteratorè¿­ä»£å™¨åŒ…å«çš„æ–¹æ³•æœ‰ï¼š</p><p>hasNext()ï¼šå¦‚æœè¿­ä»£å™¨æŒ‡å‘ä½ç½®åé¢è¿˜æœ‰å…ƒç´ ï¼Œåˆ™è¿”å› trueï¼Œå¦åˆ™è¿”å›false</p><p>next()ï¼šè¿”å›é›†åˆä¸­IteratoræŒ‡å‘ä½ç½®åé¢çš„å…ƒç´ </p><p>remove()ï¼šåˆ é™¤é›†åˆä¸­IteratoræŒ‡å‘ä½ç½®åé¢çš„å…ƒç´ </p><p>ListIteratorè¿­ä»£å™¨åŒ…å«çš„æ–¹æ³•æœ‰ï¼š</p><p>add(E e): å°†æŒ‡å®šçš„å…ƒç´ æ’å…¥åˆ—è¡¨ï¼Œæ’å…¥ä½ç½®ä¸ºè¿­ä»£å™¨å½“å‰ä½ç½®ä¹‹å‰</p><p>hasNext()ï¼šä»¥æ­£å‘éå†åˆ—è¡¨æ—¶ï¼Œå¦‚æœåˆ—è¡¨è¿­ä»£å™¨åé¢è¿˜æœ‰å…ƒç´ ï¼Œåˆ™è¿”å› trueï¼Œå¦åˆ™è¿”å›false</p><p>hasPrevious():å¦‚æœä»¥é€†å‘éå†åˆ—è¡¨ï¼Œåˆ—è¡¨è¿­ä»£å™¨å‰é¢è¿˜æœ‰å…ƒç´ ï¼Œåˆ™è¿”å› trueï¼Œå¦åˆ™è¿”å›false</p><p>next()ï¼šè¿”å›åˆ—è¡¨ä¸­ListIteratoræŒ‡å‘ä½ç½®åé¢çš„å…ƒç´ </p><p>nextIndex():è¿”å›åˆ—è¡¨ä¸­ListIteratoræ‰€éœ€ä½ç½®åé¢å…ƒç´ çš„ç´¢å¼•</p><p>previous():è¿”å›åˆ—è¡¨ä¸­ListIteratoræŒ‡å‘ä½ç½®å‰é¢çš„å…ƒç´ </p><p>previousIndex()ï¼šè¿”å›åˆ—è¡¨ä¸­ListIteratoræ‰€éœ€ä½ç½®å‰é¢å…ƒç´ çš„ç´¢å¼•</p><p>remove():ä»åˆ—è¡¨ä¸­åˆ é™¤next()æˆ–previous()è¿”å›çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼ˆæœ‰ç‚¹æ‹—å£ï¼Œæ„æ€å°±æ˜¯å¯¹è¿­ä»£å™¨ä½¿ç”¨hasNext()æ–¹æ³•æ—¶ï¼Œåˆ é™¤ListIteratoræŒ‡å‘ä½ç½®åé¢çš„å…ƒç´ ï¼›å½“å¯¹è¿­ä»£å™¨ä½¿ç”¨hasPrevious()æ–¹æ³•æ—¶ï¼Œåˆ é™¤ListIteratoræŒ‡å‘ä½ç½®å‰é¢çš„å…ƒç´ ï¼‰</p><p>set(E e)ï¼šä»åˆ—è¡¨ä¸­å°†next()æˆ–previous()è¿”å›çš„æœ€åä¸€ä¸ªå…ƒç´ è¿”å›çš„æœ€åä¸€ä¸ªå…ƒç´ æ›´æ”¹ä¸ºæŒ‡å®šå…ƒç´ e</p><h4 id="ç›¸åŒç‚¹"><a href="#ç›¸åŒç‚¹" class="headerlink" title="ç›¸åŒç‚¹"></a>ç›¸åŒç‚¹</h4><p>éƒ½æ˜¯è¿­ä»£å™¨ï¼Œå½“éœ€è¦å¯¹é›†åˆä¸­å…ƒç´ è¿›è¡Œéå†ä¸éœ€è¦å¹²æ¶‰å…¶éå†è¿‡ç¨‹æ—¶ï¼Œè¿™ä¸¤ç§è¿­ä»£å™¨éƒ½å¯ä»¥ä½¿ç”¨ã€‚</p><h4 id="ä¸åŒç‚¹"><a href="#ä¸åŒç‚¹" class="headerlink" title="ä¸åŒç‚¹"></a>ä¸åŒç‚¹</h4><ul><li><p>ä½¿ç”¨èŒƒå›´ä¸åŒï¼ŒIteratorå¯ä»¥åº”ç”¨äºæ‰€æœ‰çš„é›†åˆï¼ŒSetã€Listå’ŒMapå’Œè¿™äº›é›†åˆçš„å­ç±»å‹ã€‚è€ŒListIteratoråªèƒ½ç”¨äºListåŠå…¶å­ç±»å‹ã€‚</p></li><li><p>ListIteratoræœ‰addæ–¹æ³•ï¼Œå¯ä»¥å‘Listä¸­æ·»åŠ å¯¹è±¡ï¼Œè€ŒIteratorä¸èƒ½ã€‚</p></li><li><p>ListIteratorå’ŒIteratoréƒ½æœ‰hasNext()å’Œnext()æ–¹æ³•ï¼Œå¯ä»¥å®ç°é¡ºåºå‘åéå†ï¼Œä½†æ˜¯ListIteratoræœ‰hasPrevious()å’Œprevious()æ–¹æ³•ï¼Œå¯ä»¥å®ç°é€†å‘ï¼ˆé¡ºåºå‘å‰ï¼‰éå†ã€‚Iteratorä¸å¯ä»¥ã€‚</p></li><li><p>ListIteratorå¯ä»¥å®šä½å½“å‰ç´¢å¼•çš„ä½ç½®ï¼ŒnextIndex()å’ŒpreviousIndex()å¯ä»¥å®ç°ã€‚Iteratoræ²¡æœ‰æ­¤åŠŸèƒ½ã€‚</p></li><li><p>éƒ½å¯å®ç°åˆ é™¤æ“ä½œï¼Œä½†æ˜¯ListIteratorå¯ä»¥å®ç°å¯¹è±¡çš„ä¿®æ”¹ï¼Œset()æ–¹æ³•å¯ä»¥å®ç°ã€‚Iteratorä»…èƒ½éå†ï¼Œä¸èƒ½ä¿®æ”¹ã€‚</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ArrayList&lt;String&gt; stringArrayList1 = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">        ArrayList&lt;String&gt; stringArrayList2 = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line"></span><br><span class="line">        stringArrayList1.add(<span class="string">"ok"</span>);</span><br><span class="line">        stringArrayList1.add(<span class="string">"hello"</span>);</span><br><span class="line">        stringArrayList1.add(<span class="string">"world"</span>);</span><br><span class="line"></span><br><span class="line">        stringArrayList2.add(<span class="string">"å¥½çš„"</span>);</span><br><span class="line">        stringArrayList2.add(<span class="string">"ä½ å¥½"</span>);</span><br><span class="line">        stringArrayList2.add(<span class="string">"ä¸–ç•Œ"</span>);</span><br><span class="line"></span><br><span class="line">        stringArrayList1.addAll(stringArrayList2);</span><br><span class="line">        ListIterator&lt;String&gt; iterator = stringArrayList1.listIterator();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"ä»å‰å¾€åè¾“å‡º:"</span>);</span><br><span class="line">        <span class="keyword">while</span> (iterator.hasNext())&#123;</span><br><span class="line">            System.out.println(<span class="string">"next="</span>+iterator.next());</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">"\r\nä»åå¾€å‰è¾“å‡º:"</span>);</span><br><span class="line">        <span class="keyword">while</span> (iterator.hasPrevious())&#123;</span><br><span class="line">            System.out.println(<span class="string">"previous="</span>+iterator.previous());</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><h4 id="æ³¨æ„ï¼šä¸€å®šè¦å…ˆè¿›è¡Œç”±å‰å‘åè¾“å‡ºï¼Œä¹‹åæ‰èƒ½è¿›è¡Œç”±åå‘å‰çš„è¾“å‡ºã€‚"><a href="#æ³¨æ„ï¼šä¸€å®šè¦å…ˆè¿›è¡Œç”±å‰å‘åè¾“å‡ºï¼Œä¹‹åæ‰èƒ½è¿›è¡Œç”±åå‘å‰çš„è¾“å‡ºã€‚" class="headerlink" title="æ³¨æ„ï¼šä¸€å®šè¦å…ˆè¿›è¡Œç”±å‰å‘åè¾“å‡ºï¼Œä¹‹åæ‰èƒ½è¿›è¡Œç”±åå‘å‰çš„è¾“å‡ºã€‚"></a>æ³¨æ„ï¼šä¸€å®šè¦å…ˆè¿›è¡Œç”±å‰å‘åè¾“å‡ºï¼Œä¹‹åæ‰èƒ½è¿›è¡Œç”±åå‘å‰çš„è¾“å‡ºã€‚</h4>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> ListIterator </tag>
            
            <tag> Iterator </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ·±å…¥ç†è§£springæ³¨è§£ä¹‹@Beanæ³¨è§£</title>
      <link href="/post/2d1810c4.html"/>
      <url>/post/2d1810c4.html</url>
      
        <content type="html"><![CDATA[<p>@Beanæ˜¯ä¸€ä¸ªæ–¹æ³•çº§åˆ«ä¸Šçš„æ³¨è§£ï¼Œä¸»è¦ç”¨åœ¨@Configurationæ³¨è§£çš„ç±»é‡Œï¼Œä¹Ÿå¯ä»¥ç”¨åœ¨@Componentæ³¨è§£çš„ç±»é‡Œã€‚æ·»åŠ çš„beançš„idä¸ºæ–¹æ³•åã€‚</p><a id="more"></a><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target</span>(&#123;ElementType.METHOD, ElementType.ANNOTATION_TYPE&#125;)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Bean &#123;</span><br><span class="line">    <span class="meta">@AliasFor</span>(<span class="string">"name"</span>)</span><br><span class="line">    String[] value() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AliasFor</span>(<span class="string">"value"</span>)</span><br><span class="line">    String[] name() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function">Autowire <span class="title">autowire</span><span class="params">()</span> <span class="keyword">default</span> Autowire.NO</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">String <span class="title">initMethod</span><span class="params">()</span> <span class="keyword">default</span> ""</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">String <span class="title">destroyMethod</span><span class="params">()</span> <span class="keyword">default</span> "<span class="params">(inferred)</span>"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">value -- beanåˆ«åå’Œnameæ˜¯ç›¸äº’ä¾èµ–å…³è”çš„ï¼Œvalue,nameå¦‚æœéƒ½ä½¿ç”¨çš„è¯å€¼å¿…é¡»è¦ä¸€è‡´</span><br><span class="line">name -- beanåç§°ï¼Œå¦‚æœä¸å†™ä¼šé»˜è®¤ä¸ºæ³¨è§£çš„æ–¹æ³•åç§°</span><br><span class="line">autowire -- è‡ªå®šè£…é…é»˜è®¤æ˜¯ä¸å¼€å¯çš„ï¼Œå»ºè®®å°½é‡ä¸è¦å¼€å¯ï¼Œå› ä¸ºè‡ªåŠ¨è£…é…ä¸èƒ½è£…é…åŸºæœ¬æ•°æ®ç±»å‹ã€å­—ç¬¦ä¸²ã€æ•°ç»„ç­‰ï¼Œè¿™æ˜¯è‡ªåŠ¨è£…é…è®¾è®¡çš„å±€é™æ€§ï¼Œä»¥åŠè‡ªåŠ¨è£…é…ä¸å¦‚æ˜¾ç¤ºä¾èµ–æ³¨å…¥ç²¾ç¡®</span><br><span class="line">initMethod -- beançš„åˆå§‹åŒ–ä¹‹å‰çš„æ‰§è¡Œæ–¹æ³•ï¼Œè¯¥å‚æ•°ä¸€èˆ¬ä¸æ€ä¹ˆç”¨ï¼Œå› ä¸ºå¯ä»¥å®Œå…¨å¯ä»¥åœ¨ä»£ç ä¸­å®ç°</span><br><span class="line">destroyMethod -- beané”€æ¯æ‰§è¡Œçš„æ–¹æ³•</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> net.ydstudio.practise.bean;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åŠŸèƒ½æè¿°:&lt;br/&gt;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Bean</span>æ„æ€æ˜¯å®šä¹‰ä¸€ä¸ªbeanï¼Œè¯¥æ³¨è§£æ˜¯ä¸€ä¸ªæ–¹æ³•çº§åˆ«ä¸Šçš„æ³¨è§£ï¼Œå¯ä»¥ä½¿ç”¨åœ¨<span class="doctag">@Configuration</span>çš„ç±»é‡Œï¼Œä¹Ÿå¯ä»¥</span></span><br><span class="line"><span class="comment"> * åœ¨<span class="doctag">@Component</span>æ³¨è§£çš„ç±»é‡Œï¼Œæ·»åŠ çš„beançš„idä¸ºæ–¹æ³•çš„åç§°</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2019/4/23 19:36</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AppConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *  ä¸‹é¢çš„ä»£ç å°±ç›¸å½“äºåœ¨xmlä¹‹ä¸­æ·»åŠ ä¸‹é¢çš„é…ç½®</span></span><br><span class="line"><span class="comment">     *  &lt;beans&gt;</span></span><br><span class="line"><span class="comment">     *      &lt;bean id="transferService" class="net.ydstudio.practise.bean.TransferServiceImplâ€œ &gt;&lt;/bean&gt;</span></span><br><span class="line"><span class="comment">     *  &lt;/beans&gt;</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *  è¿˜èƒ½å¤Ÿä½¿ç”¨<span class="doctag">@Scope</span>æ³¨è§£æ¥æŒ‡å®šä½¿ç”¨<span class="doctag">@Bean</span>å®šä¹‰çš„bean</span></span><br><span class="line"><span class="comment">     *  singleton : å•ä¾‹ï¼Œæ•´ä¸ªåº”ç”¨ä¸­åªå­˜åœ¨ä¸€ä¸ªå®ä¾‹bean</span></span><br><span class="line"><span class="comment">     *  prototype ï¼š ä¸å•ä¾‹ç›¸å¯¹ï¼Œæ¯æ¬¡getBeanéƒ½ä¼šé‡æ–°ç”Ÿæˆä¸€ä¸ªBeanã€‚</span></span><br><span class="line"><span class="comment">     *  request ï¼š webç¯å¢ƒä¸‹ï¼Œæ¯ä¸ªè¯·æ±‚éƒ½ä¼šåˆ›å»ºä¸€ä¸ªbeanï¼Œåœ¨ä¸€æ¬¡è¯·æ±‚ä¸­åªå­˜åœ¨ä¸€ä¸ªBeanï¼Œä¸åŒrequestçš„beanä¸åŒ</span></span><br><span class="line"><span class="comment">     *  session ï¼š webç¯å¢ƒä¸‹ï¼Œsessionç”Ÿå‘½å‘¨æœŸä¸‹ï¼Œè·å–çš„æ˜¯åŒä¸€ä¸ªbean</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *  é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰å•å®ä¾‹beanéƒ½ä¼šåœ¨åˆ›å»ºspringå®¹å™¨çš„æ—¶å€™åˆ›å»ºï¼Œ</span></span><br><span class="line"><span class="comment">     *  å¦‚æœåœ¨beanç¬¬ä¸€æ¬¡ä½¿ç”¨çš„æ—¶å€™åˆ›å»ºï¼Œæˆ‘ä»¬ç§°ä¸ºæ‡’åŠ è½½</span></span><br><span class="line"><span class="comment">     *  é…ç½®å¾ˆç®€å•ï¼Œåœ¨åˆ›å»ºbeançš„æ–¹æ³•ä¸Šæ·»åŠ <span class="doctag">@Lazy</span>æ³¨è§£å³å¯</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> net.ydstudio.practise.bean.TransferService</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@date</span> 2019/4/23 19:41</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@Lazy</span></span><br><span class="line">    <span class="meta">@Scope</span>(<span class="string">"singleton"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> TransferService <span class="title">transferService</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> TransferServiceImpl();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Bean</span>å¯ä»¥ä¾èµ–å…¶ä»–ä»»æ„æ•°é‡çš„beanï¼Œå¦‚æœTransferServiceä¾èµ–Fooï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ–¹æ³•å‚æ•°å®ç°è¿™ä¸ªä¾èµ–</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>: foo</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> net.ydstudio.practise.bean.TransferService</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@date</span> 2019/4/24 11:23</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> TransferService <span class="title">transferService</span><span class="params">(Foo foo)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> TransferServiceImpl(foo);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * ä»»ä½•ä½¿ç”¨<span class="doctag">@Bean</span>å®šä¹‰çš„beanï¼Œä¹Ÿå¯ä»¥æ‰§è¡Œç”Ÿå‘½å‘¨æœŸçš„å›è°ƒå‡½æ•°</span></span><br><span class="line"><span class="comment">     * ç±»ä¼¼<span class="doctag">@PostConstruct</span> and <span class="doctag">@PreDestroy</span>çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> net.ydstudio.practise.bean.Foo</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@date</span> 2019/4/23 19:49</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span>(initMethod = <span class="string">"init"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Foo <span class="title">foo</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Foo();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä»»ä½•ä½¿ç”¨<span class="doctag">@Bean</span>å®šä¹‰çš„beanï¼Œä¹Ÿå¯ä»¥æ‰§è¡Œç”Ÿå‘½å‘¨æœŸçš„å›è°ƒå‡½æ•°</span></span><br><span class="line"><span class="comment">     * ç±»ä¼¼<span class="doctag">@PostConstruct</span> and <span class="doctag">@PreDestroy</span>çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>:</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> net.ydstudio.practise.bean.Bar</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@date</span> 2019/4/23 19:50</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span>(destroyMethod = <span class="string">"cleanUp"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Bar <span class="title">bar</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Bar();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * é»˜è®¤æƒ…å†µä¸‹beançš„åç§°å’Œæ–¹æ³•åç§°ç›¸åŒï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨</span></span><br><span class="line"><span class="comment">     * æ³¨è§£ä¸­çš„nameå±æ€§è¿›è¡ŒæŒ‡å®š</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>:</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> net.ydstudio.practise.bean.Foo</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@date</span> 2019/4/23 19:52</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span>(name = <span class="string">"myFoo"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Foo <span class="title">getFoo</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Foo();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¯ä»¥é€šè¿‡æŸäº›æ¡ä»¶ï¼Œæ¥é€‰æ‹©æ˜¯å¦æ³¨å†ŒBeanï¼Œé€šè¿‡<span class="doctag">@Condition</span>æ³¨è§£æ¥å®ç°</span></span><br><span class="line"><span class="comment">     * å®ç°Conditionæ¥å£ï¼Œå¹¶é‡å†™matchesæ–¹æ³•ï¼Œæ ¹æ®è¯¥æ–¹æ³•è¿”å›çš„å¸ƒå°”å€¼æ¥å†³å®šæ˜¯å¦æ³¨å†ŒBean</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> net.ydstudio.practise.bean.Book</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@date</span> 2019/4/24 11:54</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@Conditional</span>(MyCondition<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">    <span class="title">public</span> <span class="title">Book</span> <span class="title">book</span>()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Book();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Bar</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">cleanUp</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"---111111cleanUp---"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> StringBuffer sb = <span class="keyword">new</span> StringBuffer(<span class="string">"Bar&#123;"</span>);</span><br><span class="line">        sb.append(<span class="string">'&#125;'</span>);</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Book</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> BigDecimal price;</span><br><span class="line">    <span class="keyword">private</span> Date publishDate;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> BigDecimal <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrice</span><span class="params">(BigDecimal price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Date <span class="title">getPublishDate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> publishDate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPublishDate</span><span class="params">(Date publishDate)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.publishDate = publishDate;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Foo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"åˆå§‹åŒ–ä¹‹å‰---init---åˆå§‹åŒ–ä¹‹å‰"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> StringBuffer sb = <span class="keyword">new</span> StringBuffer(<span class="string">"Foo&#123;"</span>);</span><br><span class="line">        sb.append(<span class="string">'&#125;'</span>);</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyCondition</span> <span class="keyword">implements</span> <span class="title">Condition</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">matches</span><span class="params">(ConditionContext conditionContext, AnnotatedTypeMetadata annotatedTypeMetadata)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * æ ¹æ®ç¯å¢ƒå˜é‡æ˜¯å¦å­˜åœ¨my.env=helloçš„å±æ€§æ¥å†³å®šæ˜¯å¦åˆ›å»ºï¼Œ</span></span><br><span class="line"><span class="comment">         * å¯ä»¥é€šè¿‡å¯åŠ¨å‚æ•°æŒ‡å®š-Dmy.env=helloæ¥æµ‹è¯•ã€‚</span></span><br><span class="line"><span class="comment">         **/</span></span><br><span class="line">        Environment environment = conditionContext.getEnvironment();</span><br><span class="line">        String property = environment.getProperty(<span class="string">"my.env"</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">"hello"</span>.equals(property)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">TransferService</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TransferServiceImpl</span> <span class="keyword">implements</span> <span class="title">TransferService</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Foo foo;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TransferServiceImpl</span><span class="params">(Foo foo)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.foo = foo;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TransferServiceImpl</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> spring </tag>
            
            <tag> bean </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ideaè‡ªåŠ¨ç”Ÿæˆæ–¹æ³•æ³¨é‡Šï¼ˆå«å‚æ•°åŠè¿”å›å€¼ï¼‰</title>
      <link href="/post/526abd46.html"/>
      <url>/post/526abd46.html</url>
      
        <content type="html"><![CDATA[<p>ç¨‹åºå‘˜åˆ°æ–°çš„å…¬å¸ä¸Šç­ï¼Œæ‹¿åˆ°æ–°ç”µè„‘å½“ç„¶è¦ç¬¬ä¸€æ—¶é—´é…ç½®å¥½å„ç§å¼€å‘ç¯å¢ƒå’Œå¼€å‘å·¥å…·ã€‚</p><a id="more"></a><h4 id="åœ¨ideaä¸­æ‰“å¼€è®¾ç½®ï¼Œé€‰æ‹©File-gt-settings-gt-Editor-gt-Live-Templates"><a href="#åœ¨ideaä¸­æ‰“å¼€è®¾ç½®ï¼Œé€‰æ‹©File-gt-settings-gt-Editor-gt-Live-Templates" class="headerlink" title="åœ¨ideaä¸­æ‰“å¼€è®¾ç½®ï¼Œé€‰æ‹©File-&gt;settings-&gt;Editor-&gt;Live Templates"></a>åœ¨ideaä¸­æ‰“å¼€è®¾ç½®ï¼Œé€‰æ‹©File-&gt;settings-&gt;Editor-&gt;Live Templates</h4><p>ç‚¹å‡»â€+â€-&gt;é€‰æ‹©template group ï¼Œç„¶åè¾“å…¥groupçš„nameï¼Œå¦‚annotationã€‚<br>ç„¶åï¼Œé€‰ä¸­åˆšæ‰åˆ›å»ºçš„myGroupï¼Œç„¶åå†æ¬¡ç‚¹å‡»å³ä¾§çš„ç»¿è‰²+ï¼Œè¿™æ¬¡é€‰æ‹©çš„æ˜¯Live Templateã€‚å–åï¼ˆAbbreviationï¼‰ä¸º*ã€‚Descriptionä¸­å¡«å†™â€æ–¹æ³•æ³¨é‡Šâ€</p><h4 id="é…ç½®æ¨¡æ¿"><a href="#é…ç½®æ¨¡æ¿" class="headerlink" title="é…ç½®æ¨¡æ¿"></a>é…ç½®æ¨¡æ¿</h4><p>é€‰æ‹©åˆšåˆšæ·»åŠ çš„Live Templateï¼Œåœ¨ä¸‹é¢çš„Text Templateä¸­æ·»åŠ ä¸‹é¢çš„å†…å®¹ï¼Œæ³¨æ„ä¸è¦æ•´ç†ä¸‹é¢çš„æ ¼å¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">*</span><br><span class="line"> * </span><br><span class="line"> * $VAR1$ </span><br><span class="line"> $params$ </span><br><span class="line"> * <span class="meta">@return</span> $returns$</span><br><span class="line"> * <span class="meta">@author</span> <span class="number">19037900</span><span class="meta">@xx</span>.cn</span><br><span class="line"> * <span class="meta">@date</span> $date$ $time$</span><br><span class="line"> */</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼šæ­¤å¤„ä¸€å®šè¦ä¸ºåˆšåˆšçš„æ¨¡æ¿æŒ‡å®šä½¿ç”¨èŒƒå›´,é€‰æ‹©å…¨éƒ¨å°±è¡Œäº†ã€‚</p></blockquote><h4 id="é…ç½®variablesï¼Œç‚¹å‡»-Edit-variables"><a href="#é…ç½®variablesï¼Œç‚¹å‡»-Edit-variables" class="headerlink" title="é…ç½®variablesï¼Œç‚¹å‡» Edit variables"></a>é…ç½®variablesï¼Œç‚¹å‡» Edit variables</h4><p>VAR1å‚æ•°ä¸ç”¨ç®¡<br>params (ç½‘ä¸Šå¥½å¤šéƒ½ä¸è¡Œï¼Œè¿™ä¸ªæ˜¯æˆ‘æ­£åœ¨ç”¨çš„)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">groovyScript(<span class="string">"def result=''; def params=\"$&#123;_1&#125;\".replaceAll('[\\\\[|\\\\]|\\\\s]', '').split(',').toList(); for(i = 0; i &lt; params.size(); i++) &#123;result+='* @'+'param: ' + params[i] + ((i &lt; params.size() - 1) ? '\\n'+'\\b' : '')&#125;; return result"</span>, methodParameters())</span><br></pre></td></tr></table></figure><p>returnså‚æ•°å¯ä»¥ä¸‹æ‹‰ï¼Œé€‰æ‹©methodReturnType();<br>dateå‚æ•°å¯ä»¥ä¸‹æ‹‰ï¼Œé€‰æ‹©date();<br>timeå‚æ•°å¯ä»¥ä¸‹æ‹‰ï¼Œé€‰æ‹©time();</p><h4 id="é…ç½®å¿«æ·é”®ï¼Œç‚¹å‡»Edit-variablesä¸‹é¢çš„Optionsä¸­çš„Expand-withä¸‹æ‹‰é€‰æ‹©Enterã€‚"><a href="#é…ç½®å¿«æ·é”®ï¼Œç‚¹å‡»Edit-variablesä¸‹é¢çš„Optionsä¸­çš„Expand-withä¸‹æ‹‰é€‰æ‹©Enterã€‚" class="headerlink" title="é…ç½®å¿«æ·é”®ï¼Œç‚¹å‡»Edit variablesä¸‹é¢çš„Optionsä¸­çš„Expand withä¸‹æ‹‰é€‰æ‹©Enterã€‚"></a>é…ç½®å¿«æ·é”®ï¼Œç‚¹å‡»Edit variablesä¸‹é¢çš„Optionsä¸­çš„Expand withä¸‹æ‹‰é€‰æ‹©Enterã€‚</h4><h4 id="å¼€å§‹ä½¿ç”¨"><a href="#å¼€å§‹ä½¿ç”¨" class="headerlink" title="å¼€å§‹ä½¿ç”¨"></a>å¼€å§‹ä½¿ç”¨</h4><p>è¾“å…¥ /**ï¼Œç„¶åEnterï¼Œå¤§åŠŸå‘Šæˆ</p>]]></content>
      
      
      
        <tags>
            
            <tag> idea </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Windowsä¸‹æ­å»ºRedisé«˜å¯ç”¨é›†ç¾¤-å“¨å…µæ¨¡å¼ï¼ˆRedis-Sentinelï¼‰</title>
      <link href="/post/bdbc3b8a.html"/>
      <url>/post/bdbc3b8a.html</url>
      
        <content type="html"><![CDATA[<h4 id="Sentinelçš„åˆ†å¸ƒå¼ç‰¹æ€§"><a href="#Sentinelçš„åˆ†å¸ƒå¼ç‰¹æ€§" class="headerlink" title="Sentinelçš„åˆ†å¸ƒå¼ç‰¹æ€§"></a>Sentinelçš„åˆ†å¸ƒå¼ç‰¹æ€§</h4><p>Redis Sentinel æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿï¼Œ ä½ å¯ä»¥åœ¨ä¸€ä¸ªæ¶æ„ä¸­è¿è¡Œå¤šä¸ª Sentinel è¿›ç¨‹ï¼ˆprogressï¼‰ï¼Œ è¿™äº›è¿›ç¨‹ä½¿ç”¨æµè¨€åè®®ï¼ˆgossip protocols)æ¥æ¥æ”¶å…³äºä¸»æœåŠ¡å™¨æ˜¯å¦ä¸‹çº¿çš„ä¿¡æ¯ï¼Œ å¹¶ä½¿ç”¨æŠ•ç¥¨åè®®ï¼ˆagreement protocolsï¼‰æ¥å†³å®šæ˜¯å¦æ‰§è¡Œè‡ªåŠ¨æ•…éšœè¿ç§»ï¼Œ ä»¥åŠé€‰æ‹©å“ªä¸ªä»æœåŠ¡å™¨ä½œä¸ºæ–°çš„ä¸»æœåŠ¡å™¨ã€‚</p><a id="more"></a><p>å•ä¸ªsentinelè¿›ç¨‹æ¥ç›‘æ§redisé›†ç¾¤æ˜¯ä¸å¯é çš„ï¼Œå½“sentinelè¿›ç¨‹å®•æ‰å(sentinelæœ¬èº«ä¹Ÿæœ‰å•ç‚¹é—®é¢˜ï¼Œsingle-point-of-failure)æ•´ä¸ªé›†ç¾¤ç³»ç»Ÿå°†æ— æ³•æŒ‰ç…§é¢„æœŸçš„æ–¹å¼è¿è¡Œã€‚æ‰€ä»¥æœ‰å¿…è¦å°†sentinelé›†ç¾¤ï¼Œè¿™æ ·æœ‰å‡ ä¸ªå¥½å¤„ï¼š</p><ul><li><p>æœ‰ä¸€äº›sentinelè¿›ç¨‹å®•æ‰äº†ï¼Œä¾ç„¶å¯ä»¥è¿›è¡Œredisé›†ç¾¤çš„ä¸»å¤‡åˆ‡æ¢ï¼›</p></li><li><p>å¦‚æœåªæœ‰ä¸€ä¸ªsentinelè¿›ç¨‹ï¼Œå¦‚æœè¿™ä¸ªè¿›ç¨‹è¿è¡Œå‡ºé”™ï¼Œæˆ–è€…æ˜¯ç½‘ç»œå µå¡ï¼Œé‚£ä¹ˆå°†æ— æ³•å®ç°redisé›†ç¾¤çš„ä¸»å¤‡åˆ‡æ¢ï¼ˆå•ç‚¹é—®é¢˜ï¼‰ï¼›</p></li><li><p>å¦‚æœæœ‰å¤šä¸ªsentinelï¼Œredisçš„å®¢æˆ·ç«¯å¯ä»¥éšæ„åœ°è¿æ¥ä»»æ„ä¸€ä¸ªsentinelæ¥è·å¾—å…³äºredisé›†ç¾¤ä¸­çš„ä¿¡æ¯ï¼›</p></li></ul><p>ä¸€ä¸ªå¥å£®çš„éƒ¨ç½²è‡³å°‘éœ€è¦ä¸‰ä¸ªå“¨å…µå®ä¾‹ã€‚ä¸‰ä¸ªå“¨å…µå®ä¾‹åº”è¯¥æ”¾ç½®åœ¨å®¢æˆ·ä½¿ç”¨ç‹¬ç«‹æ–¹å¼ç¡®è®¤æ•…éšœçš„è®¡ç®—æœºæˆ–è™šæ‹Ÿæœºä¸­ã€‚ä¾‹å¦‚ä¸åŒçš„ç‰©ç†æœºæˆ–ä¸åŒå¯ç”¨åŒºåŸŸçš„è™šæ‹Ÿæœºã€‚</p><p>å¼€å§‹å‡†å¤‡ç¯å¢ƒæ­å»ºï¼š<br>æœ¬æ¬¡åœ¨windowä¸Šæ­å»ºå“¨å…µæ¨¡å¼çš„Redisé›†ç¾¤ã€‚æŒ‰ç…§ä¸Šä¸€ç¯‡æ–‡ç« <a href="https://www.ydstudio.net/archives/120.html" target="_blank" rel="noopener">Redisä¸»ä»å¤åˆ¶</a>çš„æŒ‡å¯¼ï¼Œå…ˆæ­å»ºå¥½Redisçš„é›†ç¾¤ï¼Œå…·ä½“æƒ…å†µå¦‚ä¸‹ï¼š<br>åœ¨gitä¸Šä¸‹è½½å¥½windowä¸‹çš„Rediså…å®‰è£…çš„åŒ…ï¼Œè§£å‹é…ç½®å¥½ä¹‹åï¼Œå†å¤åˆ¶ä¸¤ä»½ï¼Œç«¯å£å·åˆ†åˆ«ä¸º6380å’Œ6381ï¼ŒRediså®‰è£…ç›®å½•åˆ™åˆ†åˆ«ä¸ºredis6379ã€redis6380ã€redis6381.</p><ul><li>127.0.0.1 6379 master</li><li>127.0.0.1 6380 slave</li><li>127.0.0.1 6381 slave</li><li>127.0.0.1:26379  127.0.0.1:26380  127.0.0.1:26381 sentinel</li></ul><p>Redisçš„å¯†ç éƒ½è®¾ç½®æˆrequirepass 123456</p><h4 id="é…ç½®Sentinel"><a href="#é…ç½®Sentinel" class="headerlink" title="é…ç½®Sentinel"></a>é…ç½®Sentinel</h4><p>åœ¨ä¸Šè¿°ä¸‰ä¸ªRediså®‰è£…ç›®å½•ä¸‹æ–°å»ºsentinel.confæ–‡ä»¶ï¼Œåœ¨å…¶ä¸­å†™å…¥ä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> è¿™ä¸ªæ˜¯Redis6379é…ç½®å†…å®¹ï¼Œå…¶ä»–æ–‡ä»¶åŒç†æ–°å¢ç„¶åæ”¹ä¸€ä¸‹ç«¯å£å³å¯ï¼Œ26380ï¼Œå’Œ 26381ã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash">å½“å‰SentinelæœåŠ¡è¿è¡Œçš„ç«¯å£</span></span><br><span class="line">port 26379  </span><br><span class="line"><span class="meta">#</span><span class="bash"> å“¨å…µç›‘å¬çš„ä¸»æœåŠ¡å™¨ </span></span><br><span class="line">sentinel monitor mymaster 127.0.0.1 6379 2</span><br><span class="line"><span class="meta">#</span><span class="bash"> 3så†…mymasteræ— å“åº”ï¼Œåˆ™è®¤ä¸ºmymasterå®•æœºäº†</span></span><br><span class="line">sentinel down-after-milliseconds mymaster 3000</span><br><span class="line"><span class="meta">#</span><span class="bash">å¦‚æœ10ç§’å,mysaterä»æ²¡å¯åŠ¨è¿‡æ¥ï¼Œåˆ™å¯åŠ¨failover  </span></span><br><span class="line">sentinel failover-timeout mymaster 10000  </span><br><span class="line"><span class="meta">#</span><span class="bash"> æ‰§è¡Œæ•…éšœè½¬ç§»æ—¶ï¼Œ æœ€å¤šæœ‰1ä¸ªä»æœåŠ¡å™¨åŒæ—¶å¯¹æ–°çš„ä¸»æœåŠ¡å™¨è¿›è¡ŒåŒæ­¥</span></span><br><span class="line">sentinel parallel-syncs mymaster 1</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> sentinel auth-pass &lt;master-name&gt; &lt;password&gt;</span></span><br><span class="line">sentinel auth-pass mymaster 123456</span><br></pre></td></tr></table></figure><p>åœ¨å¦å¤–çš„ä¸¤ä¸ªRedisç›®å½•é‡Œé¢åˆ†åˆ«åˆ›å»ºsentinel.confï¼Œæ³¨æ„ä¿®æ”¹å…¶ä¸­portç«¯å£åˆ†26380å’Œ26381ã€‚<br>é…ç½®æ–‡ä»¶åªéœ€è¦é…ç½®masterçš„ä¿¡æ¯å°±å¥½å•¦ï¼Œä¸ç”¨é…ç½®slaveçš„ä¿¡æ¯ï¼Œå› ä¸ºslaveèƒ½å¤Ÿè¢«è‡ªåŠ¨æ£€æµ‹åˆ°(masterèŠ‚ç‚¹ä¸­æœ‰å…³äºslaveçš„æ¶ˆæ¯)ã€‚</p><p>ä¸ºäº†æ›´æ¸…æ¥šæ¯ä¸€è¡Œé…ç½®çš„å«ä¹‰ï¼Œå¯¹æ¯ä¸ªé€‰é¡¹çš„å«ä¹‰è¿›è¡Œç®€å•ä»‹ç»ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sentinel monitor [master-group-name] [ip] [port] [quorum]</span><br></pre></td></tr></table></figure><ul><li>master-group-nameï¼šmasteråç§°ï¼ˆå¯ä»¥è‡ªå®šä¹‰ï¼‰</li><li>ip port : IPåœ°å€å’Œç«¯å£å·</li><li>quorumï¼šç¥¨æ•°ï¼ŒSentineléœ€è¦åå•†åŒæ„masteræ˜¯å¦å¯åˆ°è¾¾çš„æ•°é‡ã€‚</li></ul><p>ç¬¬ä¸€è¡Œé…ç½®æŒ‡ç¤º Sentinel å»ç›‘è§†ä¸€ä¸ªåä¸º mymaster çš„ä¸»æœåŠ¡å™¨ï¼Œ è¿™ä¸ªä¸»æœåŠ¡å™¨çš„ IP åœ°å€ä¸º 127.0.0.1 ï¼Œ ç«¯å£å·ä¸º 6379 ï¼Œ è€Œå°†è¿™ä¸ªä¸»æœåŠ¡å™¨åˆ¤æ–­ä¸ºå¤±æ•ˆè‡³å°‘éœ€è¦ 2 ä¸ª Sentinel åŒæ„ ï¼ˆåªè¦åŒæ„ Sentinel çš„æ•°é‡ä¸è¾¾æ ‡ï¼Œè‡ªåŠ¨æ•…éšœè¿ç§»å°±ä¸ä¼šæ‰§è¡Œï¼‰ã€‚<br>ç¥¨æ•°åœ¨æœ¬æ–‡ä¸­ï¼šredisé›†ç¾¤ä¸­æœ‰3ä¸ªsentinelå®ä¾‹ï¼Œå…¶ä¸­masteræŒ‚æ‰å•¦ï¼Œè¿™é‡Œè®¾ç½®ç¥¨æ•°ä¸º2ï¼Œè¡¨ç¤ºæœ‰2ä¸ªsentinelè®¤ä¸ºmasteræŒ‚æ‰å•¦ï¼Œæ‰èƒ½è¢«è®¤ä¸ºæ˜¯æ­£çœŸçš„æŒ‚æ‰å•¦ã€‚ </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sentinel &lt;é€‰é¡¹çš„åå­—&gt; &lt;ä¸»æœåŠ¡å™¨çš„åå­—&gt; &lt;é€‰é¡¹çš„å€¼&gt;</span><br></pre></td></tr></table></figure><ul><li>down-after-milliseconds é€‰é¡¹æŒ‡å®šäº† Sentinel è®¤ä¸ºæœåŠ¡å™¨å·²ç»æ–­çº¿æ‰€éœ€çš„æ¯«ç§’æ•°ã€‚</li></ul><p>å¦‚æœæœåŠ¡å™¨åœ¨ç»™å®šçš„æ¯«ç§’æ•°ä¹‹å†…ï¼Œ æ²¡æœ‰è¿”å› Sentinel å‘é€çš„ PING å‘½ä»¤çš„å›å¤ï¼Œ æˆ–è€…è¿”å›ä¸€ä¸ªé”™è¯¯ï¼Œ é‚£ä¹ˆ Sentinel å°†è¿™ä¸ªæœåŠ¡å™¨æ ‡è®°ä¸ºä¸»è§‚ä¸‹çº¿ï¼ˆsubjectively downï¼Œç®€ç§° SDOWN ï¼‰ã€‚<br>ä¸è¿‡åªæœ‰ä¸€ä¸ª Sentinel å°†æœåŠ¡å™¨æ ‡è®°ä¸ºä¸»è§‚ä¸‹çº¿å¹¶ä¸ä¸€å®šä¼šå¼•èµ·æœåŠ¡å™¨çš„è‡ªåŠ¨æ•…éšœè¿ç§»ï¼š åªæœ‰åœ¨è¶³å¤Ÿæ•°é‡çš„ Sentinel éƒ½å°†ä¸€ä¸ªæœåŠ¡å™¨æ ‡è®°ä¸ºä¸»è§‚ä¸‹çº¿ä¹‹åï¼Œ æœåŠ¡å™¨æ‰ä¼šè¢«æ ‡è®°ä¸ºå®¢è§‚ä¸‹çº¿ï¼ˆobjectively downï¼Œ ç®€ç§° ODOWN ï¼‰ï¼Œ è¿™æ—¶è‡ªåŠ¨æ•…éšœè¿ç§»æ‰ä¼šæ‰§è¡Œã€‚<br>å°†æœåŠ¡å™¨æ ‡è®°ä¸ºå®¢è§‚ä¸‹çº¿æ‰€éœ€çš„ Sentinel æ•°é‡ç”±å¯¹ä¸»æœåŠ¡å™¨çš„é…ç½®å†³å®šã€‚</p><ul><li>parallel-syncs é€‰é¡¹æŒ‡å®šäº†åœ¨æ‰§è¡Œæ•…éšœè½¬ç§»æ—¶ï¼Œ æœ€å¤šå¯ä»¥æœ‰å¤šå°‘ä¸ªä»æœåŠ¡å™¨åŒæ—¶å¯¹æ–°çš„ä¸»æœåŠ¡å™¨è¿›è¡ŒåŒæ­¥ï¼Œ è¿™ä¸ªæ•°å­—è¶Šå°ï¼Œ å®Œæˆæ•…éšœè½¬ç§»æ‰€éœ€çš„æ—¶é—´å°±è¶Šé•¿ã€‚</li></ul><h4 id="æ–°å¢Rediså¯åŠ¨è„šæœ¬ï¼šstartRedisServer-bat"><a href="#æ–°å¢Rediså¯åŠ¨è„šæœ¬ï¼šstartRedisServer-bat" class="headerlink" title="æ–°å¢Rediså¯åŠ¨è„šæœ¬ï¼šstartRedisServer.bat"></a>æ–°å¢Rediså¯åŠ¨è„šæœ¬ï¼šstartRedisServer.bat</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line">redis-server.exe redis.conf</span><br><span class="line">@pause</span><br></pre></td></tr></table></figure><h4 id="æ–°å¢Redis-Sentinelå¯åŠ¨è„šæœ¬ï¼šstartRedisSentinel-bat"><a href="#æ–°å¢Redis-Sentinelå¯åŠ¨è„šæœ¬ï¼šstartRedisSentinel-bat" class="headerlink" title="æ–°å¢Redis-Sentinelå¯åŠ¨è„šæœ¬ï¼šstartRedisSentinel.bat"></a>æ–°å¢Redis-Sentinelå¯åŠ¨è„šæœ¬ï¼šstartRedisSentinel.bat</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line">redis-server.exe sentinel.conf --sentinel </span><br><span class="line">@pause</span><br></pre></td></tr></table></figure><p>å¦å¤–ä¸¤ä¸ªè¿›è¡ŒåŒæ ·çš„æ“ä½œï¼Œåˆ›å»ºæ–°å¢Rediså¯åŠ¨è„šæœ¬å’ŒRedis-Sentinelå¯åŠ¨è„šæœ¬ã€‚</p><h4 id="å¼€å§‹å¯åŠ¨ç¯å¢ƒ"><a href="#å¼€å§‹å¯åŠ¨ç¯å¢ƒ" class="headerlink" title="å¼€å§‹å¯åŠ¨ç¯å¢ƒ"></a>å¼€å§‹å¯åŠ¨ç¯å¢ƒ</h4><ul><li>ç‚¹å‡»startRedis.batï¼Œå¯åŠ¨Redisé›†ç¾¤</li><li>ç‚¹å‡»startRedisSentinel.batï¼Œå¯åŠ¨å“¨å…µå®ä¾‹</li></ul><h4 id="æ­å»ºä¸­å‡ºç°çš„é—®é¢˜"><a href="#æ­å»ºä¸­å‡ºç°çš„é—®é¢˜" class="headerlink" title="æ­å»ºä¸­å‡ºç°çš„é—®é¢˜"></a>æ­å»ºä¸­å‡ºç°çš„é—®é¢˜</h4><ul><li><p>sentinelé…ç½®æ–‡ä»¶çš„é¡ºåºé—®é¢˜</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[3968] 01 Mar 11:06:38.314 #</span><br><span class="line">*** FATAL CONFIG FILE ERROR ***</span><br><span class="line"></span><br><span class="line">[3968] 01 Mar 11:06:38.314 # Reading the configuration file, at line 10</span><br><span class="line"></span><br><span class="line">[3968] 01 Mar 11:06:38.314 # &gt;&gt;&gt; 'sentinel down-after-milliseconds  mymaster  3000'</span><br><span class="line"></span><br><span class="line">[3968] 01 Mar 11:06:38.314 # No such master with specified name.</span><br></pre></td></tr></table></figure><p>è§£å†³æ–¹æ³•ï¼šå“¨å…µç›‘å¬çš„ä¸»æœåŠ¡å™¨çš„é…ç½® </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sentinel monitor mymaster 127.0.0.1 6379 2</span><br></pre></td></tr></table></figure><p>è¦å°½é‡æ”¾åˆ°sentinelé…ç½®çš„å‰é¢</p></li><li><p>é…ç½®æ–‡ä»¶çš„ç©ºæ ¼é—®é¢˜</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Invalid argument during startup: unknown conf file parameter :</span><br></pre></td></tr></table></figure><p>è§£å†³æ–¹æ³•ï¼šåˆ é™¤æˆ–è€…æ›´æ”¹é…ç½®æ³¨æ„ä¸è¦ç•™æœ‰ç©ºæ ¼</p></li></ul><p>æœªå®Œ</p>]]></content>
      
      
      
        <tags>
            
            <tag> Windows </tag>
            
            <tag> Redis </tag>
            
            <tag> Redis-Sentinel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxä¸‹æ­å»ºRedisä¸»ä»å¤åˆ¶</title>
      <link href="/post/c1608171.html"/>
      <url>/post/c1608171.html</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘å¿™ç€å‡†å¤‡é¢è¯•ï¼Œå°±æŠŠä¹‹å‰ç”¨åˆ°çš„Redisçš„ä¸»ä»é…ç½®å’Œå“¨å…µæ¨¡å¼é…ç½®éƒ½é‡æ–°å¤ä¹ ä¸€éã€‚è¿™ç¯‡æ–‡ç« å…ˆå¤ä¹ é…ç½®Redisçš„ä¸»ä»ï¼Œä¸‹ä¸€ç¯‡å¤ä¹ Redisçš„å“¨å…µæ¨¡å¼ã€‚<br>Redisçš„ä¸»ä»å¤åˆ¶é…ç½®èµ·æ¥æ¯”è¾ƒç®€å•ï¼Œä¸»ä»é…ç½®æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p><a id="more"></a><ol><li><p>ä¸€ä¸ªMasterå¯ä»¥æœ‰å¤šä¸ªslaveä¸»æœºï¼Œæ”¯æŒé“¾å¼å¤åˆ¶</p></li><li><p>Masterä»¥éé˜»å¡æ–¹å¼åŒæ­¥æ•°æ®è‡³slaveä¸»æœº</p></li></ol><p>åœ¨ä¸€å°èŠ‚ç‚¹ä¸Šé…ç½®æ–‡ä»¶ä¸­å®šä¹‰è‡ªå·±æ˜¯è°çš„ä»èŠ‚ç‚¹ï¼Œå¹¶ä¸”å¯ç”¨ä¸»èŠ‚ç‚¹å¯†ç è®¤è¯å³å¯ã€‚ä¸‹é¢ä½¿ç”¨3å°ä¸»æœºé…ç½®ä¸€ä¸»ä¸¤ä»çš„ç»“æ„ï¼Œredisä½¿ç”¨ä¸€ä¸»å¤šä»çš„ç»“æ„æ—¶è¿˜å¯ä»¥å®ç°åƒmysql MHAé‚£æ ·çš„å¤åˆ¶é›†ç¾¤ï¼Œå½“masterèŠ‚ç‚¹å®•æœºåï¼Œå¯ä»¥åœ¨ä¸¤ä¸ªslaveèŠ‚ç‚¹ä¸­æ ¹æ®ä¼˜å…ˆçº§é€‰ä¸¾æ–°çš„masterã€‚</p><ul><li>å®‰è£…Redis<br>æœ¬æ¬¡é‡‡ç”¨æºç ç¼–è¯‘çš„æ–¹å¼å®‰è£…Redisï¼Œæ‰§è¡Œç›¸å…³çš„å‘½ä»¤å¦‚ä¸‹ï¼š<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">ä¸‹è½½rediså®‰è£…åŒ…</span></span><br><span class="line">cd /usr/local/src</span><br><span class="line">wget http://download.redis.io/releases/redis-5.0.3.tar.gz</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">è§£å‹å®‰è£…åŒ…</span></span><br><span class="line">tar -zxvf redis-5.0.3.tar.gz</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">æ‹·è´åˆ°/usr/<span class="built_in">local</span>/redisç›®å½•</span></span><br><span class="line">mkdir -p /usr/local/redis</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">ç¼–è¯‘å®‰è£…</span></span><br><span class="line">make &amp; make install</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">rediså®‰è£…å®Œæˆåï¼Œredis-serverã€redis-cliç­‰ç¨‹åºé»˜è®¤å®‰è£…åœ¨/usr/<span class="built_in">local</span>/redis/srcç›®å½•ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å°†å®ƒå®‰è£…åˆ°ç³»ç»Ÿæœç´¢è·¯å¾„ï¼Œå¹¶å®‰è£…ä¸ºç³»ç»ŸæœåŠ¡ï¼Œæ–¹ä¾¿åœ¨ä»»ä½•ç»ˆç«¯è®¿é—®ï¼Œå¹¶ä¸”å¼€æœºè‡ªåŠ¨å¯åŠ¨ã€‚</span></span><br><span class="line"></span><br><span class="line">cd /usr/local/src/redis/utils</span><br><span class="line">./install_server.sh</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">é‡å¤ä¸Šè¿°å®‰è£…æ“ä½œï¼Œå®‰è£…redisåˆ°6380å’Œ6381ç«¯å£</span></span><br><span class="line">./install_server.sh</span><br></pre></td></tr></table></figure>ç¯å¢ƒå‡†å¤‡å¥½ä¹‹åï¼Œå…·ä½“æƒ…å†µå¦‚ä¸‹ï¼š</li></ul><p>ä¸‰ä¸ªRediså®ä¾‹åˆ†åˆ«å®‰è£…ä»¥ä¸‹IPåœ°å€å’Œç«¯å£ï¼Œè§’è‰²åˆ†åˆ«å¦‚ä¸‹</p><p>192.168.1.103 6379 master<br>192.168.1.103 6380 slave<br>192.168.1.103 6381 slave</p><ul><li>é…ç½®MasterèŠ‚ç‚¹<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">bind 0.0.0.0     #ç»‘å®šåœ°å€ (ç»‘å®šåœ¨127.0.0.1ï¼Œåªæœ‰æœ¬æœºå®¢æˆ·ç«¯å¯ä»¥è®¿é—®ï¼Œå…¶ä»–æœåŠ¡å™¨æ— æ³•è®¿é—®ï¼Œç»‘å®šåœ¨0.0.0.0ä¸Šï¼Œå¦‚æœæ²¡æœ‰ç«¯å£é™åˆ¶ï¼Œé‚£ä¹ˆå…¶ä»–æœåŠ¡å™¨åˆ™å¯ä»¥è¿æ¥è¯¥æœåŠ¡å™¨çš„è¯¥ç«¯å£)</span><br><span class="line">requirepass 123456   #å¯ç”¨å¯†ç è®¤è¯</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">é»˜è®¤masterèŠ‚ç‚¹ä¿®æ”¹è¿™ä¸¤é¡¹å°±å¯ä»¥äº†ï¼Œä¹Ÿå¯ä»¥è¿›è¡Œå…¶ä»–è®¾ç½®</span></span><br></pre></td></tr></table></figure></li><li>é…ç½®SlaveèŠ‚ç‚¹</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">bind 0.0.0.0    </span><br><span class="line"><span class="meta">#</span><span class="bash">å®šä¹‰masterä¿¡æ¯</span></span><br><span class="line">slaveof 192.168.1.103 6379   </span><br><span class="line"><span class="meta">#</span><span class="bash">è®¤è¯</span></span><br><span class="line">masterauth 123456  </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">ä»èŠ‚ç‚¹ä¸Šé…ç½®è¿™ä¸‰é¡¹é¡µå°±å¯ä»¥ï¼Œå…¶ä»–å‚æ•°å¯ä»¥æ ¹æ®æƒ…å†µé€‰æ‹©è°ƒæ•´å³å¯ã€‚</span></span><br></pre></td></tr></table></figure><p>ä¿®æ”¹åè®°å¾—é‡å¯æœåŠ¡ï¼Œå¯ä»¥ç™»å½•åˆ°masterèŠ‚ç‚¹æŸ¥çœ‹ä¿¡æ¯ã€‚</p><ul><li>é¦–å…ˆä½¿ç”¨client listå‘½ä»¤æŸ¥çœ‹</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@192 bin]# redis-cli -p 6379 -a 123456</span><br><span class="line">Warning: Using a password with '-a' or '-u' option on the command line interface may not be safe.</span><br><span class="line">127.0.0.1:6379&gt; client list</span><br><span class="line">id=3 addr=127.0.0.1:44273 fd=7 name= age=2456 idle=1 flags=S db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=replconf</span><br><span class="line">id=4 addr=127.0.0.1:45342 fd=8 name= age=2453 idle=1 flags=S db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=replconf</span><br><span class="line">id=6 addr=127.0.0.1:49306 fd=9 name= age=6 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=26 qbuf-free=32742 obl=0 oll=0 omem=0 events=r cmd=client</span><br><span class="line">127.0.0.1:6379&gt; </span><br><span class="line"></span><br><span class="line">cmd=client     è¡¨ç¤ºæ˜¯master</span><br><span class="line">cmd=replconf   è¡¨ç¤ºæ˜¯slave</span><br></pre></td></tr></table></figure><ul><li>é¦–å…ˆä½¿ç”¨info replication å‘½ä»¤æŸ¥çœ‹<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; info replication</span><br><span class="line"><span class="meta">#</span><span class="bash"> Replication</span></span><br><span class="line">role:master #è‡ªå·±çš„è§’è‰²</span><br><span class="line">connected_slaves:2 #ä»èŠ‚ç‚¹æ•°é‡</span><br><span class="line">slave0:ip=127.0.0.1,port=6380,state=online,offset=3738,lag=0 #ä»èŠ‚ç‚¹ä¿¡æ¯</span><br><span class="line">slave1:ip=127.0.0.1,port=6381,state=online,offset=3738,lag=1 #ä»èŠ‚ç‚¹ä¿¡æ¯</span><br><span class="line">master_replid:061bcdd36e3b8d9a0c38d29dc762e908445baad6</span><br><span class="line">master_replid2:0000000000000000000000000000000000000000</span><br><span class="line">master_repl_offset:3738</span><br><span class="line">second_repl_offset:-1</span><br><span class="line">repl_backlog_active:1</span><br><span class="line">repl_backlog_size:1048576</span><br><span class="line">repl_backlog_first_byte_offset:1</span><br><span class="line">repl_backlog_histlen:3738</span><br><span class="line">127.0.0.1:6379&gt;</span><br></pre></td></tr></table></figure>å¯ä»¥çœ‹åˆ°ä¸»ä»å·®ä¸å¤šå·²ç»é…ç½®å¥½äº†ï¼Œæ¥ä¸‹æ¥å¯ä»¥è¿›è¡Œç®€å•çš„éªŒè¯å¤åˆ¶ï¼Œåœ¨masterèŠ‚ç‚¹è®¾ç½®ä¸€ä¸ªkeyï¼Œçœ‹ä¸¤ä¸ªslaveèŠ‚ç‚¹å¤åˆ¶æƒ…å†µã€‚</li></ul><p>MasterèŠ‚ç‚¹åˆ›å»ºä¸€ä¸ªkey:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@192 bin]# redis-cli -p 6379 -a 123456</span><br><span class="line">Warning: Using a password with '-a' or '-u' option on the command line interface may not be safe.</span><br><span class="line">127.0.0.1:6379&gt; set jobNo 123456</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt;</span><br></pre></td></tr></table></figure><p>ä»slave 6380 :</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@192 bin]# redis-cli -p 6380 -a 123456</span><br><span class="line">Warning: Using a password with '-a' or '-u' option on the command line interface may not be safe.</span><br><span class="line">127.0.0.1:6380&gt; get jobNo</span><br><span class="line">"123456"</span><br><span class="line">127.0.0.1:6380&gt;</span><br></pre></td></tr></table></figure><p>ä»slave 6381ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@192 bin]# redis-cli -p 6381 -a 123456</span><br><span class="line">Warning: Using a password with '-a' or '-u' option on the command line interface may not be safe.</span><br><span class="line">127.0.0.1:6381&gt; get jobNo</span><br><span class="line">"123456"</span><br><span class="line">127.0.0.1:6381&gt;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºåœ¨masterä¸Šè®¾ç½®çš„keyå·²ç»åŒæ­¥åˆ°äº†ä¸¤ä¸ªslaveä¸Šã€‚</p><p><em>slaveèŠ‚ç‚¹å®šä¹‰ä¹Ÿå¯ä»¥é€šè¿‡æŒ‡ä»¤è®¾ç½®ï¼Œè®¾ç½®åç«‹å³ç”Ÿæ•ˆï¼Œå¹¶ä¸”ä¼šè¢«ä¿å­˜è‡³é…ç½®æ–‡ä»¶ä¸­ï¼ŒæŒ‡ä»¤é…ç½®æ–¹å¼å¦‚ä¸‹ï¼š</em></p><p>#é…ç½®slaveèŠ‚ç‚¹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">redis-cli&gt;</span><span class="bash"> SLAVEOF &lt;MASTER_IP&gt; &lt;MASTER_PORT&gt;</span></span><br><span class="line"><span class="meta">redis-cli&gt;</span><span class="bash"> CONFIG SET masterauth &lt;PASSWORD&gt;</span></span><br></pre></td></tr></table></figure><p>redisä¸»ä»å¤åˆ¶ç›¸å…³é…ç½®<br>ä¸‹é¢æ˜¯redisä¸»ä»å¤åˆ¶åœºæ™¯çš„ä¸€äº›å¯è°ƒå‚æ•°ï¼Œéœ€è¦æ ¹æ®å®é™…ç¯å¢ƒè°ƒæ•´</p><ul><li>slave-serve-stale-data yes ï¼š æ˜¯å¦å¯ä»¥æŠŠä¸æ–°é²œçš„æ•°æ®æœåŠ¡ä¸å®¢æˆ·ç«¯</li><li>slave-read-only yes ï¼š ä»èŠ‚ç‚¹åªè¯»ï¼Œå¯ç”¨slaveofå®šä¹‰åæ‰ç”Ÿæ•ˆ</li><li>repl-diskless-sync no ï¼šæ˜¯å¦åŒæ—¶å‘å¤šä¸ªä»èŠ‚ç‚¹åŒæ—¶å‘æ•°æ®</li><li>repl-diskless-sync-delay 5 ï¼šå‘é€çš„å»¶è¿Ÿæ—¶é—´</li><li>repl-ping-slave-period 10 æ¢æµ‹ä»èŠ‚ç‚¹çŠ¶æ€</li><li>repl-timeout 60 æ¢æµ‹èŠ‚ç‚¹è¶…æ—¶æ—¶é—´</li><li>repl-disable-tcp-nodelay no ï¼š å¯ç”¨nodelay</li><li>repl-backlog-size 1mb</li><li>slave-priority 100 ï¼š ä»èŠ‚ç‚¹ä¼˜å…ˆçº§,å¤åˆ¶é›†ç¾¤ä¸­ï¼Œä¸»èŠ‚ç‚¹æ•…éšœæ—¶ï¼Œsentinelåº”ç”¨åœºæ™¯ä¸­çš„ä¸»èŠ‚ç‚¹é€‰ä¸¾æ—¶ä½¿ç”¨çš„ä¼˜å…ˆçº§ï¼›æ•°å­—è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜ï¼Œä½†0è¡¨ç¤ºä¸å‚ä¸é€‰ä¸¾ï¼›</li><li>min-slaves-to-write 3ï¼šä¸»èŠ‚ç‚¹ä»…å…è®¸å…¶èƒ½å¤Ÿé€šä¿¡çš„ä»èŠ‚ç‚¹æ•°é‡å¤§äºç­‰äºæ­¤å¤„çš„å€¼æ—¶æ¥å—å†™æ“ä½œï¼›</li><li>min-slaves-max-lag 10ï¼šä»èŠ‚ç‚¹å»¶è¿Ÿæ—¶é•¿è¶…å‡ºæ­¤å¤„æŒ‡å®šçš„æ—¶é•¿æ—¶ï¼Œä¸»èŠ‚ç‚¹ä¼šæ‹’ç»å†™å…¥æ“ä½œï¼›</li></ul><p><a href="http://gudaoyufu.com/?p=1230" target="_blank" rel="noopener">æŸ¥çœ‹åŸæ–‡</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> redis </tag>
            
            <tag> ä¸»ä»å¤åˆ¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nginxä»£ç†æ—¶headerå¤´ä¸­å¸¦_çš„ä¿¡æ¯ä¸¢å¤±çš„é—®é¢˜</title>
      <link href="/post/a6b6fb0a.html"/>
      <url>/post/a6b6fb0a.html</url>
      
        <content type="html"><![CDATA[<p>å¼€å‘ç½‘å…³é¡¹ç›®æ—¶ï¼Œåœ¨è¯·æ±‚æ—¶å¾€è¯·æ±‚å¤´headerä¸­æ”¾å…¥äº†ç­¾åsign_keyä¿¡æ¯ï¼Œåœ¨æ¥æ”¶è¯·æ±‚æ—¶å†ä»headerä¸­æ‹¿å‡ºï¼Œåœ¨æœ¬åœ°è°ƒè¯•æ—¶æ˜¯å¯ä»¥çš„ï¼Œä½†ä¸Šçº¿ä¹‹åé€šè¿‡Nginxä»£ç†ä¹‹åå‘ç°æ‹¿ä¸åˆ°ã€‚</p><a id="more"></a><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">location / &#123;</span><br><span class="line">        proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">        proxy_set_header Host  $http_host;</span><br><span class="line">        proxy_set_header X-Nginx-Proxy true;</span><br><span class="line"></span><br><span class="line">        add_header Proxy-Node $upstream_addr;</span><br><span class="line">        add_header Proxy-Status $upstream_status;</span><br><span class="line"></span><br><span class="line">        proxy_http_version 1.1;</span><br><span class="line">        proxy_pass    http://tianusa;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>åæ¥æ‰¾åˆ°åŸå› æ˜¯å› ä¸ºNginxå¯¹headeræœ‰æ‰€é™åˆ¶ï¼Œä¸‹åˆ’çº¿ï¼ˆ_ï¼‰ä¸æ”¯æŒ</p><p> 1.ä¸ç”¨ä¸‹åˆ’çº¿<br>æŠŠä¸‹åˆ’çº¿_æ”¹æˆå…¶ä»–çš„ï¼Œå¦‚sign_keyæ”¹æˆsign-key</p><p> 2.ä»æ ¹æœ¬è§£é™¤Nginxçš„é™åˆ¶<br>Nginxé»˜è®¤requestçš„headerçš„é‚£ä¹ˆä¸­åŒ…å«â€™_â€™æ—¶ï¼Œä¼šè‡ªåŠ¨å¿½ç•¥æ‰ã€‚<br>è§£å†³æ–¹æ³•æ˜¯ï¼šåœ¨nginxé‡Œçš„nginx.confé…ç½®æ–‡ä»¶ä¸­çš„httpéƒ¨åˆ†ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">underscores_in_headers on; ï¼ˆé»˜è®¤ underscores_in_headers ä¸ºoffï¼‰</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mybatis Generatoræœ€å®Œæ•´é…ç½®è¯¦è§£</title>
      <link href="/post/a9e1e2fd.html"/>
      <url>/post/a9e1e2fd.html</url>
      
        <content type="html"><![CDATA[<p>è¿™æ˜¯ä¸€ä»½Mybatis Generatoræœ€å®Œæ•´é…ç½®è¯¦è§£ï¼Œå¤§å®¶å¯ä»¥å¥½å¥½çœ‹çœ‹ã€‚</p><a id="more"></a><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE generatorConfiguration</span></span><br><span class="line"><span class="meta">  PUBLIC "-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN"</span></span><br><span class="line"><span class="meta">"http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd"&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- é…ç½®ç”Ÿæˆå™¨ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">generatorConfiguration</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- å¯ä»¥ç”¨äºåŠ è½½é…ç½®é¡¹æˆ–è€…é…ç½®æ–‡ä»¶ï¼Œåœ¨æ•´ä¸ªé…ç½®æ–‡ä»¶ä¸­å°±å¯ä»¥ä½¿ç”¨$&#123;propertyKey&#125;çš„æ–¹å¼æ¥å¼•ç”¨é…ç½®é¡¹</span></span><br><span class="line"><span class="comment">    resourceï¼šé…ç½®èµ„æºåŠ è½½åœ°å€ï¼Œä½¿ç”¨resourceï¼ŒMBGä»classpathå¼€å§‹æ‰¾ï¼Œæ¯”å¦‚com/myproject/generatorConfig.properties        </span></span><br><span class="line"><span class="comment">    urlï¼šé…ç½®èµ„æºåŠ è½½åœ°è´¨ï¼Œä½¿ç”¨URLçš„æ–¹å¼ï¼Œæ¯”å¦‚file:///C:/myfolder/generatorConfig.properties.</span></span><br><span class="line"><span class="comment">    æ³¨æ„ï¼Œä¸¤ä¸ªå±æ€§åªèƒ½é€‰å€ä¸€ä¸ª;</span></span><br><span class="line"><span class="comment">    </span></span><br><span class="line"><span class="comment">    å¦å¤–ï¼Œå¦‚æœä½¿ç”¨äº†mybatis-generator-maven-pluginï¼Œé‚£ä¹ˆåœ¨pom.xmlä¸­å®šä¹‰çš„propertieséƒ½å¯ä»¥ç›´æ¥åœ¨generatorConfig.xmlä¸­ä½¿ç”¨</span></span><br><span class="line"><span class="comment">&lt;properties resource="" url="" /&gt;</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"> </span><br><span class="line"> <span class="comment">&lt;!-- åœ¨MBGå·¥ä½œçš„æ—¶å€™ï¼Œéœ€è¦é¢å¤–åŠ è½½çš„ä¾èµ–åŒ…</span></span><br><span class="line"><span class="comment">    locationå±æ€§æŒ‡æ˜åŠ è½½jar/zipåŒ…çš„å…¨è·¯å¾„</span></span><br><span class="line"><span class="comment">&lt;classPathEntry location="/Program Files/IBM/SQLLIB/java/db2java.zip" /&gt;</span></span><br><span class="line"><span class="comment">  --&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">    context:ç”Ÿæˆä¸€ç»„å¯¹è±¡çš„ç¯å¢ƒ </span></span><br><span class="line"><span class="comment">    id:å¿…é€‰ï¼Œä¸Šä¸‹æ–‡idï¼Œç”¨äºåœ¨ç”Ÿæˆé”™è¯¯æ—¶æç¤º</span></span><br><span class="line"><span class="comment">    defaultModelType:æŒ‡å®šç”Ÿæˆå¯¹è±¡çš„æ ·å¼</span></span><br><span class="line"><span class="comment">        1ï¼Œconditionalï¼šç±»ä¼¼hierarchicalï¼›</span></span><br><span class="line"><span class="comment">        2ï¼Œflatï¼šæ‰€æœ‰å†…å®¹ï¼ˆä¸»é”®ï¼Œblobï¼‰ç­‰å…¨éƒ¨ç”Ÿæˆåœ¨ä¸€ä¸ªå¯¹è±¡ä¸­ï¼›</span></span><br><span class="line"><span class="comment">        3ï¼Œhierarchicalï¼šä¸»é”®ç”Ÿæˆä¸€ä¸ªXXKeyå¯¹è±¡(key class)ï¼ŒBlobç­‰å•ç‹¬ç”Ÿæˆä¸€ä¸ªå¯¹è±¡ï¼Œå…¶ä»–ç®€å•å±æ€§åœ¨ä¸€ä¸ªå¯¹è±¡ä¸­(record class)</span></span><br><span class="line"><span class="comment">    targetRuntime:</span></span><br><span class="line"><span class="comment">        1ï¼ŒMyBatis3ï¼šé»˜è®¤çš„å€¼ï¼Œç”ŸæˆåŸºäºMyBatis3.xä»¥ä¸Šç‰ˆæœ¬çš„å†…å®¹ï¼ŒåŒ…æ‹¬XXXBySampleï¼›</span></span><br><span class="line"><span class="comment">        2ï¼ŒMyBatis3Simpleï¼šç±»ä¼¼MyBatis3ï¼Œåªæ˜¯ä¸ç”ŸæˆXXXBySampleï¼›</span></span><br><span class="line"><span class="comment">    introspectedColumnImplï¼šç±»å…¨é™å®šåï¼Œç”¨äºæ‰©å±•MBG</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context</span> <span class="attr">id</span>=<span class="string">"mysql"</span> <span class="attr">defaultModelType</span>=<span class="string">"hierarchical"</span> <span class="attr">targetRuntime</span>=<span class="string">"MyBatis3Simple"</span> &gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- è‡ªåŠ¨è¯†åˆ«æ•°æ®åº“å…³é”®å­—ï¼Œé»˜è®¤falseï¼Œå¦‚æœè®¾ç½®ä¸ºtrueï¼Œæ ¹æ®SqlReservedWordsä¸­å®šä¹‰çš„å…³é”®å­—åˆ—è¡¨ï¼›</span></span><br><span class="line"><span class="comment">        ä¸€èˆ¬ä¿ç•™é»˜è®¤å€¼ï¼Œé‡åˆ°æ•°æ®åº“å…³é”®å­—ï¼ˆJavaå…³é”®å­—ï¼‰ï¼Œä½¿ç”¨columnOverrideè¦†ç›–</span></span><br><span class="line"><span class="comment">     --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"autoDelimitKeywords"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- ç”Ÿæˆçš„Javaæ–‡ä»¶çš„ç¼–ç  --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"javaFileEncoding"</span> <span class="attr">value</span>=<span class="string">"UTF-8"</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æ ¼å¼åŒ–javaä»£ç  --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"javaFormatter"</span> <span class="attr">value</span>=<span class="string">"org.mybatis.generator.api.dom.DefaultJavaFormatter"</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æ ¼å¼åŒ–XMLä»£ç  --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"xmlFormatter"</span> <span class="attr">value</span>=<span class="string">"org.mybatis.generator.api.dom.DefaultXmlFormatter"</span>/&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- beginningDelimiterå’ŒendingDelimiterï¼šæŒ‡æ˜æ•°æ®åº“çš„ç”¨äºæ ‡è®°æ•°æ®åº“å¯¹è±¡åçš„ç¬¦å·ï¼Œæ¯”å¦‚ORACLEå°±æ˜¯åŒå¼•å·ï¼ŒMYSQLé»˜è®¤æ˜¯`åå¼•å·ï¼› --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"beginningDelimiter"</span> <span class="attr">value</span>=<span class="string">"`"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"endingDelimiter"</span> <span class="attr">value</span>=<span class="string">"`"</span>/&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- å¿…é¡»è¦æœ‰çš„ï¼Œä½¿ç”¨è¿™ä¸ªé…ç½®é“¾æ¥æ•°æ®åº“</span></span><br><span class="line"><span class="comment">        @<span class="doctag">TODO:</span>æ˜¯å¦å¯ä»¥æ‰©å±•</span></span><br><span class="line"><span class="comment">     --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">jdbcConnection</span> <span class="attr">driverClass</span>=<span class="string">"com.mysql.jdbc.Driver"</span> <span class="attr">connectionURL</span>=<span class="string">"jdbc:mysql:///pss"</span> <span class="attr">userId</span>=<span class="string">"root"</span> <span class="attr">password</span>=<span class="string">"admin"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- è¿™é‡Œé¢å¯ä»¥è®¾ç½®propertyå±æ€§ï¼Œæ¯ä¸€ä¸ªpropertyå±æ€§éƒ½è®¾ç½®åˆ°é…ç½®çš„Driverä¸Š --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">jdbcConnection</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- javaç±»å‹å¤„ç†å™¨ </span></span><br><span class="line"><span class="comment">        ç”¨äºå¤„ç†DBä¸­çš„ç±»å‹åˆ°Javaä¸­çš„ç±»å‹ï¼Œé»˜è®¤ä½¿ç”¨JavaTypeResolverDefaultImplï¼›</span></span><br><span class="line"><span class="comment">        æ³¨æ„ä¸€ç‚¹ï¼Œé»˜è®¤ä¼šå…ˆå°è¯•ä½¿ç”¨Integerï¼ŒLongï¼ŒShortç­‰æ¥å¯¹åº”DECIMALå’Œ NUMERICæ•°æ®ç±»å‹ï¼› </span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">javaTypeResolver</span> <span class="attr">type</span>=<span class="string">"org.mybatis.generator.internal.types.JavaTypeResolverDefaultImpl"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">            trueï¼šä½¿ç”¨BigDecimalå¯¹åº”DECIMALå’Œ NUMERICæ•°æ®ç±»å‹</span></span><br><span class="line"><span class="comment">            falseï¼šé»˜è®¤,</span></span><br><span class="line"><span class="comment">                scale&gt;0;length&gt;18ï¼šä½¿ç”¨BigDecimal;</span></span><br><span class="line"><span class="comment">                scale=0;length[10,18]ï¼šä½¿ç”¨Longï¼›</span></span><br><span class="line"><span class="comment">                scale=0;length[5,9]ï¼šä½¿ç”¨Integerï¼›</span></span><br><span class="line"><span class="comment">                scale=0;length&lt;5ï¼šä½¿ç”¨Shortï¼›</span></span><br><span class="line"><span class="comment">         --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"forceBigDecimals"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">javaTypeResolver</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- javaæ¨¡å‹åˆ›å»ºå™¨ï¼Œæ˜¯å¿…é¡»è¦çš„å…ƒç´ </span></span><br><span class="line"><span class="comment">        è´Ÿè´£ï¼š1ï¼Œkeyç±»ï¼ˆè§contextçš„defaultModelTypeï¼‰ï¼›2ï¼Œjavaç±»ï¼›3ï¼ŒæŸ¥è¯¢ç±»</span></span><br><span class="line"><span class="comment">        targetPackageï¼šç”Ÿæˆçš„ç±»è¦æ”¾çš„åŒ…ï¼ŒçœŸå®çš„åŒ…å—enableSubPackageså±æ€§æ§åˆ¶ï¼›</span></span><br><span class="line"><span class="comment">        targetProjectï¼šç›®æ ‡é¡¹ç›®ï¼ŒæŒ‡å®šä¸€ä¸ªå­˜åœ¨çš„ç›®å½•ä¸‹ï¼Œç”Ÿæˆçš„å†…å®¹ä¼šæ”¾åˆ°æŒ‡å®šç›®å½•ä¸­ï¼Œå¦‚æœç›®å½•ä¸å­˜åœ¨ï¼ŒMBGä¸ä¼šè‡ªåŠ¨å»ºç›®å½•</span></span><br><span class="line"><span class="comment">     --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">javaModelGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"com._520it.mybatis.domain"</span> <span class="attr">targetProject</span>=<span class="string">"src/main/java"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--  for MyBatis3/MyBatis3Simple</span></span><br><span class="line"><span class="comment">            è‡ªåŠ¨ä¸ºæ¯ä¸€ä¸ªç”Ÿæˆçš„ç±»åˆ›å»ºä¸€ä¸ªæ„é€ æ–¹æ³•ï¼Œæ„é€ æ–¹æ³•åŒ…å«äº†æ‰€æœ‰çš„fieldï¼›è€Œä¸æ˜¯ä½¿ç”¨setterï¼›</span></span><br><span class="line"><span class="comment">         --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"constructorBased"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- åœ¨targetPackageçš„åŸºç¡€ä¸Šï¼Œæ ¹æ®æ•°æ®åº“çš„schemaå†ç”Ÿæˆä¸€å±‚packageï¼Œæœ€ç»ˆç”Ÿæˆçš„ç±»æ”¾åœ¨è¿™ä¸ªpackageä¸‹ï¼Œé»˜è®¤ä¸ºfalse --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"enableSubPackages"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- for MyBatis3 / MyBatis3Simple</span></span><br><span class="line"><span class="comment">            æ˜¯å¦åˆ›å»ºä¸€ä¸ªä¸å¯å˜çš„ç±»ï¼Œå¦‚æœä¸ºtrueï¼Œ</span></span><br><span class="line"><span class="comment">            é‚£ä¹ˆMBGä¼šåˆ›å»ºä¸€ä¸ªæ²¡æœ‰setteræ–¹æ³•çš„ç±»ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ç±»ä¼¼constructorBasedçš„ç±»</span></span><br><span class="line"><span class="comment">         --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"immutable"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- è®¾ç½®ä¸€ä¸ªæ ¹å¯¹è±¡ï¼Œ</span></span><br><span class="line"><span class="comment">            å¦‚æœè®¾ç½®äº†è¿™ä¸ªæ ¹å¯¹è±¡ï¼Œé‚£ä¹ˆç”Ÿæˆçš„keyClassæˆ–è€…recordClassä¼šç»§æ‰¿è¿™ä¸ªç±»ï¼›åœ¨Tableçš„rootClasså±æ€§ä¸­å¯ä»¥è¦†ç›–è¯¥é€‰é¡¹</span></span><br><span class="line"><span class="comment">            æ³¨æ„ï¼šå¦‚æœåœ¨key classæˆ–è€…record classä¸­æœ‰root classç›¸åŒçš„å±æ€§ï¼ŒMBGå°±ä¸ä¼šé‡æ–°ç”Ÿæˆè¿™äº›å±æ€§äº†ï¼ŒåŒ…æ‹¬ï¼š</span></span><br><span class="line"><span class="comment">                1ï¼Œå±æ€§åç›¸åŒï¼Œç±»å‹ç›¸åŒï¼Œæœ‰ç›¸åŒçš„getter/setteræ–¹æ³•ï¼›</span></span><br><span class="line"><span class="comment">         --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"rootClass"</span> <span class="attr">value</span>=<span class="string">"com._520it.mybatis.domain.BaseDomain"</span>/&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- è®¾ç½®æ˜¯å¦åœ¨getteræ–¹æ³•ä¸­ï¼Œå¯¹Stringç±»å‹å­—æ®µè°ƒç”¨trim()æ–¹æ³• --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"trimStrings"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">javaModelGenerator</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- ç”ŸæˆSQL mapçš„XMLæ–‡ä»¶ç”Ÿæˆå™¨ï¼Œ</span></span><br><span class="line"><span class="comment">        æ³¨æ„ï¼Œåœ¨Mybatis3ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨mapper.xmlæ–‡ä»¶+Mapperæ¥å£ï¼ˆæˆ–è€…ä¸ç”¨mapperæ¥å£ï¼‰ï¼Œ</span></span><br><span class="line"><span class="comment">            æˆ–è€…åªä½¿ç”¨Mapperæ¥å£+Annotationï¼Œæ‰€ä»¥ï¼Œå¦‚æœ javaClientGeneratoré…ç½®ä¸­é…ç½®äº†éœ€è¦ç”ŸæˆXMLçš„è¯ï¼Œè¿™ä¸ªå…ƒç´ å°±å¿…é¡»é…ç½®</span></span><br><span class="line"><span class="comment">        targetPackage/targetProject:åŒjavaModelGenerator</span></span><br><span class="line"><span class="comment">     --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">sqlMapGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"com._520it.mybatis.mapper"</span> <span class="attr">targetProject</span>=<span class="string">"src/main/resources"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- åœ¨targetPackageçš„åŸºç¡€ä¸Šï¼Œæ ¹æ®æ•°æ®åº“çš„schemaå†ç”Ÿæˆä¸€å±‚packageï¼Œæœ€ç»ˆç”Ÿæˆçš„ç±»æ”¾åœ¨è¿™ä¸ªpackageä¸‹ï¼Œé»˜è®¤ä¸ºfalse --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"enableSubPackages"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">sqlMapGenerator</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- å¯¹äºmybatisæ¥è¯´ï¼Œå³ç”ŸæˆMapperæ¥å£ï¼Œæ³¨æ„ï¼Œå¦‚æœæ²¡æœ‰é…ç½®è¯¥å…ƒç´ ï¼Œé‚£ä¹ˆé»˜è®¤ä¸ä¼šç”ŸæˆMapperæ¥å£ </span></span><br><span class="line"><span class="comment">        targetPackage/targetProject:åŒjavaModelGenerator</span></span><br><span class="line"><span class="comment">        typeï¼šé€‰æ‹©æ€ä¹ˆç”Ÿæˆmapperæ¥å£ï¼ˆåœ¨MyBatis3/MyBatis3Simpleä¸‹ï¼‰ï¼š</span></span><br><span class="line"><span class="comment">            1ï¼ŒANNOTATEDMAPPERï¼šä¼šç”Ÿæˆä½¿ç”¨Mapperæ¥å£+Annotationçš„æ–¹å¼åˆ›å»ºï¼ˆSQLç”Ÿæˆåœ¨annotationä¸­ï¼‰ï¼Œä¸ä¼šç”Ÿæˆå¯¹åº”çš„XMLï¼›</span></span><br><span class="line"><span class="comment">            2ï¼ŒMIXEDMAPPERï¼šä½¿ç”¨æ··åˆé…ç½®ï¼Œä¼šç”ŸæˆMapperæ¥å£ï¼Œå¹¶é€‚å½“æ·»åŠ åˆé€‚çš„Annotationï¼Œä½†æ˜¯XMLä¼šç”Ÿæˆåœ¨XMLä¸­ï¼›</span></span><br><span class="line"><span class="comment">            3ï¼ŒXMLMAPPERï¼šä¼šç”ŸæˆMapperæ¥å£ï¼Œæ¥å£å®Œå…¨ä¾èµ–XMLï¼›</span></span><br><span class="line"><span class="comment">        æ³¨æ„ï¼Œå¦‚æœcontextæ˜¯MyBatis3Simpleï¼šåªæ”¯æŒANNOTATEDMAPPERå’ŒXMLMAPPER</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">javaClientGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"com._520it.mybatis.mapper"</span> <span class="attr">type</span>=<span class="string">"ANNOTATEDMAPPER"</span> <span class="attr">targetProject</span>=<span class="string">"src/main/java"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- åœ¨targetPackageçš„åŸºç¡€ä¸Šï¼Œæ ¹æ®æ•°æ®åº“çš„schemaå†ç”Ÿæˆä¸€å±‚packageï¼Œæœ€ç»ˆç”Ÿæˆçš„ç±»æ”¾åœ¨è¿™ä¸ªpackageä¸‹ï¼Œé»˜è®¤ä¸ºfalse --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"enableSubPackages"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- å¯ä»¥ä¸ºæ‰€æœ‰ç”Ÿæˆçš„æ¥å£æ·»åŠ ä¸€ä¸ªçˆ¶æ¥å£ï¼Œä½†æ˜¯MBGåªè´Ÿè´£ç”Ÿæˆï¼Œä¸è´Ÿè´£æ£€æŸ¥</span></span><br><span class="line"><span class="comment">        &lt;property name="rootInterface" value=""/&gt;</span></span><br><span class="line"><span class="comment">         --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">javaClientGenerator</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- é€‰æ‹©ä¸€ä¸ªtableæ¥ç”Ÿæˆç›¸å…³æ–‡ä»¶ï¼Œå¯ä»¥æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªtableï¼Œå¿…é¡»è¦æœ‰tableå…ƒç´ </span></span><br><span class="line"><span class="comment">        é€‰æ‹©çš„tableä¼šç”Ÿæˆä¸€ä¸‹æ–‡ä»¶ï¼š</span></span><br><span class="line"><span class="comment">        1ï¼ŒSQL mapæ–‡ä»¶</span></span><br><span class="line"><span class="comment">        2ï¼Œç”Ÿæˆä¸€ä¸ªä¸»é”®ç±»ï¼›</span></span><br><span class="line"><span class="comment">        3ï¼Œé™¤äº†BLOBå’Œä¸»é”®çš„å…¶ä»–å­—æ®µçš„ç±»ï¼›</span></span><br><span class="line"><span class="comment">        4ï¼ŒåŒ…å«BLOBçš„ç±»ï¼›</span></span><br><span class="line"><span class="comment">        5ï¼Œä¸€ä¸ªç”¨æˆ·ç”ŸæˆåŠ¨æ€æŸ¥è¯¢çš„æ¡ä»¶ç±»ï¼ˆselectByExample, deleteByExampleï¼‰ï¼Œå¯é€‰ï¼›</span></span><br><span class="line"><span class="comment">        6ï¼ŒMapperæ¥å£ï¼ˆå¯é€‰ï¼‰</span></span><br><span class="line"><span class="comment">    </span></span><br><span class="line"><span class="comment">        tableNameï¼ˆå¿…è¦ï¼‰ï¼šè¦ç”Ÿæˆå¯¹è±¡çš„è¡¨åï¼›</span></span><br><span class="line"><span class="comment">        æ³¨æ„ï¼šå¤§å°å†™æ•æ„Ÿé—®é¢˜ã€‚æ­£å¸¸æƒ…å†µä¸‹ï¼ŒMBGä¼šè‡ªåŠ¨çš„å»è¯†åˆ«æ•°æ®åº“æ ‡è¯†ç¬¦çš„å¤§å°å†™æ•æ„Ÿåº¦ï¼Œåœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒMBGä¼š</span></span><br><span class="line"><span class="comment">            æ ¹æ®è®¾ç½®çš„schemaï¼Œcatalogæˆ–tablenameå»æŸ¥è¯¢æ•°æ®è¡¨ï¼ŒæŒ‰ç…§ä¸‹é¢çš„æµç¨‹ï¼š</span></span><br><span class="line"><span class="comment">            1ï¼Œå¦‚æœschemaï¼Œcatalogæˆ–tablenameä¸­æœ‰ç©ºæ ¼ï¼Œé‚£ä¹ˆè®¾ç½®çš„æ˜¯ä»€ä¹ˆæ ¼å¼ï¼Œå°±ç²¾ç¡®çš„ä½¿ç”¨æŒ‡å®šçš„å¤§å°å†™æ ¼å¼å»æŸ¥è¯¢ï¼›</span></span><br><span class="line"><span class="comment">            2ï¼Œå¦åˆ™ï¼Œå¦‚æœæ•°æ®åº“çš„æ ‡è¯†ç¬¦ä½¿ç”¨å¤§å†™çš„ï¼Œé‚£ä¹ˆMBGè‡ªåŠ¨æŠŠè¡¨åå˜æˆå¤§å†™å†æŸ¥æ‰¾ï¼›</span></span><br><span class="line"><span class="comment">            3ï¼Œå¦åˆ™ï¼Œå¦‚æœæ•°æ®åº“çš„æ ‡è¯†ç¬¦ä½¿ç”¨å°å†™çš„ï¼Œé‚£ä¹ˆMBGè‡ªåŠ¨æŠŠè¡¨åå˜æˆå°å†™å†æŸ¥æ‰¾ï¼›</span></span><br><span class="line"><span class="comment">            4ï¼Œå¦åˆ™ï¼Œä½¿ç”¨æŒ‡å®šçš„å¤§å°å†™æ ¼å¼æŸ¥è¯¢ï¼›</span></span><br><span class="line"><span class="comment">        å¦å¤–çš„ï¼Œå¦‚æœåœ¨åˆ›å»ºè¡¨çš„æ—¶å€™ï¼Œä½¿ç”¨çš„""æŠŠæ•°æ®åº“å¯¹è±¡è§„å®šå¤§å°å†™ï¼Œå°±ç®—æ•°æ®åº“æ ‡è¯†ç¬¦æ˜¯ä½¿ç”¨çš„å¤§å†™ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ä¹Ÿä¼šä½¿ç”¨ç»™å®šçš„å¤§å°å†™æ¥åˆ›å»ºè¡¨åï¼›</span></span><br><span class="line"><span class="comment">        è¿™ä¸ªæ—¶å€™ï¼Œè¯·è®¾ç½®delimitIdentifiers="true"å³å¯ä¿ç•™å¤§å°å†™æ ¼å¼ï¼›</span></span><br><span class="line"><span class="comment">        </span></span><br><span class="line"><span class="comment">        å¯é€‰ï¼š</span></span><br><span class="line"><span class="comment">        1ï¼Œschemaï¼šæ•°æ®åº“çš„schemaï¼›</span></span><br><span class="line"><span class="comment">        2ï¼Œcatalogï¼šæ•°æ®åº“çš„catalogï¼›</span></span><br><span class="line"><span class="comment">        3ï¼Œaliasï¼šä¸ºæ•°æ®è¡¨è®¾ç½®çš„åˆ«åï¼Œå¦‚æœè®¾ç½®äº†aliasï¼Œé‚£ä¹ˆç”Ÿæˆçš„æ‰€æœ‰çš„SELECT SQLè¯­å¥ä¸­ï¼Œåˆ—åä¼šå˜æˆï¼šalias_actualColumnName</span></span><br><span class="line"><span class="comment">        4ï¼ŒdomainObjectNameï¼šç”Ÿæˆçš„domainç±»çš„åå­—ï¼Œå¦‚æœä¸è®¾ç½®ï¼Œç›´æ¥ä½¿ç”¨è¡¨åä½œä¸ºdomainç±»çš„åå­—ï¼›å¯ä»¥è®¾ç½®ä¸ºsomepck.domainNameï¼Œé‚£ä¹ˆä¼šè‡ªåŠ¨æŠŠdomainNameç±»å†æ”¾åˆ°somepckåŒ…é‡Œé¢ï¼›</span></span><br><span class="line"><span class="comment">        5ï¼ŒenableInsertï¼ˆé»˜è®¤trueï¼‰ï¼šæŒ‡å®šæ˜¯å¦ç”Ÿæˆinsertè¯­å¥ï¼›</span></span><br><span class="line"><span class="comment">        6ï¼ŒenableSelectByPrimaryKeyï¼ˆé»˜è®¤trueï¼‰ï¼šæŒ‡å®šæ˜¯å¦ç”ŸæˆæŒ‰ç…§ä¸»é”®æŸ¥è¯¢å¯¹è±¡çš„è¯­å¥ï¼ˆå°±æ˜¯getByIdæˆ–getï¼‰ï¼›</span></span><br><span class="line"><span class="comment">        7ï¼ŒenableSelectByExampleï¼ˆé»˜è®¤trueï¼‰ï¼šMyBatis3Simpleä¸ºfalseï¼ŒæŒ‡å®šæ˜¯å¦ç”ŸæˆåŠ¨æ€æŸ¥è¯¢è¯­å¥ï¼›</span></span><br><span class="line"><span class="comment">        8ï¼ŒenableUpdateByPrimaryKeyï¼ˆé»˜è®¤trueï¼‰ï¼šæŒ‡å®šæ˜¯å¦ç”ŸæˆæŒ‰ç…§ä¸»é”®ä¿®æ”¹å¯¹è±¡çš„è¯­å¥ï¼ˆå³update)ï¼›</span></span><br><span class="line"><span class="comment">        9ï¼ŒenableDeleteByPrimaryKeyï¼ˆé»˜è®¤trueï¼‰ï¼šæŒ‡å®šæ˜¯å¦ç”ŸæˆæŒ‰ç…§ä¸»é”®åˆ é™¤å¯¹è±¡çš„è¯­å¥ï¼ˆå³deleteï¼‰ï¼›</span></span><br><span class="line"><span class="comment">        10ï¼ŒenableDeleteByExampleï¼ˆé»˜è®¤trueï¼‰ï¼šMyBatis3Simpleä¸ºfalseï¼ŒæŒ‡å®šæ˜¯å¦ç”ŸæˆåŠ¨æ€åˆ é™¤è¯­å¥ï¼›</span></span><br><span class="line"><span class="comment">        11ï¼ŒenableCountByExampleï¼ˆé»˜è®¤trueï¼‰ï¼šMyBatis3Simpleä¸ºfalseï¼ŒæŒ‡å®šæ˜¯å¦ç”ŸæˆåŠ¨æ€æŸ¥è¯¢æ€»æ¡æ•°è¯­å¥ï¼ˆç”¨äºåˆ†é¡µçš„æ€»æ¡æ•°æŸ¥è¯¢ï¼‰ï¼›</span></span><br><span class="line"><span class="comment">        12ï¼ŒenableUpdateByExampleï¼ˆé»˜è®¤trueï¼‰ï¼šMyBatis3Simpleä¸ºfalseï¼ŒæŒ‡å®šæ˜¯å¦ç”ŸæˆåŠ¨æ€ä¿®æ”¹è¯­å¥ï¼ˆåªä¿®æ”¹å¯¹è±¡ä¸­ä¸ä¸ºç©ºçš„å±æ€§ï¼‰ï¼›</span></span><br><span class="line"><span class="comment">        13ï¼ŒmodelTypeï¼šå‚è€ƒcontextå…ƒç´ çš„defaultModelTypeï¼Œç›¸å½“äºè¦†ç›–ï¼›</span></span><br><span class="line"><span class="comment">        14ï¼ŒdelimitIdentifiersï¼šå‚è€ƒtableNameçš„è§£é‡Šï¼Œæ³¨æ„ï¼Œé»˜è®¤çš„delimitIdentifiersæ˜¯åŒå¼•å·ï¼Œå¦‚æœç±»ä¼¼MYSQLè¿™æ ·çš„æ•°æ®åº“ï¼Œä½¿ç”¨çš„æ˜¯`ï¼ˆåå¼•å·ï¼Œé‚£ä¹ˆè¿˜éœ€è¦è®¾ç½®contextçš„beginningDelimiterå’ŒendingDelimiterå±æ€§ï¼‰</span></span><br><span class="line"><span class="comment">        15ï¼ŒdelimitAllColumnsï¼šè®¾ç½®æ˜¯å¦æ‰€æœ‰ç”Ÿæˆçš„SQLä¸­çš„åˆ—åéƒ½ä½¿ç”¨æ ‡è¯†ç¬¦å¼•èµ·æ¥ã€‚é»˜è®¤ä¸ºfalseï¼ŒdelimitIdentifierså‚è€ƒcontextçš„å±æ€§</span></span><br><span class="line"><span class="comment">        </span></span><br><span class="line"><span class="comment">        æ³¨æ„ï¼Œtableé‡Œé¢å¾ˆå¤šå‚æ•°éƒ½æ˜¯å¯¹javaModelGeneratorï¼Œcontextç­‰å…ƒç´ çš„é»˜è®¤å±æ€§çš„ä¸€ä¸ªå¤å†™ï¼›</span></span><br><span class="line"><span class="comment">     --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">"userinfo"</span> &gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- å‚è€ƒ javaModelGenerator çš„ constructorBasedå±æ€§--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"constructorBased"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- é»˜è®¤ä¸ºfalseï¼Œå¦‚æœè®¾ç½®ä¸ºtrueï¼Œåœ¨ç”Ÿæˆçš„SQLä¸­ï¼Œtableåå­—ä¸ä¼šåŠ ä¸Šcatalogæˆ–schemaï¼› --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"ignoreQualifiersAtRuntime"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- å‚è€ƒ javaModelGenerator çš„ immutable å±æ€§ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"immutable"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- æŒ‡å®šæ˜¯å¦åªç”Ÿæˆdomainç±»ï¼Œå¦‚æœè®¾ç½®ä¸ºtrueï¼Œåªç”Ÿæˆdomainç±»ï¼Œå¦‚æœè¿˜é…ç½®äº†sqlMapGeneratorï¼Œé‚£ä¹ˆåœ¨mapper XMLæ–‡ä»¶ä¸­ï¼Œåªç”ŸæˆresultMapå…ƒç´  --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"modelOnly"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- å‚è€ƒ javaModelGenerator çš„ rootClass å±æ€§ </span></span><br><span class="line"><span class="comment">        &lt;property name="rootClass" value=""/&gt;</span></span><br><span class="line"><span class="comment">         --&gt;</span></span><br><span class="line">         </span><br><span class="line">        <span class="comment">&lt;!-- å‚è€ƒjavaClientGenerator çš„  rootInterface å±æ€§</span></span><br><span class="line"><span class="comment">        &lt;property name="rootInterface" value=""/&gt;</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- å¦‚æœè®¾ç½®äº†runtimeCatalogï¼Œé‚£ä¹ˆåœ¨ç”Ÿæˆçš„SQLä¸­ï¼Œä½¿ç”¨è¯¥æŒ‡å®šçš„catalogï¼Œè€Œä¸æ˜¯tableå…ƒç´ ä¸Šçš„catalog </span></span><br><span class="line"><span class="comment">        &lt;property name="runtimeCatalog" value=""/&gt;</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- å¦‚æœè®¾ç½®äº†runtimeSchemaï¼Œé‚£ä¹ˆåœ¨ç”Ÿæˆçš„SQLä¸­ï¼Œä½¿ç”¨è¯¥æŒ‡å®šçš„schemaï¼Œè€Œä¸æ˜¯tableå…ƒç´ ä¸Šçš„schema </span></span><br><span class="line"><span class="comment">        &lt;property name="runtimeSchema" value=""/&gt;</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- å¦‚æœè®¾ç½®äº†runtimeTableNameï¼Œé‚£ä¹ˆåœ¨ç”Ÿæˆçš„SQLä¸­ï¼Œä½¿ç”¨è¯¥æŒ‡å®šçš„tablenameï¼Œè€Œä¸æ˜¯tableå…ƒç´ ä¸Šçš„tablename </span></span><br><span class="line"><span class="comment">        &lt;property name="runtimeTableName" value=""/&gt;</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- æ³¨æ„ï¼Œè¯¥å±æ€§åªé’ˆå¯¹MyBatis3Simpleæœ‰ç”¨ï¼›</span></span><br><span class="line"><span class="comment">            å¦‚æœé€‰æ‹©çš„runtimeæ˜¯MyBatis3Simpleï¼Œé‚£ä¹ˆä¼šç”Ÿæˆä¸€ä¸ªSelectAllæ–¹æ³•ï¼Œå¦‚æœæŒ‡å®šäº†selectAllOrderByClauseï¼Œé‚£ä¹ˆä¼šåœ¨è¯¥SQLä¸­æ·»åŠ æŒ‡å®šçš„è¿™ä¸ªorderæ¡ä»¶ï¼›</span></span><br><span class="line"><span class="comment">         --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"selectAllOrderByClause"</span> <span class="attr">value</span>=<span class="string">"age desc,username asc"</span>/&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- å¦‚æœè®¾ç½®ä¸ºtrueï¼Œç”Ÿæˆçš„modelç±»ä¼šç›´æ¥ä½¿ç”¨columnæœ¬èº«çš„åå­—ï¼Œè€Œä¸ä¼šå†ä½¿ç”¨é©¼å³°å‘½åæ–¹æ³•ï¼Œæ¯”å¦‚BORN_DATEï¼Œç”Ÿæˆçš„å±æ€§åå­—å°±æ˜¯BORN_DATE,è€Œä¸ä¼šæ˜¯bornDate --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"useActualColumnNames"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- generatedKeyç”¨äºç”Ÿæˆç”Ÿæˆä¸»é”®çš„æ–¹æ³•ï¼Œ</span></span><br><span class="line"><span class="comment">            å¦‚æœè®¾ç½®äº†è¯¥å…ƒç´ ï¼ŒMBGä¼šåœ¨ç”Ÿæˆçš„&lt;insert&gt;å…ƒç´ ä¸­ç”Ÿæˆä¸€æ¡æ­£ç¡®çš„&lt;selectKey&gt;å…ƒç´ ï¼Œè¯¥å…ƒç´ å¯é€‰</span></span><br><span class="line"><span class="comment">            column:ä¸»é”®çš„åˆ—åï¼›</span></span><br><span class="line"><span class="comment">            sqlStatementï¼šè¦ç”Ÿæˆçš„selectKeyè¯­å¥ï¼Œæœ‰ä»¥ä¸‹å¯é€‰é¡¹ï¼š</span></span><br><span class="line"><span class="comment">                Cloudscape:ç›¸å½“äºselectKeyçš„SQLä¸ºï¼š VALUES IDENTITY_VAL_LOCAL()</span></span><br><span class="line"><span class="comment">                DB2       :ç›¸å½“äºselectKeyçš„SQLä¸ºï¼š VALUES IDENTITY_VAL_LOCAL()</span></span><br><span class="line"><span class="comment">                DB2_MF    :ç›¸å½“äºselectKeyçš„SQLä¸ºï¼šSELECT IDENTITY_VAL_LOCAL() FROM SYSIBM.SYSDUMMY1</span></span><br><span class="line"><span class="comment">                Derby     :ç›¸å½“äºselectKeyçš„SQLä¸ºï¼šVALUES IDENTITY_VAL_LOCAL()</span></span><br><span class="line"><span class="comment">                HSQLDB    :ç›¸å½“äºselectKeyçš„SQLä¸ºï¼šCALL IDENTITY()</span></span><br><span class="line"><span class="comment">                Informix  :ç›¸å½“äºselectKeyçš„SQLä¸ºï¼šselect dbinfo('sqlca.sqlerrd1') from systables where tabid=1</span></span><br><span class="line"><span class="comment">                MySql     :ç›¸å½“äºselectKeyçš„SQLä¸ºï¼šSELECT LAST_INSERT_ID()</span></span><br><span class="line"><span class="comment">                SqlServer :ç›¸å½“äºselectKeyçš„SQLä¸ºï¼šSELECT SCOPE_IDENTITY()</span></span><br><span class="line"><span class="comment">                SYBASE    :ç›¸å½“äºselectKeyçš„SQLä¸ºï¼šSELECT @@IDENTITY</span></span><br><span class="line"><span class="comment">                JDBC      :ç›¸å½“äºåœ¨ç”Ÿæˆçš„insertå…ƒç´ ä¸Šæ·»åŠ useGeneratedKeys="true"å’ŒkeyPropertyå±æ€§</span></span><br><span class="line"><span class="comment">        &lt;generatedKey column="" sqlStatement=""/&gt;</span></span><br><span class="line"><span class="comment">         --&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">            è¯¥å…ƒç´ ä¼šåœ¨æ ¹æ®è¡¨ä¸­åˆ—åè®¡ç®—å¯¹è±¡å±æ€§åä¹‹å‰å…ˆé‡å‘½ååˆ—åï¼Œéå¸¸é€‚åˆç”¨äºè¡¨ä¸­çš„åˆ—éƒ½æœ‰å…¬ç”¨çš„å‰ç¼€å­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œ</span></span><br><span class="line"><span class="comment">            æ¯”å¦‚åˆ—åä¸ºï¼šCUST_ID,CUST_NAME,CUST_EMAIL,CUST_ADDRESSç­‰ï¼›</span></span><br><span class="line"><span class="comment">            é‚£ä¹ˆå°±å¯ä»¥è®¾ç½®searchStringä¸º"^CUST_"ï¼Œå¹¶ä½¿ç”¨ç©ºç™½æ›¿æ¢ï¼Œé‚£ä¹ˆç”Ÿæˆçš„Customerå¯¹è±¡ä¸­çš„å±æ€§åç§°å°±ä¸æ˜¯</span></span><br><span class="line"><span class="comment">            custId,custNameç­‰ï¼Œè€Œæ˜¯å…ˆè¢«æ›¿æ¢ä¸ºID,NAME,EMAIL,ç„¶åå˜æˆå±æ€§ï¼šidï¼Œnameï¼Œemailï¼›</span></span><br><span class="line"><span class="comment">            </span></span><br><span class="line"><span class="comment">            æ³¨æ„ï¼ŒMBGæ˜¯ä½¿ç”¨java.util.regex.Matcher.replaceAllæ¥æ›¿æ¢searchStringå’ŒreplaceStringçš„ï¼Œ</span></span><br><span class="line"><span class="comment">            å¦‚æœä½¿ç”¨äº†columnOverrideå…ƒç´ ï¼Œè¯¥å±æ€§æ— æ•ˆï¼›</span></span><br><span class="line"><span class="comment">            </span></span><br><span class="line"><span class="comment">        &lt;columnRenamingRule searchString="" replaceString=""/&gt;</span></span><br><span class="line"><span class="comment">         --&gt;</span></span><br><span class="line">         </span><br><span class="line">         </span><br><span class="line">         <span class="comment">&lt;!-- ç”¨æ¥ä¿®æ”¹è¡¨ä¸­æŸä¸ªåˆ—çš„å±æ€§ï¼ŒMBGä¼šä½¿ç”¨ä¿®æ”¹åçš„åˆ—æ¥ç”Ÿæˆdomainçš„å±æ€§ï¼›</span></span><br><span class="line"><span class="comment">            column:è¦é‡æ–°è®¾ç½®çš„åˆ—åï¼›</span></span><br><span class="line"><span class="comment">            æ³¨æ„ï¼Œä¸€ä¸ªtableå…ƒç´ ä¸­å¯ä»¥æœ‰å¤šä¸ªcolumnOverrideå…ƒç´ å“ˆ~</span></span><br><span class="line"><span class="comment">          --&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">columnOverride</span> <span class="attr">column</span>=<span class="string">"username"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- ä½¿ç”¨propertyå±æ€§æ¥æŒ‡å®šåˆ—è¦ç”Ÿæˆçš„å±æ€§åç§° --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"property"</span> <span class="attr">value</span>=<span class="string">"userName"</span>/&gt;</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment">&lt;!-- javaTypeç”¨äºæŒ‡å®šç”Ÿæˆçš„domainçš„å±æ€§ç±»å‹ï¼Œä½¿ç”¨ç±»å‹çš„å…¨é™å®šå</span></span><br><span class="line"><span class="comment">            &lt;property name="javaType" value=""/&gt;</span></span><br><span class="line"><span class="comment">             --&gt;</span></span><br><span class="line">             </span><br><span class="line">            <span class="comment">&lt;!-- jdbcTypeç”¨äºæŒ‡å®šè¯¥åˆ—çš„JDBCç±»å‹ </span></span><br><span class="line"><span class="comment">            &lt;property name="jdbcType" value=""/&gt;</span></span><br><span class="line"><span class="comment">             --&gt;</span></span><br><span class="line">             </span><br><span class="line">            <span class="comment">&lt;!-- typeHandler ç”¨äºæŒ‡å®šè¯¥åˆ—ä½¿ç”¨åˆ°çš„TypeHandlerï¼Œå¦‚æœè¦æŒ‡å®šï¼Œé…ç½®ç±»å‹å¤„ç†å™¨çš„å…¨é™å®šå</span></span><br><span class="line"><span class="comment">                æ³¨æ„ï¼Œmybatisä¸­ï¼Œä¸ä¼šç”Ÿæˆåˆ°mybatis-config.xmlä¸­çš„typeHandler</span></span><br><span class="line"><span class="comment">                åªä¼šç”Ÿæˆç±»ä¼¼ï¼šwhere id = #&#123;id,jdbcType=BIGINT,typeHandler=com._520it.mybatis.MyTypeHandler&#125;çš„å‚æ•°æè¿°</span></span><br><span class="line"><span class="comment">            &lt;property name="jdbcType" value=""/&gt;</span></span><br><span class="line"><span class="comment">            --&gt;</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment">&lt;!-- å‚è€ƒtableå…ƒç´ çš„delimitAllColumnsé…ç½®ï¼Œé»˜è®¤ä¸ºfalse</span></span><br><span class="line"><span class="comment">            &lt;property name="delimitedColumnName" value=""/&gt;</span></span><br><span class="line"><span class="comment">             --&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">columnOverride</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">         <span class="comment">&lt;!-- ignoreColumnè®¾ç½®ä¸€ä¸ªMGBå¿½ç•¥çš„åˆ—ï¼Œå¦‚æœè®¾ç½®äº†æ”¹åˆ—ï¼Œé‚£ä¹ˆåœ¨ç”Ÿæˆçš„domainä¸­ï¼Œç”Ÿæˆçš„SQLä¸­ï¼Œéƒ½ä¸ä¼šæœ‰è¯¥åˆ—å‡ºç° </span></span><br><span class="line"><span class="comment">            column:æŒ‡å®šè¦å¿½ç•¥çš„åˆ—çš„åå­—ï¼›</span></span><br><span class="line"><span class="comment">            delimitedColumnNameï¼šå‚è€ƒtableå…ƒç´ çš„delimitAllColumnsé…ç½®ï¼Œé»˜è®¤ä¸ºfalse</span></span><br><span class="line"><span class="comment">            </span></span><br><span class="line"><span class="comment">            æ³¨æ„ï¼Œä¸€ä¸ªtableå…ƒç´ ä¸­å¯ä»¥æœ‰å¤šä¸ªignoreColumnå…ƒç´ </span></span><br><span class="line"><span class="comment">         &lt;ignoreColumn column="deptId" delimitedColumnName=""/&gt;</span></span><br><span class="line"><span class="comment">         --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">context</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> mybatis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaå®ç°äºŒåˆ†æŸ¥æ‰¾ç®—æ³•</title>
      <link href="/post/e486e255.html"/>
      <url>/post/e486e255.html</url>
      
        <content type="html"><![CDATA[<p>  äºŒåˆ†æ³•æŸ¥æ‰¾ï¼Œä¹Ÿç§°ä¸ºæŠ˜åŠæ³•ï¼Œæ˜¯ä¸€ç§åœ¨æœ‰åºæ•°ç»„ä¸­æŸ¥æ‰¾ç‰¹å®šå…ƒç´ çš„æœç´¢ç®—æ³•ã€‚æ‰€ä»¥åœ¨é‡‡ç”¨äºŒåˆ†æ³•æŸ¥æ‰¾æ—¶ï¼Œæ•°æ®éœ€æ˜¯æœ‰åºä¸é‡å¤çš„ï¼Œå¦‚æœæ˜¯æ— åºçš„ä¹Ÿå¯é€šè¿‡é€‰æ‹©æ’åºã€å†’æ³¡æ’åºç­‰æ•°ç»„æ’åºæ–¹æ³•è¿›è¡Œæ’åºä¹‹åï¼Œå°±å¯ä»¥ä½¿ç”¨äºŒåˆ†æ³•æŸ¥æ‰¾ã€‚<br>  åŸºæœ¬æ€æƒ³ï¼šå‡è®¾æ•°æ®æ˜¯æŒ‰å‡åºæ’åºçš„ï¼Œå¯¹äºç»™å®šå€¼ xï¼Œä»åºåˆ—çš„ä¸­é—´ä½ç½®å¼€å§‹æ¯”è¾ƒï¼Œå¦‚æœå½“å‰ä½ç½®å€¼ç­‰äº xï¼Œåˆ™æŸ¥æ‰¾æˆåŠŸï¼›è‹¥ x å°äºå½“å‰ä½ç½®å€¼ï¼Œåˆ™åœ¨æ•°åˆ—çš„å‰åŠæ®µä¸­æŸ¥æ‰¾ï¼›è‹¥ x å¤§äºå½“å‰ä½ç½®å€¼åˆ™åœ¨æ•°åˆ—çš„ååŠæ®µä¸­ç»§ç»­æŸ¥æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°ä¸ºæ­¢ï¼Œä½†æ˜¯å¦‚æœå½“å‰æ®µçš„ç´¢å¼•æœ€å¤§å€¼å°äºå½“å‰æ®µç´¢å¼•æœ€å°å€¼ï¼Œè¯´æ˜æŸ¥æ‰¾çš„å€¼ä¸å­˜åœ¨ï¼Œè¿”å›-1ï¼Œä¸ç»§ç»­æŸ¥æ‰¾ã€‚<br>  <a id="more"></a><br> ä¸‹é¢è´´å‡ºä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.LinkedList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by Sam on 18/12/9.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span>[] array = &#123;<span class="number">1</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">12</span>,<span class="number">56</span>,<span class="number">78</span>,<span class="number">89</span>,<span class="number">120</span>,<span class="number">179</span>,<span class="number">180</span>,<span class="number">200</span>,<span class="number">290</span>&#125;;</span><br><span class="line">        System.out.println(<span class="string">"index="</span>+binarySearch(array,<span class="number">290</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">binarySearch</span><span class="params">(<span class="keyword">int</span>[] array,<span class="keyword">int</span> searchNumber)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> minIndex = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> maxIndex = array.length - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> searchIndex = (minIndex + maxIndex) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (array[searchIndex] != searchNumber)&#123;</span><br><span class="line"></span><br><span class="line">            System.out.printf(<span class="string">"ç¬¬æ¬¡%dæ¬¡è¿ç®—\n"</span>, ++count);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (array[searchIndex] &gt; searchNumber)&#123;</span><br><span class="line">                maxIndex = searchIndex - <span class="number">1</span> ;</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                minIndex = searchIndex + <span class="number">1</span> ;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (minIndex&gt;maxIndex)&#123;</span><br><span class="line">                <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            searchIndex = (minIndex + maxIndex) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> searchIndex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> äºŒåˆ†æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PowerDesignerç”ŸæˆSQLæ—¶æ³¨é‡Šä¸ºnameå’Œcommentåˆå¹¶åçš„å†…å®¹</title>
      <link href="/post/26129f65.html"/>
      <url>/post/26129f65.html</url>
      
        <content type="html"><![CDATA[<p>PowerDesignerç”ŸæˆSQLæ—¶çš„æ³¨é‡Šé»˜è®¤æ˜¯æ²¡æœ‰nameå­—æ®µçš„ï¼Œç½‘ä¸Šè®²çš„è®¾ç½®æ–¹æ³•å¤§éƒ¨åˆ†éƒ½æ˜¯åªèƒ½ç”¨nameæˆ–è€…commentï¼Œæ— æ³•å°†ä¸¤è€…åˆå¹¶ä½¿ç”¨ã€‚ä½†æ˜¯æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦nameå’Œcommentå­—æ®µåˆå¹¶èµ·æ¥åŠ åˆ°æ³¨é‡Šä¸­ï¼Œåˆ™å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹æ³•æ¥å®ç°ã€‚</p><a id="more"></a><ol><li>ç¬¬ä¸€æ­¥ï¼šä¿®æ”¹SQLçš„ç”Ÿæˆè„šæœ¬<ul><li>é€‰æ‹©èœå•ï¼šdatabase -&gt; edit current DBMSâ€¦</li><li>é€‰æ‹©generalé€‰é¡¹å¡ï¼šscript -&gt; objects -&gt; column -&gt; columncommnet</li><li>ä¿®æ”¹valueå€¼ä¸ºï¼š é‡ç‚¹å°±æ˜¯ä¸‹é¢è¿™ä¸ªè„šæœ¬äº†ï¼Œæœ¬äººå¯¹è„šæœ¬è¯­æ³•ä¸ç†Ÿæ‚‰ï¼Œç»è¿‡å„ç§å°è¯•ï¼Œæœ€ç»ˆè„šæœ¬å¦‚ä¸‹<figure class="highlight vbs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">alter table %TABLE% modify column [%QUALIFIER%] %TABLE%.%COLUMN%  %DATATYPE%[%Unsigned%? unsigned][%ZeroFill%? zerofill][.Z:[ %NOTNULL%][%R%?[%PRIMARY%]][%IDENTITY%? auto_increment:[ <span class="keyword">default</span> %<span class="keyword">DEFAULT</span>%]]] comment</span><br><span class="line">.<span class="keyword">if</span> (%COMMENT%==%COLNNAME%)</span><br><span class="line"> <span class="comment">'%COLNNAME%'</span></span><br><span class="line">.<span class="keyword">else</span></span><br><span class="line"> <span class="comment">'%COLNNAME% %COMMENT%'</span></span><br><span class="line">.endif(\n)</span><br></pre></td></tr></table></figure></li></ul></li><li>ç¬¬äºŒæ­¥ï¼šä¿®æ”¹ç”Ÿæˆè§„åˆ™<br>å½“ç¬¬ä¸€æ­¥çš„è„šæœ¬ä¿®æ”¹åå°±å¯ä»¥æ˜¾ç¤ºnameä¸ºæ³¨é‡Šäº†ï¼Œä½†æ˜¯commentä¸ºç©ºçš„åˆ™ä¸èƒ½ç”Ÿæˆæ³¨é‡Šï¼Œéœ€è¦ä¿®æ”¹ç”Ÿæˆè§„åˆ™ã€‚</li></ol><ul><li>é€‰æ‹©èœå•ï¼šdatabase -&gt; generate databaseâ€¦</li><li>é€‰æ‹©formaté€‰é¡¹å¡ï¼Œé€‰ä¸­â€generate name is empty commentâ€é€‰é¡¹</li><li>ç‚¹â€œåº”ç”¨â€æŒ‰é’®ä¿å­˜è®¾ç½®</li></ul><p>ç¬¬ä¸€æ¬¡å®ç°è¿™ç§æ•ˆæœï¼Œä¸æ˜¯é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæ¢äº†æ–°çš„æœºå™¨ä¹‹åï¼Œä¹‹å‰é‚£ç§æ–¹æ³•æ‰¾ä¸åˆ°äº†ï¼Œå°±é€šè¿‡æŸ¥æ‰¾èµ„æ–™ç”¨è¿™ç§æ–¹å¼å®ç°äº†</p>]]></content>
      
      
      
        <tags>
            
            <tag> PowerDesigner </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Snowflakeç®—æ³•ç”Ÿæˆåˆ†å¸ƒå¼ç³»ç»Ÿå”¯ä¸€ID</title>
      <link href="/post/4f74853e.html"/>
      <url>/post/4f74853e.html</url>
      
        <content type="html"><![CDATA[<p>åœ¨å¤æ‚çš„ç³»ç»Ÿä¸­å”¯ä¸€IDæ˜¯æˆ‘ä»¬åœ¨è®¾è®¡çš„æ—¶å€™å¸¸å¸¸ä¼šé‡è§çš„é—®é¢˜ï¼Œç”ŸæˆIDçš„æ–¹æ³•æœ‰å¾ˆå¤šï¼Œé€‚åº”ä¸åŒçš„åœºæ™¯ã€éœ€æ±‚ä»¥åŠæ€§èƒ½è¦æ±‚ã€‚æ‰€ä»¥æœ‰äº›æ¯”è¾ƒå¤æ‚çš„ç³»ç»Ÿä¼šæœ‰å¤šä¸ªIDç”Ÿæˆçš„ç­–ç•¥ï¼Œä¸‹é¢å°±ä»‹ç»ä¸€äº›å¸¸è§çš„IDç”Ÿæˆç­–ç•¥ã€‚</p><a id="more"></a><h4 id="1-æ•°æ®åº“è‡ªå¢é•¿åºåˆ—æˆ–å­—æ®µ"><a href="#1-æ•°æ®åº“è‡ªå¢é•¿åºåˆ—æˆ–å­—æ®µ" class="headerlink" title="1. æ•°æ®åº“è‡ªå¢é•¿åºåˆ—æˆ–å­—æ®µ"></a>1. æ•°æ®åº“è‡ªå¢é•¿åºåˆ—æˆ–å­—æ®µ</h4><p>æœ€å¸¸è§çš„æ–¹å¼ã€‚åˆ©ç”¨æ•°æ®åº“ï¼Œå…¨æ•°æ®åº“å”¯ä¸€ã€‚</p><p>ä¼˜ç‚¹ï¼š</p><ul><li><p>ç®€å•ï¼Œä»£ç æ–¹ä¾¿ï¼Œæ€§èƒ½å¯ä»¥æ¥å—ã€‚</p></li><li><p>æ•°å­—IDå¤©ç„¶æ’åºï¼Œå¯¹åˆ†é¡µæˆ–è€…éœ€è¦æ’åºçš„ç»“æœå¾ˆæœ‰å¸®åŠ©ã€‚</p></li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li><p>ä¸åŒæ•°æ®åº“è¯­æ³•å’Œå®ç°ä¸åŒï¼Œæ•°æ®åº“è¿ç§»çš„æ—¶å€™æˆ–å¤šæ•°æ®åº“ç‰ˆæœ¬æ”¯æŒçš„æ—¶å€™éœ€è¦å¤„ç†ã€‚</p></li><li><p>åœ¨å•ä¸ªæ•°æ®åº“æˆ–è¯»å†™åˆ†ç¦»æˆ–ä¸€ä¸»å¤šä»çš„æƒ…å†µä¸‹ï¼Œåªæœ‰ä¸€ä¸ªä¸»åº“å¯ä»¥ç”Ÿæˆã€‚æœ‰å•ç‚¹æ•…éšœçš„é£é™©ã€‚</p></li><li><p>åœ¨æ€§èƒ½è¾¾ä¸åˆ°è¦æ±‚çš„æƒ…å†µä¸‹ï¼Œæ¯”è¾ƒéš¾äºæ‰©å±•ã€‚</p></li><li><p>å¦‚æœé‡è§å¤šä¸ªç³»ç»Ÿéœ€è¦åˆå¹¶æˆ–è€…æ¶‰åŠåˆ°æ•°æ®è¿ç§»ä¼šç›¸å½“ç—›è‹¦ã€‚</p></li></ul><p>ä¼˜åŒ–æ–¹æ¡ˆï¼š</p><ul><li>é’ˆå¯¹ä¸»åº“å•ç‚¹ï¼Œå¦‚æœæœ‰å¤šä¸ªMasteråº“ï¼Œåˆ™æ¯ä¸ªMasteråº“è®¾ç½®çš„èµ·å§‹æ•°å­—ä¸ä¸€æ ·ï¼Œæ­¥é•¿ä¸€æ ·ï¼Œå¯ä»¥æ˜¯Masterçš„ä¸ªæ•°ã€‚æ¯”å¦‚ï¼šMaster1 ç”Ÿæˆçš„æ˜¯ 1ï¼Œ4ï¼Œ7ï¼Œ10ï¼ŒMaster2ç”Ÿæˆçš„æ˜¯2,5,8,11 Master3ç”Ÿæˆçš„æ˜¯ 3,6,9,12ã€‚è¿™æ ·å°±å¯ä»¥æœ‰æ•ˆç”Ÿæˆé›†ç¾¤ä¸­çš„å”¯ä¸€IDï¼Œä¹Ÿå¯ä»¥å¤§å¤§é™ä½IDç”Ÿæˆæ•°æ®åº“æ“ä½œçš„è´Ÿè½½ã€‚</li></ul><h4 id="2-UUID"><a href="#2-UUID" class="headerlink" title="2. UUID"></a>2. UUID</h4><p> UUID(Universally Unique Identifier)çš„æ ‡å‡†å‹å¼åŒ…å«32ä¸ª16è¿›åˆ¶æ•°å­—ï¼Œä»¥è¿å­—å·åˆ†ä¸ºäº”æ®µï¼Œå½¢å¼ä¸º8-4-4-4-12çš„36ä¸ªå­—ç¬¦ï¼Œç¤ºä¾‹ï¼š550e8400-e29b-41d4-a716-446655440000ï¼Œåˆ°ç›®å‰ä¸ºæ­¢ä¸šç•Œä¸€å…±æœ‰5ç§æ–¹å¼ç”ŸæˆUUIDã€‚</p><p>ä¼˜ç‚¹ï¼š</p><ul><li><p>ç®€å•ï¼Œä»£ç æ–¹ä¾¿ã€‚</p></li><li><p>ç”ŸæˆIDæ€§èƒ½éå¸¸å¥½ï¼ŒåŸºæœ¬ä¸ä¼šæœ‰æ€§èƒ½é—®é¢˜ï¼Œæœ¬åœ°ç”Ÿæˆï¼Œæ²¡æœ‰ç½‘ç»œæ¶ˆè€—ã€‚</p></li><li><p>å…¨çƒå”¯ä¸€ï¼Œåœ¨é‡è§æ•°æ®è¿ç§»ï¼Œç³»ç»Ÿæ•°æ®åˆå¹¶ï¼Œæˆ–è€…æ•°æ®åº“å˜æ›´ç­‰æƒ…å†µä¸‹ï¼Œå¯ä»¥ä»å®¹åº”å¯¹ã€‚</p></li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>ä¸æ˜“äºå­˜å‚¨ï¼ŒUUIDå¤ªé•¿ï¼Œ16å­—èŠ‚128ä½ï¼Œé€šå¸¸ä»¥36é•¿åº¦çš„å­—ç¬¦ä¸²è¡¨ç¤ºï¼Œå¾ˆå¤šåœºæ™¯ä¸é€‚ç”¨ã€‚MySQLå®˜æ–¹æœ‰æ˜ç¡®çš„å»ºè®®ä¸»é”®è¦å°½é‡è¶ŠçŸ­è¶Šå¥½</li><li>ä¿¡æ¯ä¸å®‰å…¨ï¼šåŸºäºMACåœ°å€ç”ŸæˆUUIDçš„ç®—æ³•å¯èƒ½ä¼šé€ æˆMACåœ°å€æ³„éœ²ï¼Œè¿™ä¸ªæ¼æ´æ›¾è¢«ç”¨äºå¯»æ‰¾æ¢…ä¸½èç—…æ¯’çš„åˆ¶ä½œè€…ä½ç½®ã€‚</li><li>ç”ŸæˆIDæ— åºå¯¹MySQLç´¢å¼•ä¸åˆ©ï¼šå¦‚æœä½œä¸ºæ•°æ®åº“ä¸»é”®ï¼Œåœ¨InnoDBå¼•æ“ä¸‹ï¼ŒUUIDçš„æ— åºæ€§å¯èƒ½ä¼šå¼•èµ·æ•°æ®ä½ç½®é¢‘ç¹å˜åŠ¨ï¼Œä¸¥é‡å½±å“æ€§èƒ½ã€‚</li></ul><h4 id="3-snowflakeæ–¹æ¡ˆ"><a href="#3-snowflakeæ–¹æ¡ˆ" class="headerlink" title="3. snowflakeæ–¹æ¡ˆ"></a>3. snowflakeæ–¹æ¡ˆ</h4><p>å¤§è‡´æ¥è¯´æ˜¯ä¸€ç§ä»¥åˆ’åˆ†å‘½åç©ºé—´ï¼ˆUUIDä¹Ÿç®—ï¼Œç”±äºæ¯”è¾ƒå¸¸è§ï¼Œæ‰€ä»¥å•ç‹¬åˆ†æï¼‰æ¥ç”ŸæˆIDçš„ä¸€ç§ç®—æ³•ï¼Œè¿™ç§æ–¹æ¡ˆæŠŠ64-bitåˆ†åˆ«åˆ’åˆ†æˆå¤šæ®µï¼Œåˆ†å¼€æ¥æ ‡ç¤ºæœºå™¨ã€æ—¶é—´ç­‰ï¼Œæ¯”å¦‚åœ¨snowflakeä¸­çš„64-bitåˆ†åˆ«è¡¨ç¤ºå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span> - <span class="number">0000000000</span> <span class="number">0000000000</span> <span class="number">0000000000</span> <span class="number">0000000000</span> <span class="number">0</span> - <span class="number">00000</span> - <span class="number">00000</span> - <span class="number">000000000000</span></span><br></pre></td></tr></table></figure><ul><li>1bit è¡¨ç¤ºç¬¦å·ä½ï¼Œè¡¨ç¤ºæ˜¯æ­£æ•°è¿˜æ˜¯è´Ÿæ•°ï¼Œè®¾ä¸ºæ­£æ•°å›ºå®šä¸º0</li><li>41bit çš„æ—¶é—´æˆ³ å¯ä»¥è¡¨ç¤º( 1L&lt;&lt;41 ) / ( 1000L * 3600 * 24 *365 )=69å¹´çš„æ—¶é—´ã€‚</li><li>10bitæœºå™¨å¯ä»¥åˆ†åˆ«è¡¨ç¤º1024å°æœºå™¨ã€‚å¦‚æœæˆ‘ä»¬å¯¹IDCåˆ’åˆ†æœ‰éœ€æ±‚ï¼Œè¿˜å¯ä»¥å°†10bitåˆ†5bitç»™IDCï¼Œåˆ†5bitç»™å·¥ä½œæœºå™¨ã€‚è¿™æ ·å°±å¯ä»¥è¡¨ç¤º32ä¸ªIDCï¼Œæ¯ä¸ªIDCä¸‹å¯ä»¥æœ‰32å°æœºå™¨ï¼Œå¯ä»¥æ ¹æ®è‡ªèº«éœ€æ±‚å®šä¹‰ã€‚</li><li>12bitå¯ä»¥è¡¨ç¤ºçš„æœ€å¤§æ­£æ•´æ•°æ˜¯2^12-1=4095ï¼Œå³å¯ä»¥ç”¨0ã€1ã€2ã€3ã€â€¦.4094è¿™4095ä¸ªæ•°å­—ï¼Œæ¥è¡¨ç¤ºåŒä¸€æœºå™¨åŒä¸€æ—¶é—´æˆªï¼ˆæ¯«ç§’)å†…äº§ç”Ÿçš„4095ä¸ªIDåºå·ï¼Œè¿™ç§åˆ†é…æ–¹å¼å¯ä»¥ä¿è¯åœ¨ä»»ä½•ä¸€ä¸ªIDCçš„ä»»ä½•ä¸€å°æœºå™¨åœ¨ä»»æ„æ¯«ç§’å†…ç”Ÿæˆçš„IDéƒ½æ˜¯ä¸åŒçš„ã€‚</li></ul><p>ä¼˜ç‚¹ï¼š</p><ul><li>æ¯«ç§’æ•°åœ¨é«˜ä½ï¼Œè‡ªå¢åºåˆ—åœ¨ä½ä½ï¼Œæ•´ä¸ªIDéƒ½æ˜¯è¶‹åŠ¿é€’å¢çš„ã€‚</li><li>ä¸ä¾èµ–æ•°æ®åº“ç­‰ç¬¬ä¸‰æ–¹ç³»ç»Ÿï¼Œä»¥æœåŠ¡çš„æ–¹å¼éƒ¨ç½²ï¼Œç¨³å®šæ€§æ›´é«˜ï¼Œç”ŸæˆIDçš„æ€§èƒ½ä¹Ÿæ˜¯éå¸¸é«˜çš„ã€‚</li><li>å¯ä»¥æ ¹æ®è‡ªèº«ä¸šåŠ¡ç‰¹æ€§åˆ†é…bitä½ï¼Œéå¸¸çµæ´»ã€‚</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>å¼ºä¾èµ–æœºå™¨æ—¶é’Ÿï¼Œåœ¨å•æœºä¸Šæ˜¯é€’å¢çš„ï¼Œä½†æ˜¯ç”±äºæ¶‰åŠåˆ°åˆ†å¸ƒå¼ç¯å¢ƒï¼Œæ¯å°æœºå™¨ä¸Šçš„æ—¶é’Ÿä¸å¯èƒ½å®Œå…¨åŒæ­¥ï¼Œè¿˜æœ‰é—°ç§’çš„å­˜åœ¨ï¼Œä¼šå¯¼è‡´é‡å¤æˆ–è€…æœåŠ¡ä¼šå¤„äºä¸å¯ç”¨çŠ¶æ€ã€‚</li></ul><p>é™„ä¸Šç›¸å…³çš„ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dm.tool.util;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é€šè¿‡ snowFlake é›ªèŠ±ç®—æ³•ç”Ÿæˆå”¯ä¸€ä¸”åœ¨æ—¶é—´æ®µå†…è¶‹åŠ¿é€’å¢çš„</span></span><br><span class="line"><span class="comment"> * åˆ†å¸ƒå¼ID</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Nick</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@projectName</span> dm-mt</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@package</span> com.dm.tool.util</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@createDate</span> 2019/01/17 09:17</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@updateDate</span> 2019/01/17 09:17</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SnowFlake</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> SnowFlake instance ;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * èµ·å§‹çš„æ—¶é—´æˆ³</span></span><br><span class="line"><span class="comment">     * ä» 2019/01/01 00:00:00 å¼€å§‹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">long</span> START_STMP = <span class="number">1546272000000L</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åºåˆ—å·å ç”¨çš„ä½æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">long</span> SEQUENCE_BIT = <span class="number">12</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æœºå™¨æ ‡è¯†å ç”¨çš„ä½æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">long</span> MACHINE_BIT = <span class="number">5</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ•°æ®ä¸­å¿ƒå ç”¨çš„ä½æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">long</span> DATACENTER_BIT = <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ¯ä¸€éƒ¨åˆ†çš„æœ€å¤§å€¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">long</span> MAX_DATACENTER_NUM = -<span class="number">1L</span> ^ (-<span class="number">1L</span> &lt;&lt; DATACENTER_BIT);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">long</span> MAX_MACHINE_NUM = -<span class="number">1L</span> ^ (-<span class="number">1L</span> &lt;&lt; MACHINE_BIT);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">long</span> MAX_SEQUENCE = -<span class="number">1L</span> ^ (-<span class="number">1L</span> &lt;&lt; SEQUENCE_BIT);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ¯ä¸€éƒ¨åˆ†å‘å·¦çš„ä½ç§»</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">long</span> MACHINE_LEFT = SEQUENCE_BIT;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">long</span> DATACENTER_LEFT = SEQUENCE_BIT + MACHINE_BIT;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">long</span> TIMESTMP_LEFT = DATACENTER_LEFT + DATACENTER_BIT;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ•°æ®ä¸­å¿ƒ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> datacenterId;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æœºå™¨æ ‡è¯†</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> machineId;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åºåˆ—å·</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> sequence = <span class="number">0L</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸Šä¸€æ¬¡æ—¶é—´æˆ³</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> lastStmp = -<span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> datacenterId æ•°æ®ä¸­å¿ƒID (0~31)</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> machineId  workerId å·¥ä½œID (0~31)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">SnowFlake</span><span class="params">(<span class="keyword">long</span> datacenterId, <span class="keyword">long</span> machineId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (datacenterId &gt; MAX_DATACENTER_NUM || datacenterId &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(String.format(<span class="string">"datacenterId can't be greater than %d or less than 0"</span>,MAX_DATACENTER_NUM));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (machineId &gt; MAX_MACHINE_NUM || machineId &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(String.format(<span class="string">"machineId can't be greater than %d or less than 0"</span>,MAX_MACHINE_NUM));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.datacenterId = datacenterId;</span><br><span class="line">        <span class="keyword">this</span>.machineId = machineId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SnowFlake <span class="title">getInstance</span><span class="params">(<span class="keyword">long</span> datacenterId, <span class="keyword">long</span> machineId)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (instance == <span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (SnowFlake<span class="class">.<span class="keyword">class</span>)</span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (instance == <span class="keyword">null</span>)&#123;</span><br><span class="line">                    instance = <span class="keyword">new</span> SnowFlake(datacenterId,machineId);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * äº§ç”Ÿä¸‹ä¸€ä¸ªID</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">synchronized</span> <span class="keyword">long</span> <span class="title">nextId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">long</span> currStmp = getNewTimestamp();</span><br><span class="line">        <span class="keyword">if</span> (currStmp &lt; lastStmp) &#123;</span><br><span class="line">            String msg = String.format(<span class="string">"Clock moved backwards. Refusing to generate id! currStmp=%d,lastStmp=%d"</span>,currStmp,lastStmp);</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(msg);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (currStmp == lastStmp) &#123;</span><br><span class="line">            <span class="comment">// ç›¸åŒæ¯«ç§’å†…ï¼Œåºåˆ—å·è‡ªå¢</span></span><br><span class="line">            sequence = (sequence + <span class="number">1</span>) &amp; MAX_SEQUENCE;</span><br><span class="line">            <span class="comment">// åŒä¸€æ¯«ç§’çš„åºåˆ—æ•°å·²ç»è¾¾åˆ°æœ€å¤§</span></span><br><span class="line">            <span class="keyword">if</span> (sequence == <span class="number">0L</span>) &#123;</span><br><span class="line">                currStmp = getNextMill();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// ä¸åŒæ¯«ç§’å†…ï¼Œåºåˆ—å·ç½®ä¸º0</span></span><br><span class="line">            sequence = <span class="number">0L</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        lastStmp = currStmp;</span><br><span class="line">        <span class="comment">// æ—¶é—´æˆ³ 41  æ•°æ®ä¸­å¿ƒ 5 æœºå™¨æ ‡è¯† 5 åºåˆ—å· 12</span></span><br><span class="line">        <span class="keyword">return</span> (currStmp - START_STMP) &lt;&lt; TIMESTMP_LEFT</span><br><span class="line">                | datacenterId &lt;&lt; DATACENTER_LEFT</span><br><span class="line">                | machineId &lt;&lt; MACHINE_LEFT</span><br><span class="line">                | sequence;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">long</span> <span class="title">getNextMill</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">long</span> mill = getNewTimestamp();</span><br><span class="line">        <span class="keyword">while</span> (mill &lt;= lastStmp) &#123;</span><br><span class="line">            mill = getNewTimestamp();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> mill;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">long</span> <span class="title">getNewTimestamp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> System.currentTimeMillis();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">long</span> <span class="title">getSequenceBit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> SEQUENCE_BIT;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">long</span> <span class="title">getMachineBit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> MACHINE_BIT;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">long</span> <span class="title">getDatacenterBit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> DATACENTER_BIT;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">long</span> <span class="title">getStartStmp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> START_STMP;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å·¥å…·ç±»å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dm.tool.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang.StringUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.math.BigInteger;</span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * snowFlakeå·¥å…·ç±»</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Nick</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@projectName</span> dm-mt</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@package</span> com.dm.tool.util</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@createDate</span> 2019/01/16 09:30</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@updateDate</span> 2019/01/16 09:30</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SnowFlakeIDUtil</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> radix = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ•°æ®ä¸­å¿ƒID 0ï¼Œæœºå™¨ID 0</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> datacenterId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> machineId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">long</span> <span class="title">getNextId</span><span class="params">(<span class="keyword">long</span> datacenterId, <span class="keyword">long</span> machineId)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> SnowFlake.getInstance(datacenterId,machineId).nextId();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å¾—è®¢å•IDç”Ÿæˆæ—¶çš„æ—¶é—´æˆ³</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">long</span> <span class="title">getIDTimestamp</span><span class="params">(<span class="keyword">long</span> id)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (id &gt;&gt; SnowFlake.getTimestmpLeft() &amp; ~(-<span class="number">1L</span> &lt;&lt; <span class="number">41</span>))+SnowFlake.getStartStmp();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–æ•°æ®ä¸­å¿ƒ ID</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">long</span> <span class="title">getDatacenterId</span><span class="params">(<span class="keyword">long</span> id)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> id &gt;&gt; SnowFlake.getDatacenterLeft() &amp; ~(-<span class="number">1L</span> &lt;&lt; SnowFlake.getDatacenterBit());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å¾—æœºå™¨ID</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">long</span> <span class="title">getMachineId</span><span class="params">(<span class="keyword">long</span> id)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> id &gt;&gt; SnowFlake.getMachineLeft() &amp; ~(-<span class="number">1L</span> &lt;&lt; SnowFlake.getMachineBit());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–åºåˆ—ID</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">long</span> <span class="title">getSequence</span><span class="params">(<span class="keyword">long</span> id)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id &amp; ~(-<span class="number">1L</span> &lt;&lt; SnowFlake.getSequenceBit());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        MyThread thread1 = <span class="keyword">new</span> MyThread();</span><br><span class="line">        MyThread thread2 = <span class="keyword">new</span> MyThread();</span><br><span class="line">        MyThread thread3 = <span class="keyword">new</span> MyThread();</span><br><span class="line">        MyThread thread4 = <span class="keyword">new</span> MyThread();</span><br><span class="line"></span><br><span class="line">        thread1.start();</span><br><span class="line">        thread2.start();</span><br><span class="line">        thread3.start();</span><br><span class="line">        thread4.start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">while</span> (<span class="keyword">true</span>)&#123;</span><br><span class="line">                <span class="keyword">long</span> id = SnowFlakeIDUtil.getNextId(<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">                System.out.println(<span class="string">"ID="</span>+id+<span class="string">"æ—¶é—´æˆ³= "</span>+getIDTimestamp(id)+<span class="string">" DatacenterId= "</span>+getDatacenterId(id)+<span class="string">" MachineId="</span>+getMachineId(id)+<span class="string">" Sequence="</span>+getSequence(id));</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> Snowflake </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨FastJsonè¿›è¡Œå¯¹è±¡å’ŒJSONè½¬æ¢å±æ€§å‘½åè§„åˆ™ä¸ºä¸‹åˆ’çº¿å’Œé©¼å³°çš„é—®é¢˜</title>
      <link href="/post/ff52aa1f.html"/>
      <url>/post/ff52aa1f.html</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨å¯¹æ¥æ”¯ä»˜å®ï¼Œåœ¨ç¼–å†™æ”¯ä»˜éœ€è¦çš„beançš„æ—¶å€™ï¼Œå‘ç°æ”¯ä»˜å®éœ€è¦ä¼ é€’çš„å‚æ•°å‘½åæ–¹å¼éƒ½æ˜¯ä¸‹åˆ’çº¿ï¼Œè‡ªå·±ideaåˆè£…äº†é˜¿é‡Œå·´å·´çš„ç¼–ç¨‹è§„çº¦ï¼Œä»£ç è€æ˜¯æœ‰é»„è‰²æç¤ºï¼Œæ˜¾å¾—ç‰¹åˆ«éš¾çœ‹ã€‚äºæ˜¯ä¹æˆ‘æŠŠå±æ€§æ”¹æˆäº†é©¼å³°çš„å‘½åæ–¹å¼ï¼Œç„¶åä¸‹æ„è¯†çš„åœ¨ä¸Šé¢åŠ äº†ä¸€ä¸ª@JsonPropertyæ³¨è§£å®ç°ç›¸äº’è½¬æ¢è¿‡ç¨‹ä¸­å±æ€§å‘½åæ–¹å¼ä¹Ÿèƒ½è‡ªåŠ¨è½¬æ¢ã€‚å¯æ˜¯æˆ‘è¿è¡Œä»£ç æ—¶å‘ç°ä»£ç æŠ¥é”™è¿è¡Œä¸èµ·æ¥äº†ã€‚ä¸»è¦ä»£ç å¦‚ä¸‹ï¼š</p><a id="more"></a><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AliPayParam</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@JsonProperty</span>(name=<span class="string">"out_trade_no"</span>)</span><br><span class="line">    <span class="keyword">private</span> String outTradeNo;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@JsonProperty</span>(name=<span class="string">"total_amount"</span>)</span><br><span class="line">    <span class="keyword">private</span> String totalAmount;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å…¬å…±å›ä¼ å‚æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@JsonProperty</span>(name=<span class="string">"passback_params"</span>)</span><br><span class="line">    <span class="keyword">private</span> String passbackParams;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String subject;</span><br><span class="line">    <span class="keyword">private</span> String body;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@JsonProperty</span>(name=<span class="string">"product_code"</span>)</span><br><span class="line">    <span class="keyword">private</span> String productCode;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¯¥å‚æ•°åœ¨è¯·æ±‚åˆ°æ”¯ä»˜å®æ—¶å¼€å§‹è®¡æ—¶,è¯¥ç¬”è®¢å•å…è®¸çš„æœ€æ™šä»˜æ¬¾æ—¶é—´ï¼Œé€¾æœŸå°†å…³é—­äº¤æ˜“ã€‚</span></span><br><span class="line"><span class="comment">     * å–å€¼èŒƒå›´ï¼š1mï½15dã€‚m-åˆ†é’Ÿï¼Œh-å°æ—¶ï¼Œd-å¤©ï¼Œ1c-å½“å¤©</span></span><br><span class="line"><span class="comment">     * ï¼ˆ1c-å½“å¤©çš„æƒ…å†µä¸‹ï¼Œæ— è®ºäº¤æ˜“ä½•æ—¶åˆ›å»ºï¼Œéƒ½åœ¨0ç‚¹å…³é—­ï¼‰ã€‚</span></span><br><span class="line"><span class="comment">     * è¯¥å‚æ•°æ•°å€¼ä¸æ¥å—å°æ•°ç‚¹ï¼Œ å¦‚ 1.5hï¼Œå¯è½¬æ¢ä¸º 90mã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@JsonProperty</span>(name=<span class="string">"timeout_express"</span>)</span><br><span class="line">    <span class="keyword">private</span> String timeoutExpress;</span><br><span class="line"></span><br><span class="line">ï½</span><br></pre></td></tr></table></figure><p>çªç„¶å‘ç°è¿™ä¸ª@JsonPropertyæ³¨è§£æ˜¯Springæ¡†æ¶è‡ªå¸¦jacksonçš„æ³¨è§£ï¼Œä¸æ˜¯é˜¿é‡ŒFastJsonçš„æ³¨è§£ï¼Œäºæ˜¯ä¹æˆ‘çœ‹äº†çœ‹æ‰¾åˆ°äº†ä¸‹é¢çš„è¿™ä¸ªæ³¨è§£ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> JSONField &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * config encode/decode ordinal</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@since</span> 1.1.42</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">// é…ç½®åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„é¡ºåºï¼Œ1.1.42ç‰ˆæœ¬ä¹‹åæ‰æ”¯æŒ</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">ordinal</span><span class="params">()</span> <span class="keyword">default</span> 0</span>;</span><br><span class="line">    <span class="comment">// æŒ‡å®šå­—æ®µçš„åç§°</span></span><br><span class="line">    <span class="function">String <span class="title">name</span><span class="params">()</span> <span class="keyword">default</span> ""</span>;</span><br><span class="line">    <span class="comment">// æŒ‡å®šå­—æ®µçš„æ ¼å¼ï¼Œå¯¹æ—¥æœŸæ ¼å¼æœ‰ç”¨</span></span><br><span class="line">    <span class="function">String <span class="title">format</span><span class="params">()</span> <span class="keyword">default</span> ""</span>;</span><br><span class="line">    <span class="comment">// æ˜¯å¦åºåˆ—åŒ–</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">serialize</span><span class="params">()</span> <span class="keyword">default</span> <span class="keyword">true</span></span>;</span><br><span class="line">    <span class="comment">// æ˜¯å¦ååºåˆ—åŒ–</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">deserialize</span><span class="params">()</span> <span class="keyword">default</span> <span class="keyword">true</span></span>;</span><br><span class="line"></span><br><span class="line">    SerializerFeature[] serialzeFeatures() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    Feature[] parseFeatures() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="function">String <span class="title">label</span><span class="params">()</span> <span class="keyword">default</span> ""</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@since</span> 1.2.12</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">jsonDirect</span><span class="params">()</span> <span class="keyword">default</span> <span class="keyword">false</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Serializer class to use for serializing associated value.</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@since</span> 1.2.16</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Class&lt;?&gt; serializeUsing() <span class="keyword">default</span> Void<span class="class">.<span class="keyword">class</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Deserializer class to use for deserializing associated value. </span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@since</span> 1.2.16 </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Class&lt;?&gt; deserializeUsing() <span class="keyword">default</span> Void<span class="class">.<span class="keyword">class</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@since</span> 1.2.21</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the alternative names of the field when it is deserialized</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String[] alternateNames() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@since</span> 1.2.31</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">unwrapped</span><span class="params">()</span> <span class="keyword">default</span> <span class="keyword">false</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çŸ¥é“è¿™ä¸ªæ³¨è§£ä¹‹åï¼ŒæŠŠ@JsonPropertyæ›¿æ¢æˆ@JSONFieldæ³¨è§£å°±è¡Œäº†ï¼Œè½¬æ¢æˆJsonå±æ€§åå°±ä¼šä»outTradeNoå˜æˆout_trade_no</p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> fastJson </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è°ˆè°ˆJavaé›†åˆArrayListæ‰©å®¹</title>
      <link href="/post/3d08b907.html"/>
      <url>/post/3d08b907.html</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸€-å…ˆä»-ArrayList-çš„æ„é€ å‡½æ•°è¯´èµ·"><a href="#ä¸€-å…ˆä»-ArrayList-çš„æ„é€ å‡½æ•°è¯´èµ·" class="headerlink" title="ä¸€ å…ˆä» ArrayList çš„æ„é€ å‡½æ•°è¯´èµ·"></a>ä¸€ å…ˆä» ArrayList çš„æ„é€ å‡½æ•°è¯´èµ·</h2><p><strong>ArrayListæœ‰ä¸‰ç§æ–¹å¼æ¥åˆå§‹åŒ–ï¼Œæ„é€ æ–¹æ³•æºç å¦‚ä¸‹ï¼š</strong></p><a id="more"></a><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * é»˜è®¤åˆå§‹å®¹é‡å¤§å°</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> DEFAULT_CAPACITY = <span class="number">10</span>;</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment">  *é»˜è®¤æ„é€ å‡½æ•°ï¼Œä½¿ç”¨åˆå§‹å®¹é‡10æ„é€ ä¸€ä¸ªç©ºåˆ—è¡¨(æ— å‚æ•°æ„é€ )</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="title">ArrayList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">     <span class="keyword">this</span>.elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA;</span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment">  * å¸¦åˆå§‹å®¹é‡å‚æ•°çš„æ„é€ å‡½æ•°ã€‚ï¼ˆç”¨æˆ·è‡ªå·±æŒ‡å®šå®¹é‡ï¼‰</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="title">ArrayList</span><span class="params">(<span class="keyword">int</span> initialCapacity)</span> </span>&#123;</span><br><span class="line">     <span class="keyword">if</span> (initialCapacity &gt; <span class="number">0</span>) &#123;<span class="comment">//åˆå§‹å®¹é‡å¤§äº0</span></span><br><span class="line">         <span class="comment">//åˆ›å»ºinitialCapacityå¤§å°çš„æ•°ç»„</span></span><br><span class="line">         <span class="keyword">this</span>.elementData = <span class="keyword">new</span> Object[initialCapacity];</span><br><span class="line">     &#125; <span class="keyword">else</span> <span class="keyword">if</span> (initialCapacity == <span class="number">0</span>) &#123;<span class="comment">//åˆå§‹å®¹é‡ç­‰äº0</span></span><br><span class="line">         <span class="comment">//åˆ›å»ºç©ºæ•°ç»„</span></span><br><span class="line">         <span class="keyword">this</span>.elementData = EMPTY_ELEMENTDATA;</span><br><span class="line">     &#125; <span class="keyword">else</span> &#123;<span class="comment">//åˆå§‹å®¹é‡å°äº0ï¼ŒæŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">         <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Illegal Capacity: "</span>+</span><br><span class="line">                                            initialCapacity);</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *æ„é€ åŒ…å«æŒ‡å®šcollectionå…ƒç´ çš„åˆ—è¡¨ï¼Œè¿™äº›å…ƒç´ åˆ©ç”¨è¯¥é›†åˆçš„è¿­ä»£å™¨æŒ‰é¡ºåºè¿”å›</span></span><br><span class="line"><span class="comment"> *å¦‚æœæŒ‡å®šçš„é›†åˆä¸ºnullï¼Œthrows NullPointerExceptionã€‚ </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">ArrayList</span><span class="params">(Collection&lt;? extends E&gt; c)</span> </span>&#123;</span><br><span class="line">     elementData = c.toArray();</span><br><span class="line">     <span class="keyword">if</span> ((size = elementData.length) != <span class="number">0</span>) &#123;</span><br><span class="line">         <span class="comment">// c.toArray might (incorrectly) not return Object[] (see 6260652)</span></span><br><span class="line">         <span class="keyword">if</span> (elementData.getClass() != Object[]<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">             <span class="title">elementData</span> </span>= Arrays.copyOf(elementData, size, Object[]<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">     &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">         <span class="comment">// replace with empty array.</span></span><br><span class="line">         <span class="keyword">this</span>.elementData = EMPTY_ELEMENTDATA;</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>ç»†å¿ƒçš„åŒå­¦ä¸€å®šä¼šå‘ç° ï¼š<strong>ä»¥æ— å‚æ•°æ„é€ æ–¹æ³•åˆ›å»º ArrayList æ—¶ï¼Œå®é™…ä¸Šåˆå§‹åŒ–èµ‹å€¼çš„æ˜¯ä¸€ä¸ªç©ºæ•°ç»„ã€‚å½“çœŸæ­£å¯¹æ•°ç»„è¿›è¡Œæ·»åŠ å…ƒç´ æ“ä½œæ—¶ï¼Œæ‰çœŸæ­£åˆ†é…å®¹é‡ã€‚å³å‘æ•°ç»„ä¸­æ·»åŠ ç¬¬ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œæ•°ç»„å®¹é‡æ‰©ä¸º10ã€‚</strong> ä¸‹é¢åœ¨æˆ‘ä»¬åˆ†æ ArrayList æ‰©å®¹æ—¶ä¼šé™åˆ°è¿™ä¸€ç‚¹å†…å®¹ï¼</p><h2 id="äºŒ-ä¸€æ­¥ä¸€æ­¥åˆ†æ-ArrayList-æ‰©å®¹æœºåˆ¶"><a href="#äºŒ-ä¸€æ­¥ä¸€æ­¥åˆ†æ-ArrayList-æ‰©å®¹æœºåˆ¶" class="headerlink" title="äºŒ ä¸€æ­¥ä¸€æ­¥åˆ†æ ArrayList æ‰©å®¹æœºåˆ¶"></a>äºŒ ä¸€æ­¥ä¸€æ­¥åˆ†æ ArrayList æ‰©å®¹æœºåˆ¶</h2><p>è¿™é‡Œä»¥æ— å‚æ„é€ å‡½æ•°åˆ›å»ºçš„ ArrayList ä¸ºä¾‹åˆ†æ</p><h3 id="1-å…ˆæ¥çœ‹-add-æ–¹æ³•"><a href="#1-å…ˆæ¥çœ‹-add-æ–¹æ³•" class="headerlink" title="1. å…ˆæ¥çœ‹ add æ–¹æ³•"></a>1. å…ˆæ¥çœ‹ <code>add</code> æ–¹æ³•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment">  * å°†æŒ‡å®šçš„å…ƒç´ è¿½åŠ åˆ°æ­¤åˆ—è¡¨çš„æœ«å°¾ã€‚ </span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line"><span class="comment">//æ·»åŠ å…ƒç´ ä¹‹å‰ï¼Œå…ˆè°ƒç”¨ensureCapacityInternalæ–¹æ³•</span></span><br><span class="line">     ensureCapacityInternal(size + <span class="number">1</span>);  <span class="comment">// Increments modCount!!</span></span><br><span class="line">     <span class="comment">//è¿™é‡Œçœ‹åˆ°ArrayListæ·»åŠ å…ƒç´ çš„å®è´¨å°±ç›¸å½“äºä¸ºæ•°ç»„èµ‹å€¼</span></span><br><span class="line">     elementData[size++] = e;</span><br><span class="line">     <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><h3 id="2-å†æ¥çœ‹çœ‹-ensureCapacityInternal-æ–¹æ³•"><a href="#2-å†æ¥çœ‹çœ‹-ensureCapacityInternal-æ–¹æ³•" class="headerlink" title="2. å†æ¥çœ‹çœ‹ ensureCapacityInternal() æ–¹æ³•"></a>2. å†æ¥çœ‹çœ‹ <code>ensureCapacityInternal()</code> æ–¹æ³•</h3><p>å¯ä»¥çœ‹åˆ° <code>add</code> æ–¹æ³• é¦–å…ˆè°ƒç”¨äº†<code>ensureCapacityInternal(size + 1)</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å¾—åˆ°æœ€å°æ‰©å®¹é‡</span></span><br><span class="line"> <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ensureCapacityInternal</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">     <span class="keyword">if</span> (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) &#123;</span><br><span class="line">           <span class="comment">// è·å–é»˜è®¤çš„å®¹é‡å’Œä¼ å…¥å‚æ•°çš„è¾ƒå¤§å€¼</span></span><br><span class="line">         minCapacity = Math.max(DEFAULT_CAPACITY, minCapacity);</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     ensureExplicitCapacity(minCapacity);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p><strong>å½“ è¦ add è¿›ç¬¬1ä¸ªå…ƒç´ æ—¶ï¼ŒminCapacityä¸º1ï¼Œåœ¨Math.max()æ–¹æ³•æ¯”è¾ƒåï¼ŒminCapacity ä¸º10ã€‚</strong></p><h3 id="3-ensureExplicitCapacity-æ–¹æ³•"><a href="#3-ensureExplicitCapacity-æ–¹æ³•" class="headerlink" title="3. ensureExplicitCapacity() æ–¹æ³•"></a>3. <code>ensureExplicitCapacity()</code> æ–¹æ³•</h3><p>å¦‚æœè°ƒç”¨ <code>ensureCapacityInternal()</code> æ–¹æ³•å°±ä¸€å®šä¼šè¿›è¿‡ï¼ˆæ‰§è¡Œï¼‰è¿™ä¸ªæ–¹æ³•ï¼Œä¸‹é¢æˆ‘ä»¬æ¥ç ”ç©¶ä¸€ä¸‹è¿™ä¸ªæ–¹æ³•çš„æºç ï¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ensureExplicitCapacity</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">      modCount++;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// overflow-conscious code</span></span><br><span class="line">      <span class="keyword">if</span> (minCapacity - elementData.length &gt; <span class="number">0</span>)</span><br><span class="line">          <span class="comment">//è°ƒç”¨growæ–¹æ³•è¿›è¡Œæ‰©å®¹ï¼Œè°ƒç”¨æ­¤æ–¹æ³•ä»£è¡¨å·²ç»å¼€å§‹æ‰©å®¹äº†</span></span><br><span class="line">          grow(minCapacity);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æ¥ä»”ç»†åˆ†æä¸€ä¸‹ï¼š</p><ul><li>å½“æˆ‘ä»¬è¦ add è¿›ç¬¬1ä¸ªå…ƒç´ åˆ° ArrayList æ—¶ï¼ŒelementData.length ä¸º0 ï¼ˆå› ä¸ºè¿˜æ˜¯ä¸€ä¸ªç©ºçš„ listï¼‰ï¼Œå› ä¸ºæ‰§è¡Œäº† <code>ensureCapacityInternal()</code> æ–¹æ³• ï¼Œæ‰€ä»¥ minCapacity æ­¤æ—¶ä¸º10ã€‚æ­¤æ—¶ï¼Œ<code>minCapacity - elementData.length &gt; 0</code>æˆç«‹ï¼Œæ‰€ä»¥ä¼šè¿›å…¥ <code>grow(minCapacity)</code> æ–¹æ³•ã€‚</li><li>å½“addç¬¬2ä¸ªå…ƒç´ æ—¶ï¼ŒminCapacity ä¸º2ï¼Œæ­¤æ—¶e lementData.length(å®¹é‡)åœ¨æ·»åŠ ç¬¬ä¸€ä¸ªå…ƒç´ åæ‰©å®¹æˆ 10 äº†ã€‚æ­¤æ—¶ï¼Œ<code>minCapacity - elementData.length &gt; 0</code> ä¸æˆç«‹ï¼Œæ‰€ä»¥ä¸ä¼šè¿›å…¥ ï¼ˆæ‰§è¡Œï¼‰<code>grow(minCapacity)</code> æ–¹æ³•ã€‚</li><li>æ·»åŠ ç¬¬3ã€4Â·Â·Â·åˆ°ç¬¬10ä¸ªå…ƒç´ æ—¶ï¼Œä¾ç„¶ä¸ä¼šæ‰§è¡Œgrowæ–¹æ³•ï¼Œæ•°ç»„å®¹é‡éƒ½ä¸º10ã€‚</li></ul><p>ç›´åˆ°æ·»åŠ ç¬¬11ä¸ªå…ƒç´ ï¼ŒminCapacity(ä¸º11)æ¯”elementData.lengthï¼ˆä¸º10ï¼‰è¦å¤§ã€‚è¿›å…¥growæ–¹æ³•è¿›è¡Œæ‰©å®¹ã€‚</p><h3 id="4-grow-æ–¹æ³•"><a href="#4-grow-æ–¹æ³•" class="headerlink" title="4. grow() æ–¹æ³•"></a>4. <code>grow()</code> æ–¹æ³•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è¦åˆ†é…çš„æœ€å¤§æ•°ç»„å¤§å°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MAX_ARRAY_SIZE = Integer.MAX_VALUE - <span class="number">8</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ArrayListæ‰©å®¹çš„æ ¸å¿ƒæ–¹æ³•ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">grow</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// oldCapacityä¸ºæ—§å®¹é‡ï¼ŒnewCapacityä¸ºæ–°å®¹é‡</span></span><br><span class="line">    <span class="keyword">int</span> oldCapacity = elementData.length;</span><br><span class="line">    <span class="comment">//å°†oldCapacity å³ç§»ä¸€ä½ï¼Œå…¶æ•ˆæœç›¸å½“äºoldCapacity /2ï¼Œ</span></span><br><span class="line">    <span class="comment">//æˆ‘ä»¬çŸ¥é“ä½è¿ç®—çš„é€Ÿåº¦è¿œè¿œå¿«äºæ•´é™¤è¿ç®—ï¼Œæ•´å¥è¿ç®—å¼çš„ç»“æœå°±æ˜¯å°†æ–°å®¹é‡æ›´æ–°ä¸ºæ—§å®¹é‡çš„1.5å€ï¼Œ</span></span><br><span class="line">    <span class="keyword">int</span> newCapacity = oldCapacity + (oldCapacity &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    <span class="comment">//ç„¶åæ£€æŸ¥æ–°å®¹é‡æ˜¯å¦å¤§äºæœ€å°éœ€è¦å®¹é‡ï¼Œè‹¥è¿˜æ˜¯å°äºæœ€å°éœ€è¦å®¹é‡ï¼Œé‚£ä¹ˆå°±æŠŠæœ€å°éœ€è¦å®¹é‡å½“ä½œæ•°ç»„çš„æ–°å®¹é‡ï¼Œ</span></span><br><span class="line">    <span class="keyword">if</span> (newCapacity - minCapacity &lt; <span class="number">0</span>)</span><br><span class="line">        newCapacity = minCapacity;</span><br><span class="line">   <span class="comment">// å¦‚æœæ–°å®¹é‡å¤§äº MAX_ARRAY_SIZE,è¿›å…¥(æ‰§è¡Œ) `hugeCapacity()` æ–¹æ³•æ¥æ¯”è¾ƒ minCapacity å’Œ MAX_ARRAY_SIZEï¼Œ</span></span><br><span class="line">   <span class="comment">//å¦‚æœminCapacityå¤§äºæœ€å¤§å®¹é‡ï¼Œåˆ™æ–°å®¹é‡åˆ™ä¸º`Integer.MAX_VALUE`ï¼Œå¦åˆ™ï¼Œæ–°å®¹é‡å¤§å°åˆ™ä¸º MAX_ARRAY_SIZE å³ä¸º `Integer.MAX_VALUE - 8`ã€‚</span></span><br><span class="line">    <span class="keyword">if</span> (newCapacity - MAX_ARRAY_SIZE &gt; <span class="number">0</span>)</span><br><span class="line">        newCapacity = hugeCapacity(minCapacity);</span><br><span class="line">    <span class="comment">// minCapacity is usually close to size, so this is a win:</span></span><br><span class="line">    elementData = Arrays.copyOf(elementData, newCapacity);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>int newCapacity = oldCapacity + (oldCapacity &gt;&gt; 1),æ‰€ä»¥ ArrayList æ¯æ¬¡æ‰©å®¹ä¹‹åå®¹é‡éƒ½ä¼šå˜ä¸ºåŸæ¥çš„ 1.5 å€ï¼</strong>  è®°æ¸…æ¥šäº†ï¼ä¸æ˜¯ç½‘ä¸Šå¾ˆå¤šäººè¯´çš„ 1.5 å€+1ï¼</p><blockquote><p>  â€œ&gt;&gt;â€ï¼ˆç§»ä½è¿ç®—ç¬¦ï¼‰ï¼š&gt;&gt;1 å³ç§»ä¸€ä½ç›¸å½“äºé™¤2ï¼Œå³ç§»nä½ç›¸å½“äºé™¤ä»¥ 2 çš„ n æ¬¡æ–¹ã€‚è¿™é‡Œ oldCapacity æ˜æ˜¾å³ç§»äº†1ä½æ‰€ä»¥ç›¸å½“äºoldCapacity /2ã€‚å¯¹äºå¤§æ•°æ®çš„2è¿›åˆ¶è¿ç®—,ä½ç§»è¿ç®—ç¬¦æ¯”é‚£äº›æ™®é€šè¿ç®—ç¬¦çš„è¿ç®—è¦å¿«å¾ˆå¤š,å› ä¸ºç¨‹åºä»…ä»…ç§»åŠ¨ä¸€ä¸‹è€Œå·²,ä¸å»è®¡ç®—,è¿™æ ·æé«˜äº†æ•ˆç‡,èŠ‚çœäº†èµ„æº ã€€</p></blockquote><p><strong>æˆ‘ä»¬å†æ¥é€šè¿‡ä¾‹å­æ¢ç©¶ä¸€ä¸‹<code>grow()</code> æ–¹æ³• ï¼š</strong></p><ul><li>å½“addç¬¬1ä¸ªå…ƒç´ æ—¶ï¼ŒoldCapacity ä¸º0ï¼Œç»æ¯”è¾ƒåç¬¬ä¸€ä¸ªifåˆ¤æ–­æˆç«‹ï¼ŒnewCapacity = minCapacity(ä¸º10)ã€‚ä½†æ˜¯ç¬¬äºŒä¸ªifåˆ¤æ–­ä¸ä¼šæˆç«‹ï¼Œå³newCapacity ä¸æ¯” MAX_ARRAY_SIZEå¤§ï¼Œåˆ™ä¸ä¼šè¿›å…¥ <code>hugeCapacity</code> æ–¹æ³•ã€‚æ•°ç»„å®¹é‡ä¸º10ï¼Œaddæ–¹æ³•ä¸­ return true,sizeå¢ä¸º1ã€‚</li><li>å½“addç¬¬11ä¸ªå…ƒç´ è¿›å…¥growæ–¹æ³•æ—¶ï¼ŒnewCapacityä¸º15ï¼Œæ¯”minCapacityï¼ˆä¸º11ï¼‰å¤§ï¼Œç¬¬ä¸€ä¸ªifåˆ¤æ–­ä¸æˆç«‹ã€‚æ–°å®¹é‡æ²¡æœ‰å¤§äºæ•°ç»„æœ€å¤§sizeï¼Œä¸ä¼šè¿›å…¥hugeCapacityæ–¹æ³•ã€‚æ•°ç»„å®¹é‡æ‰©ä¸º15ï¼Œaddæ–¹æ³•ä¸­return true,sizeå¢ä¸º11ã€‚</li><li>ä»¥æ­¤ç±»æ¨Â·Â·Â·Â·Â·Â·</li></ul><p><strong>è¿™é‡Œè¡¥å……ä¸€ç‚¹æ¯”è¾ƒé‡è¦ï¼Œä½†æ˜¯å®¹æ˜“è¢«å¿½è§†æ‰çš„çŸ¥è¯†ç‚¹ï¼š</strong></p><ul><li>java ä¸­çš„ <code>length</code>å±æ€§æ˜¯é’ˆå¯¹æ•°ç»„è¯´çš„,æ¯”å¦‚è¯´ä½ å£°æ˜äº†ä¸€ä¸ªæ•°ç»„,æƒ³çŸ¥é“è¿™ä¸ªæ•°ç»„çš„é•¿åº¦åˆ™ç”¨åˆ°äº† length è¿™ä¸ªå±æ€§.</li><li>java ä¸­çš„ <code>length()</code> æ–¹æ³•æ˜¯é’ˆå¯¹å­—ç¬¦ä¸²è¯´çš„,å¦‚æœæƒ³çœ‹è¿™ä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦åˆ™ç”¨åˆ° <code>length()</code> è¿™ä¸ªæ–¹æ³•.</li><li>java ä¸­çš„ <code>size()</code> æ–¹æ³•æ˜¯é’ˆå¯¹æ³›å‹é›†åˆè¯´çš„,å¦‚æœæƒ³çœ‹è¿™ä¸ªæ³›å‹æœ‰å¤šå°‘ä¸ªå…ƒç´ ,å°±è°ƒç”¨æ­¤æ–¹æ³•æ¥æŸ¥çœ‹!</li></ul><h3 id="5-hugeCapacity-æ–¹æ³•ã€‚"><a href="#5-hugeCapacity-æ–¹æ³•ã€‚" class="headerlink" title="5. hugeCapacity() æ–¹æ³•ã€‚"></a>5. <code>hugeCapacity()</code> æ–¹æ³•ã€‚</h3><p>ä»ä¸Šé¢ <code>grow()</code> æ–¹æ³•æºç æˆ‘ä»¬çŸ¥é“ï¼š å¦‚æœæ–°å®¹é‡å¤§äº MAX_ARRAY_SIZE,è¿›å…¥(æ‰§è¡Œ) <code>hugeCapacity()</code> æ–¹æ³•æ¥æ¯”è¾ƒ minCapacity å’Œ MAX_ARRAY_SIZEï¼Œå¦‚æœminCapacityå¤§äºæœ€å¤§å®¹é‡ï¼Œåˆ™æ–°å®¹é‡åˆ™ä¸º<code>Integer.MAX_VALUE</code>ï¼Œå¦åˆ™ï¼Œæ–°å®¹é‡å¤§å°åˆ™ä¸º MAX_ARRAY_SIZE å³ä¸º <code>Integer.MAX_VALUE - 8</code>ã€‚ </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">hugeCapacity</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (minCapacity &lt; <span class="number">0</span>) <span class="comment">// overflow</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> OutOfMemoryError();</span><br><span class="line">    <span class="comment">//å¯¹minCapacityå’ŒMAX_ARRAY_SIZEè¿›è¡Œæ¯”è¾ƒ</span></span><br><span class="line">    <span class="comment">//è‹¥minCapacityå¤§ï¼Œå°†Integer.MAX_VALUEä½œä¸ºæ–°æ•°ç»„çš„å¤§å°</span></span><br><span class="line">    <span class="comment">//è‹¥MAX_ARRAY_SIZEå¤§ï¼Œå°†MAX_ARRAY_SIZEä½œä¸ºæ–°æ•°ç»„çš„å¤§å°</span></span><br><span class="line">    <span class="comment">//MAX_ARRAY_SIZE = Integer.MAX_VALUE - 8;</span></span><br><span class="line">    <span class="keyword">return</span> (minCapacity &gt; MAX_ARRAY_SIZE) ?</span><br><span class="line">        Integer.MAX_VALUE :</span><br><span class="line">        MAX_ARRAY_SIZE;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¸‰-System-arraycopy-å’Œ-Arrays-copyOf-æ–¹æ³•"><a href="#ä¸‰-System-arraycopy-å’Œ-Arrays-copyOf-æ–¹æ³•" class="headerlink" title="ä¸‰ System.arraycopy() å’Œ Arrays.copyOf()æ–¹æ³•"></a>ä¸‰ <code>System.arraycopy()</code> å’Œ <code>Arrays.copyOf()</code>æ–¹æ³•</h2><p>é˜…è¯»æºç çš„è¯ï¼Œæˆ‘ä»¬å°±ä¼šå‘ç° ArrayList ä¸­å¤§é‡è°ƒç”¨äº†è¿™ä¸¤ä¸ªæ–¹æ³•ã€‚æ¯”å¦‚ï¼šæˆ‘ä»¬ä¸Šé¢è®²çš„æ‰©å®¹æ“ä½œä»¥åŠ<code>add(int index, E element)</code>ã€<code>toArray()</code> ç­‰æ–¹æ³•ä¸­éƒ½ç”¨åˆ°äº†è¯¥æ–¹æ³•ï¼</p><h3 id="3-1-System-arraycopy-æ–¹æ³•"><a href="#3-1-System-arraycopy-æ–¹æ³•" class="headerlink" title="3.1 System.arraycopy() æ–¹æ³•"></a>3.1 <code>System.arraycopy()</code> æ–¹æ³•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åœ¨æ­¤åˆ—è¡¨ä¸­çš„æŒ‡å®šä½ç½®æ’å…¥æŒ‡å®šçš„å…ƒç´ ã€‚ </span></span><br><span class="line"><span class="comment"> *å…ˆè°ƒç”¨ rangeCheckForAdd å¯¹indexè¿›è¡Œç•Œé™æ£€æŸ¥ï¼›ç„¶åè°ƒç”¨ ensureCapacityInternal æ–¹æ³•ä¿è¯capacityè¶³å¤Ÿå¤§ï¼›</span></span><br><span class="line"><span class="comment"> *å†å°†ä»indexå¼€å§‹ä¹‹åçš„æ‰€æœ‰æˆå‘˜åç§»ä¸€ä¸ªä½ç½®ï¼›å°†elementæ’å…¥indexä½ç½®ï¼›æœ€åsizeåŠ 1ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> index, E element)</span> </span>&#123;</span><br><span class="line">    rangeCheckForAdd(index);</span><br><span class="line"></span><br><span class="line">    ensureCapacityInternal(size + <span class="number">1</span>);  <span class="comment">// Increments modCount!!</span></span><br><span class="line">    <span class="comment">//arraycopy()æ–¹æ³•å®ç°æ•°ç»„è‡ªå·±å¤åˆ¶è‡ªå·±</span></span><br><span class="line">    <span class="comment">//elementData:æºæ•°ç»„;index:æºæ•°ç»„ä¸­çš„èµ·å§‹ä½ç½®;elementDataï¼šç›®æ ‡æ•°ç»„ï¼›index + 1ï¼šç›®æ ‡æ•°ç»„ä¸­çš„èµ·å§‹ä½ç½®ï¼› size - indexï¼šè¦å¤åˆ¶çš„æ•°ç»„å…ƒç´ çš„æ•°é‡ï¼›</span></span><br><span class="line">    System.arraycopy(elementData, index, elementData, index + <span class="number">1</span>, size - index);</span><br><span class="line">    elementData[index] = element;</span><br><span class="line">    size++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å†™ä¸€ä¸ªç®€å•çš„æ–¹æ³•æµ‹è¯•ä»¥ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArraycopyTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"><span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line"><span class="keyword">int</span>[] a = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">10</span>];</span><br><span class="line">a[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">a[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">a[<span class="number">2</span>] = <span class="number">2</span>;</span><br><span class="line">a[<span class="number">3</span>] = <span class="number">3</span>;</span><br><span class="line">System.arraycopy(a, <span class="number">2</span>, a, <span class="number">3</span>, <span class="number">3</span>);</span><br><span class="line">a[<span class="number">2</span>]=<span class="number">99</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; a.length; i++) &#123;</span><br><span class="line">System.out.println(a[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0 1 99 2 3 0 0 0 0 0</span><br></pre></td></tr></table></figure><h3 id="3-2-Arrays-copyOf-æ–¹æ³•"><a href="#3-2-Arrays-copyOf-æ–¹æ³•" class="headerlink" title="3.2 Arrays.copyOf()æ–¹æ³•"></a>3.2 <code>Arrays.copyOf()</code>æ–¹æ³•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  ä»¥æ­£ç¡®çš„é¡ºåºè¿”å›ä¸€ä¸ªåŒ…å«æ­¤åˆ—è¡¨ä¸­æ‰€æœ‰å…ƒç´ çš„æ•°ç»„ï¼ˆä»ç¬¬ä¸€ä¸ªåˆ°æœ€åä¸€ä¸ªå…ƒç´ ï¼‰; è¿”å›çš„æ•°ç»„çš„è¿è¡Œæ—¶ç±»å‹æ˜¯æŒ‡å®šæ•°ç»„çš„è¿è¡Œæ—¶ç±»å‹ã€‚ </span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> <span class="keyword">public</span> Object[] toArray() &#123;</span><br><span class="line"> <span class="comment">//elementDataï¼šè¦å¤åˆ¶çš„æ•°ç»„ï¼›sizeï¼šè¦å¤åˆ¶çš„é•¿åº¦</span></span><br><span class="line">     <span class="keyword">return</span> Arrays.copyOf(elementData, size);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>ä¸ªäººè§‰å¾—ä½¿ç”¨ <code>Arrays.copyOf()</code>æ–¹æ³•ä¸»è¦æ˜¯ä¸ºäº†ç»™åŸæœ‰æ•°ç»„æ‰©å®¹ï¼Œæµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArrayscopyOfTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span>[] a = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">3</span>];</span><br><span class="line">a[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">a[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">a[<span class="number">2</span>] = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">int</span>[] b = Arrays.copyOf(a, <span class="number">10</span>);</span><br><span class="line">System.out.println(<span class="string">"b.length"</span>+b.length);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10</span><br></pre></td></tr></table></figure><h3 id="3-3-ä¸¤è€…è”ç³»å’ŒåŒºåˆ«"><a href="#3-3-ä¸¤è€…è”ç³»å’ŒåŒºåˆ«" class="headerlink" title="3.3 ä¸¤è€…è”ç³»å’ŒåŒºåˆ«"></a>3.3 ä¸¤è€…è”ç³»å’ŒåŒºåˆ«</h3><p><strong>è”ç³»ï¼š</strong> </p><p>çœ‹ä¸¤è€…æºä»£ç å¯ä»¥å‘ç° copyOf() å†…éƒ¨å®é™…è°ƒç”¨äº† <code>System.arraycopy()</code> æ–¹æ³• </p><p><strong>åŒºåˆ«ï¼š</strong></p><p><code>arraycopy()</code> éœ€è¦ç›®æ ‡æ•°ç»„ï¼Œå°†åŸæ•°ç»„æ‹·è´åˆ°ä½ è‡ªå·±å®šä¹‰çš„æ•°ç»„é‡Œæˆ–è€…åŸæ•°ç»„ï¼Œè€Œä¸”å¯ä»¥é€‰æ‹©æ‹·è´çš„èµ·ç‚¹å’Œé•¿åº¦ä»¥åŠæ”¾å…¥æ–°æ•°ç»„ä¸­çš„ä½ç½® <code>copyOf()</code> æ˜¯ç³»ç»Ÿè‡ªåŠ¨åœ¨å†…éƒ¨æ–°å»ºä¸€ä¸ªæ•°ç»„ï¼Œå¹¶è¿”å›è¯¥æ•°ç»„ã€‚</p><h2 id="å››-ensureCapacityæ–¹æ³•"><a href="#å››-ensureCapacityæ–¹æ³•" class="headerlink" title="å›› ensureCapacityæ–¹æ³•"></a>å›› <code>ensureCapacity</code>æ–¹æ³•</h2><p>ArrayList æºç ä¸­æœ‰ä¸€ä¸ª <code>ensureCapacity</code> æ–¹æ³•ä¸çŸ¥é“å¤§å®¶æ³¨æ„åˆ°æ²¡æœ‰ï¼Œè¿™ä¸ªæ–¹æ³• ArrayList å†…éƒ¨æ²¡æœ‰è¢«è°ƒç”¨è¿‡ï¼Œæ‰€ä»¥å¾ˆæ˜¾ç„¶æ˜¯æä¾›ç»™ç”¨æˆ·è°ƒç”¨çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•æœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">å¦‚æœ‰å¿…è¦ï¼Œå¢åŠ æ­¤ ArrayList å®ä¾‹çš„å®¹é‡ï¼Œä»¥ç¡®ä¿å®ƒè‡³å°‘å¯ä»¥å®¹çº³ç”±minimum capacityå‚æ•°æŒ‡å®šçš„å…ƒç´ æ•°ã€‚</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span>   minCapacity   æ‰€éœ€çš„æœ€å°å®¹é‡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ensureCapacity</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> minExpand = (elementData != DEFAULTCAPACITY_EMPTY_ELEMENTDATA)</span><br><span class="line">        <span class="comment">// any size if not default element table</span></span><br><span class="line">        ? <span class="number">0</span></span><br><span class="line">        <span class="comment">// larger than default for default empty table. It's already</span></span><br><span class="line">        <span class="comment">// supposed to be at default size.</span></span><br><span class="line">        : DEFAULT_CAPACITY;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (minCapacity &gt; minExpand) &#123;</span><br><span class="line">        ensureExplicitCapacity(minCapacity);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æœ€å¥½åœ¨ add å¤§é‡å…ƒç´ ä¹‹å‰ç”¨ <code>ensureCapacity</code> æ–¹æ³•ï¼Œä»¥å‡å°‘å¢é‡ä»æ–°åˆ†é…çš„æ¬¡æ•°</strong></p><p>æˆ‘ä»¬é€šè¿‡ä¸‹é¢çš„ä»£ç å®é™…æµ‹è¯•ä»¥ä¸‹è¿™ä¸ªæ–¹æ³•çš„æ•ˆæœï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EnsureCapacityTest</span> </span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">ArrayList&lt;Object&gt; list = <span class="keyword">new</span> ArrayList&lt;Object&gt;();</span><br><span class="line"><span class="keyword">final</span> <span class="keyword">int</span> N = <span class="number">10000000</span>;</span><br><span class="line"><span class="keyword">long</span> startTime = System.currentTimeMillis();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) &#123;</span><br><span class="line">list.add(i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">long</span> endTime = System.currentTimeMillis();</span><br><span class="line">System.out.println(<span class="string">"ä½¿ç”¨ensureCapacityæ–¹æ³•å‰ï¼š"</span>+(endTime - startTime));</span><br><span class="line"></span><br><span class="line">list = <span class="keyword">new</span> ArrayList&lt;Object&gt;();</span><br><span class="line"><span class="keyword">long</span> startTime1 = System.currentTimeMillis();</span><br><span class="line">list.ensureCapacity(N);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) &#123;</span><br><span class="line">list.add(i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">long</span> endTime1 = System.currentTimeMillis();</span><br><span class="line">System.out.println(<span class="string">"ä½¿ç”¨ensureCapacityæ–¹æ³•åï¼š"</span>+(endTime1 - startTime1));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ä½¿ç”¨ensureCapacityæ–¹æ³•å‰ï¼š4637</span><br><span class="line">ä½¿ç”¨ensureCapacityæ–¹æ³•åï¼š241</span><br></pre></td></tr></table></figure><p>é€šè¿‡è¿è¡Œç»“æœï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ˜æ˜¾çš„çœ‹å‡ºå‘ ArrayList æ·»åŠ å¤§é‡å…ƒç´ ä¹‹å‰æœ€å¥½å…ˆä½¿ç”¨<code>ensureCapacity</code> æ–¹æ³•ï¼Œä»¥å‡å°‘å¢é‡ä»æ–°åˆ†é…çš„æ¬¡æ•°</p><p><a href="https://github.com/Snailclimb/JavaGuide" target="_blank" rel="noopener">æŸ¥çœ‹åŸæ–‡</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> arrayList </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è°ˆè°ˆJavaé›†åˆArrayList</title>
      <link href="/post/e6d29090.html"/>
      <url>/post/e6d29090.html</url>
      
        <content type="html"><![CDATA[<ul><li><a href="#arraylistç®€ä»‹">ArrayListç®€ä»‹</a></li><li><a href="#arraylistæ ¸å¿ƒæºç ">ArrayListæ ¸å¿ƒæºç </a></li><li><a href="#arraylistæºç åˆ†æ">ArrayListæºç åˆ†æ</a><ul><li><a href="#systemarraycopyå’Œarrayscopyofæ–¹æ³•">System.arraycopy()å’ŒArrays.copyOf()æ–¹æ³•</a><ul><li><a href="#ä¸¤è€…è”ç³»ä¸åŒºåˆ«">ä¸¤è€…è”ç³»ä¸åŒºåˆ«</a></li></ul></li><li><a href="#arraylistæ ¸å¿ƒæ‰©å®¹æŠ€æœ¯">ArrayListæ ¸å¿ƒæ‰©å®¹æŠ€æœ¯</a></li><li><a href="#å†…éƒ¨ç±»">å†…éƒ¨ç±»</a></li></ul></li><li><a href="#arraylistç»å…¸demo">ArrayListç»å…¸Demo</a></li></ul><h3 id="ArrayListç®€ä»‹"><a href="#ArrayListç®€ä»‹" class="headerlink" title="ArrayListç®€ä»‹"></a>ArrayListç®€ä»‹</h3><p>ã€€ã€€ArrayList çš„åº•å±‚æ˜¯æ•°ç»„é˜Ÿåˆ—ï¼Œç›¸å½“äºåŠ¨æ€æ•°ç»„ã€‚ä¸ Java ä¸­çš„æ•°ç»„ç›¸æ¯”ï¼Œå®ƒçš„å®¹é‡èƒ½åŠ¨æ€å¢é•¿ã€‚åœ¨æ·»åŠ å¤§é‡å…ƒç´ å‰ï¼Œåº”ç”¨ç¨‹åºå¯ä»¥ä½¿ç”¨<code>ensureCapacity</code>æ“ä½œæ¥å¢åŠ  ArrayList å®ä¾‹çš„å®¹é‡ã€‚è¿™å¯ä»¥å‡å°‘é€’å¢å¼å†åˆ†é…çš„æ•°é‡ã€‚</p><a id="more"></a><p>   å®ƒç»§æ‰¿äº <strong>AbstractList</strong>ï¼Œå®ç°äº† <strong>List</strong>, <strong>RandomAccess</strong>, <strong>Cloneable</strong>, <strong>java.io.Serializable</strong> è¿™äº›æ¥å£ã€‚</p><p>   åœ¨æˆ‘ä»¬å­¦æ•°æ®ç»“æ„çš„æ—¶å€™å°±çŸ¥é“äº†çº¿æ€§è¡¨çš„é¡ºåºå­˜å‚¨ï¼Œæ’å…¥åˆ é™¤å…ƒç´ çš„æ—¶é—´å¤æ‚åº¦ä¸º<strong>Oï¼ˆnï¼‰</strong>,æ±‚è¡¨é•¿ä»¥åŠå¢åŠ å…ƒç´ ï¼Œå–ç¬¬ i   å…ƒç´ çš„æ—¶é—´å¤æ‚åº¦ä¸º<strong>Oï¼ˆ1ï¼‰</strong></p><p>ã€€  ArrayList ç»§æ‰¿äº†AbstractListï¼Œå®ç°äº†Listã€‚å®ƒæ˜¯ä¸€ä¸ªæ•°ç»„é˜Ÿåˆ—ï¼Œæä¾›äº†ç›¸å…³çš„æ·»åŠ ã€åˆ é™¤ã€ä¿®æ”¹ã€éå†ç­‰åŠŸèƒ½ã€‚</p><p>ã€€ã€€ArrayList å®ç°äº†<strong>RandomAccess æ¥å£</strong>ï¼Œå³æä¾›äº†éšæœºè®¿é—®åŠŸèƒ½ã€‚RandomAccess æ˜¯ Java ä¸­ç”¨æ¥è¢« List å®ç°ï¼Œä¸º List æä¾›<strong>å¿«é€Ÿè®¿é—®åŠŸèƒ½</strong>çš„ã€‚åœ¨ ArrayList ä¸­ï¼Œæˆ‘ä»¬å³å¯ä»¥é€šè¿‡å…ƒç´ çš„åºå·å¿«é€Ÿè·å–å…ƒç´ å¯¹è±¡ï¼Œè¿™å°±æ˜¯å¿«é€Ÿéšæœºè®¿é—®ã€‚</p><p>ã€€ã€€ArrayList å®ç°äº†<strong>Cloneable æ¥å£</strong>ï¼Œå³è¦†ç›–äº†å‡½æ•° clone()ï¼Œ<strong>èƒ½è¢«å…‹éš†</strong>ã€‚</p><p>ã€€ã€€ArrayList å®ç°<strong>java.io.Serializable æ¥å£</strong>ï¼Œè¿™æ„å‘³ç€ArrayList<strong>æ”¯æŒåºåˆ—åŒ–</strong>ï¼Œ<strong>èƒ½é€šè¿‡åºåˆ—åŒ–å»ä¼ è¾“</strong>ã€‚</p><p>ã€€ã€€å’Œ Vector ä¸åŒï¼Œ<strong>ArrayList ä¸­çš„æ“ä½œä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„</strong>ï¼æ‰€ä»¥ï¼Œå»ºè®®åœ¨å•çº¿ç¨‹ä¸­æ‰ä½¿ç”¨ ArrayListï¼Œè€Œåœ¨å¤šçº¿ç¨‹ä¸­å¯ä»¥é€‰æ‹© Vector æˆ–è€…  CopyOnWriteArrayListã€‚</p><h3 id="ArrayListæ ¸å¿ƒæºç "><a href="#ArrayListæ ¸å¿ƒæºç " class="headerlink" title="ArrayListæ ¸å¿ƒæºç "></a>ArrayListæ ¸å¿ƒæºç </h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> java.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.function.Consumer;</span><br><span class="line"><span class="keyword">import</span> java.util.function.Predicate;</span><br><span class="line"><span class="keyword">import</span> java.util.function.UnaryOperator;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArrayList</span>&lt;<span class="title">E</span>&gt; <span class="keyword">extends</span> <span class="title">AbstractList</span>&lt;<span class="title">E</span>&gt;</span></span><br><span class="line"><span class="class">        <span class="keyword">implements</span> <span class="title">List</span>&lt;<span class="title">E</span>&gt;, <span class="title">RandomAccess</span>, <span class="title">Cloneable</span>, <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">8683452581122892189L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é»˜è®¤åˆå§‹å®¹é‡å¤§å°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> DEFAULT_CAPACITY = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç©ºæ•°ç»„ï¼ˆç”¨äºç©ºå®ä¾‹ï¼‰ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Object[] EMPTY_ELEMENTDATA = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">     <span class="comment">//ç”¨äºé»˜è®¤å¤§å°ç©ºå®ä¾‹çš„å…±äº«ç©ºæ•°ç»„å®ä¾‹ã€‚</span></span><br><span class="line">      <span class="comment">//æˆ‘ä»¬æŠŠå®ƒä»EMPTY_ELEMENTDATAæ•°ç»„ä¸­åŒºåˆ†å‡ºæ¥ï¼Œä»¥çŸ¥é“åœ¨æ·»åŠ ç¬¬ä¸€ä¸ªå…ƒç´ æ—¶å®¹é‡éœ€è¦å¢åŠ å¤šå°‘ã€‚</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¿å­˜ArrayListæ•°æ®çš„æ•°ç»„</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">transient</span> Object[] elementData; <span class="comment">// non-private to simplify nested class access</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ArrayList æ‰€åŒ…å«çš„å…ƒç´ ä¸ªæ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> size;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¸¦åˆå§‹å®¹é‡å‚æ•°çš„æ„é€ å‡½æ•°ã€‚ï¼ˆç”¨æˆ·è‡ªå·±æŒ‡å®šå®¹é‡ï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ArrayList</span><span class="params">(<span class="keyword">int</span> initialCapacity)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (initialCapacity &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">//åˆ›å»ºinitialCapacityå¤§å°çš„æ•°ç»„</span></span><br><span class="line">            <span class="keyword">this</span>.elementData = <span class="keyword">new</span> Object[initialCapacity];</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (initialCapacity == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">//åˆ›å»ºç©ºæ•°ç»„</span></span><br><span class="line">            <span class="keyword">this</span>.elementData = EMPTY_ELEMENTDATA;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Illegal Capacity: "</span>+</span><br><span class="line">                                               initialCapacity);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *é»˜è®¤æ„é€ å‡½æ•°ï¼Œå…¶é»˜è®¤åˆå§‹å®¹é‡ä¸º10</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ArrayList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ„é€ ä¸€ä¸ªåŒ…å«æŒ‡å®šé›†åˆçš„å…ƒç´ çš„åˆ—è¡¨ï¼ŒæŒ‰ç…§å®ƒä»¬ç”±é›†åˆçš„è¿­ä»£å™¨è¿”å›çš„é¡ºåºã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ArrayList</span><span class="params">(Collection&lt;? extends E&gt; c)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        elementData = c.toArray();</span><br><span class="line">        <span class="comment">//å¦‚æœæŒ‡å®šé›†åˆå…ƒç´ ä¸ªæ•°ä¸ä¸º0</span></span><br><span class="line">        <span class="keyword">if</span> ((size = elementData.length) != <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">// c.toArray å¯èƒ½è¿”å›çš„ä¸æ˜¯Objectç±»å‹çš„æ•°ç»„æ‰€ä»¥åŠ ä¸Šä¸‹é¢çš„è¯­å¥ç”¨äºåˆ¤æ–­ï¼Œ</span></span><br><span class="line">            <span class="comment">//è¿™é‡Œç”¨åˆ°äº†åå°„é‡Œé¢çš„getClass()æ–¹æ³•</span></span><br><span class="line">            <span class="keyword">if</span> (elementData.getClass() != Object[]<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">                <span class="title">elementData</span> </span>= Arrays.copyOf(elementData, size, Object[]<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// ç”¨ç©ºæ•°ç»„ä»£æ›¿</span></span><br><span class="line">            <span class="keyword">this</span>.elementData = EMPTY_ELEMENTDATA;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¿®æ”¹è¿™ä¸ªArrayListå®ä¾‹çš„å®¹é‡æ˜¯åˆ—è¡¨çš„å½“å‰å¤§å°ã€‚ åº”ç”¨ç¨‹åºå¯ä»¥ä½¿ç”¨æ­¤æ“ä½œæ¥æœ€å°åŒ–ArrayListå®ä¾‹çš„å­˜å‚¨ã€‚ </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">trimToSize</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        modCount++;</span><br><span class="line">        <span class="keyword">if</span> (size &lt; elementData.length) &#123;</span><br><span class="line">            elementData = (size == <span class="number">0</span>)</span><br><span class="line">              ? EMPTY_ELEMENTDATA</span><br><span class="line">              : Arrays.copyOf(elementData, size);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//ä¸‹é¢æ˜¯ArrayListçš„æ‰©å®¹æœºåˆ¶</span></span><br><span class="line"><span class="comment">//ArrayListçš„æ‰©å®¹æœºåˆ¶æé«˜äº†æ€§èƒ½ï¼Œå¦‚æœæ¯æ¬¡åªæ‰©å……ä¸€ä¸ªï¼Œ</span></span><br><span class="line"><span class="comment">//é‚£ä¹ˆé¢‘ç¹çš„æ’å…¥ä¼šå¯¼è‡´é¢‘ç¹çš„æ‹·è´ï¼Œé™ä½æ€§èƒ½ï¼Œè€ŒArrayListçš„æ‰©å®¹æœºåˆ¶é¿å…äº†è¿™ç§æƒ…å†µã€‚</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¦‚æœ‰å¿…è¦ï¼Œå¢åŠ æ­¤ArrayListå®ä¾‹çš„å®¹é‡ï¼Œä»¥ç¡®ä¿å®ƒè‡³å°‘èƒ½å®¹çº³å…ƒç´ çš„æ•°é‡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>   minCapacity   æ‰€éœ€çš„æœ€å°å®¹é‡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ensureCapacity</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> minExpand = (elementData != DEFAULTCAPACITY_EMPTY_ELEMENTDATA)</span><br><span class="line">            <span class="comment">// any size if not default element table</span></span><br><span class="line">            ? <span class="number">0</span></span><br><span class="line">            <span class="comment">// larger than default for default empty table. It's already</span></span><br><span class="line">            <span class="comment">// supposed to be at default size.</span></span><br><span class="line">            : DEFAULT_CAPACITY;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (minCapacity &gt; minExpand) &#123;</span><br><span class="line">            ensureExplicitCapacity(minCapacity);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">   <span class="comment">//å¾—åˆ°æœ€å°æ‰©å®¹é‡</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ensureCapacityInternal</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) &#123;</span><br><span class="line">              <span class="comment">// è·å–é»˜è®¤çš„å®¹é‡å’Œä¼ å…¥å‚æ•°çš„è¾ƒå¤§å€¼</span></span><br><span class="line">            minCapacity = Math.max(DEFAULT_CAPACITY, minCapacity);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ensureExplicitCapacity(minCapacity);</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="comment">//åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ensureExplicitCapacity</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">        modCount++;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// overflow-conscious code</span></span><br><span class="line">        <span class="keyword">if</span> (minCapacity - elementData.length &gt; <span class="number">0</span>)</span><br><span class="line">            <span class="comment">//è°ƒç”¨growæ–¹æ³•è¿›è¡Œæ‰©å®¹ï¼Œè°ƒç”¨æ­¤æ–¹æ³•ä»£è¡¨å·²ç»å¼€å§‹æ‰©å®¹äº†</span></span><br><span class="line">            grow(minCapacity);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¦åˆ†é…çš„æœ€å¤§æ•°ç»„å¤§å°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MAX_ARRAY_SIZE = Integer.MAX_VALUE - <span class="number">8</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ArrayListæ‰©å®¹çš„æ ¸å¿ƒæ–¹æ³•ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">grow</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// oldCapacityä¸ºæ—§å®¹é‡ï¼ŒnewCapacityä¸ºæ–°å®¹é‡</span></span><br><span class="line">        <span class="keyword">int</span> oldCapacity = elementData.length;</span><br><span class="line">        <span class="comment">//å°†oldCapacity å³ç§»ä¸€ä½ï¼Œå…¶æ•ˆæœç›¸å½“äºoldCapacity /2ï¼Œ</span></span><br><span class="line">        <span class="comment">//æˆ‘ä»¬çŸ¥é“ä½è¿ç®—çš„é€Ÿåº¦è¿œè¿œå¿«äºæ•´é™¤è¿ç®—ï¼Œæ•´å¥è¿ç®—å¼çš„ç»“æœå°±æ˜¯å°†æ–°å®¹é‡æ›´æ–°ä¸ºæ—§å®¹é‡çš„1.5å€ï¼Œ</span></span><br><span class="line">        <span class="keyword">int</span> newCapacity = oldCapacity + (oldCapacity &gt;&gt; <span class="number">1</span>);</span><br><span class="line">        <span class="comment">//ç„¶åæ£€æŸ¥æ–°å®¹é‡æ˜¯å¦å¤§äºæœ€å°éœ€è¦å®¹é‡ï¼Œè‹¥è¿˜æ˜¯å°äºæœ€å°éœ€è¦å®¹é‡ï¼Œé‚£ä¹ˆå°±æŠŠæœ€å°éœ€è¦å®¹é‡å½“ä½œæ•°ç»„çš„æ–°å®¹é‡ï¼Œ</span></span><br><span class="line">        <span class="keyword">if</span> (newCapacity - minCapacity &lt; <span class="number">0</span>)</span><br><span class="line">            newCapacity = minCapacity;</span><br><span class="line">        <span class="comment">//å†æ£€æŸ¥æ–°å®¹é‡æ˜¯å¦è¶…å‡ºäº†ArrayListæ‰€å®šä¹‰çš„æœ€å¤§å®¹é‡ï¼Œ</span></span><br><span class="line">        <span class="comment">//è‹¥è¶…å‡ºäº†ï¼Œåˆ™è°ƒç”¨hugeCapacity()æ¥æ¯”è¾ƒminCapacityå’Œ MAX_ARRAY_SIZEï¼Œ</span></span><br><span class="line">        <span class="comment">//å¦‚æœminCapacityå¤§äºæœ€å¤§å®¹é‡ï¼Œåˆ™æ–°å®¹é‡åˆ™ä¸ºArrayListå®šä¹‰çš„æœ€å¤§å®¹é‡ï¼Œå¦åˆ™ï¼Œæ–°å®¹é‡å¤§å°åˆ™ä¸º minCapacityã€‚ </span></span><br><span class="line">        <span class="keyword">if</span> (newCapacity - MAX_ARRAY_SIZE &gt; <span class="number">0</span>)</span><br><span class="line">            newCapacity = hugeCapacity(minCapacity);</span><br><span class="line">        <span class="comment">// minCapacity is usually close to size, so this is a win:</span></span><br><span class="line">        elementData = Arrays.copyOf(elementData, newCapacity);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æ¯”è¾ƒminCapacityå’Œ MAX_ARRAY_SIZE</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">hugeCapacity</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (minCapacity &lt; <span class="number">0</span>) <span class="comment">// overflow</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> OutOfMemoryError();</span><br><span class="line">        <span class="keyword">return</span> (minCapacity &gt; MAX_ARRAY_SIZE) ?</span><br><span class="line">            Integer.MAX_VALUE :</span><br><span class="line">            MAX_ARRAY_SIZE;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *è¿”å›æ­¤åˆ—è¡¨ä¸­çš„å…ƒç´ æ•°ã€‚ </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> size;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¦‚æœæ­¤åˆ—è¡¨ä¸åŒ…å«å…ƒç´ ï¼Œåˆ™è¿”å› true ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isEmpty</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//æ³¨æ„=å’Œ==çš„åŒºåˆ«</span></span><br><span class="line">        <span class="keyword">return</span> size == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¦‚æœæ­¤åˆ—è¡¨åŒ…å«æŒ‡å®šçš„å…ƒç´ ï¼Œåˆ™è¿”å›true ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">contains</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//indexOf()æ–¹æ³•ï¼šè¿”å›æ­¤åˆ—è¡¨ä¸­æŒ‡å®šå…ƒç´ çš„é¦–æ¬¡å‡ºç°çš„ç´¢å¼•ï¼Œå¦‚æœæ­¤åˆ—è¡¨ä¸åŒ…å«æ­¤å…ƒç´ ï¼Œåˆ™ä¸º-1 </span></span><br><span class="line">        <span class="keyword">return</span> indexOf(o) &gt;= <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *è¿”å›æ­¤åˆ—è¡¨ä¸­æŒ‡å®šå…ƒç´ çš„é¦–æ¬¡å‡ºç°çš„ç´¢å¼•ï¼Œå¦‚æœæ­¤åˆ—è¡¨ä¸åŒ…å«æ­¤å…ƒç´ ï¼Œåˆ™ä¸º-1 </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">indexOf</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (o == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++)</span><br><span class="line">                <span class="keyword">if</span> (elementData[i]==<span class="keyword">null</span>)</span><br><span class="line">                    <span class="keyword">return</span> i;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++)</span><br><span class="line">                <span class="comment">//equals()æ–¹æ³•æ¯”è¾ƒ</span></span><br><span class="line">                <span class="keyword">if</span> (o.equals(elementData[i]))</span><br><span class="line">                    <span class="keyword">return</span> i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿”å›æ­¤åˆ—è¡¨ä¸­æŒ‡å®šå…ƒç´ çš„æœ€åä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ï¼Œå¦‚æœæ­¤åˆ—è¡¨ä¸åŒ…å«å…ƒç´ ï¼Œåˆ™è¿”å›-1ã€‚.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">lastIndexOf</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (o == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = size-<span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">                <span class="keyword">if</span> (elementData[i]==<span class="keyword">null</span>)</span><br><span class="line">                    <span class="keyword">return</span> i;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = size-<span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">                <span class="keyword">if</span> (o.equals(elementData[i]))</span><br><span class="line">                    <span class="keyword">return</span> i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿”å›æ­¤ArrayListå®ä¾‹çš„æµ…æ‹·è´ã€‚ ï¼ˆå…ƒç´ æœ¬èº«ä¸è¢«å¤åˆ¶ã€‚ï¼‰ </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">clone</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            ArrayList&lt;?&gt; v = (ArrayList&lt;?&gt;) <span class="keyword">super</span>.clone();</span><br><span class="line">            <span class="comment">//Arrays.copyOfåŠŸèƒ½æ˜¯å®ç°æ•°ç»„çš„å¤åˆ¶ï¼Œè¿”å›å¤åˆ¶åçš„æ•°ç»„ã€‚å‚æ•°æ˜¯è¢«å¤åˆ¶çš„æ•°ç»„å’Œå¤åˆ¶çš„é•¿åº¦</span></span><br><span class="line">            v.elementData = Arrays.copyOf(elementData, size);</span><br><span class="line">            v.modCount = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">return</span> v;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (CloneNotSupportedException e) &#123;</span><br><span class="line">            <span class="comment">// è¿™ä¸åº”è¯¥å‘ç”Ÿï¼Œå› ä¸ºæˆ‘ä»¬æ˜¯å¯ä»¥å…‹éš†çš„</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> InternalError(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *ä»¥æ­£ç¡®çš„é¡ºåºï¼ˆä»ç¬¬ä¸€ä¸ªåˆ°æœ€åä¸€ä¸ªå…ƒç´ ï¼‰è¿”å›ä¸€ä¸ªåŒ…å«æ­¤åˆ—è¡¨ä¸­æ‰€æœ‰å…ƒç´ çš„æ•°ç»„ã€‚ </span></span><br><span class="line"><span class="comment">     *è¿”å›çš„æ•°ç»„å°†æ˜¯â€œå®‰å…¨çš„â€ï¼Œå› ä¸ºè¯¥åˆ—è¡¨ä¸ä¿ç•™å¯¹å®ƒçš„å¼•ç”¨ã€‚ ï¼ˆæ¢å¥è¯è¯´ï¼Œè¿™ä¸ªæ–¹æ³•å¿…é¡»åˆ†é…ä¸€ä¸ªæ–°çš„æ•°ç»„ï¼‰ã€‚</span></span><br><span class="line"><span class="comment">     *å› æ­¤ï¼Œè°ƒç”¨è€…å¯ä»¥è‡ªç”±åœ°ä¿®æ”¹è¿”å›çš„æ•°ç»„ã€‚ æ­¤æ–¹æ³•å……å½“åŸºäºé˜µåˆ—å’ŒåŸºäºé›†åˆçš„APIä¹‹é—´çš„æ¡¥æ¢ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Object[] toArray() &#123;</span><br><span class="line">        <span class="keyword">return</span> Arrays.copyOf(elementData, size);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä»¥æ­£ç¡®çš„é¡ºåºè¿”å›ä¸€ä¸ªåŒ…å«æ­¤åˆ—è¡¨ä¸­æ‰€æœ‰å…ƒç´ çš„æ•°ç»„ï¼ˆä»ç¬¬ä¸€ä¸ªåˆ°æœ€åä¸€ä¸ªå…ƒç´ ï¼‰; </span></span><br><span class="line"><span class="comment">     *è¿”å›çš„æ•°ç»„çš„è¿è¡Œæ—¶ç±»å‹æ˜¯æŒ‡å®šæ•°ç»„çš„è¿è¡Œæ—¶ç±»å‹ã€‚ å¦‚æœåˆ—è¡¨é€‚åˆæŒ‡å®šçš„æ•°ç»„ï¼Œåˆ™è¿”å›å…¶ä¸­ã€‚ </span></span><br><span class="line"><span class="comment">     *å¦åˆ™ï¼Œå°†ä¸ºæŒ‡å®šæ•°ç»„çš„è¿è¡Œæ—¶ç±»å‹å’Œæ­¤åˆ—è¡¨çš„å¤§å°åˆ†é…ä¸€ä¸ªæ–°æ•°ç»„ã€‚ </span></span><br><span class="line"><span class="comment">     *å¦‚æœåˆ—è¡¨é€‚ç”¨äºæŒ‡å®šçš„æ•°ç»„ï¼Œå…¶ä½™ç©ºé—´ï¼ˆå³æ•°ç»„çš„åˆ—è¡¨æ•°é‡å¤šäºæ­¤å…ƒç´ ï¼‰ï¼Œåˆ™ç´§è·Ÿåœ¨é›†åˆç»“æŸåçš„æ•°ç»„ä¸­çš„å…ƒç´ è®¾ç½®ä¸ºnull ã€‚</span></span><br><span class="line"><span class="comment">     *ï¼ˆè¿™ä»…åœ¨è°ƒç”¨è€…çŸ¥é“åˆ—è¡¨ä¸åŒ…å«ä»»ä½•ç©ºå…ƒç´ çš„æƒ…å†µä¸‹æ‰èƒ½ç¡®å®šåˆ—è¡¨çš„é•¿åº¦ã€‚ï¼‰ </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; T[] toArray(T[] a) &#123;</span><br><span class="line">        <span class="keyword">if</span> (a.length &lt; size)</span><br><span class="line">            <span class="comment">// æ–°å»ºä¸€ä¸ªè¿è¡Œæ—¶ç±»å‹çš„æ•°ç»„ï¼Œä½†æ˜¯ArrayListæ•°ç»„çš„å†…å®¹</span></span><br><span class="line">            <span class="keyword">return</span> (T[]) Arrays.copyOf(elementData, size, a.getClass());</span><br><span class="line">            <span class="comment">//è°ƒç”¨Systemæä¾›çš„arraycopy()æ–¹æ³•å®ç°æ•°ç»„ä¹‹é—´çš„å¤åˆ¶</span></span><br><span class="line">        System.arraycopy(elementData, <span class="number">0</span>, a, <span class="number">0</span>, size);</span><br><span class="line">        <span class="keyword">if</span> (a.length &gt; size)</span><br><span class="line">            a[size] = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Positional Access Operations</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">    <span class="function">E <span class="title">elementData</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (E) elementData[index];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿”å›æ­¤åˆ—è¡¨ä¸­æŒ‡å®šä½ç½®çš„å…ƒç´ ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> E <span class="title">get</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">        rangeCheck(index);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> elementData(index);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æŒ‡å®šçš„å…ƒç´ æ›¿æ¢æ­¤åˆ—è¡¨ä¸­æŒ‡å®šä½ç½®çš„å…ƒç´ ã€‚ </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> E <span class="title">set</span><span class="params">(<span class="keyword">int</span> index, E element)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//å¯¹indexè¿›è¡Œç•Œé™æ£€æŸ¥</span></span><br><span class="line">        rangeCheck(index);</span><br><span class="line"></span><br><span class="line">        E oldValue = elementData(index);</span><br><span class="line">        elementData[index] = element;</span><br><span class="line">        <span class="comment">//è¿”å›åŸæ¥åœ¨è¿™ä¸ªä½ç½®çš„å…ƒç´ </span></span><br><span class="line">        <span class="keyword">return</span> oldValue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°†æŒ‡å®šçš„å…ƒç´ è¿½åŠ åˆ°æ­¤åˆ—è¡¨çš„æœ«å°¾ã€‚ </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">        ensureCapacityInternal(size + <span class="number">1</span>);  <span class="comment">// Increments modCount!!</span></span><br><span class="line">        <span class="comment">//è¿™é‡Œçœ‹åˆ°ArrayListæ·»åŠ å…ƒç´ çš„å®è´¨å°±ç›¸å½“äºä¸ºæ•°ç»„èµ‹å€¼</span></span><br><span class="line">        elementData[size++] = e;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åœ¨æ­¤åˆ—è¡¨ä¸­çš„æŒ‡å®šä½ç½®æ’å…¥æŒ‡å®šçš„å…ƒç´ ã€‚ </span></span><br><span class="line"><span class="comment">     *å…ˆè°ƒç”¨ rangeCheckForAdd å¯¹indexè¿›è¡Œç•Œé™æ£€æŸ¥ï¼›ç„¶åè°ƒç”¨ ensureCapacityInternal æ–¹æ³•ä¿è¯capacityè¶³å¤Ÿå¤§ï¼›</span></span><br><span class="line"><span class="comment">     *å†å°†ä»indexå¼€å§‹ä¹‹åçš„æ‰€æœ‰æˆå‘˜åç§»ä¸€ä¸ªä½ç½®(æœ¬äººä¿®æ”¹ï¼Œç§»åŠ¨æˆå‘˜åŒ…æ‹¬indexæ‰€åœ¨å…ƒç´ )ï¼›å°†elementæ’å…¥indexä½ç½®ï¼›æœ€åsizeåŠ 1ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> index, E element)</span> </span>&#123;</span><br><span class="line">        rangeCheckForAdd(index);</span><br><span class="line"></span><br><span class="line">        ensureCapacityInternal(size + <span class="number">1</span>);  <span class="comment">// Increments modCount!!</span></span><br><span class="line">        <span class="comment">//arraycopy()è¿™ä¸ªå®ç°æ•°ç»„ä¹‹é—´å¤åˆ¶çš„æ–¹æ³•ä¸€å®šè¦çœ‹ä¸€ä¸‹ï¼Œä¸‹é¢å°±ç”¨åˆ°äº†arraycopy()æ–¹æ³•å®ç°æ•°ç»„è‡ªå·±å¤åˆ¶è‡ªå·±</span></span><br><span class="line">        System.arraycopy(elementData, index, elementData, index + <span class="number">1</span>,</span><br><span class="line">                         size - index);</span><br><span class="line">        elementData[index] = element;</span><br><span class="line">        size++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤è¯¥åˆ—è¡¨ä¸­æŒ‡å®šä½ç½®çš„å…ƒç´ ã€‚ å°†ä»»ä½•åç»­å…ƒç´ ç§»åŠ¨åˆ°å·¦ä¾§ï¼ˆä»å…¶ç´¢å¼•ä¸­å‡å»ä¸€ä¸ªå…ƒç´ ï¼‰ã€‚ </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> E <span class="title">remove</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">        rangeCheck(index);</span><br><span class="line"></span><br><span class="line">        modCount++;</span><br><span class="line">        E oldValue = elementData(index);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> numMoved = size - index - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (numMoved &gt; <span class="number">0</span>)</span><br><span class="line">            System.arraycopy(elementData, index+<span class="number">1</span>, elementData, index,</span><br><span class="line">                             numMoved);</span><br><span class="line">        elementData[--size] = <span class="keyword">null</span>; <span class="comment">// clear to let GC do its work</span></span><br><span class="line">      <span class="comment">//ä»åˆ—è¡¨ä¸­åˆ é™¤çš„å…ƒç´  </span></span><br><span class="line">        <span class="keyword">return</span> oldValue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä»åˆ—è¡¨ä¸­åˆ é™¤æŒ‡å®šå…ƒç´ çš„ç¬¬ä¸€ä¸ªå‡ºç°ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ã€‚ å¦‚æœåˆ—è¡¨ä¸åŒ…å«è¯¥å…ƒç´ ï¼Œåˆ™å®ƒä¸ä¼šæ›´æ”¹ã€‚</span></span><br><span class="line"><span class="comment">     *è¿”å›trueï¼Œå¦‚æœæ­¤åˆ—è¡¨åŒ…å«æŒ‡å®šçš„å…ƒç´ </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">remove</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (o == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> index = <span class="number">0</span>; index &lt; size; index++)</span><br><span class="line">                <span class="keyword">if</span> (elementData[index] == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    fastRemove(index);</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> index = <span class="number">0</span>; index &lt; size; index++)</span><br><span class="line">                <span class="keyword">if</span> (o.equals(elementData[index])) &#123;</span><br><span class="line">                    fastRemove(index);</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * Private remove method that skips bounds checking and does not</span></span><br><span class="line"><span class="comment">     * return the value removed.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">fastRemove</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">        modCount++;</span><br><span class="line">        <span class="keyword">int</span> numMoved = size - index - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (numMoved &gt; <span class="number">0</span>)</span><br><span class="line">            System.arraycopy(elementData, index+<span class="number">1</span>, elementData, index,</span><br><span class="line">                             numMoved);</span><br><span class="line">        elementData[--size] = <span class="keyword">null</span>; <span class="comment">// clear to let GC do its work</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä»åˆ—è¡¨ä¸­åˆ é™¤æ‰€æœ‰å…ƒç´ ã€‚ </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        modCount++;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æŠŠæ•°ç»„ä¸­æ‰€æœ‰çš„å…ƒç´ çš„å€¼è®¾ä¸ºnull</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++)</span><br><span class="line">            elementData[i] = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        size = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŒ‰æŒ‡å®šé›†åˆçš„Iteratorè¿”å›çš„é¡ºåºå°†æŒ‡å®šé›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ è¿½åŠ åˆ°æ­¤åˆ—è¡¨çš„æœ«å°¾ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">addAll</span><span class="params">(Collection&lt;? extends E&gt; c)</span> </span>&#123;</span><br><span class="line">        Object[] a = c.toArray();</span><br><span class="line">        <span class="keyword">int</span> numNew = a.length;</span><br><span class="line">        ensureCapacityInternal(size + numNew);  <span class="comment">// Increments modCount</span></span><br><span class="line">        System.arraycopy(a, <span class="number">0</span>, elementData, size, numNew);</span><br><span class="line">        size += numNew;</span><br><span class="line">        <span class="keyword">return</span> numNew != <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°†æŒ‡å®šé›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ æ’å…¥åˆ°æ­¤åˆ—è¡¨ä¸­ï¼Œä»æŒ‡å®šçš„ä½ç½®å¼€å§‹ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">addAll</span><span class="params">(<span class="keyword">int</span> index, Collection&lt;? extends E&gt; c)</span> </span>&#123;</span><br><span class="line">        rangeCheckForAdd(index);</span><br><span class="line"></span><br><span class="line">        Object[] a = c.toArray();</span><br><span class="line">        <span class="keyword">int</span> numNew = a.length;</span><br><span class="line">        ensureCapacityInternal(size + numNew);  <span class="comment">// Increments modCount</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> numMoved = size - index;</span><br><span class="line">        <span class="keyword">if</span> (numMoved &gt; <span class="number">0</span>)</span><br><span class="line">            System.arraycopy(elementData, index, elementData, index + numNew,</span><br><span class="line">                             numMoved);</span><br><span class="line"></span><br><span class="line">        System.arraycopy(a, <span class="number">0</span>, elementData, index, numNew);</span><br><span class="line">        size += numNew;</span><br><span class="line">        <span class="keyword">return</span> numNew != <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä»æ­¤åˆ—è¡¨ä¸­åˆ é™¤æ‰€æœ‰ç´¢å¼•ä¸ºfromIndex ï¼ˆå«ï¼‰å’ŒtoIndexä¹‹é—´çš„å…ƒç´ ã€‚</span></span><br><span class="line"><span class="comment">     *å°†ä»»ä½•åç»­å…ƒç´ ç§»åŠ¨åˆ°å·¦ä¾§ï¼ˆå‡å°‘å…¶ç´¢å¼•ï¼‰ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">removeRange</span><span class="params">(<span class="keyword">int</span> fromIndex, <span class="keyword">int</span> toIndex)</span> </span>&#123;</span><br><span class="line">        modCount++;</span><br><span class="line">        <span class="keyword">int</span> numMoved = size - toIndex;</span><br><span class="line">        System.arraycopy(elementData, toIndex, elementData, fromIndex,</span><br><span class="line">                         numMoved);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// clear to let GC do its work</span></span><br><span class="line">        <span class="keyword">int</span> newSize = size - (toIndex-fromIndex);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = newSize; i &lt; size; i++) &#123;</span><br><span class="line">            elementData[i] = <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        size = newSize;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ£€æŸ¥ç»™å®šçš„ç´¢å¼•æ˜¯å¦åœ¨èŒƒå›´å†…ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">rangeCheck</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (index &gt;= size)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IndexOutOfBoundsException(outOfBoundsMsg(index));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * addå’ŒaddAllä½¿ç”¨çš„rangeCheckçš„ä¸€ä¸ªç‰ˆæœ¬</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">rangeCheckForAdd</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (index &gt; size || index &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IndexOutOfBoundsException(outOfBoundsMsg(index));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿”å›IndexOutOfBoundsExceptionç»†èŠ‚ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">outOfBoundsMsg</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Index: "</span>+index+<span class="string">", Size: "</span>+size;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä»æ­¤åˆ—è¡¨ä¸­åˆ é™¤æŒ‡å®šé›†åˆä¸­åŒ…å«çš„æ‰€æœ‰å…ƒç´ ã€‚ </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">removeAll</span><span class="params">(Collection&lt;?&gt; c)</span> </span>&#123;</span><br><span class="line">        Objects.requireNonNull(c);</span><br><span class="line">        <span class="comment">//å¦‚æœæ­¤åˆ—è¡¨è¢«ä¿®æ”¹åˆ™è¿”å›true</span></span><br><span class="line">        <span class="keyword">return</span> batchRemove(c, <span class="keyword">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä»…ä¿ç•™æ­¤åˆ—è¡¨ä¸­åŒ…å«åœ¨æŒ‡å®šé›†åˆä¸­çš„å…ƒç´ ã€‚</span></span><br><span class="line"><span class="comment">     *æ¢å¥è¯è¯´ï¼Œä»æ­¤åˆ—è¡¨ä¸­åˆ é™¤å…¶ä¸­ä¸åŒ…å«åœ¨æŒ‡å®šé›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ ã€‚ </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">retainAll</span><span class="params">(Collection&lt;?&gt; c)</span> </span>&#123;</span><br><span class="line">        Objects.requireNonNull(c);</span><br><span class="line">        <span class="keyword">return</span> batchRemove(c, <span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä»åˆ—è¡¨ä¸­çš„æŒ‡å®šä½ç½®å¼€å§‹ï¼Œè¿”å›åˆ—è¡¨ä¸­çš„å…ƒç´ ï¼ˆæŒ‰æ­£ç¡®é¡ºåºï¼‰çš„åˆ—è¡¨è¿­ä»£å™¨ã€‚</span></span><br><span class="line"><span class="comment">     *æŒ‡å®šçš„ç´¢å¼•è¡¨ç¤ºåˆå§‹è°ƒç”¨å°†è¿”å›çš„ç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºnext ã€‚ åˆå§‹è°ƒç”¨previouså°†è¿”å›æŒ‡å®šç´¢å¼•å‡1çš„å…ƒç´ ã€‚ </span></span><br><span class="line"><span class="comment">     *è¿”å›çš„åˆ—è¡¨è¿­ä»£å™¨æ˜¯fail-fast ã€‚ </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ListIterator&lt;E&gt; <span class="title">listIterator</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (index &lt; <span class="number">0</span> || index &gt; size)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IndexOutOfBoundsException(<span class="string">"Index: "</span>+index);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ListItr(index);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *è¿”å›åˆ—è¡¨ä¸­çš„åˆ—è¡¨è¿­ä»£å™¨ï¼ˆæŒ‰é€‚å½“çš„é¡ºåºï¼‰ã€‚ </span></span><br><span class="line"><span class="comment">     *è¿”å›çš„åˆ—è¡¨è¿­ä»£å™¨æ˜¯fail-fast ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ListIterator&lt;E&gt; <span class="title">listIterator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ListItr(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *ä»¥æ­£ç¡®çš„é¡ºåºè¿”å›è¯¥åˆ—è¡¨ä¸­çš„å…ƒç´ çš„è¿­ä»£å™¨ã€‚ </span></span><br><span class="line"><span class="comment">     *è¿”å›çš„è¿­ä»£å™¨æ˜¯fail-fast ã€‚ </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Iterator&lt;E&gt; <span class="title">iterator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Itr();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="ArrayListæºç åˆ†æ"><a href="#ArrayListæºç åˆ†æ" class="headerlink" title="ArrayListæºç åˆ†æ"></a><font face="æ¥·ä½“" id="1" id="5">ArrayListæºç åˆ†æ</font></h3><h4 id="System-arraycopy-å’ŒArrays-copyOf-æ–¹æ³•"><a href="#System-arraycopy-å’ŒArrays-copyOf-æ–¹æ³•" class="headerlink" title="System.arraycopy()å’ŒArrays.copyOf()æ–¹æ³•"></a>System.arraycopy()å’ŒArrays.copyOf()æ–¹æ³•</h4><p>ã€€ã€€é€šè¿‡ä¸Šé¢æºç æˆ‘ä»¬å‘ç°è¿™ä¸¤ä¸ªå®ç°æ•°ç»„å¤åˆ¶çš„æ–¹æ³•è¢«å¹¿æ³›ä½¿ç”¨è€Œä¸”å¾ˆå¤šåœ°æ–¹éƒ½ç‰¹åˆ«å·§å¦™ã€‚æ¯”å¦‚ä¸‹é¢<font color="red">add(int index, E element)</font>æ–¹æ³•å°±å¾ˆå·§å¦™çš„ç”¨åˆ°äº†<font color="red">arraycopy()æ–¹æ³•</font>è®©æ•°ç»„è‡ªå·±å¤åˆ¶è‡ªå·±å®ç°è®©indexå¼€å§‹ä¹‹åçš„æ‰€æœ‰æˆå‘˜åç§»ä¸€ä¸ªä½ç½®:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åœ¨æ­¤åˆ—è¡¨ä¸­çš„æŒ‡å®šä½ç½®æ’å…¥æŒ‡å®šçš„å…ƒç´ ã€‚ </span></span><br><span class="line"><span class="comment"> *å…ˆè°ƒç”¨ rangeCheckForAdd å¯¹indexè¿›è¡Œç•Œé™æ£€æŸ¥ï¼›ç„¶åè°ƒç”¨ ensureCapacityInternal æ–¹æ³•ä¿è¯capacityè¶³å¤Ÿå¤§ï¼›</span></span><br><span class="line"><span class="comment"> *å†å°†ä»indexå¼€å§‹ä¹‹åçš„æ‰€æœ‰æˆå‘˜åç§»ä¸€ä¸ªä½ç½®ï¼›å°†elementæ’å…¥indexä½ç½®ï¼›æœ€åsizeåŠ 1ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> index, E element)</span> </span>&#123;</span><br><span class="line">    rangeCheckForAdd(index);</span><br><span class="line"></span><br><span class="line">    ensureCapacityInternal(size + <span class="number">1</span>);  <span class="comment">// Increments modCount!!</span></span><br><span class="line">    <span class="comment">//arraycopy()æ–¹æ³•å®ç°æ•°ç»„è‡ªå·±å¤åˆ¶è‡ªå·±</span></span><br><span class="line">    <span class="comment">//elementData:æºæ•°ç»„;index:æºæ•°ç»„ä¸­çš„èµ·å§‹ä½ç½®;elementDataï¼šç›®æ ‡æ•°ç»„ï¼›index + 1ï¼šç›®æ ‡æ•°ç»„ä¸­çš„èµ·å§‹ä½ç½®ï¼› size - indexï¼šè¦å¤åˆ¶çš„æ•°ç»„å…ƒç´ çš„æ•°é‡ï¼›</span></span><br><span class="line">    System.arraycopy(elementData, index, elementData, index + <span class="number">1</span>, size - index);</span><br><span class="line">    elementData[index] = element;</span><br><span class="line">    size++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆå¦‚toArray()æ–¹æ³•ä¸­ç”¨åˆ°äº†copyOf()æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *ä»¥æ­£ç¡®çš„é¡ºåºï¼ˆä»ç¬¬ä¸€ä¸ªåˆ°æœ€åä¸€ä¸ªå…ƒç´ ï¼‰è¿”å›ä¸€ä¸ªåŒ…å«æ­¤åˆ—è¡¨ä¸­æ‰€æœ‰å…ƒç´ çš„æ•°ç»„ã€‚ </span></span><br><span class="line"><span class="comment"> *è¿”å›çš„æ•°ç»„å°†æ˜¯â€œå®‰å…¨çš„â€ï¼Œå› ä¸ºè¯¥åˆ—è¡¨ä¸ä¿ç•™å¯¹å®ƒçš„å¼•ç”¨ã€‚ ï¼ˆæ¢å¥è¯è¯´ï¼Œè¿™ä¸ªæ–¹æ³•å¿…é¡»åˆ†é…ä¸€ä¸ªæ–°çš„æ•°ç»„ï¼‰ã€‚</span></span><br><span class="line"><span class="comment"> *å› æ­¤ï¼Œè°ƒç”¨è€…å¯ä»¥è‡ªç”±åœ°ä¿®æ”¹è¿”å›çš„æ•°ç»„ã€‚ æ­¤æ–¹æ³•å……å½“åŸºäºé˜µåˆ—å’ŒåŸºäºé›†åˆçš„APIä¹‹é—´çš„æ¡¥æ¢ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> Object[] toArray() &#123;</span><br><span class="line"><span class="comment">//elementDataï¼šè¦å¤åˆ¶çš„æ•°ç»„ï¼›sizeï¼šè¦å¤åˆ¶çš„é•¿åº¦</span></span><br><span class="line">    <span class="keyword">return</span> Arrays.copyOf(elementData, size);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="ä¸¤è€…è”ç³»ä¸åŒºåˆ«"><a href="#ä¸¤è€…è”ç³»ä¸åŒºåˆ«" class="headerlink" title="ä¸¤è€…è”ç³»ä¸åŒºåˆ«"></a>ä¸¤è€…è”ç³»ä¸åŒºåˆ«</h5><p><strong>è”ç³»ï¼š</strong><br>çœ‹ä¸¤è€…æºä»£ç å¯ä»¥å‘ç°<code>copyOf()</code>å†…éƒ¨è°ƒç”¨äº†<code>System.arraycopy()</code>æ–¹æ³•<br><strong>åŒºåˆ«ï¼š</strong></p><ol><li>arraycopy()éœ€è¦ç›®æ ‡æ•°ç»„ï¼Œå°†åŸæ•°ç»„æ‹·è´åˆ°ä½ è‡ªå·±å®šä¹‰çš„æ•°ç»„é‡Œï¼Œè€Œä¸”å¯ä»¥é€‰æ‹©æ‹·è´çš„èµ·ç‚¹å’Œé•¿åº¦ä»¥åŠæ”¾å…¥æ–°æ•°ç»„ä¸­çš„ä½ç½®</li><li>copyOf()æ˜¯ç³»ç»Ÿè‡ªåŠ¨åœ¨å†…éƒ¨æ–°å»ºä¸€ä¸ªæ•°ç»„ï¼Œå¹¶è¿”å›è¯¥æ•°ç»„ã€‚<h4 id="ArrayList-æ ¸å¿ƒæ‰©å®¹æŠ€æœ¯"><a href="#ArrayList-æ ¸å¿ƒæ‰©å®¹æŠ€æœ¯" class="headerlink" title="ArrayList æ ¸å¿ƒæ‰©å®¹æŠ€æœ¯"></a>ArrayList æ ¸å¿ƒæ‰©å®¹æŠ€æœ¯</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä¸‹é¢æ˜¯ArrayListçš„æ‰©å®¹æœºåˆ¶</span></span><br><span class="line"><span class="comment">//ArrayListçš„æ‰©å®¹æœºåˆ¶æé«˜äº†æ€§èƒ½ï¼Œå¦‚æœæ¯æ¬¡åªæ‰©å……ä¸€ä¸ªï¼Œ</span></span><br><span class="line"><span class="comment">//é‚£ä¹ˆé¢‘ç¹çš„æ’å…¥ä¼šå¯¼è‡´é¢‘ç¹çš„æ‹·è´ï¼Œé™ä½æ€§èƒ½ï¼Œè€ŒArrayListçš„æ‰©å®¹æœºåˆ¶é¿å…äº†è¿™ç§æƒ…å†µã€‚</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¦‚æœ‰å¿…è¦ï¼Œå¢åŠ æ­¤ArrayListå®ä¾‹çš„å®¹é‡ï¼Œä»¥ç¡®ä¿å®ƒè‡³å°‘èƒ½å®¹çº³å…ƒç´ çš„æ•°é‡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>   minCapacity   æ‰€éœ€çš„æœ€å°å®¹é‡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ensureCapacity</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> minExpand = (elementData != DEFAULTCAPACITY_EMPTY_ELEMENTDATA)</span><br><span class="line">            <span class="comment">// any size if not default element table</span></span><br><span class="line">            ? <span class="number">0</span></span><br><span class="line">            <span class="comment">// larger than default for default empty table. It's already</span></span><br><span class="line">            <span class="comment">// supposed to be at default size.</span></span><br><span class="line">            : DEFAULT_CAPACITY;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (minCapacity &gt; minExpand) &#123;</span><br><span class="line">            ensureExplicitCapacity(minCapacity);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">   <span class="comment">//å¾—åˆ°æœ€å°æ‰©å®¹é‡</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ensureCapacityInternal</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) &#123;</span><br><span class="line">              <span class="comment">// è·å–é»˜è®¤çš„å®¹é‡å’Œä¼ å…¥å‚æ•°çš„è¾ƒå¤§å€¼</span></span><br><span class="line">            minCapacity = Math.max(DEFAULT_CAPACITY, minCapacity);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ensureExplicitCapacity(minCapacity);</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="comment">//åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹,ä¸Šé¢ä¸¤ä¸ªæ–¹æ³•éƒ½è¦è°ƒç”¨</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ensureExplicitCapacity</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">        modCount++;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¦‚æœè¯´minCapacityä¹Ÿå°±æ˜¯æ‰€éœ€çš„æœ€å°å®¹é‡å¤§äºä¿å­˜ArrayListæ•°æ®çš„æ•°ç»„çš„é•¿åº¦çš„è¯ï¼Œå°±éœ€è¦è°ƒç”¨grow(minCapacity)æ–¹æ³•æ‰©å®¹ã€‚</span></span><br><span class="line">        <span class="comment">//è¿™ä¸ªminCapacityåˆ°åº•ä¸ºå¤šå°‘å‘¢ï¼Ÿä¸¾ä¸ªä¾‹å­åœ¨æ·»åŠ å…ƒç´ (add)æ–¹æ³•ä¸­è¿™ä¸ªminCapacityçš„å¤§å°å°±ä¸ºç°åœ¨æ•°ç»„çš„é•¿åº¦åŠ 1</span></span><br><span class="line">        <span class="keyword">if</span> (minCapacity - elementData.length &gt; <span class="number">0</span>)</span><br><span class="line">            <span class="comment">//è°ƒç”¨growæ–¹æ³•è¿›è¡Œæ‰©å®¹ï¼Œè°ƒç”¨æ­¤æ–¹æ³•ä»£è¡¨å·²ç»å¼€å§‹æ‰©å®¹äº†</span></span><br><span class="line">            grow(minCapacity);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ArrayListæ‰©å®¹çš„æ ¸å¿ƒæ–¹æ³•ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">grow</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">   <span class="comment">//elementDataä¸ºä¿å­˜ArrayListæ•°æ®çš„æ•°ç»„</span></span><br><span class="line">   <span class="comment">///elementData.lengthæ±‚æ•°ç»„é•¿åº¦elementData.sizeæ˜¯æ±‚æ•°ç»„ä¸­çš„å…ƒç´ ä¸ªæ•°</span></span><br><span class="line">    <span class="comment">// oldCapacityä¸ºæ—§å®¹é‡ï¼ŒnewCapacityä¸ºæ–°å®¹é‡</span></span><br><span class="line">    <span class="keyword">int</span> oldCapacity = elementData.length;</span><br><span class="line">    <span class="comment">//å°†oldCapacity å³ç§»ä¸€ä½ï¼Œå…¶æ•ˆæœç›¸å½“äºoldCapacity /2ï¼Œ</span></span><br><span class="line">    <span class="comment">//æˆ‘ä»¬çŸ¥é“ä½è¿ç®—çš„é€Ÿåº¦è¿œè¿œå¿«äºæ•´é™¤è¿ç®—ï¼Œæ•´å¥è¿ç®—å¼çš„ç»“æœå°±æ˜¯å°†æ–°å®¹é‡æ›´æ–°ä¸ºæ—§å®¹é‡çš„1.5å€ï¼Œ</span></span><br><span class="line">    <span class="keyword">int</span> newCapacity = oldCapacity + (oldCapacity &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    <span class="comment">//ç„¶åæ£€æŸ¥æ–°å®¹é‡æ˜¯å¦å¤§äºæœ€å°éœ€è¦å®¹é‡ï¼Œè‹¥è¿˜æ˜¯å°äºæœ€å°éœ€è¦å®¹é‡ï¼Œé‚£ä¹ˆå°±æŠŠæœ€å°éœ€è¦å®¹é‡å½“ä½œæ•°ç»„çš„æ–°å®¹é‡ï¼Œ</span></span><br><span class="line">    <span class="keyword">if</span> (newCapacity - minCapacity &lt; <span class="number">0</span>)</span><br><span class="line">        newCapacity = minCapacity;</span><br><span class="line">    <span class="comment">//å†æ£€æŸ¥æ–°å®¹é‡æ˜¯å¦è¶…å‡ºäº†ArrayListæ‰€å®šä¹‰çš„æœ€å¤§å®¹é‡ï¼Œ</span></span><br><span class="line">    <span class="comment">//è‹¥è¶…å‡ºäº†ï¼Œåˆ™è°ƒç”¨hugeCapacity()æ¥æ¯”è¾ƒminCapacityå’Œ MAX_ARRAY_SIZEï¼Œ</span></span><br><span class="line">    <span class="comment">//å¦‚æœminCapacityå¤§äºæœ€å¤§å®¹é‡ï¼Œåˆ™æ–°å®¹é‡åˆ™ä¸ºArrayListå®šä¹‰çš„æœ€å¤§å®¹é‡ï¼Œå¦åˆ™ï¼Œæ–°å®¹é‡å¤§å°åˆ™ä¸º minCapacityã€‚ </span></span><br><span class="line">    <span class="keyword">if</span> (newCapacity - MAX_ARRAY_SIZE &gt; <span class="number">0</span>)</span><br><span class="line">        newCapacity = hugeCapacity(minCapacity);</span><br><span class="line">    <span class="comment">// minCapacity is usually close to size, so this is a win:</span></span><br><span class="line">    elementData = Arrays.copyOf(elementData, newCapacity);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>ã€€ã€€æ‰©å®¹æœºåˆ¶ä»£ç å·²ç»åšäº†è¯¦ç»†çš„è§£é‡Šã€‚å¦å¤–å€¼å¾—æ³¨æ„çš„æ˜¯å¤§å®¶å¾ˆå®¹æ˜“å¿½ç•¥çš„ä¸€ä¸ªè¿ç®—ç¬¦ï¼š<strong>ç§»ä½è¿ç®—ç¬¦</strong><br>ã€€ã€€<strong>ç®€ä»‹</strong>ï¼šç§»ä½è¿ç®—ç¬¦å°±æ˜¯åœ¨äºŒè¿›åˆ¶çš„åŸºç¡€ä¸Šå¯¹æ•°å­—è¿›è¡Œå¹³ç§»ã€‚æŒ‰ç…§å¹³ç§»çš„æ–¹å‘å’Œå¡«å……æ•°å­—çš„è§„åˆ™åˆ†ä¸ºä¸‰ç§:<font color="red">&lt;&lt;(å·¦ç§»)</font>ã€<font color="red">&gt;&gt;(å¸¦ç¬¦å·å³ç§»)</font>å’Œ<font color="red">&gt;&gt;&gt;(æ— ç¬¦å·å³ç§»)</font>ã€‚<br>ã€€ã€€<strong>ä½œç”¨</strong>ï¼š<strong>å¯¹äºå¤§æ•°æ®çš„2è¿›åˆ¶è¿ç®—,ä½ç§»è¿ç®—ç¬¦æ¯”é‚£äº›æ™®é€šè¿ç®—ç¬¦çš„è¿ç®—è¦å¿«å¾ˆå¤š,å› ä¸ºç¨‹åºä»…ä»…ç§»åŠ¨ä¸€ä¸‹è€Œå·²,ä¸å»è®¡ç®—,è¿™æ ·æé«˜äº†æ•ˆç‡,èŠ‚çœäº†èµ„æº</strong><br>ã€€ã€€æ¯”å¦‚è¿™é‡Œï¼šint newCapacity = oldCapacity + (oldCapacity &gt;&gt; 1);<br>å³ç§»ä¸€ä½ç›¸å½“äºé™¤2ï¼Œå³ç§»nä½ç›¸å½“äºé™¤ä»¥ 2 çš„ n æ¬¡æ–¹ã€‚è¿™é‡Œ oldCapacity æ˜æ˜¾å³ç§»äº†1ä½æ‰€ä»¥ç›¸å½“äºoldCapacity /2ã€‚</li></ol><p><strong>å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼š</strong></p><ol><li><p>java ä¸­çš„<strong>length å±æ€§</strong>æ˜¯é’ˆå¯¹æ•°ç»„è¯´çš„,æ¯”å¦‚è¯´ä½ å£°æ˜äº†ä¸€ä¸ªæ•°ç»„,æƒ³çŸ¥é“è¿™ä¸ªæ•°ç»„çš„é•¿åº¦åˆ™ç”¨åˆ°äº† length è¿™ä¸ªå±æ€§.</p></li><li><p>java ä¸­çš„<strong>length()æ–¹æ³•</strong>æ˜¯é’ˆå¯¹å­—  ç¬¦ä¸²Stringè¯´çš„,å¦‚æœæƒ³çœ‹è¿™ä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦åˆ™ç”¨åˆ° length()è¿™ä¸ªæ–¹æ³•.</p></li><li><p>.java ä¸­çš„<strong>size()æ–¹æ³•</strong>æ˜¯é’ˆå¯¹æ³›å‹é›†åˆè¯´çš„,å¦‚æœæƒ³çœ‹è¿™ä¸ªæ³›å‹æœ‰å¤šå°‘ä¸ªå…ƒç´ ,å°±è°ƒç”¨æ­¤æ–¹æ³•æ¥æŸ¥çœ‹!</p></li></ol><h4 id="å†…éƒ¨ç±»"><a href="#å†…éƒ¨ç±»" class="headerlink" title="å†…éƒ¨ç±»"></a>å†…éƒ¨ç±»</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">    (<span class="number">1</span>)<span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">Itr</span> <span class="keyword">implements</span> <span class="title">Iterator</span>&lt;<span class="title">E</span>&gt;  </span></span><br><span class="line"><span class="class">    (2)<span class="title">private</span> <span class="title">class</span> <span class="title">ListItr</span> <span class="keyword">extends</span> <span class="title">Itr</span> <span class="keyword">implements</span> <span class="title">ListIterator</span>&lt;<span class="title">E</span>&gt;  </span></span><br><span class="line"><span class="class">    (3)<span class="title">private</span> <span class="title">class</span> <span class="title">SubList</span> <span class="keyword">extends</span> <span class="title">AbstractList</span>&lt;<span class="title">E</span>&gt; <span class="keyword">implements</span> <span class="title">RandomAccess</span>  </span></span><br><span class="line"><span class="class">    (4)<span class="title">static</span> <span class="title">final</span> <span class="title">class</span> <span class="title">ArrayListSpliterator</span>&lt;<span class="title">E</span>&gt; <span class="keyword">implements</span> <span class="title">Spliterator</span>&lt;<span class="title">E</span>&gt;  </span></span><br><span class="line"><span class="class">```  </span></span><br><span class="line">ã€€ã€€ArrayListæœ‰å››ä¸ªå†…éƒ¨ç±»ï¼Œå…¶ä¸­çš„**Itræ˜¯å®ç°äº†Iteratoræ¥å£**ï¼ŒåŒæ—¶é‡å†™äº†é‡Œé¢çš„**hasNext()**ï¼Œ**next()**ï¼Œ**remove()**ç­‰æ–¹æ³•ï¼›å…¶ä¸­çš„**ListItr**ç»§æ‰¿**Itr**ï¼Œå®ç°äº†**ListIteratoræ¥å£**ï¼ŒåŒæ—¶é‡å†™äº†**hasPrevious()**ï¼Œ**nextIndex()**ï¼Œ**previousIndex()**ï¼Œ**previous()**ï¼Œ**set(E e)**ï¼Œ**add(E e)**ç­‰æ–¹æ³•ï¼Œæ‰€ä»¥è¿™ä¹Ÿå¯ä»¥çœ‹å‡ºäº†**Iteratorå’ŒListIteratorçš„åŒºåˆ«:**ListIteratoråœ¨Iteratorçš„åŸºç¡€ä¸Šå¢åŠ äº†æ·»åŠ å¯¹è±¡ï¼Œä¿®æ”¹å¯¹è±¡ï¼Œé€†å‘éå†ç­‰æ–¹æ³•ï¼Œè¿™äº›æ˜¯Iteratorä¸èƒ½å®ç°çš„ã€‚</span><br><span class="line">### ArrayListç»å…¸Demo</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line"><span class="keyword">package</span> list;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArrayListDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] srgs)</span></span>&#123;</span><br><span class="line">         ArrayList&lt;Integer&gt; arrayList = <span class="keyword">new</span> ArrayList&lt;Integer&gt;();</span><br><span class="line"></span><br><span class="line">         System.out.printf(<span class="string">"Before add:arrayList.size() = %d\n"</span>,arrayList.size());</span><br><span class="line"></span><br><span class="line">         arrayList.add(<span class="number">1</span>);</span><br><span class="line">         arrayList.add(<span class="number">3</span>);</span><br><span class="line">         arrayList.add(<span class="number">5</span>);</span><br><span class="line">         arrayList.add(<span class="number">7</span>);</span><br><span class="line">         arrayList.add(<span class="number">9</span>);</span><br><span class="line">         System.out.printf(<span class="string">"After add:arrayList.size() = %d\n"</span>,arrayList.size());</span><br><span class="line"></span><br><span class="line">         System.out.println(<span class="string">"Printing elements of arrayList"</span>);</span><br><span class="line">         <span class="comment">// ä¸‰ç§éå†æ–¹å¼æ‰“å°å…ƒç´ </span></span><br><span class="line">         <span class="comment">// ç¬¬ä¸€ç§ï¼šé€šè¿‡è¿­ä»£å™¨éå†</span></span><br><span class="line">         System.out.print(<span class="string">"é€šè¿‡è¿­ä»£å™¨éå†:"</span>);</span><br><span class="line">         Iterator&lt;Integer&gt; it = arrayList.iterator();</span><br><span class="line">         <span class="keyword">while</span>(it.hasNext())&#123;</span><br><span class="line">             System.out.print(it.next() + <span class="string">" "</span>);</span><br><span class="line">         &#125;</span><br><span class="line">         System.out.println();</span><br><span class="line"></span><br><span class="line">         <span class="comment">// ç¬¬äºŒç§ï¼šé€šè¿‡ç´¢å¼•å€¼éå†</span></span><br><span class="line">         System.out.print(<span class="string">"é€šè¿‡ç´¢å¼•å€¼éå†:"</span>);</span><br><span class="line">         <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; arrayList.size(); i++)&#123;</span><br><span class="line">             System.out.print(arrayList.get(i) + <span class="string">" "</span>);</span><br><span class="line">         &#125;</span><br><span class="line">         System.out.println();</span><br><span class="line"></span><br><span class="line">         <span class="comment">// ç¬¬ä¸‰ç§ï¼šforå¾ªç¯éå†</span></span><br><span class="line">         System.out.print(<span class="string">"forå¾ªç¯éå†:"</span>);</span><br><span class="line">         <span class="keyword">for</span>(Integer number : arrayList)&#123;</span><br><span class="line">             System.out.print(number + <span class="string">" "</span>);</span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">         <span class="comment">// toArrayç”¨æ³•</span></span><br><span class="line">         <span class="comment">// ç¬¬ä¸€ç§æ–¹å¼(æœ€å¸¸ç”¨)</span></span><br><span class="line">         Integer[] integer = arrayList.toArray(<span class="keyword">new</span> Integer[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">         <span class="comment">// ç¬¬äºŒç§æ–¹å¼(å®¹æ˜“ç†è§£)</span></span><br><span class="line">         Integer[] integer1 = <span class="keyword">new</span> Integer[arrayList.size()];</span><br><span class="line">         arrayList.toArray(integer1);</span><br><span class="line"></span><br><span class="line">         <span class="comment">// æŠ›å‡ºå¼‚å¸¸ï¼Œjavaä¸æ”¯æŒå‘ä¸‹è½¬å‹</span></span><br><span class="line">         <span class="comment">//Integer[] integer2 = new Integer[arrayList.size()];</span></span><br><span class="line">         <span class="comment">//integer2 = arrayList.toArray();</span></span><br><span class="line">         System.out.println();</span><br><span class="line"></span><br><span class="line">         <span class="comment">// åœ¨æŒ‡å®šä½ç½®æ·»åŠ å…ƒç´ </span></span><br><span class="line">         arrayList.add(<span class="number">2</span>,<span class="number">2</span>);</span><br><span class="line">         <span class="comment">// åˆ é™¤æŒ‡å®šä½ç½®ä¸Šçš„å…ƒç´ </span></span><br><span class="line">         arrayList.remove(<span class="number">2</span>);    </span><br><span class="line">         <span class="comment">// åˆ é™¤æŒ‡å®šå…ƒç´ </span></span><br><span class="line">         arrayList.remove((Object)<span class="number">3</span>);</span><br><span class="line">         <span class="comment">// åˆ¤æ–­arrayListæ˜¯å¦åŒ…å«5</span></span><br><span class="line">         System.out.println(<span class="string">"ArrayList contains 5 is: "</span> + arrayList.contains(<span class="number">5</span>));</span><br><span class="line"></span><br><span class="line">         <span class="comment">// æ¸…ç©ºArrayList</span></span><br><span class="line">         arrayList.clear();</span><br><span class="line">         <span class="comment">// åˆ¤æ–­ArrayListæ˜¯å¦ä¸ºç©º</span></span><br><span class="line">         System.out.println(<span class="string">"ArrayList is empty: "</span> + arrayList.isEmpty());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://github.com/Snailclimb/JavaGuide/blob/master/Java%E7%9B%B8%E5%85%B3/ArrayList.md" target="_blank" rel="noopener">æŸ¥çœ‹åŸæ–‡</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> arrayList </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨Nginxåšåå‘ä»£ç†,è®¾ç½®è¯·æ±‚è¿”å›æ—¶å¸¦ä¸Šè¢«ä»£ç†æœºå™¨çš„ä¿¡æ¯</title>
      <link href="/post/8f4c3efa.html"/>
      <url>/post/8f4c3efa.html</url>
      
        <content type="html"><![CDATA[<p>ç°åœ¨çš„å¤§å®¶ç»å¸¸ä½¿ç”¨Nginxåšä»£ç†ï¼Œä¾‹å¦‚ç”¨Nginxå»ä»£ç†Nodeã€‚å¦‚æœä»£ç†çš„Nodeè¿‡å¤šï¼ŒNodeä¸€æ—¦å‡ºç°é—®é¢˜æˆ‘ä»¬æ€ä¹ˆçŸ¥é“åˆ°åº•æ˜¯å“ªä¸ªå‡ºäº†é—®é¢˜å‘¢ï¼Ÿäºæ˜¯å°±æœ‰äº†ä»Šå¤©çš„æ–‡ç« ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®è¯·æ±‚è¿”å›æ—¶å¸¦ä¸Šè¢«ä»£ç†æœºå™¨çš„ä¸€äº›ä¿¡æ¯ã€‚</p><a id="more"></a><ol><li>Nginxçš„é…ç½®<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">upstream usa &#123;</span><br><span class="line">    server 127.0.0.1:3001; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">    listen       80 ;</span><br><span class="line">    server_name   xxx.com ; </span><br><span class="line">    error_log    /var/log/nginx/tianxingusa_error.log    error;</span><br><span class="line">    access_log    /var/log/nginx/tianxingusa_accss.log    main;</span><br><span class="line">    </span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">        proxy_set_header Host  $http_host;</span><br><span class="line">        proxy_set_header X-Nginx-Proxy true;</span><br><span class="line"></span><br><span class="line">        add_header Proxy-Node $upstream_addr;</span><br><span class="line">        add_header Proxy-Status $upstream_status;</span><br><span class="line"></span><br><span class="line">        proxy_http_version 1.1;</span><br><span class="line">        proxy_pass    http://usa;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">   #</span><span class="bash">çœç•¥éƒ¨åˆ†ä¿¡æ¯</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>ä¸Šé¢é…ç½®ä¸­<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">add_header Proxy-Node $upstream_addr;</span><br><span class="line">add_header Proxy-Status $upstream_status;</span><br></pre></td></tr></table></figure>è®¾ç½®äº†Proxy-Nodeå’ŒProxy-Statusä¸¤ä¸ªheaderï¼ŒProxy-Nodeæ˜¾ç¤ºçš„æ˜¯è¢«ä»£ç†çš„èŠ‚ç‚¹ï¼ŒProxy-Statusæ˜¾ç¤ºçš„æ˜¯è¢«ä»£ç†èŠ‚ç‚¹çš„çŠ¶æ€ï¼Œé…ç½®å¥½ä¹‹åé‡è½½Nginxçš„é…ç½®æ–‡ä»¶ã€‚æˆ‘ä»¬å°±å¯ä»¥åœ¨ Response Headers ä¸­çœ‹åˆ°ç›¸å…³çš„ä¿¡æ¯ï¼š<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Server: nginx</span><br><span class="line">Date: Fri, 09 Nov 2018 03:07:55 GMT</span><br><span class="line">Content-Type: text/html; charset=UTF-8</span><br><span class="line">Content-Length: 1227</span><br><span class="line">Connection: keep-alive</span><br><span class="line">X-Powered-By: Express</span><br><span class="line">Accept-Ranges: bytes</span><br><span class="line">Cache-Control: public, max-age=0</span><br><span class="line">Last-Modified: Fri, 26 Oct 2018 10:11:49 GMT</span><br><span class="line">ETag: W/"4cb-166afdbcd67"</span><br><span class="line">Proxy-Node: 127.0.0.1:3001</span><br><span class="line">Proxy-Status: 200</span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> nginx </tag>
            
            <tag> proxy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring Boot 1.x ä¸­æ•´åˆSharding-JDBCå®ç°è¯»å†™åˆ†ç¦»</title>
      <link href="/post/6d3d362b.html"/>
      <url>/post/6d3d362b.html</url>
      
        <content type="html"><![CDATA[<p>å›½åº†æœŸé—´ç ”ç©¶äº†æ•°æ®åº“ä¸­é—´ä»¶ä¾‹å¦‚Mycatå’ŒSharding JDBCï¼ŒSharding-jdbcå’ŒMycatä½¿ç”¨ä¸åŒçš„ç†å¿µï¼ŒSharding-jdbcç›®å‰æ˜¯åŸºäºJdbcé©±åŠ¨ï¼Œæ— éœ€é¢å¤–çš„proxyï¼Œå› æ­¤ä¹Ÿæ— éœ€å…³æ³¨proxyæœ¬èº«çš„é«˜å¯ç”¨ã€‚Mycat æ˜¯åŸºäº Proxyï¼Œå®ƒå¤å†™äº† MySQL åè®®ï¼Œå°† Mycat Server ä¼ªè£…æˆä¸€ä¸ª MySQL æ•°æ®åº“ï¼Œè€Œ Sharding-JDBC æ˜¯åŸºäº JDBC æ¥å£çš„æ‰©å±•ï¼Œæ˜¯ä»¥jaråŒ…çš„å½¢å¼æä¾›è½»é‡çº§æœåŠ¡çš„ã€‚</p><a id="more"></a><p>å…ˆä»‹ç»ä¸€ä¸‹æ•´åˆè¿‡ç¨‹ä¸­ç”¨åˆ°çš„ä¸»è¦è½¯ä»¶çš„ç‰ˆæœ¬ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Spring Boot: <span class="number">1.5</span><span class="number">.8</span>.RELEASE</span><br><span class="line">Sharding-JDBC: <span class="number">2.0</span><span class="number">.3</span></span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼š</strong> å®ç°è¯»å†™åˆ†ç¦»æˆ‘ä»¬è‡ªå·±è¦å…ˆé…ç½®å¥½MySQLçš„ä¸»ä»å¤åˆ¶ï¼Œæˆ‘è‡ªå·±å·²ç»é…ç½®å¥½äº†ä¸€ä¸»ä¸¤ä»ã€‚é…ç½®çš„æ­¥éª¤å¯ä»¥å‚è€ƒ<a href="/archives/19.html">ã€å®ç°MySQLä¸»ä»å¤åˆ¶ã€‘</a></p><h4 id="pom-xml-ä¾èµ–"><a href="#pom-xml-ä¾èµ–" class="headerlink" title="pom.xml ä¾èµ–"></a>pom.xml ä¾èµ–</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.shardingjdbc<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>sharding-jdbc-core-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="applicationé…ç½®æ–‡ä»¶"><a href="#applicationé…ç½®æ–‡ä»¶" class="headerlink" title="applicationé…ç½®æ–‡ä»¶"></a>applicationé…ç½®æ–‡ä»¶</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">server.port=<span class="number">8080</span></span><br><span class="line"></span><br><span class="line">sharding.jdbc.datasource.names=ds_master,ds_slave_1,ds_slave_2</span><br><span class="line"></span><br><span class="line"># ä¸»æ•°æ®æº</span><br><span class="line">sharding.jdbc.datasource.ds_master.type=com.alibaba.druid.pool.DruidDataSource</span><br><span class="line">sharding.jdbc.datasource.ds_master.driver-<span class="class"><span class="keyword">class</span>-<span class="title">name</span></span>=com.mysql.jdbc.Driver</span><br><span class="line">sharding.jdbc.datasource.ds_master.url=jdbc:mysql:<span class="comment">//localhost:3306/db1?characterEncoding=utf-8</span></span><br><span class="line">sharding.jdbc.datasource.ds_master.username=root</span><br><span class="line">sharding.jdbc.datasource.ds_master.password=<span class="number">123456</span></span><br><span class="line">sharding.jdbc.datasource.ds_master.maxPoolSize=<span class="number">20</span></span><br><span class="line"></span><br><span class="line"># ä»æ•°æ®æº ds_slave_1</span><br><span class="line">sharding.jdbc.datasource.ds_slave_1.type=com.alibaba.druid.pool.DruidDataSource</span><br><span class="line">sharding.jdbc.datasource.ds_slave_1.driver-<span class="class"><span class="keyword">class</span>-<span class="title">name</span></span>=com.mysql.jdbc.Driver</span><br><span class="line">sharding.jdbc.datasource.ds_slave_1.url=jdbc:mysql:<span class="comment">//localhost:3307/db1?characterEncoding=utf-8</span></span><br><span class="line">sharding.jdbc.datasource.ds_slave_1.username=root</span><br><span class="line">sharding.jdbc.datasource.ds_slave_1.password=<span class="number">123456</span></span><br><span class="line">sharding.jdbc.datasource.ds_slave_1.maxPoolSize=<span class="number">20</span></span><br><span class="line"></span><br><span class="line"># ä»æ•°æ®æº ds_slave_2</span><br><span class="line">sharding.jdbc.datasource.ds_slave_2.type=com.alibaba.druid.pool.DruidDataSource</span><br><span class="line">sharding.jdbc.datasource.ds_slave_2.driver-<span class="class"><span class="keyword">class</span>-<span class="title">name</span></span>=com.mysql.jdbc.Driver</span><br><span class="line">sharding.jdbc.datasource.ds_slave_2.url=jdbc:mysql:<span class="comment">//localhost:3308/db1?characterEncoding=utf-8</span></span><br><span class="line">sharding.jdbc.datasource.ds_slave_2.username=root</span><br><span class="line">sharding.jdbc.datasource.ds_slave_2.password=<span class="number">123456</span></span><br><span class="line">sharding.jdbc.datasource.ds_slave_2.maxPoolSize=<span class="number">20</span></span><br><span class="line"></span><br><span class="line"># è¯»å†™åˆ†ç¦»é…ç½®</span><br><span class="line">sharding.jdbc.config.masterslave.load-balance-algorithm-type=round_robin</span><br><span class="line">sharding.jdbc.config.masterslave.name=dataSource</span><br><span class="line">sharding.jdbc.config.masterslave.master-data-source-name=ds_master</span><br><span class="line">sharding.jdbc.config.masterslave.slave-data-source-names=ds_slave_1,ds_slave_2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mybatis.config-location=classpath:mybatis-config.xml</span><br><span class="line">mybatis.mapper-locations=classpath:mapper<span class="comment">/*.xml</span></span><br><span class="line"><span class="comment">mybatis.typeAliasesPackage=net.ydstuio.shardingjdbc.repository</span></span><br></pre></td></tr></table></figure><ul><li><p>sharding.jdbc.config.masterslave.load-balance-algorithm-type<br>æŸ¥è¯¢æ—¶çš„è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œç›®å‰æœ‰2ç§ç®—æ³•ï¼Œround_robinï¼ˆè½®è¯¢ï¼‰å’Œrandomï¼ˆéšæœºï¼‰ã€‚</p></li><li><p>ç®—æ³•æ¥å£æ˜¯ï¼šio.shardingjdbc.core.api.algorithm.masterslave.MasterSlaveLoadBalanceAlgorithmã€‚</p></li><li><p>å®ç°ç±»æœ‰RandomMasterSlaveLoadBalanceAlgorithmå’ŒRoundRobinMasterSlaveLoadBalanceAlgorithmã€‚</p></li><li><p>sharding.jdbc.config.masterslave.master-data-source-name ä¸»æ•°æ®æºåç§°ã€‚</p></li><li><p>sharding.jdbc.config.masterslave.slave-data-source-names ä»æ•°æ®æºåç§°ï¼Œå¤šä¸ªç”¨é€—å·éš”å¼€ã€‚</p></li></ul><p>åˆ°æ­¤ï¼ŒSharing-Jdbcçš„è¯»å†™åˆ†ç¦»å°±å·²ç»å°±é…ç½®å¥½äº†ï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯å¾ˆç®€å•ã€‚å¦‚æœå¯¹æ•°æ®çš„åŠæ—¶æ€§è¦æ±‚å¾ˆé«˜ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä»£ç ï¼Œä½¿å¾—è¯»å–ä¹Ÿè½åˆ°ä¸»åº“ä¸Šã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¼ºåˆ¶è·¯ç”±ä¸»åº“</span></span><br><span class="line">HintManager.getInstance().setMasterRouteOnly();</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> spring boot </tag>
            
            <tag> sharding-jdbc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring Boot 1.5.8æ•´åˆDubbo</title>
      <link href="/post/53410e91.html"/>
      <url>/post/53410e91.html</url>
      
        <content type="html"><![CDATA[<p>åºŸè¯ä¸å¤šè¯´ï¼Œä»Šå¤©è¯´è¯´Spring Bootå’ŒDubboçš„æ•´åˆ,æ³¨å†ŒæœåŠ¡ä¸­å¿ƒç”¨çš„æ˜¯Zookeeperï¼Œè‡³äºDubboã€Zookeeperä¸ºä½•ç‰©æˆ‘åœ¨æ­¤ä¸å†å¤šè¨€ï¼Œä¸çŸ¥é“æ˜¯ä»€ä¹ˆè‡ªå·±å»ç™¾åº¦ï¼Œæœ¬æ–‡é€‚ç”¨äºå¯¹å¾®æœåŠ¡æˆ–è€…RPCäº†è§£çš„äººå‡†å¤‡çš„ï¼</p><a id="more"></a><p>  å…ˆä»‹ç»ä¸€ä¸‹æ•´åˆè¿‡ç¨‹ä¸­ç”¨åˆ°çš„ä¸»è¦è½¯ä»¶çš„ç‰ˆæœ¬ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Spring Boot: <span class="number">1.5</span><span class="number">.8</span>.RELEASE</span><br><span class="line">Dubbo: dubbo-spring-boot-starter <span class="number">0.1</span><span class="number">.1</span></span><br><span class="line">Zookeeper: <span class="number">3.4</span><span class="number">.10</span></span><br><span class="line">dubbo-adminï¼š<span class="number">2.5</span><span class="number">.4</span></span><br></pre></td></tr></table></figure><p>å…¶ä¸­dubbo-adminä½¿ç”¨çš„æ˜¯è€ç‰ˆæœ¬çš„ï¼Œæ–°ç‰ˆæœ¬çš„å¤§å®¶å¯ä»¥åˆ°githubä¸Šå»æœç´¢ï¼Œè¿™é‡Œç»™å‡ºè¿™ä¸ªç‰ˆæœ¬çš„ä¸‹è½½åœ°å€ï¼Œæˆ‘ä¸ä¿è¯ä»»ä½•æ—¶å€™éƒ½å¯ä»¥ä½¿ç”¨<br><a href="http://files.git.oschina.net/group1/M00/02/8C/PaAvDFo5ucaAR9erAZJTkl50Dto401.war?token=c66854e7d9046899e84dd1c1d96a0065&ts=1538744101&attname=dubbo-admin-2.5.4.war" target="_blank" rel="noopener">dubbo-admin-2.5.4</a><br>Dubboä½¿ç”¨çš„æ˜¯alibabaå®˜æ–¹æä¾›çš„starter ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>dubbo-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.1.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¦‚æœæ‚¨çš„å·¥ç¨‹é‡åˆ°äº†ä¾èµ–é—®é¢˜, è¯·å°è¯•æ·»åŠ å¦‚ä¸‹ Maven å‚è€ƒåˆ°å·¥ç¨‹çš„ pom.xml æ–‡ä»¶ä¸­ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">repositories</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">repository</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span>&gt;</span>sonatype-nexus-snapshots<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://oss.sonatype.org/content/repositories/snapshots<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">releases</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">enabled</span>&gt;</span>false<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">releases</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">snapshots</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">snapshots</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">repository</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">repositories</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä»ç°åœ¨å¼€å§‹, dubbo-spring-boot-project å°†åœ¨æ¯ä¸ªå‘å¸ƒä¸­å‘è¡Œä¸¤ä¸ªç‰ˆæœ¬ :</p><ul><li><a href="https://github.com/apache/incubator-dubbo-spring-boot-project" target="_blank" rel="noopener">0.2.x</a> æ˜¯æ”¯æŒ Spring Boot 2.x çš„ä¸»è¦ç‰ˆæœ¬ï¼ˆæ¨èï¼Œé•¿æœŸç»´æŠ¤ï¼‰</li><li><a href="https://github.com/apache/incubator-dubbo-spring-boot-project/tree/0.1.x" target="_blank" rel="noopener">0.1.x</a> æ˜¯æ”¯æŒ Spring Boot 1.x çš„ç»´æŠ¤ç‰ˆæœ¬ï¼ˆå…¼å®¹ï¼ŒçŸ­æœŸç»´æŠ¤ï¼‰<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ç‰ˆæœ¬JavaSpring BootDubbo</span><br><span class="line">0.2.01.8+2.0.x2.6.2+</span><br><span class="line">0.1.11.7+1.5.x2.6.2+</span><br></pre></td></tr></table></figure>ä»¥ä¸Šç‰µæ¶‰åˆ°éœ€è¦å®‰è£…çš„è½¯ä»¶ï¼Œéœ€è¦å¤§å®¶è‡ªè¡Œå‡†å¤‡ï¼Œæœ¬æ–‡çš„é‡ç‚¹ä¸åœ¨äºæ­¤ï¼å‹æƒ…æç¤º,ä½¿ç”¨ä¸Šé¢ç‰ˆæœ¬çš„dubbo-adminæ˜¯ä¸ªwaråŒ…å¯ä»¥ä¹‹å‰éƒ¨ç½²åœ¨Tomcatä¸­ï¼Œæ³¨æ„å…¶ä¸­é…ç½®æ–‡ä»¶ä¸­çš„Zookeeperçš„åœ°å€ï¼Œè¯·ä¿®æ”¹æˆè‡ªå·±å¯ç”¨çš„Zookeeperåœ°å€ï¼</li></ul><p>æˆ‘ä¹‹å‰å†™è¿‡ä¸€ä¸ªåŸºäºSpring Bootå’ŒSpring Cloudçš„BTæœç´¢é¡¹ç›®ï¼Œæˆ‘ä¸»è¦æ˜¯æƒ³ç”¨è¿™ä¸ªé¡¹ç›®ç»ƒæ‰‹Spring Cloudï¼Œå…¶ä¸­ç”¨äº†Zuulã€Feginã€Ribbonã€Spring Configã€Hystrixã€Eurekaç­‰ç»„ä»¶ã€‚ä¸‹é¢å¼€å§‹æ­£å¼çš„ç¼–ç ï¼ŒSpring Bootå’ŒDubboçš„æ•´åˆã€‚å…¶ä¸­é—®é¢˜æœ‰å¾ˆå¤šï¼Œæµªè´¹äº†æˆ‘å›½åº†å‡æœŸä¸­çš„ä¸€å¤©ï¼Œå…¶å®æœ€åå‘ç°é—®é¢˜è§£å†³å¾ˆç®€å•ã€‚</p><p>####ç”±æœåŠ¡æä¾›æ–¹ä¸ºæœåŠ¡æ¶ˆè´¹æ–¹æš´éœ²æ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> net.ydstudio.dubbo.search.api.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> net.ydstudio.dubbo.search.api.document.BtSearchDocument;</span><br><span class="line"><span class="keyword">import</span> net.ydstudio.dubbo.search.api.model.EsSearchHotResult;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by Sam on 18/7/7.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BtSearchService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  åˆ›å»ºç´¢å¼•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">Boolean <span class="title">createIndex</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šè¿‡wordæŸ¥è¯¢ æ–‡æ¡£</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> word</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">BtSearchDocument <span class="title">findOne</span><span class="params">(String word)</span> <span class="keyword">throws</span> IOException</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®idåˆ é™¤æ–‡æ¡£</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> word</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">Boolean <span class="title">delete</span><span class="params">(String word)</span> <span class="keyword">throws</span> IOException</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¿å­˜ document</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> word</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> true or false</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">Boolean <span class="title">save</span><span class="params">(String word)</span> <span class="keyword">throws</span> IOException</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤ç´¢å¼•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">Boolean <span class="title">deleteIndex</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * çƒ­æœè¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">EsSearchHotResult <span class="title">hotWordList</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>####æœåŠ¡æä¾›æ–¹</p><h5 id="pom-xmlä¸­çš„ä¾èµ–"><a href="#pom-xmlä¸­çš„ä¾èµ–" class="headerlink" title="pom.xmlä¸­çš„ä¾èµ–"></a>pom.xmlä¸­çš„ä¾èµ–</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>net.ydstudio.dubbo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>search-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>dubbo-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.1.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="å®ç°æš´éœ²çš„æ¥å£"><a href="#å®ç°æš´éœ²çš„æ¥å£" class="headerlink" title="å®ç°æš´éœ²çš„æ¥å£"></a>å®ç°æš´éœ²çš„æ¥å£</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> net.ydstudio.dubbo.search.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.config.annotation.Service;</span><br><span class="line"><span class="keyword">import</span> io.searchbox.client.JestClient;</span><br><span class="line"><span class="keyword">import</span> io.searchbox.client.JestResult;</span><br><span class="line"><span class="keyword">import</span> io.searchbox.core.Search;</span><br><span class="line"><span class="keyword">import</span> net.ydstudio.dubbo.search.api.document.BtSearchDocument;</span><br><span class="line"><span class="keyword">import</span> net.ydstudio.dubbo.search.api.model.EsSearchHotResult;</span><br><span class="line"><span class="keyword">import</span> net.ydstudio.dubbo.search.api.service.BtSearchService;</span><br><span class="line"><span class="keyword">import</span> net.ydstudio.dubbo.search.util.Md5Util;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.index.query.BoolQueryBuilder;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.index.query.QueryBuilder;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.index.query.QueryBuilders;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.search.builder.SearchSourceBuilder;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.search.sort.FieldSortBuilder;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.search.sort.SortBuilders;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.search.sort.SortOrder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.io.Resource;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.StringUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by Sam on 18/7/7.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BtSearchServiceImpl</span> <span class="keyword">implements</span> <span class="title">BtSearchService</span>,<span class="title">EsSearchService</span>&lt;<span class="title">BtSearchDocument</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç´¢å¼•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String INDEX_NAME = <span class="string">"search"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç´¢å¼•ç±»å‹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String TYPE = <span class="string">"searchWord"</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"classpath:mapping/searchMapping.json"</span>)</span><br><span class="line">    <span class="keyword">private</span> Resource mappingFile;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> JestClient jestClient;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Boolean <span class="title">createIndex</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> createESIndex(jestClient, mappingFile, INDEX_NAME, TYPE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> BtSearchDocument <span class="title">findOne</span><span class="params">(String word)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        String id  = Md5Util.md5(word);</span><br><span class="line">        <span class="keyword">return</span> findDocument(jestClient, INDEX_NAME, TYPE, id, BtSearchDocument<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Boolean <span class="title">delete</span><span class="params">(String word)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        String id  = Md5Util.md5(word);</span><br><span class="line">        <span class="keyword">return</span> deleteDocument(jestClient, INDEX_NAME, TYPE, id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Boolean <span class="title">save</span><span class="params">(String word)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        String id  = Md5Util.md5(word);</span><br><span class="line">        BtSearchDocument document = <span class="keyword">this</span>.findOne(id);</span><br><span class="line"></span><br><span class="line">        SimpleDateFormat format = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd HH:mm:ss"</span>);</span><br><span class="line">        Date date = <span class="keyword">new</span> Date();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isEmpty(document))&#123;</span><br><span class="line">            document = <span class="keyword">new</span> BtSearchDocument();</span><br><span class="line">            document.setId(id);</span><br><span class="line">            document.setCreated(format.format(date));</span><br><span class="line">            document.setNum(<span class="number">1</span>);</span><br><span class="line">            document.setWord(word);</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            document.setNum(document.getNum()+<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        document.setUpdated(format.format(date));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> saveDocument(jestClient, INDEX_NAME, TYPE, id, document);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Boolean <span class="title">deleteIndex</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> deleteESIndex(jestClient, INDEX_NAME);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> EsSearchHotResult <span class="title">hotWordList</span><span class="params">()</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//    match_all</span></span><br><span class="line">        BoolQueryBuilder boolQuery = QueryBuilders.boolQuery();</span><br><span class="line">        SearchSourceBuilder searchSourceBuilder = <span class="keyword">new</span> SearchSourceBuilder();</span><br><span class="line"></span><br><span class="line">        QueryBuilder queryBuilder = QueryBuilders.matchAllQuery();</span><br><span class="line">        boolQuery.must(queryBuilder);</span><br><span class="line"></span><br><span class="line">        FieldSortBuilder sortBuilder = SortBuilders.fieldSort(<span class="string">"num"</span>);</span><br><span class="line">        sortBuilder.order(SortOrder.DESC);</span><br><span class="line">        searchSourceBuilder.query(boolQuery);</span><br><span class="line"></span><br><span class="line">        searchSourceBuilder.sort(sortBuilder);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ„å»ºSearchå¯¹è±¡</span></span><br><span class="line">        Search search = <span class="keyword">new</span> Search.Builder(searchSourceBuilder.toString())</span><br><span class="line">                .addIndex(INDEX_NAME)</span><br><span class="line">                .addType(TYPE)</span><br><span class="line">                .build();</span><br><span class="line"></span><br><span class="line">        EsSearchHotResult esSearchHotResult = <span class="keyword">new</span> EsSearchHotResult();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            JestResult result = jestClient.execute(search);</span><br><span class="line">            List&lt;BtSearchDocument&gt; list = result.getSourceAsObjectList(BtSearchDocument<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            esSearchHotResult.setTook(result.getValue(<span class="string">"took"</span>).toString());</span><br><span class="line">            esSearchHotResult.setDocumentList(list);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> esSearchHotResult;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>searchæœåŠ¡æä¾›æ–¹çš„applicationçš„é…ç½®ä¿¡æ¯ï¼š</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">dubbo:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">id:</span> <span class="string">search-provider</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">search-provider</span></span><br><span class="line">  <span class="attr">protocosl:</span></span><br><span class="line">    <span class="attr">id:</span> <span class="string">dubbo</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">dubbo</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">20880</span></span><br><span class="line">  <span class="attr">scan:</span></span><br><span class="line">    <span class="attr">basePackages:</span> <span class="string">net.ydstudio.dubbo.search.service</span></span><br><span class="line">  <span class="attr">registry:</span></span><br><span class="line">    <span class="attr">id:</span> <span class="string">my-registry</span></span><br><span class="line">    <span class="attr">address:</span> <span class="string">zookeeper://xx.xx.xxx.xxx:xxx</span></span><br><span class="line">    <span class="attr">parameters:</span></span><br><span class="line">      <span class="attr">max-active:</span> <span class="number">8</span></span><br><span class="line">      <span class="attr">max-wait:</span> <span class="number">-1</span></span><br><span class="line">      <span class="attr">max-idle:</span> <span class="number">8</span></span><br><span class="line">      <span class="attr">min-idle:</span> <span class="number">0</span></span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong> basePackagesé¡¹é…ç½®çš„åŒ…è·¯å¾„ï¼Œä»–å¯¹åº”çš„æ˜¯è®¾ç½®æ‰«æè·¯å¾„å³è¢«æ³¨è§£@serviceå’Œ@Referenceæè¿°çš„æ¥å£ï¼ˆæˆ–è€…è¯´æ˜¯æš´éœ²æ¥å£çš„å®ç°ç±»çš„åŒ…è·¯å¾„ï¼Œè¿™ä¸ªå¾ˆé‡è¦ï¼Œæˆ‘åœ¨æ­¤å¤„è€½æäº†å¾ˆä¹…ï¼‰,è¿™ä¸ªé…ç½®å¯ä»¥ä½¿ç”¨ @EnableDubbo æ³¨è§£æ›¿ä»£ï¼ˆåŠ åœ¨å¯åŠ¨ç±»ä¸Šï¼‰</p><p>####æœåŠ¡æ¶ˆè´¹æ–¹<br>#####pom.xmlä¸­çš„ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>net.ydstudio.dubbo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>bt-model<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>net.ydstudio.dubbo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>search-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>dubbo-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.1.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--thymeleaf--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>net.sourceforge.nekohtml<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>nekohtml<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.generator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-generator-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.generator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-generator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h5><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">dubbo:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">id:</span> <span class="string">bt-search</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">bt-search</span></span><br><span class="line">  <span class="attr">protocosl:</span></span><br><span class="line">    <span class="attr">id:</span> <span class="string">dubbo</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">dubbo</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">20880</span></span><br><span class="line">  <span class="attr">scan:</span></span><br><span class="line">    <span class="attr">basePackages:</span> <span class="string">net.ydstudio.dubbo.bt</span></span><br><span class="line">  <span class="attr">registry:</span></span><br><span class="line">    <span class="attr">id:</span> <span class="string">my-registry</span></span><br><span class="line">    <span class="attr">address:</span> <span class="string">zookeeper://xx.xx.xxx.xxx:xxx</span></span><br><span class="line">    <span class="attr">parameters:</span></span><br><span class="line">      <span class="attr">max-active:</span> <span class="number">8</span></span><br><span class="line">      <span class="attr">max-wait:</span> <span class="number">-1</span></span><br><span class="line">      <span class="attr">max-idle:</span> <span class="number">8</span></span><br><span class="line">      <span class="attr">min-idle:</span> <span class="number">0</span></span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong> basePackages è®¾ç½®æ‰«æè·¯å¾„,æ‰«æè¢«æ³¨è§£@serviceå’Œ@Referenceçš„æ¥å£</p><h5 id="RPCè°ƒç”¨"><a href="#RPCè°ƒç”¨" class="headerlink" title="RPCè°ƒç”¨"></a>RPCè°ƒç”¨</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Reference</span></span><br><span class="line"><span class="keyword">private</span> BtSearchService  btSearchService;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨com.alibaba.dubbo.config.annotation.Referenceä¸­çš„ @Referenceæ³¨è§£ä¿®é¥°æ¥å£BtSearchService ï¼Œç„¶ååƒæ™®é€šçš„beanä½¿ç”¨å³å¯ã€‚</p><h4 id="æ•´åˆæ€»ç»“"><a href="#æ•´åˆæ€»ç»“" class="headerlink" title="æ•´åˆæ€»ç»“"></a>æ•´åˆæ€»ç»“</h4><p>ç”±äºè½¯ä»¶æ›´æ–°çš„å¿«ï¼Œæˆ–è€…è½¯ä»¶é¡¹ç›®çš„ç”Ÿå­˜å‘¨æœŸå¤ªçŸ­ï¼Œè½¯ä»¶å¯¹åº”çš„è¯´æ˜æ–‡æ¡£ä¼šè·Ÿä¸ä¸Šã€‚Dubboç°åœ¨å·²ç»æçŒ®ç»™äº†Apacheï¼Œè¿™ä¸€æ–¹é¢å¯èƒ½ä¼šå¥½ä¸€ç‚¹ã€‚å¤§å®¶åœ¨å¼€å‘çš„æ—¶å€™æ³¨æ„ç»†å¿ƒä¸€ç‚¹ï¼Œå¤šå»çœ‹çœ‹GitHubï¼Œä¸ç„¶é—®é¢˜ä¼šå¾ˆå¤šï¼</p><p><strong>é™„æ³¨å‚è€ƒèµ„æ–™</strong><br><a href="https://github.com/apache/incubator-dubbo-spring-boot-project" target="_blank" rel="noopener">ã€å®˜æ–¹Dubboå’ŒSpring Bootæ•´åˆçš„GitHubåœ°å€ã€‘</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> dubbo </tag>
            
            <tag> spring boot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mycat æ•°æ®åº“åˆ†åº“åˆ†è¡¨ä¸­é—´ä»¶çš„åˆ†åº“é…ç½®</title>
      <link href="/post/dcd836f7.html"/>
      <url>/post/dcd836f7.html</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ–‡æ˜¯Mycat æ•°æ®åº“åˆ†åº“åˆ†è¡¨ä¸­é—´ä»¶ç³»åˆ—æ–‡ç« çš„ç¬¬ä¸‰ç¯‡ï¼Œå¹³æ—¶å·¥ä½œå¤ªå¿™ï¼ŒåŠ ä¸Šåˆå¿™ç€ä»PHPè½¬Javaï¼Œå¹³æ—¥çš„ç©ºé—²æ—¶é—´éƒ½å»ç ”ç©¶Javaäº†ã€‚ä»€ä¹ˆSpring MVCã€Spring Bootã€Spring Cloudã€Dubboï¼Œä¸œè¥¿çœŸå°¼ç›çš„å¤šï¼æ­£å¥½å›½åº†ä¸€äººæ²¡äº‹å¹²ï¼Œå†æ¬¡æ‹¾èµ·æ¥Mycatçš„ç ”ç©¶ã€‚</p><a id="more"></a><p>  é¦–å…ˆï¼Œå…ˆæŒ‰ç…§ <a href="/archives/19.html">å®ç°MySQLä¸»ä»å¤åˆ¶</a> ä¸Šçš„æ­¥éª¤é…ç½®ä¸€ä¸ªç®€å•çš„MySQLä¸»ä»ç¯å¢ƒï¼Œå…ˆè´´ä¸€ä¸‹ç›¸å…³çš„é…ç½®ä¿¡æ¯ï¼š<br>MySQLä¸­Masterçš„é…ç½®ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[client]</span><br><span class="line">port=3306</span><br><span class="line">[mysql]</span><br><span class="line">default-character-set=utf8</span><br><span class="line"></span><br><span class="line">[mysqld]</span><br><span class="line">port=3306</span><br><span class="line">basedir="C:/phpStudy/MySQL/"</span><br><span class="line">datadir="C:/phpStudy/MySQL/data/"</span><br><span class="line">character-set-server=utf8</span><br><span class="line">collation-server=utf8_general_ci </span><br><span class="line">default-storage-engine=MyISAM</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">## add</span></span></span><br><span class="line">server-id=1</span><br><span class="line">log-bin =mysql-bin</span><br><span class="line">binlog-format = mixed</span><br><span class="line">binlog-do-db=db1 #æ­¤å‚æ•°è¡¨ç¤ºåªè®°å½•æŒ‡å®šæ•°æ®åº“çš„äºŒè¿›åˆ¶æ—¥å¿—ã€‚</span><br><span class="line">binlog-do-db=db2</span><br><span class="line">binlog-do-db=db3</span><br><span class="line"><span class="meta">#</span><span class="bash">binlog-ignore-db=api,mysql,performance_schema <span class="comment">#æ­¤å‚æ•°è¡¨ç¤ºå¿½ç•¥æŒ‡å®šçš„æ•°æ®åº“çš„äºŒè¿›åˆ¶æ—¥å¿—ã€‚</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">å…¶ä»–é…ç½®çœç•¥</span></span><br></pre></td></tr></table></figure><p>MySQLä¸­slaveçš„é…ç½®ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[client]</span><br><span class="line">port=3307</span><br><span class="line">[mysql]</span><br><span class="line">default-character-set=utf8</span><br><span class="line"></span><br><span class="line">[mysqld]</span><br><span class="line">port=3307</span><br><span class="line">basedir="C:/phpStudy/MySQL3307/"</span><br><span class="line">datadir="C:/phpStudy/MySQL3307/data/"</span><br><span class="line">character-set-server=utf8</span><br><span class="line">collation-server=utf8_general_ci </span><br><span class="line">default-storage-engine=MyISAM</span><br><span class="line"></span><br><span class="line">server-id=3307</span><br><span class="line">log-bin = mysql-bin</span><br><span class="line">binlog-format =mixed</span><br><span class="line">relay-log=mysql-relay</span><br><span class="line">slave-skip-errors=all #è·³è¿‡æ‰€æœ‰é”™è¯¯</span><br><span class="line"><span class="meta">#</span><span class="bash">å…¶ä»–é…ç½®çœç•¥</span></span><br></pre></td></tr></table></figure><p>åœ¨masterä¸Šåˆ›å»ºç”¨äºåŒæ­¥æ•°æ®çš„è´¦æˆ·ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">grant replication client,replication slave on *.* to slave3307@'%' identified by 'slave3307';</span><br><span class="line"><span class="meta">#</span><span class="bash">åˆ·æ–°æƒé™ï¼Œç«‹å³ç”Ÿæ•ˆ</span></span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure><p>åœ¨Masteræ‰§è¡Œå‘½ä»¤æŸ¥çœ‹log_poså’Œlog_file</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">show master status;</span><br><span class="line"></span><br><span class="line">   +------------------+----------+--------------+------------------+</span><br><span class="line">   | File             | Position | Binlog_Do_DB | Binlog_Ignore_DB |</span><br><span class="line">   +------------------+----------+--------------+------------------+</span><br><span class="line">   | mysql-bin.000062 |      8233|              |                  |</span><br><span class="line">   +------------------+----------+--------------+------------------+</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong> æ‰§è¡Œå®Œæ­¤æ­¥éª¤åä¸è¦å†æ“ä½œä¸»æœåŠ¡å™¨MYSQLï¼Œé˜²æ­¢ä¸»æœåŠ¡å™¨çŠ¶æ€å€¼å˜åŒ–</p><p>åœ¨slaveä¸Šæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œè®²masterå’Œslaveå…³è”èµ·æ¥ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hange master to master_host='127.0.0.1',master_port=3306,master_user='slave3307',</span><br><span class="line">master_password='slave3307',master_log_file='mysql-bin.000062',master_log_pos=8233;</span><br><span class="line"></span><br><span class="line">start slave #å¯åŠ¨ä»æœåŠ¡å™¨å¤åˆ¶åŠŸèƒ½</span><br><span class="line">show slave status\G</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ Slave_IO_Running å’Œ Slave_SQL_Running ä¸¤åˆ—çš„å€¼éƒ½ä¸º â€œYesâ€ï¼Œè¡¨æ˜ Slave çš„ I/O å’Œ SQL çº¿ç¨‹éƒ½åœ¨æ­£å¸¸è¿è¡Œã€‚æ­£å¸¸çš„è¡¨ç°å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> show slave status\G</span></span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">               Slave_IO_State: Waiting for master to send event</span><br><span class="line">                  Master_Host: 127.0.0.1</span><br><span class="line">                  Master_User: slave3307</span><br><span class="line">                  Master_Port: 3306</span><br><span class="line">                Connect_Retry: 60</span><br><span class="line">              Master_Log_File: mysql-bin.000007</span><br><span class="line">          Read_Master_Log_Pos: 24536</span><br><span class="line">               Relay_Log_File: mysql-relay.000005</span><br><span class="line">                Relay_Log_Pos: 24699</span><br><span class="line">        Relay_Master_Log_File: mysql-bin.000007</span><br><span class="line">             Slave_IO_Running: Yes</span><br><span class="line">            Slave_SQL_Running: Yes</span><br><span class="line">              Replicate_Do_DB:</span><br><span class="line">          Replicate_Ignore_DB:</span><br><span class="line">           Replicate_Do_Table:</span><br><span class="line">       Replicate_Ignore_Table:</span><br><span class="line">      Replicate_Wild_Do_Table:</span><br><span class="line">  Replicate_Wild_Ignore_Table:</span><br><span class="line">                   Last_Errno: 0</span><br><span class="line">                   Last_Error:</span><br><span class="line">                 Skip_Counter: 0</span><br><span class="line">          Exec_Master_Log_Pos: 24536</span><br><span class="line">              Relay_Log_Space: 25318</span><br><span class="line">              Until_Condition: None</span><br><span class="line">               Until_Log_File:</span><br><span class="line">                Until_Log_Pos: 0</span><br><span class="line">           Master_SSL_Allowed: No</span><br><span class="line">           Master_SSL_CA_File:</span><br><span class="line">           Master_SSL_CA_Path:</span><br><span class="line">              Master_SSL_Cert:</span><br><span class="line">            Master_SSL_Cipher:</span><br><span class="line">               Master_SSL_Key:</span><br><span class="line">        Seconds_Behind_Master: 0</span><br><span class="line">Master_SSL_Verify_Server_Cert: No</span><br><span class="line">                Last_IO_Errno: 0</span><br><span class="line">                Last_IO_Error:</span><br><span class="line">               Last_SQL_Errno: 0</span><br><span class="line">               Last_SQL_Error:</span><br><span class="line">  Replicate_Ignore_Server_Ids:</span><br><span class="line">             Master_Server_Id: 1</span><br><span class="line">                  Master_UUID: fe1b230d-6ee9-11e8-b0c6-9c5c8e103115</span><br><span class="line">             Master_Info_File: C:\phpStudy\MySQL3307\data\master.info</span><br><span class="line">                    SQL_Delay: 0</span><br><span class="line">          SQL_Remaining_Delay: NULL</span><br><span class="line">      Slave_SQL_Running_State: Slave has read all relay log; waiting for the slave I/O thread to update it</span><br><span class="line">           Master_Retry_Count: 86400</span><br><span class="line">                  Master_Bind:</span><br><span class="line">      Last_IO_Error_Timestamp:</span><br><span class="line">     Last_SQL_Error_Timestamp:</span><br><span class="line">               Master_SSL_Crl:</span><br><span class="line">           Master_SSL_Crlpath:</span><br><span class="line">           Retrieved_Gtid_Set:</span><br><span class="line">            Executed_Gtid_Set:</span><br><span class="line">                Auto_Position: 0</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure><p><strong>å‹æƒ…æç¤ºï¼š</strong>å¦‚æœæ˜¯ç›´æ¥å¤åˆ¶MySQLçš„å®‰è£…ç›®å½•é…ç½®çš„ä¸»ä»ï¼Œæ³¨æ„MySQL5.6å¼€å§‹çš„UUIDçš„é—®é¢˜ã€‚<br>ä¸‹é¢å¼€å§‹Mycatçš„é…ç½®ï¼ŒMycatä¸­æœ‰ä¸‰ä¸ªé‡è¦çš„é…ç½®æ–‡ä»¶ï¼šserver.xmlã€schema.xmlã€rule.xmlï¼Œä¸‹é¢å°±åˆ†åˆ«è´´ä¸€ä¸‹å¯¹åº”çš„é…ç½®ä¿¡æ¯ï¼š<br>server.xmlä¸­çš„é…ç½®ä¿¡æ¯ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE mycat:server SYSTEM "server.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mycat:server</span> <span class="attr">xmlns:mycat</span>=<span class="string">"http://io.mycat/"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">system</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"useSqlStat"</span>&gt;</span>0<span class="tag">&lt;/<span class="name">property</span>&gt;</span>  <span class="comment">&lt;!-- 1ä¸ºå¼€å¯å®æ—¶ç»Ÿè®¡ã€0ä¸ºå…³é—­ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"useGlobleTableCheck"</span>&gt;</span>0<span class="tag">&lt;/<span class="name">property</span>&gt;</span>  <span class="comment">&lt;!-- 1ä¸ºå¼€å¯å…¨åŠ ç­ä¸€è‡´æ€§æ£€æµ‹ã€0ä¸ºå…³é—­ --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sequnceHandlerType"</span>&gt;</span>2<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">&lt;!--é»˜è®¤ä¸ºtype 0: DirectByteBufferPool | type 1 ByteBufferArena--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"processorBufferPoolType"</span>&gt;</span>0<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">&lt;!--åˆ†å¸ƒå¼äº‹åŠ¡å¼€å…³ï¼Œ0ä¸ºä¸è¿‡æ»¤åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œ1ä¸ºè¿‡æ»¤åˆ†å¸ƒå¼äº‹åŠ¡ï¼ˆå¦‚æœåˆ†å¸ƒå¼äº‹åŠ¡å†…åªæ¶‰åŠå…¨å±€è¡¨ï¼Œåˆ™ä¸è¿‡æ»¤ï¼‰ï¼Œ2ä¸ºä¸è¿‡æ»¤åˆ†å¸ƒå¼äº‹åŠ¡,ä½†æ˜¯è®°å½•åˆ†å¸ƒå¼äº‹åŠ¡æ—¥å¿—--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"handleDistributedTransactions"</span>&gt;</span>0<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--off heap for merge/order/group/limit  1å¼€å¯   0å…³é—­--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"useOffHeapForMerge"</span>&gt;</span>1<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--å•ä½ä¸ºm--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"memoryPageSize"</span>&gt;</span>1m<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--å•ä½ä¸ºk--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"spillsFileBufferSize"</span>&gt;</span>1k<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"useStreamOutput"</span>&gt;</span>0<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--å•ä½ä¸ºm--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"systemReserveMemorySize"</span>&gt;</span>384m<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--æ˜¯å¦é‡‡ç”¨zookeeperåè°ƒåˆ‡æ¢  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"useZKSwitch"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">system</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">user</span> <span class="attr">name</span>=<span class="string">"root"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span>&gt;</span>mycat<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--å¤šä¸ªæ•°æ®åº“é€—å·éš”å¼€ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"schemas"</span>&gt;</span>testdb<span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">user</span> <span class="attr">name</span>=<span class="string">"mycatread"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span>&gt;</span>mycatread<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"schemas"</span>&gt;</span>testdb<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"readOnly"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mycat:server</span>&gt;</span></span><br></pre></td></tr></table></figure><p>schema.xmlä¸­çš„é…ç½®ä¿¡æ¯ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE mycat:schema SYSTEM "schema.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mycat:schema</span> <span class="attr">xmlns:mycat</span>=<span class="string">"http://io.mycat/"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">schema</span> <span class="attr">name</span>=<span class="string">"testdb"</span> <span class="attr">checkSQLschema</span>=<span class="string">"false"</span> <span class="attr">sqlMaxLimit</span>=<span class="string">"100"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">table</span> <span class="attr">name</span>=<span class="string">"t_user"</span> <span class="attr">dataNode</span>=<span class="string">"dn1,dn2,dn3"</span> <span class="attr">rule</span>=<span class="string">"crc32slot"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- çˆ¶è¡¨ä¸ºt_userï¼Œå­è¡¨ä¸ºt_adminã€‚t_adminè¡¨ä¸­çš„å­—æ®µuser_idå¼•ç”¨t_userè¡¨ä¸­çš„idä¸»é”®å­—æ®µã€‚ --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">childTable</span> <span class="attr">name</span>=<span class="string">"t_admin"</span> <span class="attr">joinKey</span>=<span class="string">"user_id"</span> <span class="attr">parentKey</span>=<span class="string">"id"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">schema</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dataNode</span> <span class="attr">name</span>=<span class="string">"dn1"</span> <span class="attr">dataHost</span>=<span class="string">"localhost1"</span> <span class="attr">database</span>=<span class="string">"db1"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dataNode</span> <span class="attr">name</span>=<span class="string">"dn2"</span> <span class="attr">dataHost</span>=<span class="string">"localhost1"</span> <span class="attr">database</span>=<span class="string">"db2"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dataNode</span> <span class="attr">name</span>=<span class="string">"dn3"</span> <span class="attr">dataHost</span>=<span class="string">"localhost1"</span> <span class="attr">database</span>=<span class="string">"db3"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dataHost</span> <span class="attr">name</span>=<span class="string">"localhost1"</span> <span class="attr">maxCon</span>=<span class="string">"1000"</span> <span class="attr">minCon</span>=<span class="string">"10"</span> <span class="attr">balance</span>=<span class="string">"1"</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">writeType</span>=<span class="string">"0"</span> <span class="attr">dbType</span>=<span class="string">"mysql"</span> <span class="attr">dbDriver</span>=<span class="string">"native"</span> <span class="attr">switchType</span>=<span class="string">"2"</span>  <span class="attr">slaveThreshold</span>=<span class="string">"100"</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">heartbeat</span>&gt;</span>show slave status<span class="tag">&lt;/<span class="name">heartbeat</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">writeHost</span> <span class="attr">host</span>=<span class="string">"hostM1"</span> <span class="attr">url</span>=<span class="string">"127.0.0.1:3306"</span> <span class="attr">user</span>=<span class="string">"root"</span> <span class="attr">password</span>=<span class="string">"123456"</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--&lt;readHost  host="hostS1" url="127.0.0.1:3307" user="root" password="123456"/&gt;--&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">writeHost</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dataHost</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mycat:schema</span>&gt;</span></span><br></pre></td></tr></table></figure><p>rule.xmlä¸­çš„é…ç½®ä¿¡æ¯ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">function</span> <span class="attr">name</span>=<span class="string">"crc32slot"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">class</span>=<span class="string">"io.mycat.route.function.PartitionByCRC32PreSlot"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"count"</span>&gt;</span>3<span class="tag">&lt;/<span class="name">property</span>&gt;</span><span class="comment">&lt;!-- è¦åˆ†ç‰‡çš„æ•°æ®åº“èŠ‚ç‚¹æ•°é‡ï¼Œå¿…é¡»æŒ‡å®šï¼Œå¦åˆ™æ²¡æ³•åˆ†ç‰‡ --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">function</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„ä¸‹é¢çš„åœ°æ–¹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--schema.xmlä¸­--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">name</span>=<span class="string">"t_user"</span> <span class="attr">dataNode</span>=<span class="string">"dn1,dn2,dn3"</span> <span class="attr">rule</span>=<span class="string">"crc32slot"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--rule.xmlä¸­--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">function</span> <span class="attr">name</span>=<span class="string">"crc32slot"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">class</span>=<span class="string">"io.mycat.route.function.PartitionByCRC32PreSlot"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"count"</span>&gt;</span>3<span class="tag">&lt;/<span class="name">property</span>&gt;</span><span class="comment">&lt;!-- è¦åˆ†ç‰‡çš„æ•°æ®åº“èŠ‚ç‚¹æ•°é‡ï¼Œå¿…é¡»æŒ‡å®šï¼Œå¦åˆ™æ²¡æ³•åˆ†ç‰‡ --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">function</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨crc32lotè¿›è¡Œåˆ†ç‰‡ï¼Œåˆ†ç‰‡çš„æ•°æ®åº“èŠ‚ç‚¹çš„æ•°é‡é»˜è®¤ç»™äº†2ï¼Œå¦‚æœä½ ä¿®æ”¹äº†è¿™é‡Œï¼Œè¯·ä¸€å®šè¦åˆ é™¤conf/ruledata/crc32slot_T_USER.propertiesè¿™ä¸ªæ–‡ä»¶ï¼Œå¹¶é‡æ–°å¯åŠ¨Mycatï¼Œä¸ç„¶ä½ çš„æ•°æ®æ˜¯ä¸ä¼šåˆ†åˆ°db3è¿™ä¸ªæ•°æ®åº“èŠ‚ç‚¹çš„ã€‚<br>åˆ°è¿™é‡ŒMycatåˆ†åº“é…ç½®å°±å®Œæˆäº†ï¼Œä½ åªéœ€è¦åœ¨Mycatçš„ç®¡ç†ä¸Šæ“ä½œï¼Œå°±èƒ½åœ¨masterã€slaveä¸Šçœ‹åˆ°æ•ˆæœï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">mysql&gt;</span><span class="bash">mysql -uroot -pmycat -P8066</span></span><br><span class="line">Warning: Using a password on the command line interface can be insecure.</span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is 3</span><br><span class="line">Server version: 5.6.29-mycat-1.6-RELEASE-20161028204710 MyCat Server (OpenCloun</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.</span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> insert into t_user(id, name) values(1, <span class="string">'aaa'</span>);</span></span><br><span class="line">Query OK, 1 row affected (0.02 sec)</span><br><span class="line"></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> insert into t_user(id, name) values(2, <span class="string">'bbb'</span>);</span></span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> insert into t_user(id, name) values(3, <span class="string">'ccc'</span>);</span></span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> insert into t_user(id, name) values(4, <span class="string">'ddd'</span>);</span></span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> insert into t_user(id, name) values(5, <span class="string">'eee'</span>);</span></span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br></pre></td></tr></table></figure><p>åœ¨masterä¸Šçœ‹æ•ˆæœï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\nick&gt;mysql -uroot -p123456</span><br><span class="line">Warning: Using a password on the command line interface can be insecure.</span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is 10628</span><br><span class="line">Server version: 5.6.40-log MySQL Community Server (GPL)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.</span><br><span class="line"></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> select * from db1.t_user;</span></span><br><span class="line">+----+------+-------+</span><br><span class="line">| id | name | _slot |</span><br><span class="line">+----+------+-------+</span><br><span class="line">|  3 | ccc  | 32411 |</span><br><span class="line">|  5 | eee  | 27566 |</span><br><span class="line">+----+------+-------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> select * from db2.t_user;</span></span><br><span class="line">+----+------+-------+</span><br><span class="line">| id | name | _slot |</span><br><span class="line">+----+------+-------+</span><br><span class="line">|  1 | aaa  | 44983 |</span><br><span class="line">|  2 | bbb  | 65037 |</span><br><span class="line">+----+------+-------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> select * from db3.t_user;</span></span><br><span class="line">+----+------+-------+</span><br><span class="line">| id | name | _slot |</span><br><span class="line">+----+------+-------+</span><br><span class="line">|  4 | ddd  | 68408 |</span><br><span class="line">+----+------+-------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure><p>åœ¨slaveä¸ŠæŸ¥çœ‹æ•°æ®ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œæ­¤å¤„å°±è´´å‡ºéƒ¨åˆ†æ•°æ®ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">C:\Users\nick&gt;mysql -uroot -p -P3307</span><br><span class="line">Enter password: ******</span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is 10412</span><br><span class="line">Server version: 5.6.40-log MySQL Community Server (GPL)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.</span><br><span class="line"></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> select * from db1.t_user;</span></span><br><span class="line">+----+------+-------+</span><br><span class="line">| id | name | _slot |</span><br><span class="line">+----+------+-------+</span><br><span class="line">|  3 | ccc  | 32411 |</span><br><span class="line">|  5 | eee  | 27566 |</span><br><span class="line">+----+------+-------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> mycat </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Feignè°ƒç”¨è¿”å›å¤æ‚å¯¹è±¡æ—¶æŠ¥é”™java.lang.ClassCastException: java.util.LinkedHashMap cannot be cast to xxx</title>
      <link href="/post/4f6a533b.html"/>
      <url>/post/4f6a533b.html</url>
      
        <content type="html"><![CDATA[<p>åœ¨å…¬å¸çš„æ•°æ®ä¸­å¿ƒé¡¹ç›®é‡Œä½¿ç”¨äº†Feignï¼Œè¿›è¡Œæ¥å£çš„è°ƒç”¨ï¼Œåœ¨è¿”å›ä¸€ä¸ªå¤æ‚çš„å¯¹è±¡æ—¶å€™ï¼Œå‡ºç°ä¸‹é¢çš„ä¸€ä¸ªé”™è¯¯ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java.lang.ClassCastException: java.util.LinkedHashMap cannot be cast to xxx</span><br></pre></td></tr></table></figure><a id="more"></a><p>å¤§è‡´æ„æ€å°±æ˜¯ LinkedHashMap ä¸èƒ½å¤Ÿè½¬æ¢æˆ xxx å¯¹è±¡ï¼Œæˆ‘å¾ˆå¥‡æ€ªï¼å› ä¸ºè¿™ä¸ªæ¥å£ç›¸å…³çš„åœ°æ–¹éƒ½æ²¡æœ‰ä½¿ç”¨åˆ° LinkedHashMapï¼Œä»–æ˜¯ä»å“ªé‡Œå†’å‡ºæ¥çš„ï¼Ÿæˆ‘å¼€å§‹è°ƒè¯•ä¸‹é¢çš„ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;EsFilterKV&gt; <span class="title">getFilterKV</span><span class="params">(Integer companyId, Integer appId, Long usrId, String filterName)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (StringUtils.isEmpty(filterName))&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    List&lt;CompanyDistributionFilterGroup&gt;  distributionFilterGroupList = companyDistributionService.findDistributionFilterGroupList(companyId,<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">    List&lt;ProductDocument&gt; productDocumentList = <span class="keyword">new</span> ArrayList&lt;ProductDocument&gt;(<span class="number">100</span>);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (CompanyDistributionFilterGroup group: distributionFilterGroupList) &#123;</span><br><span class="line">            List&lt;FilterItem&gt; filterItemList = filterGroupFilterService.findFilterItemList(group.getFilterGroupId());</span><br><span class="line">            MtSearchFilterRequest request = <span class="keyword">new</span> MtSearchFilterRequest();</span><br><span class="line">            request.setFilterItemList(filterItemList);</span><br><span class="line">            MtSearchResult mtSearchResult = productSearchService.search(request);</span><br><span class="line">            productDocumentList.addAll(mtSearchResult.getData());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (MtException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    List&lt;Long&gt; longList = productDocumentList.stream().map(p-&gt;p.getId()).distinct().collect(Collectors.toList());</span><br><span class="line">    <span class="keyword">if</span> (CollectionUtils.isEmpty(longList))&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    List&lt;Map&gt; idValueList = productPackageService.findPackageIdValueList(longList,filterName,<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (CollectionUtils.isEmpty(idValueList))&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    List&lt;EsFilterKV&gt; esFilterKVs = <span class="keyword">new</span> ArrayList&lt;EsFilterKV&gt;(idValueList.size());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (Map map: idValueList)&#123;</span><br><span class="line">        EsFilterKV  esFilterKV = <span class="keyword">new</span> EsFilterKV();</span><br><span class="line"></span><br><span class="line">        esFilterKV.setName(map.get(<span class="string">"name"</span>).toString());</span><br><span class="line">        esFilterKV.setId(<span class="keyword">new</span> Long(map.get(<span class="string">"id"</span>).toString()));</span><br><span class="line">        esFilterKV.setJsonName(<span class="string">"&#123;'id':"</span>+esFilterKV.getId()+<span class="string">",'name':'"</span>+esFilterKV.getName()+<span class="string">"'&#125;"</span>);</span><br><span class="line"></span><br><span class="line">        esFilterKVs.add(esFilterKV);</span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> esFilterKVs;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘å‘ç°åœ¨ productDocumentList.addAll(mtSearchResult.getData()); è¿™ä¸€è¡Œï¼ŒproductDocumentListé‡Œé¢æ”¾çš„å…¨æ˜¯LinkedHashMapï¼Œä¸æ˜¯æƒ³è±¡ä¸­çš„å¯¹è±¡åˆ—è¡¨ã€‚é€šè¿‡é¢å‘ç™¾åº¦ç¼–ç¨‹ï¼Œæˆ‘æŠŠproductSearchService.search()è¿™ä¸ªæ–¹æ³•è¿”å›çš„æ³›å‹ç»™å»æ‰äº†ï¼ŒæŒ‡å®šäº†çœŸå®çš„ç±»å‹ï¼Œä»è€Œè§£å†³äº†ä¸Šé¢çš„é—®é¢˜ï¼</p><p>é€šè¿‡ç™¾åº¦å¾—çŸ¥æœ‰ä¸å°‘äººé‡åˆ°è¿™ç§é—®é¢˜ï¼Œæœ‰ä¸ªæ„Ÿè§‰æ¯”è¾ƒé è°±çš„è§£é‡Šå¦‚ä¸‹ï¼š</p><p><strong>å› ä¸ºrpcè¿œç¨‹è°ƒç”¨åœ¨åº•å±‚è¿˜æ˜¯ä½¿ç”¨çš„HTTPClientï¼Œæ‰€ä»¥åœ¨ä¼ é€’å‚æ•°çš„æ—¶å€™ï¼Œå¿…å®šè¦æœ‰ä¸ªé¡ºåºï¼Œå½“ä½ ä¼ é€’mapçš„æ—¶å€™mapé‡Œé¢çš„å€¼ä¹Ÿè¦æœ‰é¡ºåºï¼Œä¸ç„¶æœåŠ¡å±‚åœ¨æ¥çš„æ—¶å€™å°±å‡ºé—®é¢˜äº†ï¼Œæ‰€ä»¥å®ƒæ‰ä¼šä»mapè½¬ä¸ºlinkedhashMapï¼spring æœ‰ä¸€ä¸ªç±»å«ModelMapï¼Œç»§æ‰¿äº†linkedhashMap public class ModelMap extends LinkedHashMap ,æ‰€ä»¥ä¸€ä¸ªæ¥å£è¿”å›çš„ç»“æœå°±å¯ä»¥ç›´æ¥ç”¨ModelMapæ¥æ¥ï¼Œæ³¨æ„ModelMapæ˜¯æ²¡æœ‰æ³›å‹çš„ï¼Œä¸ç®¡ä½ è¿”å›çš„ç»“æœæ˜¯ä»€ä¹ˆç±»å‹çš„mapï¼Œæ³›å‹æ˜¯å¤šå¤æ‚çš„mapï¼Œéƒ½å¯ä»¥ç›´æ¥newä¸€ä¸ªModelmapï¼Œç”¨å®ƒæ¥æ¥è¿”å›çš„ç»“æœï¼ï¼ï¼</strong></p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> feign </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>php-fpmçš„è¿›ç¨‹æ± ç›¸å…³å‚æ•°è¯´æ˜</title>
      <link href="/post/c1dfde53.html"/>
      <url>/post/c1dfde53.html</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘å…¬å¸çš„å®˜ç½‘æ®ä¸šåŠ¡è¯´æ—¶ä¸æ—¶çš„å¡ï¼Œè€Œè´Ÿè´£ç»´æŠ¤å®˜ç½‘çš„äººè¯·å‡å»å¾·å›½è·‘é©¬æ‹‰æ¾äº†ï¼ˆ<strong>ps:æœ‰é’±çœŸå¥½</strong>ï¼‰ï¼Œæˆ‘åˆè‹¦é€¼çš„å¸®ä»–å¤„ç†å®˜ç½‘çš„äº‹æƒ…ã€‚</p><p>php-fpmè¿›ç¨‹æ± å¼€å¯è¿›ç¨‹æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯staticï¼Œç›´æ¥å¼€å¯æŒ‡å®šæ•°é‡çš„php-fpmè¿›ç¨‹ï¼Œä¸å†å¢åŠ æˆ–è€…å‡å°‘ï¼›<br>å¦ä¸€ç§åˆ™æ˜¯dynamicï¼Œå¼€å§‹æ—¶å¼€å¯ä¸€å®šæ•°é‡çš„php-fpmè¿›ç¨‹ï¼Œå½“è¯·æ±‚é‡å˜å¤§æ—¶ï¼ŒåŠ¨æ€çš„å¢åŠ php-fpmè¿›ç¨‹æ•°åˆ°ä¸Šé™ï¼Œå½“ç©ºé—²æ—¶è‡ªåŠ¨é‡Šæ”¾ç©ºé—²çš„è¿›ç¨‹æ•°åˆ°ä¸€ä¸ªä¸‹é™ã€‚è¿™ä¸¤ç§ä¸åŒçš„æ‰§è¡Œæ–¹å¼ï¼Œå¯ä»¥æ ¹æ®æœåŠ¡å™¨çš„å®é™…éœ€æ±‚æ¥è¿›è¡Œè°ƒæ•´ã€‚</p><a id="more"></a><p>å…¶ä¸­æ¶‰åŠåˆ°çš„ä¸€äº›å‚æ•°ï¼Œåˆ†åˆ«æ˜¯pmã€pm.max_childrenã€pm.start_serversã€pm.min_spare_serverså’Œpm.max_spare_serversã€‚<br>pmè¡¨ç¤ºä½¿ç”¨é‚£ç§æ–¹å¼ï¼Œæœ‰ä¸¤ä¸ªå€¼å¯ä»¥é€‰æ‹©ï¼Œå°±æ˜¯staticï¼ˆé™æ€ï¼‰æˆ–è€…dynamicï¼ˆåŠ¨æ€ï¼‰ã€‚</p><p>ä¸‹é¢4ä¸ªå‚æ•°çš„æ„æ€åˆ†åˆ«ä¸ºï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pm.max_childrenï¼šé™æ€æ–¹å¼ä¸‹å¼€å¯çš„php-fpmè¿›ç¨‹æ•°é‡ï¼Œåœ¨åŠ¨æ€æ–¹å¼ä¸‹ä»–é™å®šphp-fpmçš„æœ€å¤§è¿›ç¨‹æ•°ï¼ˆè¿™é‡Œè¦æ³¨æ„pm.max_spare_serversçš„å€¼åªèƒ½å°äºç­‰äºpm.max_childrenï¼‰</span><br><span class="line">pm.start_serversï¼šåŠ¨æ€æ–¹å¼ä¸‹çš„èµ·å§‹php-fpmè¿›ç¨‹æ•°é‡ã€‚</span><br><span class="line">pm.min_spare_serversï¼šåŠ¨æ€æ–¹å¼ç©ºé—²çŠ¶æ€ä¸‹çš„æœ€å°php-fpmè¿›ç¨‹æ•°é‡ã€‚</span><br><span class="line">pm.max_spare_serversï¼šåŠ¨æ€æ–¹å¼ç©ºé—²çŠ¶æ€ä¸‹çš„æœ€å¤§php-fpmè¿›ç¨‹æ•°é‡ã€‚</span><br></pre></td></tr></table></figure><p>phpçš„é…ç½®æ–‡ä»¶é‡Œé¢ç»™å‡ºäº†pm.start_serversçš„è®¡ç®—å…¬å¼ï¼š<br>min_spare_servers + (max_spare_servers - min_spare_servers) / 2</p><p>å¦‚æœdmè®¾ç½®ä¸ºstaticï¼Œé‚£ä¹ˆå…¶å®åªæœ‰pm.max_childrenè¿™ä¸ªå‚æ•°ç”Ÿæ•ˆã€‚ç³»ç»Ÿä¼šå¼€å¯å‚æ•°è®¾ç½®æ•°é‡çš„php-fpmè¿›ç¨‹ã€‚</p><p>å¦‚æœdmè®¾ç½®ä¸ºdynamicï¼Œ4ä¸ªå‚æ•°éƒ½ç”Ÿæ•ˆã€‚ç³»ç»Ÿä¼šåœ¨php-fpmè¿è¡Œå¼€å§‹æ—¶å¯åŠ¨pm.start_serversä¸ªphp-fpmè¿›ç¨‹ï¼Œç„¶åæ ¹æ®ç³»ç»Ÿçš„éœ€æ±‚åŠ¨æ€åœ¨pm.min_spare_serverså’Œpm.max_spare_serversä¹‹é—´è°ƒæ•´php-fpmè¿›ç¨‹æ•°ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> php </tag>
            
            <tag> php-fpm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring Cloud Configå®¢æˆ·ç«¯æŠ¥é”™Could not locate PropertySource: I/O error on GET request xxx</title>
      <link href="/post/29fad61b.html"/>
      <url>/post/29fad61b.html</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¤©åœ¨ç ”ç©¶Spring Cloud Configé…ç½®ä¸­å¿ƒï¼Œå‡ºäº†ä¸€ä¸ªå¾ˆè®©äººæ¼ç«çš„é—®é¢˜ï¼Œæˆ‘å…ˆè´´ä¸€ä¸‹æˆ‘çš„ç›¸å…³é…ç½®ä¿¡æ¯ï¼š</p><a id="more"></a><p>å®¢æˆ·ç«¯çš„bootstrap.ymlé…ç½®ï¼š</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9009</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">admin-server</span></span><br><span class="line">    <span class="attr">profiles:</span></span><br><span class="line">      <span class="attr">active:</span> <span class="string">dev</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">config:</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">admin-server-config</span></span><br><span class="line">      <span class="attr">label:</span> <span class="string">master</span></span><br><span class="line">      <span class="attr">profile:</span> <span class="string">dev</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">service-id:</span> <span class="string">config-server</span></span><br><span class="line"></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://Eurexxxr:xxxx-12xxx56@accp.xxx.net:8786/eureka/</span></span><br></pre></td></tr></table></figure><p>å‡ºç°çš„é—®é¢˜å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Could not locate PropertySource: I/O error on GET request <span class="keyword">for</span> <span class="string">"http://config-server:9008/admin-server-config/dev/master"</span>: Connection refused; nested exception is java.net.ConnectException: Connection refused</span><br></pre></td></tr></table></figure><p>å¤§è‡´çš„æ„æ€æ˜¯è¯´â€<a href="http://config-server:9008/admin-server-config/dev/master&quot;è¿™ä¸ªé“¾æ¥ä¸èƒ½å¤Ÿè®¿é—®ï¼Œå¯æˆ‘è¯•ç€è®¿é—®ä¸€ä¸‹ï¼Œå´æ˜¯å¯ä»¥è®¿é—®çš„ï¼Œè¿™å°±è®©æˆ‘ç™¾æ€ä¸å¾—å…¶è§£ï¼äºæ˜¯ä¹ç™¾åº¦googleèµ°èµ·ï¼Œåœ¨stackoverflowä¸Šå€’æ˜¯æ‰¾åˆ°å‡ æ¡ç›¸å…³çš„é—®é¢˜ï¼Œä½†æ˜¯é—®é¢˜çš„è§£ç­”æ–¹æ¡ˆéƒ½ä¸æ˜¯å¾ˆé è°±ï¼äºæ˜¯ä¹æ”¾å¼ƒç­”æ¡ˆçš„å¯»æ‰¾ï¼Œæˆ‘å°±å»èœå¸‚åœºä¹°èœï¼Œæ¯•ç«Ÿæ™šé¥­è¿˜æ˜¯è¦åƒçš„!é…’è¶³é¥­é¥±ä¹‹åæˆ‘åˆæ¥ç ”ç©¶è¿™ä¸ªé—®é¢˜ã€‚æŒ‰ç†è¯´æç¤ºè¿™ç§é“¾æ¥ä¸èƒ½è®¿é—®ï¼Œå°±æ˜¯hostsæ–‡ä»¶æ˜ å°„çš„é—®é¢˜ï¼ˆpsï¼šé…ç½®ä¸­å¿ƒconfig-serveræˆ‘éƒ¨ç½²åœ¨æˆ‘é˜¿é‡Œäº‘åšå®¢ä¸Šï¼‰ï¼Œå¯æ˜¯é‚£ä¸ªé“¾æ¥ç¡®å®å¯ä»¥ç›´æ¥è®¿é—®çš„â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦æˆ‘å°±è¯•ç€çœ‹çœ‹æˆ‘çš„hostsæ–‡ä»¶ï¼Œç¬¬ä¸€æ¬¡æˆ‘è¿˜æ²¡æœ‰çœ‹å‡ºé—®é¢˜ï¼Œæˆ‘ä¸æ­»å¿ƒçš„åˆçœ‹ç¬¬äºŒæ¬¡ï¼Œæ€»ç®—è®©æˆ‘å‘ç°äº†é—®é¢˜çš„æ‰€åœ¨ï¼Œä¸‹é¢æ˜¯å½“æ—¶hostsæ–‡ä»¶çš„å†…å®¹ï¼š" target="_blank" rel="noopener">http://config-server:9008/admin-server-config/dev/master&quot;è¿™ä¸ªé“¾æ¥ä¸èƒ½å¤Ÿè®¿é—®ï¼Œå¯æˆ‘è¯•ç€è®¿é—®ä¸€ä¸‹ï¼Œå´æ˜¯å¯ä»¥è®¿é—®çš„ï¼Œè¿™å°±è®©æˆ‘ç™¾æ€ä¸å¾—å…¶è§£ï¼äºæ˜¯ä¹ç™¾åº¦googleèµ°èµ·ï¼Œåœ¨stackoverflowä¸Šå€’æ˜¯æ‰¾åˆ°å‡ æ¡ç›¸å…³çš„é—®é¢˜ï¼Œä½†æ˜¯é—®é¢˜çš„è§£ç­”æ–¹æ¡ˆéƒ½ä¸æ˜¯å¾ˆé è°±ï¼äºæ˜¯ä¹æ”¾å¼ƒç­”æ¡ˆçš„å¯»æ‰¾ï¼Œæˆ‘å°±å»èœå¸‚åœºä¹°èœï¼Œæ¯•ç«Ÿæ™šé¥­è¿˜æ˜¯è¦åƒçš„!é…’è¶³é¥­é¥±ä¹‹åæˆ‘åˆæ¥ç ”ç©¶è¿™ä¸ªé—®é¢˜ã€‚æŒ‰ç†è¯´æç¤ºè¿™ç§é“¾æ¥ä¸èƒ½è®¿é—®ï¼Œå°±æ˜¯hostsæ–‡ä»¶æ˜ å°„çš„é—®é¢˜ï¼ˆpsï¼šé…ç½®ä¸­å¿ƒconfig-serveræˆ‘éƒ¨ç½²åœ¨æˆ‘é˜¿é‡Œäº‘åšå®¢ä¸Šï¼‰ï¼Œå¯æ˜¯é‚£ä¸ªé“¾æ¥ç¡®å®å¯ä»¥ç›´æ¥è®¿é—®çš„â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦æˆ‘å°±è¯•ç€çœ‹çœ‹æˆ‘çš„hostsæ–‡ä»¶ï¼Œç¬¬ä¸€æ¬¡æˆ‘è¿˜æ²¡æœ‰çœ‹å‡ºé—®é¢˜ï¼Œæˆ‘ä¸æ­»å¿ƒçš„åˆçœ‹ç¬¬äºŒæ¬¡ï¼Œæ€»ç®—è®©æˆ‘å‘ç°äº†é—®é¢˜çš„æ‰€åœ¨ï¼Œä¸‹é¢æ˜¯å½“æ—¶hostsæ–‡ä»¶çš„å†…å®¹ï¼š</a></p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Host Database</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># localhost is used to configure the loopback interface</span></span><br><span class="line"><span class="comment"># when the system is booting.  Do not change this entry.</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>       <span class="string">localhost</span></span><br><span class="line"><span class="string">xx.78.xx.12</span>     <span class="string">config-server</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>       <span class="string">dev</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>       <span class="string">search-provider</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>       <span class="string">config-server</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>       <span class="string">work.ydstudios.com</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>       <span class="string">work.damei.com</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>       <span class="string">work.gx.com</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>       <span class="string">work.phpcms.com</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>       <span class="string">work.typecho.com</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>       <span class="string">work.seacms.com</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>       <span class="string">work.dy360.net</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>       <span class="string">work.btsearch.com</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>       <span class="string">work.search.com</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>       <span class="string">work.mm.com</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>       <span class="string">work.duowan.com</span></span><br></pre></td></tr></table></figure><p>ä¸çŸ¥é“å¤§å®¶çœ‹å‡ºæ¥æ²¡æœ‰ï¼Ÿæœ‰ä¸¤ä¸ªipæŒ‡å‘äº†config-serverï¼Œè€Œä¸”æˆ‘å‘ç°è¿™ç§é…ç½®ï¼Œä¸åŒæ—¶å€™èµ·ä½œç”¨çš„é…ç½®è¿˜ä¸ä¸€æ ·ï¼<br>ç›´æ¥è®¿é—®urlåœ°å€çš„æ—¶å€™ï¼Œç¬¬ä¸€ä¸ªé…ç½®ç”Ÿæ•ˆï¼Œç¨‹åºé‡Œç¡®å®ç¬¬äºŒä¸ªé…ç½®ç”Ÿæ•ˆï¼Œå°´å°¬â€¦â€¦â€¦â€¦</p>]]></content>
      
      
      
        <tags>
            
            <tag> spring cloud </tag>
            
            <tag> spring cloud config </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring Cloudæ•´åˆé…ç½®ä¸­å¿ƒEurekaä¸­çš„æœåŠ¡çŠ¶æ€æ˜¾ç¤ºUNKOWN</title>
      <link href="/post/5e4a0e78.html"/>
      <url>/post/5e4a0e78.html</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¤©åœ¨ç ”ç©¶Spring Cloudçš„é…ç½®ä¸­å¿ƒçš„æ—¶å€™ï¼Œå‘ç°å°†åº”ç”¨çš„é…ç½®ç§»åˆ°gitä¸Šï¼Œå¯åŠ¨åº”ç”¨åå‘ç°ï¼Œåœ¨Eurakaæ³¨å†Œä¸­å¿ƒä¸Šè¿™ä¸ªåº”ç”¨çš„çŠ¶æ€å§‹ç»ˆä¸ºUNKOWNï¼Œå¯æ˜¯è¿™ä¸ªåº”ç”¨æ˜¯å¯ä»¥æä¾›æœåŠ¡çš„ã€‚ä¸‹é¢æ˜¯åº”ç”¨çš„bootstrapçš„é…ç½®ï¼š</p><a id="more"></a><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">search-provider</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">config:</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">search-config</span></span><br><span class="line">      <span class="attr">profile:</span> <span class="string">dev</span></span><br><span class="line">      <span class="attr">label:</span> <span class="string">master</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">service-id:</span> <span class="string">config-server</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">    <span class="attr">client:</span></span><br><span class="line">        <span class="attr">fetch-registry:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">register-with-eureka:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">healthcheck:</span></span><br><span class="line">           <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">service-url:</span></span><br><span class="line">          <span class="attr">defaultZone:</span> <span class="string">http://xxxx:xxxx@xxx.ydstudio.net:xxx/eureka/</span></span><br><span class="line">    <span class="attr">instance:</span></span><br><span class="line">        <span class="comment">#instance-idé»˜è®¤å€¼æ˜¯ä¸»æœºåï¼šåº”ç”¨åï¼šåº”ç”¨ç«¯å£ instance-id: $&#123;spring.application.name&#125;:$&#123;random.value&#125;</span></span><br><span class="line">        <span class="comment">#instance-id: $&#123;spring.cloud.client.ipAddress&#125;:$&#123;server.port&#125;</span></span><br><span class="line">        <span class="attr">instance-id:</span> <span class="string">$&#123;spring.cloud.client.ipAddress&#125;:$&#123;spring.application.name&#125;:$&#123;server.port&#125;</span></span><br><span class="line">        <span class="attr">hostname:</span> <span class="string">$&#123;spring.cloud.client.ipAddress&#125;</span></span><br><span class="line">        <span class="comment">#hostname: $&#123;spring.application.name&#125;</span></span><br><span class="line">        <span class="comment"># é»˜è®¤30sï¼Œè¡¨ç¤ºeureka clientå‘é€å¿ƒè·³ç»™serverç«¯çš„é¢‘ç‡</span></span><br><span class="line">        <span class="attr">lease-renewal-interval-in-seconds:</span> <span class="number">15</span></span><br><span class="line">        <span class="comment"># é»˜è®¤90sï¼Œè¡¨ç¤ºeureka serverè‡³ä¸Šä¸€æ¬¡æ”¶åˆ°clientçš„å¿ƒè·³ä¹‹åï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡å¿ƒè·³çš„è¶…æ—¶æ—¶é—´ï¼Œåœ¨è¿™ä¸ªæ—¶é—´å†…è‹¥æ²¡æ”¶åˆ°ä¸‹ä¸€æ¬¡å¿ƒè·³ï¼Œåˆ™å°†ç§»é™¤è¯¥instance</span></span><br><span class="line">        <span class="attr">lease-expiration-duration-in-seconds:</span> <span class="number">25</span></span><br><span class="line">        <span class="comment"># å°†è‡ªå·±çš„ipæ˜¾ç¤ºåˆ°EuekaServerä¸Š</span></span><br><span class="line">        <span class="attr">prefer-ip-address:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>æ—¥å¿—æ‰“å°åº”ç”¨çš„çŠ¶æ€ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">StatusChangeEvent [timestamp=<span class="number">1536481926709</span>, current=UNKNOWN, previous=UP]</span><br></pre></td></tr></table></figure><p>è¿™äº›é…ç½®è‚¯å®šæ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œå› ä¸ºè¿™äº›é…ç½®åœ¨æ²¡æœ‰æŒªåˆ°bootstrap.ymlä¸­ä¹‹å‰éƒ½æ˜¯å¯ä»¥æ­£å¸¸ä½¿ç”¨çš„ã€‚ç°åœ¨Eurekaæ³¨å†Œä¸­å¿ƒå´ä¸èƒ½æ£€æµ‹åˆ°åº”ç”¨çš„çŠ¶æ€ï¼Œè¿™æ ·è®©æˆ‘ç™¾æ€ä¸å¾—å…¶è§£ã€‚åæ¥æˆ‘åœ¨stackoverflowä¸Šæ‰¾åˆ°äº†ç­”æ¡ˆ<br><a href="https://stackoverflow.com/questions/38578705/springboot-app-registers-unknown-with-eureka-in-brixton-sr3s" target="_blank" rel="noopener">stackoverflowåœ°å€</a>,é—®é¢˜åªæœ‰ä¸€ä¸ªç­”æ¡ˆï¼Œå…¶ä¸­é‡è¦å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eureka.client.healthcheck.enabled=<span class="keyword">true</span> should only be set in  application.yml. Setting the value in bootstrap.yml will cause undesirable side effects like registering in eureka with an  UNKNOWN status.</span><br></pre></td></tr></table></figure><p>çŸ¥é“è¿™ä¸€ç‚¹åæˆ‘å°†bootstrap.ymlä¸­çš„å†…å®¹ä¿®æ”¹å¦‚ä¸‹é¢ä¸€æ ·ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">spring:</span><br><span class="line">  application:</span><br><span class="line">    name: search-provider</span><br><span class="line">  cloud:</span><br><span class="line">    config:</span><br><span class="line">      name: search-config</span><br><span class="line">      profile: dev</span><br><span class="line">      label: master</span><br><span class="line">      #uri: http://localhost:9008</span><br><span class="line">      discovery:</span><br><span class="line">        enabled: <span class="keyword">true</span></span><br><span class="line">        service-id: config-server</span><br><span class="line"></span><br><span class="line">eureka:</span><br><span class="line">    client:</span><br><span class="line">        service-url:</span><br><span class="line">          defaultZone: http:<span class="comment">//xxxx:xxxx@xxx.ydstudio.net:xxx/eureka/</span></span><br></pre></td></tr></table></figure><p>åœ¨Eurekaæ³¨å†Œä¸­å¿ƒä¸­åº”ç”¨çš„çŠ¶æ€å°±æ˜¾ç¤ºæ­£å¸¸äº†ï¼</p>]]></content>
      
      
      
        <tags>
            
            <tag> spring cloud </tag>
            
            <tag> eureka </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Elastic Searchæœç´¢æ•°æ®Termsèšåˆè¿”å›çš„ä¸æ­£ç¡®çš„é—®é¢˜</title>
      <link href="/post/39992895.html"/>
      <url>/post/39992895.html</url>
      
        <content type="html"><![CDATA[<p>é¡¹ç›®ä¸­ä½¿ç”¨Elastic Searchåšæœç´¢ï¼Œåœ¨èšåˆäº§å“çš„æ ‡ç­¾çš„æ—¶å€™ï¼Œæˆ‘å‘ç°æ ‡ç­¾çš„ç§ç±»æœ‰å¾ˆå¤šè¶…è¿‡äº†10ä¸ªï¼ˆè¿™ä¸€ç‚¹å¾ˆé‡è¦ï¼‰ï¼Œä½†æ˜¯èšåˆæ ‡ç­¾å‡ºæ¥çš„æ•°æ®åªæœ‰10ä¸ªï¼Œç¼ºå°‘äº†å¾ˆå¤šæ ‡ç­¾ï¼ŒæŸ¥è¯¢çš„è¯­å¥å¦‚ä¸‹ï¼š</p><a id="more"></a><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"from"</span> : <span class="number">0</span>,</span><br><span class="line">  <span class="attr">"size"</span> : <span class="number">15</span>,</span><br><span class="line">  <span class="attr">"query"</span> : &#123;</span><br><span class="line">    <span class="attr">"bool"</span> : &#123;</span><br><span class="line">      <span class="attr">"must"</span> : [ &#123;</span><br><span class="line">        <span class="attr">"terms"</span> : &#123;</span><br><span class="line">          <span class="attr">"categoryId"</span> : [ <span class="number">1046</span>, <span class="number">1045</span>, <span class="number">1044</span> ]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;, &#123;</span><br><span class="line">        <span class="attr">"terms"</span> : &#123;</span><br><span class="line">          <span class="attr">"tagList.id"</span> : [ <span class="number">1063</span>, <span class="number">1138</span>, <span class="number">1115</span>, <span class="number">1142</span> ]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"aggregations"</span> : &#123;</span><br><span class="line">    <span class="attr">"categoryId"</span> : &#123;</span><br><span class="line">      <span class="attr">"terms"</span> : &#123;</span><br><span class="line">        <span class="attr">"field"</span> : <span class="string">"categoryId"</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"tagList.tagContent"</span> : &#123;</span><br><span class="line">      <span class="attr">"terms"</span> : &#123;</span><br><span class="line">        <span class="attr">"field"</span> : <span class="string">"tagList.tagContent"</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç™¾æ€ä¸å¾—å…¶è§£ï¼Œçœ‹æ–‡æ¡£å‘ç°è‡ªå·±çš„æŸ¥è¯¢å’ŒTermsçš„èšåˆä½¿ç”¨éƒ½æ˜¯æ²¡æœ‰ä»»ä½•é—®é¢˜çš„ï¼Œä½†æ˜¯å‡ºæ¥çš„æ•°æ®ä¸ºä»€ä¹ˆä¼šå°‘å‘¢ï¼Ÿäºæ˜¯æ˜¨å¤©ä¸ŠåˆèŠ±äº†å°†è¿‘ä¸€ä¸ªå°æ—¶çš„æ—¶é—´æ‰æ‰¾åˆ°é—®é¢˜çš„æ‰€åœ¨ï¼Œä¸‹é¢æ˜¯æ–‡æ¡£ä¸Šå¯¹è¿”å›æ•°æ®çš„ä¸€ä¸ªè§£é‡Šï¼š<br>By default, the terms aggregation will return the buckets for the top ten terms ordered by the doc_count. One can change this default behaviour by setting the size parameter.</p><p>Size<br>The size parameter can be set to define how many term buckets should be returned out of the overall terms list. By default, the node coordinating the search process will request each shard to provide its own top size term buckets and once all shards respond, it will reduce the results to the final list that will then be returned to the client. This means that if the number of unique terms is greater than size, the returned list is slightly off and not accurate (it could be that the term counts are slightly off and it could even be that a term that should have been in the top size buckets was not returned).</p><p>åŸæ¥Elastic Searchå¯¹æ•°æ®èšåˆé»˜è®¤è¿”å›10ä¸ªï¼Œæˆ‘èšåˆçš„æ•°æ®æœ¯è¯­æ¡¶è¶…è¿‡äº†10ä¸ªï¼Œå¯ä»¥è‡ªè¡Œè®¾ç½®sizeæ¥è¿”å›ä¸åŒæ•°é‡çš„æœ¯è¯­æ¡¶ã€‚äºæ˜¯ä¹ï¼ŒæŸ¥è¯¢çš„è¯­å¥ä¿®æ”¹æˆä¸‹é¢çš„æ ·å­å°±æˆåŠŸè¿”å›äº†æ‰€æœ‰çš„æ•°æ®ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"from"</span> : <span class="number">0</span>,</span><br><span class="line">  <span class="attr">"size"</span> : <span class="number">15</span>,</span><br><span class="line">  <span class="attr">"query"</span> : &#123;</span><br><span class="line">    <span class="attr">"bool"</span> : &#123;</span><br><span class="line">      <span class="attr">"must"</span> : [ &#123;</span><br><span class="line">        <span class="attr">"terms"</span> : &#123;</span><br><span class="line">          <span class="attr">"categoryId"</span> : [ <span class="number">1046</span>, <span class="number">1045</span>, <span class="number">1044</span> ]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;, &#123;</span><br><span class="line">        <span class="attr">"terms"</span> : &#123;</span><br><span class="line">          <span class="attr">"tagList.id"</span> : [ <span class="number">1063</span>, <span class="number">1138</span>, <span class="number">1115</span>, <span class="number">1142</span> ]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"aggregations"</span> : &#123;</span><br><span class="line">    <span class="attr">"categoryId"</span> : &#123;</span><br><span class="line">      <span class="attr">"terms"</span> : &#123;</span><br><span class="line">        <span class="attr">"field"</span> : <span class="string">"categoryId"</span>,</span><br><span class="line">        <span class="attr">"size"</span> : <span class="number">100</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"tagList.tagContent"</span> : &#123;</span><br><span class="line">      <span class="attr">"terms"</span> : &#123;</span><br><span class="line">        <span class="attr">"field"</span> : <span class="string">"tagList.tagContent"</span>,</span><br><span class="line">        <span class="attr">"size"</span> : <span class="number">100</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶å®æˆ‘è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨ä½¿ç”¨<strong>RangeèŒƒå›´èšåˆ</strong>çš„æ—¶å€™ï¼Œå‘ç°èšåˆçš„æ•°æ®ä¸å‡†ç¡®ï¼Œå°±æ˜¯è¯´10-20æœ¬æ¥å°±30æ¡è®°å½•ï¼Œä½†æ˜¯èšåˆæ˜¾ç¤ºè¿™ä¸ªèŒƒå›´çš„æ•°æ®åªæœ‰10ä¸ªï¼Œè¿™ä¸ªé—®é¢˜æˆ‘æš‚æ—¶è¿˜æ²¡æœ‰æ‰¾åˆ°åŸå› ï¼Œæœ‰äººçŸ¥é“çš„è¯ï¼Œæˆ‘å¾ˆé«˜å…´æœ‰äººèƒ½å‘Šè¯‰æˆ‘ï¼</p><p>2018/10/12æ›´æ–°ï¼š<br>å¯¹äºä¸Šé¢çš„RangeèŒƒå›´èšåˆä¸æ­£ç¡®çš„åŸå› å·²ç»æ‰¾åˆ°ï¼Œå‘ç°è¿˜æ˜¯è‡ªå·±å¤ªè¿‡ç²—å¿ƒï¼Œäººå®¶æä¾›çš„å¼€å‘æ–‡æ¡£æ²¡æœ‰ä»”ç»†çš„çœ‹ï¼Œç»ˆäºæˆ‘åœ¨2018/10/11çš„æ—¶å€™é‡æ–°çœ‹äº†ä¸€ä¸‹<a href="https://www.elastic.co/guide/en/elasticsearch/reference/5.5/search-aggregations-bucket-range-aggregation.html" target="_blank" rel="noopener">Elasticsearch Reference 5.5 Â» Aggregations Â» Bucket Aggregations Â» Range Aggregation</a>,æœ€å¼€å§‹çš„ä¸€æ®µè¯å°±æ˜¯é—®é¢˜çš„ç­”æ¡ˆï¼</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">A multi-bucket value source based aggregation that enables the user to define a set of ranges - each representing a bucket. During the aggregation process, the values extracted from each document will be checked against each bucket range and "bucket" the relevant/matching document. Note that this aggregation includes the from value and excludes the to value for each range.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Example:</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">"aggs"</span> : &#123;</span><br><span class="line">        <span class="attr">"price_ranges"</span> : &#123;</span><br><span class="line">            <span class="attr">"range"</span> : &#123;</span><br><span class="line">                <span class="attr">"field"</span> : <span class="string">"price"</span>,</span><br><span class="line">                <span class="attr">"ranges"</span> : [</span><br><span class="line">                    &#123; <span class="attr">"to"</span> : <span class="number">50</span> &#125;,</span><br><span class="line">                    &#123; <span class="attr">"from"</span> : <span class="number">50</span>, <span class="attr">"to"</span> : <span class="number">100</span> &#125;,</span><br><span class="line">                    &#123; <span class="attr">"from"</span> : <span class="number">100</span> &#125;</span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ç»Ÿè®¡çš„å«ä¹‰æ˜¯ï¼š</p><ul><li>ç»Ÿè®¡ä»·æ ¼å°äº50çš„æ€»æ•°</li><li>ç»Ÿè®¡ä»·æ ¼å¤§äºç­‰äº50ï¼Œå°äº100çš„æ€»æ•°</li><li>ç»Ÿè®¡ä»·æ ¼å¤§äºç­‰äº100çš„æ€»æ•°</li></ul><p>æ€»ä¹‹ï¼Œå°±æ˜¯ç»Ÿè®¡åŒ…å«ä¸‹é™ï¼Œä¸åŒ…å«ä¸Šé™ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> elasticSearch </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>IntelliJ Idea å¸¸ç”¨å¿«æ·é”®åˆ—è¡¨</title>
      <link href="/post/fea71f82.html"/>
      <url>/post/fea71f82.html</url>
      
        <content type="html"><![CDATA[<p>åŠ ç²—çš„æ˜¯æˆ‘å¸¸ç”¨çš„å¿«æ·é”®</p><a id="more"></a><p>Ctrl+Shift + Enterï¼Œè¯­å¥å®Œæˆ<br>â€œï¼â€ï¼Œå¦å®šå®Œæˆï¼Œè¾“å…¥è¡¨è¾¾å¼æ—¶æŒ‰ â€œï¼â€é”®<br>Ctrl+Eï¼Œæœ€è¿‘çš„æ–‡ä»¶<br>Ctrl+Shift+Eï¼Œæœ€è¿‘æ›´æ”¹çš„æ–‡ä»¶<br>Shift+Clickï¼Œå¯ä»¥å…³é—­æ–‡ä»¶<br>Ctrl+[ OR ]ï¼Œå¯ä»¥è·‘åˆ°å¤§æ‹¬å·çš„å¼€å¤´ä¸ç»“å°¾<br>Ctrl+F12ï¼Œå¯ä»¥æ˜¾ç¤ºå½“å‰æ–‡ä»¶çš„ç»“æ„<br>Ctrl+F7ï¼Œå¯ä»¥æŸ¥è¯¢å½“å‰å…ƒç´ åœ¨å½“å‰æ–‡ä»¶ä¸­çš„å¼•ç”¨ï¼Œç„¶åæŒ‰ F3 å¯ä»¥é€‰æ‹©<br>Ctrl+Nï¼Œå¯ä»¥å¿«é€Ÿæ‰“å¼€ç±»<br>Ctrl+Shift+Nï¼Œå¯ä»¥å¿«é€Ÿæ‰“å¼€æ–‡ä»¶<br><strong>Alt+Qï¼Œå¯ä»¥çœ‹åˆ°å½“å‰æ–¹æ³•çš„å£°æ˜</strong><br><strong>Ctrl+Pï¼Œå¯ä»¥æ˜¾ç¤ºå‚æ•°ä¿¡æ¯</strong><br>Ctrl+Shift+Insertï¼Œå¯ä»¥é€‰æ‹©å‰ªè´´æ¿å†…å®¹å¹¶æ’å…¥<br>Alt+Insertï¼Œå¯ä»¥ç”Ÿæˆæ„é€ å™¨/Getter/Setterç­‰<br>Ctrl+Alt+Vï¼Œå¯ä»¥å¼•å…¥å˜é‡ã€‚ä¾‹å¦‚ï¼šnew String();  è‡ªåŠ¨å¯¼å…¥å˜é‡å®šä¹‰<br>Ctrl+Alt+Tï¼Œå¯ä»¥æŠŠä»£ç åŒ…åœ¨ä¸€ä¸ªå—å†…ï¼Œä¾‹å¦‚ï¼štry/catch<br><strong>Ctrl+Enterï¼Œå¯¼å…¥åŒ…ï¼Œè‡ªåŠ¨ä¿®æ­£</strong><br><strong>Ctrl+Alt+Lï¼Œæ ¼å¼åŒ–ä»£ç </strong><br>Ctrl+Alt+Iï¼Œå°†é€‰ä¸­çš„ä»£ç è¿›è¡Œè‡ªåŠ¨ç¼©è¿›ç¼–æ’ï¼Œè¿™ä¸ªåŠŸèƒ½åœ¨ç¼–è¾‘ JSP æ–‡ä»¶æ—¶ä¹Ÿå¯ä»¥å·¥ä½œ<br><strong>Ctrl+Alt+Oï¼Œä¼˜åŒ–å¯¼å…¥çš„ç±»å’ŒåŒ…</strong><br><strong>Ctrl+Rï¼Œæ›¿æ¢æ–‡æœ¬</strong><br><strong>Ctrl+Fï¼ŒæŸ¥æ‰¾æ–‡æœ¬</strong><br>Ctrl+Shift+Spaceï¼Œè‡ªåŠ¨è¡¥å…¨ä»£ç <br>Ctrl+ç©ºæ ¼ï¼Œä»£ç æç¤ºï¼ˆä¸ç³»ç»Ÿè¾“å…¥æ³•å¿«æ·é”®å†²çªï¼‰<br>Ctrl+Shift+Alt+Nï¼ŒæŸ¥æ‰¾ç±»ä¸­çš„æ–¹æ³•æˆ–å˜é‡<br>Alt+Shift+Cï¼Œæœ€è¿‘çš„æ›´æ”¹<br>Alt+Shift+Up/Downï¼Œä¸Š/ä¸‹ç§»ä¸€è¡Œ<br>Shift+F6ï¼Œé‡æ„ - é‡å‘½å<br><strong>Ctrl+Xï¼Œåˆ é™¤è¡Œ</strong><br><strong>Ctrl+Dï¼Œå¤åˆ¶è¡Œ</strong><br>Ctrl+/æˆ–Ctrl+Shift+/ï¼Œæ³¨é‡Šï¼ˆ//æˆ–è€…/<strong>/ï¼‰<br>Ctrl+Jï¼Œè‡ªåŠ¨ä»£ç ï¼ˆä¾‹å¦‚ï¼šserrï¼‰<br>Ctrl+Alt+Jï¼Œç”¨åŠ¨æ€æ¨¡æ¿ç¯ç»•<br>Ctrl+Hï¼Œæ˜¾ç¤ºç±»ç»“æ„å›¾ï¼ˆç±»çš„ç»§æ‰¿å±‚æ¬¡ï¼‰<br>**Ctrl+Qï¼Œæ˜¾ç¤ºæ³¨é‡Šæ–‡æ¡£</strong><br>Alt+F1ï¼ŒæŸ¥æ‰¾ä»£ç æ‰€åœ¨ä½ç½®<br>Alt+1ï¼Œå¿«é€Ÿæ‰“å¼€æˆ–éšè—å·¥ç¨‹é¢æ¿<br>Ctrl+Alt+left/rightï¼Œè¿”å›è‡³ä¸Šæ¬¡æµè§ˆçš„ä½ç½®<br><strong>Alt+left/rightï¼Œåˆ‡æ¢ä»£ç è§†å›¾</strong><br>Alt+Up/Downï¼Œåœ¨æ–¹æ³•é—´å¿«é€Ÿç§»åŠ¨å®šä½<br>Ctrl+Shift+Up/Downï¼Œå‘ä¸Š/ä¸‹ç§»åŠ¨è¯­å¥<br>F2 æˆ– Shift+F2ï¼Œé«˜äº®é”™è¯¯æˆ–è­¦å‘Šå¿«é€Ÿå®šä½<br>Tabï¼Œä»£ç æ ‡ç­¾è¾“å…¥å®Œæˆåï¼ŒæŒ‰ Tabï¼Œç”Ÿæˆä»£ç <br>Ctrl+Shift+F7ï¼Œé«˜äº®æ˜¾ç¤ºæ‰€æœ‰è¯¥æ–‡æœ¬ï¼ŒæŒ‰ Esc é«˜äº®æ¶ˆå¤±<br>Alt+F3ï¼Œé€ä¸ªå¾€ä¸‹æŸ¥æ‰¾ç›¸åŒæ–‡æœ¬ï¼Œå¹¶é«˜äº®æ˜¾ç¤º<br>Ctrl+Up/Downï¼Œå…‰æ ‡ä¸­è½¬åˆ°ç¬¬ä¸€è¡Œæˆ–æœ€åä¸€è¡Œä¸‹<br>Ctrl+B/Ctrl+Clickï¼Œå¿«é€Ÿæ‰“å¼€å…‰æ ‡å¤„çš„ç±»æˆ–æ–¹æ³•ï¼ˆè·³è½¬åˆ°å®šä¹‰å¤„ï¼‰<br>Ctrl+Alt+Bï¼Œè·³è½¬åˆ°æ–¹æ³•å®ç°å¤„<br>Ctrl+Shift+Backspaceï¼Œè·³è½¬åˆ°ä¸Šæ¬¡ç¼–è¾‘çš„åœ°æ–¹<br>Ctrl+Oï¼Œé‡å†™æ–¹æ³•<br>Ctrl+Alt+Spaceï¼Œç±»åè‡ªåŠ¨å®Œæˆ<br>Ctrl+Alt+Up/Downï¼Œå¿«é€Ÿè·³è½¬æœç´¢ç»“æœ<br>Ctrl+Shift+Jï¼Œæ•´åˆä¸¤è¡Œ<br>Alt+F8ï¼Œè®¡ç®—å˜é‡å€¼<br>Ctrl+Shift+Vï¼Œå¯ä»¥å°†æœ€è¿‘ä½¿ç”¨çš„å‰ªè´´æ¿å†…å®¹é€‰æ‹©æ’å…¥åˆ°æ–‡æœ¬<br>Ctrl+Alt+Shift+Vï¼Œç®€å•ç²˜è´´<br>Shift+Escï¼Œä¸ä»…å¯ä»¥æŠŠç„¦ç‚¹ç§»åˆ°ç¼–è¾‘å™¨ä¸Šï¼Œè€Œä¸”è¿˜å¯ä»¥éšè—å½“å‰ï¼ˆæˆ–æœ€åæ´»åŠ¨çš„ï¼‰å·¥å…·çª—å£<br>F12ï¼ŒæŠŠç„¦ç‚¹ä»ç¼–è¾‘å™¨ç§»åˆ°æœ€è¿‘ä½¿ç”¨çš„å·¥å…·çª—å£<br>Shift+F1ï¼Œè¦æ‰“å¼€ç¼–è¾‘å™¨å…‰æ ‡å­—ç¬¦å¤„ä½¿ç”¨çš„ç±»æˆ–è€…æ–¹æ³• Java æ–‡æ¡£çš„æµè§ˆå™¨<br>Ctrl+Wï¼Œå¯ä»¥é€‰æ‹©å•è¯ç»§è€Œè¯­å¥ç»§è€Œè¡Œç»§è€Œå‡½æ•°<br>Ctrl+Shift+Wï¼Œå–æ¶ˆé€‰æ‹©å…‰æ ‡æ‰€åœ¨è¯<br>Alt+F7ï¼ŒæŸ¥æ‰¾æ•´ä¸ªå·¥ç¨‹ä¸­ä½¿ç”¨åœ°æŸä¸€ä¸ªç±»ã€æ–¹æ³•æˆ–è€…å˜é‡çš„ä½ç½®<br>Ctrl+Iï¼Œå®ç°æ–¹æ³•<br>Ctrl+Shift+Uï¼Œå¤§å°å†™è½¬åŒ–<br><strong>Ctrl+Yï¼Œåˆ é™¤å½“å‰è¡Œ</strong><br>Shift+Enterï¼Œå‘ä¸‹æ’å…¥æ–°è¡Œ<br>psvm/soutï¼Œmain/System.out.println(); Ctrl+Jï¼ŒæŸ¥çœ‹æ›´å¤š<br>Ctrl+Shift+Fï¼Œå…¨å±€æŸ¥æ‰¾<br>Ctrl+Fï¼ŒæŸ¥æ‰¾/Shift+F3ï¼Œå‘ä¸ŠæŸ¥æ‰¾/F3ï¼Œå‘ä¸‹æŸ¥æ‰¾<br>Ctrl+Shift+Sï¼Œé«˜çº§æœç´¢<br>Ctrl+Uï¼Œè½¬åˆ°çˆ¶ç±»<br>Ctrl+Alt+Sï¼Œæ‰“å¼€è®¾ç½®å¯¹è¯æ¡†<br>Alt+Shift+Inertï¼Œå¼€å¯/å…³é—­åˆ—é€‰æ‹©æ¨¡å¼<br>Ctrl+Alt+Shift+Sï¼Œæ‰“å¼€å½“å‰é¡¹ç›®/æ¨¡å—å±æ€§<br>Ctrl+Gï¼Œå®šä½è¡Œ<br>Alt+Homeï¼Œè·³è½¬åˆ°å¯¼èˆªæ <br>Ctrl+Enterï¼Œä¸Šæ’ä¸€è¡Œ<br>Ctrl+Backspaceï¼ŒæŒ‰å•è¯åˆ é™¤<br>Ctrl+â€+/-â€œï¼Œå½“å‰æ–¹æ³•å±•å¼€ã€æŠ˜å <br>Ctrl+Shift+â€+/-â€œï¼Œå…¨éƒ¨å±•å¼€ã€æŠ˜å <br>ã€è°ƒè¯•éƒ¨åˆ†ã€ç¼–è¯‘ã€‘<br>Ctrl+F2ï¼Œåœæ­¢<br>Alt+Shift+F9ï¼Œé€‰æ‹© Debug<br>Alt+Shift+F10ï¼Œé€‰æ‹© Run<br>Ctrl+Shift+F9ï¼Œç¼–è¯‘<br>Ctrl+Shift+F10ï¼Œè¿è¡Œ<br>Ctrl+Shift+F8ï¼ŒæŸ¥çœ‹æ–­ç‚¹<br>F8ï¼Œæ­¥è¿‡<br>F7ï¼Œæ­¥å…¥<br>Shift+F7ï¼Œæ™ºèƒ½æ­¥å…¥<br>Shift+F8ï¼Œæ­¥å‡º<br>Alt+Shift+F8ï¼Œå¼ºåˆ¶æ­¥è¿‡<br>Alt+Shift+F7ï¼Œå¼ºåˆ¶æ­¥å…¥<br>Alt+F9ï¼Œè¿è¡Œè‡³å…‰æ ‡å¤„<br>Ctrl+Alt+F9ï¼Œå¼ºåˆ¶è¿è¡Œè‡³å…‰æ ‡å¤„<br>F9ï¼Œæ¢å¤ç¨‹åº<br>Alt+F10ï¼Œå®šä½åˆ°æ–­ç‚¹<br>Ctrl+F8ï¼Œåˆ‡æ¢è¡Œæ–­ç‚¹<br>Ctrl+F9ï¼Œç”Ÿæˆé¡¹ç›®<br>Alt+1ï¼Œé¡¹ç›®<br>Alt+2ï¼Œæ”¶è—<br>Alt+6ï¼ŒTODO<br><strong>Alt+7ï¼Œç»“æ„</strong><br>Ctrl+Shift+Cï¼Œå¤åˆ¶è·¯å¾„<br>Ctrl+Alt+Shift+Cï¼Œå¤åˆ¶å¼•ç”¨ï¼Œå¿…é¡»é€‰æ‹©ç±»å<br>Ctrl+Alt+Yï¼ŒåŒæ­¥<br>Ctrl+<del>ï¼Œå¿«é€Ÿåˆ‡æ¢æ–¹æ¡ˆï¼ˆç•Œé¢å¤–è§‚ã€ä»£ç é£æ ¼ã€å¿«æ·é”®æ˜ å°„ç­‰èœå•ï¼‰<br>Shift+F12ï¼Œè¿˜åŸé»˜è®¤å¸ƒå±€<br>Ctrl+Shift+F12ï¼Œéšè—/æ¢å¤æ‰€æœ‰çª—å£<br>Ctrl+F4ï¼Œå…³é—­<br>Ctrl+Shift+F4ï¼Œå…³é—­æ´»åŠ¨é€‰é¡¹å¡<br>Ctrl+Tabï¼Œè½¬åˆ°ä¸‹ä¸€ä¸ªæ‹†åˆ†å™¨<br>Ctrl+Shift+Tabï¼Œè½¬åˆ°ä¸Šä¸€ä¸ªæ‹†åˆ†å™¨<br>ã€é‡æ„ã€‘<br>Ctrl+Alt+Shift+Tï¼Œå¼¹å‡ºé‡æ„èœå•<br>Shift+F6ï¼Œé‡å‘½å<br>F6ï¼Œç§»åŠ¨<br>F5ï¼Œå¤åˆ¶<br>Alt+Deleteï¼Œå®‰å…¨åˆ é™¤<br>Ctrl+Alt+Nï¼Œå†…è”<br>ã€æŸ¥æ‰¾ã€‘<br>Ctrl+Fï¼ŒæŸ¥æ‰¾<br>Ctrl+Rï¼Œæ›¿æ¢<br>F3ï¼ŒæŸ¥æ‰¾ä¸‹ä¸€ä¸ª<br>Shift+F3ï¼ŒæŸ¥æ‰¾ä¸Šä¸€ä¸ª<br>Ctrl+Shift+Fï¼Œåœ¨è·¯å¾„ä¸­æŸ¥æ‰¾<br>Ctrl+Shift+Rï¼Œåœ¨è·¯å¾„ä¸­æ›¿æ¢<br>Ctrl+Shift+Sï¼Œæœç´¢ç»“æ„<br>Ctrl+Shift+Mï¼Œæ›¿æ¢ç»“æ„<br>Alt+F7ï¼ŒæŸ¥æ‰¾ç”¨æ³•<br>Ctrl+Alt+F7ï¼Œæ˜¾ç¤ºç”¨æ³•<br>Ctrl+F7ï¼Œåœ¨æ–‡ä»¶ä¸­æŸ¥æ‰¾ç”¨æ³•<br>Ctrl+Shift+F7ï¼Œåœ¨æ–‡ä»¶ä¸­é«˜äº®æ˜¾ç¤ºç”¨æ³•<br>ã€VCSã€‘<br>Alt+</del>ï¼ŒVCS æ“ä½œèœå•<br>Ctrl+Kï¼Œæäº¤æ›´æ”¹<br>Ctrl+Tï¼Œæ›´æ–°é¡¹ç›®<br>Ctrl+Alt+Shift+Dï¼Œæ˜¾ç¤ºå˜åŒ–</p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> ide </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BigDecimalè¿ç®—å‡ºç°Non-terminating decimal expansion; no exact representable decimal result</title>
      <link href="/post/77a90911.html"/>
      <url>/post/77a90911.html</url>
      
        <content type="html"><![CDATA[<p>æˆ‘ä»¬éƒ½çŸ¥é“Javaæä¾›äº†ä¸¤ä¸ªé«˜ç²¾åº¦è®¡ç®—çš„ç±»:BigIntegerå’ŒBigDeciamlã€‚è™½ç„¶å®ƒä»¬å¤§ä½“ä¸Šå±äºâ€œåŒ…è£…å™¨ç±»â€çš„èŒƒç•´ï¼Œä½†ä¸¤è€…éƒ½æ²¡æœ‰å¯¹åº”çš„åŸºæœ¬ç±»å‹ã€‚BigDeciamlæ”¯æŒä»»æ„ç²¾åº¦çš„å®šç‚¹æ•°ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ç”¨å®ƒè¿›è¡Œç²¾ç¡®çš„è´§å¸è®¡ç®—ã€‚ï¼ˆä»¥ä¸Šæ‘˜è‡ªJavaç¼–ç¨‹æ€æƒ³ç¬¬4ç‰ˆï¼‰</p><a id="more"></a><p>æœ€è¿‘çš„é¡¹ç›®ä½¿ç”¨BigDeciamlï¼Œä»£ç å¦‚ä¸‹:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> originPrice åŸå§‹è´§å¸é‡‘é¢</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> betweenCurrencyRate åŸå§‹è´§å¸å…‘æ¢ä¸­é—´è´§å¸çš„æ±‡ç‡</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> toCurrencyRate ä¸­é—´è´§å¸å…‘æ¢ç›®æ ‡è´§å¸çš„æ±‡ç‡</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return</span> java.math.BigDecimal</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> BigDecimal <span class="title">rate</span><span class="params">(BigDecimal originPrice,BigDecimal betweenCurrencyRate,BigDecimal toCurrencyRate)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">return</span> originPrice.multiply(betweenCurrencyRate).divide(toCurrencyRate);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">BigDecimal chaoIn = exchangeRate.getChaoIn();</span><br><span class="line">BigDecimal cNYChaoIn = exchangeRateCNY.getChaoIn();</span><br><span class="line"></span><br><span class="line">adultPrice = RateExchangeUtil.rate(adultPrice,chaoIn,cNYChaoIn);</span><br><span class="line">childPrice = RateExchangeUtil.rate(childRetail.multiply(<span class="keyword">new</span> BigDecimal(childNum)),chaoIn,cNYChaoIn);</span><br><span class="line"><span class="comment">// è®¡ç®—é…’åº—é‡Œé¢æ€»ä»·</span></span><br><span class="line">hotelTotalPrice = hotelTotalPrice.add(childPrice).add(adultPrice);</span><br></pre></td></tr></table></figure><p>åœ¨ä½¿ç”¨BigDecimalåšè¿ç®—çš„æ—¶å€™ï¼Œå‡ºç°äº†ä¸‹é¢çš„å¼‚å¸¸ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Non-terminating decimal expansion; no exact representable decimal result.</span><br></pre></td></tr></table></figure><p>åæ¥é€šè¿‡æœç´¢å¾—çŸ¥ï¼Œé€šè¿‡BigDecimalçš„divideæ–¹æ³•è¿›è¡Œé™¤æ³•æ—¶å½“ä¸æ•´é™¤ï¼Œå‡ºç°æ— é™å¾ªç¯å°æ•°æ—¶ï¼Œå°±ä¼šæŠ›å‡ºä¸Šé¢çš„å¼‚å¸¸ã€‚<br>æˆ‘ä»¬åº”è¯¥ä½¿ç”¨divideçš„é‡è½½æ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">BigDecimal.divide(BigDecimal divisor, <span class="keyword">int</span> scale, RoundingMode roundingMode) ;</span><br><span class="line"></span><br><span class="line">scaleä¸ºå°æ•°ä½æ•°ï¼›</span><br><span class="line"></span><br><span class="line">roundingModeä¸ºå°æ•°æ¨¡å¼ï¼›</span><br><span class="line">ROUND_CEILING</span><br><span class="line">å¦‚æœ BigDecimal æ˜¯æ­£çš„ï¼Œåˆ™åš ROUND_UP æ“ä½œï¼›å¦‚æœä¸ºè´Ÿï¼Œåˆ™åš ROUND_DOWN æ“ä½œã€‚</span><br><span class="line">ROUND_DOWN</span><br><span class="line">ä»ä¸åœ¨èˆå¼ƒ(å³æˆªæ–­)çš„å°æ•°ä¹‹å‰å¢åŠ æ•°å­—ã€‚</span><br><span class="line">ROUND_FLOOR</span><br><span class="line">å¦‚æœ BigDecimal ä¸ºæ­£ï¼Œåˆ™ä½œ ROUND_UP ï¼›å¦‚æœä¸ºè´Ÿï¼Œåˆ™ä½œ ROUND_DOWN ã€‚</span><br><span class="line">ROUND_HALF_DOWN</span><br><span class="line">è‹¥èˆå¼ƒéƒ¨åˆ†&gt; .<span class="number">5</span>ï¼Œåˆ™ä½œ ROUND_UPï¼›å¦åˆ™ï¼Œä½œ ROUND_DOWN ã€‚</span><br><span class="line">ROUND_HALF_EVEN</span><br><span class="line">å¦‚æœèˆå¼ƒéƒ¨åˆ†å·¦è¾¹çš„æ•°å­—ä¸ºå¥‡æ•°ï¼Œåˆ™ä½œ ROUND_HALF_UP ï¼›å¦‚æœå®ƒä¸ºå¶æ•°ï¼Œåˆ™ä½œ ROUND_HALF_DOWN ã€‚</span><br><span class="line">ROUND_HALF_UP</span><br><span class="line">è‹¥èˆå¼ƒéƒ¨åˆ†&gt;=.<span class="number">5</span>ï¼Œåˆ™ä½œ ROUND_UP ï¼›å¦åˆ™ï¼Œä½œ ROUND_DOWN ã€‚</span><br><span class="line">ROUND_UNNECESSARY</span><br><span class="line">è¯¥â€œä¼ªèˆå…¥æ¨¡å¼â€å®é™…æ˜¯æŒ‡æ˜æ‰€è¦æ±‚çš„æ“ä½œå¿…é¡»æ˜¯ç²¾ç¡®çš„ï¼Œï¼Œå› æ­¤ä¸éœ€è¦èˆå…¥æ“ä½œã€‚</span><br><span class="line">ROUND_UP</span><br><span class="line">æ€»æ˜¯åœ¨é <span class="number">0</span> èˆå¼ƒå°æ•°(å³æˆªæ–­)ä¹‹å‰å¢åŠ æ•°å­—ã€‚</span><br></pre></td></tr></table></figure><p>æœ€åä¿®æ­£rateæ–¹æ³•ä¸­çš„é—®é¢˜ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">*  è´§å¸è½¬æ¢ ç¾å…ƒè½¬åŠ å…ƒï¼Œäººæ°‘å¸ä½œä¸ºä¸­é—´è´§å¸</span></span><br><span class="line"><span class="comment">*  ç¾å…ƒ * ç¾å…ƒå…‘æ¢äººæ°‘å¸çš„æ±‡ç‡ / äººæ°‘å¸å…‘æ¢åŠ å…ƒçš„æ±‡ç‡</span></span><br><span class="line"><span class="comment">*  å‡ºç°é—®é¢˜ Non-terminating decimal expansion; no exact representable decimal result.</span></span><br><span class="line"><span class="comment">*  è¦æŒ‡å®š divideçš„åä¸¤ä¸ªå‚æ•°</span></span><br><span class="line"><span class="comment">*  JAVAä¸­å¦‚æœç”¨BigDecimalåšé™¤æ³•çš„æ—¶å€™ä¸€å®šè¦åœ¨divideæ–¹æ³•ä¸­ä¼ é€’scaleå‚æ•°ï¼Œ</span></span><br><span class="line"><span class="comment">*  å®šä¹‰ç²¾ç¡®åˆ°å°æ•°ç‚¹åå‡ ä½ï¼Œå¦åˆ™åœ¨ä¸æ•´é™¤çš„æƒ…å†µä¸‹ï¼Œç»“æœæ˜¯æ— é™å¾ªç¯å°æ•°æ—¶ï¼Œå°±ä¼šæŠ›å‡ºä»¥ä¸Šå¼‚å¸¸ã€‚</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> originPrice åŸå§‹è´§å¸é‡‘é¢</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> betweenCurrencyRate åŸå§‹è´§å¸å…‘æ¢ä¸­é—´è´§å¸çš„æ±‡ç‡</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> toCurrencyRate ä¸­é—´è´§å¸å…‘æ¢ç›®æ ‡è´§å¸çš„æ±‡ç‡</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return</span> java.math.BigDecimal</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> BigDecimal <span class="title">rate</span><span class="params">(BigDecimal originPrice,BigDecimal betweenCurrencyRate,BigDecimal toCurrencyRate)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> originPrice.multiply(betweenCurrencyRate).divide(toCurrencyRate,<span class="number">4</span>,BigDecimal.ROUND_HALF_UP);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> BigDecimal </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nginxå®ç°åå‘ä»£ç† Node.js</title>
      <link href="/post/45183e9d.html"/>
      <url>/post/45183e9d.html</url>
      
        <content type="html"><![CDATA[<p>å…¬å¸æœ‰é¡¹ç›®å‰ç«¯æ˜¯ç”¨node.jsè¿›è¡ŒæœåŠ¡å™¨æ¸²æŸ“ï¼Œç„¶åå†è¿”å›ç»™æµè§ˆå™¨ï¼Œè¿›è€Œè§£å†³å•é¡µé¢çš„SEOé—®é¢˜ã€‚é¡¹ç›®éƒ¨ç½²çš„æ—¶å€™ï¼Œä½¿ç”¨Nginxåå‘ä»£ç†Node.jsã€‚å…·ä½“çš„æ­¥éª¤å¦‚ä¸‹ï¼š</p><a id="more"></a><p>ï¼ˆNginxã€Node.jsçš„å®‰è£…å’ŒåŸºæœ¬é…ç½®ç›´æ¥è·³è¿‡ï¼‰</p><p>é¦–å…ˆæˆ‘ä»¬è¦åœ¨nginx.cnfæ–‡ä»¶ä¸­çš„httpèŠ‚ç‚¹æ‰“å¼€ä¸‹é¢çš„é…ç½®ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">http &#123;</span><br><span class="line">    log_format   main  <span class="string">'$remote_addr - $remote_user [$time_local] "$request" '</span></span><br><span class="line">                      <span class="string">'$status $body_bytes_sent "$http_referer" '</span></span><br><span class="line">                      <span class="string">'"$http_user_agent" "$http_x_forwarded_for"'</span>;</span><br><span class="line"></span><br><span class="line">    access_log  /var/<span class="built_in">log</span>/nginx/access.log  main;</span><br><span class="line"></span><br><span class="line">    sendfile            on;</span><br><span class="line">    tcp_nopush          on;</span><br><span class="line">    tcp_nodelay         on;</span><br><span class="line">    keepalive_timeout   65;</span><br><span class="line">    types_hash_max_size 2048;</span><br><span class="line"></span><br><span class="line">    include             /etc/nginx/mime.types;</span><br><span class="line">    default_type        application/octet-stream;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ‰“å¼€è¿™ä¸€è¡Œçš„é…ç½®</span></span><br><span class="line">    include /etc/nginx/conf.d/*.conf;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åæ¯ä¸ª<strong>åŸŸåçš„é…ç½®æ–‡ä»¶å°±æ”¾åˆ°è¿™ä¸ªç›®å½•/etc/nginx/conf.d/ä¸‹ï¼Œæ–‡ä»¶åç¼€ä»¥confç»“æŸã€‚</strong></p><ol><li>ç¬¬ä¸€ç§æ–¹å¼ï¼Œè¿™ç§ç®€å•ï¼š</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen       80 ;</span><br><span class="line">    server_name  localhost;</span><br><span class="line">    root   /xxx/xxx/hxxydexx/;</span><br><span class="line">    </span><br><span class="line">    #set $my_server_name $scheme://$server_name; </span><br><span class="line"></span><br><span class="line">    #if ( $my_server_name != https://$server_name ) &#123;</span><br><span class="line">    #   rewrite ^ https://$server_name$request_uri? permanent;</span><br><span class="line">    #&#125;</span><br><span class="line">    </span><br><span class="line">    error_log    /var/log/nginx/hyde_error.log    error;</span><br><span class="line">    access_log    /var/log/nginx/hyde_accss.log    main;</span><br><span class="line">    </span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">        proxy_set_header Host  $http_host;</span><br><span class="line">        proxy_set_header X-Nginx-Proxy true;</span><br><span class="line">        proxy_http_version 1.1;</span><br><span class="line">        proxy_set_header Connection &quot;&quot;;</span><br><span class="line">        </span><br><span class="line">        # ä¸éœ€è¦è€ƒè™‘åˆ°è´Ÿè½½çš„ï¼Œå°±æ— éœ€é…ç½®upstreamèŠ‚ç‚¹ã€‚</span><br><span class="line">        proxy_pass    http://127.0.0.1:3000;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    error_page 404 /404.html;</span><br><span class="line">        location =  /xxx/xxx/40x.html &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    error_page 500 502 503 504 /50x.html;</span><br><span class="line">        location =  /xxx/xxx/50x.html &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> 2.ç¬¬äºŒç§æ–¹å¼ï¼Œè€ƒè™‘åˆ°è´Ÿè½½</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">upstream node &#123;</span><br><span class="line">    server 127.0.0.1:3000; </span><br><span class="line">&#125;</span><br><span class="line">server &#123;</span><br><span class="line">    listen       80 ;</span><br><span class="line">    server_name  localhost;</span><br><span class="line">    root   /xxx/xxx/hxxydexx/;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">#set $my_server_name $scheme://$server_name; </span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#if ( $my_server_name != https://$server_name ) &#123;</span></span><br><span class="line">    <span class="comment">#   rewrite ^ https://$server_name$request_uri? permanent;</span></span><br><span class="line">    <span class="comment">#&#125;</span></span><br><span class="line">    </span><br><span class="line">    error_log    /var/<span class="built_in">log</span>/nginx/hyde_error.log    error;</span><br><span class="line">    access_log    /var/<span class="built_in">log</span>/nginx/hyde_accss.log    main;</span><br><span class="line">    </span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_set_header X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">        proxy_set_header X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">        proxy_set_header Host  <span class="variable">$http_host</span>;</span><br><span class="line">        proxy_set_header X-Nginx-Proxy <span class="literal">true</span>;</span><br><span class="line">        proxy_http_version 1.1;</span><br><span class="line">        proxy_set_header Connection <span class="string">""</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># é…ç½®upstreamèŠ‚ç‚¹</span></span><br><span class="line">        proxy_pass    http://node;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    error_page 404 /404.html;</span><br><span class="line">        location =  /xxx/xxx/40x.html &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    error_page 500 502 503 504 /50x.html;</span><br><span class="line">        location =  /xxx/xxx/50x.html &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åé‡å¯æˆ–è€…é‡æ–°è½½å…¥nginxçš„é…ç½®æ–‡ä»¶å³å¯ã€‚å‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ£€æŸ¥nginxé…ç½®æ–‡ä»¶ä¸­è¯­æ³•æ˜¯å¦æ­£ç¡®</span></span><br><span class="line">nginx -t</span><br><span class="line"></span><br><span class="line"><span class="comment">#é‡å¯nginx</span></span><br><span class="line">service nginx restart</span><br><span class="line"></span><br><span class="line"><span class="comment">#é‡è½½é…ç½®æ–‡ä»¶</span></span><br><span class="line">nginx -s reload</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„é—®é¢˜ï¼š</strong><br>ä¸Šé¢å¯èƒ½ä¼šå‡ºç°ä¸‹é¢çš„é—®é¢˜ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">events.js:72</span><br><span class="line">    throw er; // Unhandled <span class="string">'error'</span> event</span><br><span class="line">          ^</span><br><span class="line">Error: listen EADDRINUSE</span><br><span class="line">    at errnoException (net.js:884:11)</span><br><span class="line">    at Server._listen2 (net.js:1022:14)</span><br><span class="line">    at listen (net.js:1044:10)</span><br><span class="line">    at Server.listen (net.js:1110:5)</span><br><span class="line">    at Object.&lt;anonymous&gt; (folderName/app.js:33:24)</span><br><span class="line">    at Module._compile (module.js:456:26)</span><br><span class="line">    at Object.Module._extensions..js (module.js:474:10)</span><br><span class="line">    at Module.load (module.js:356:32)</span><br><span class="line">    at Function.Module._load (module.js:312:12)</span><br><span class="line">    at Function.Module.runMain (module.js:497:10)</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå…¶å®æ˜¯Node.jsæœåŠ¡å¤šå¼€ç«¯å£è¢«å ç”¨å¯¼è‡´çš„æŠ¥é”™ï¼Œå‡ºç°è¿™ç§é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨Node.jsé¡¹ç›®ç®¡ç†å·¥å…·pm2ï¼Œæˆ–è€…ä½¿ç”¨netstat -anopè¿›è¡ŒæŸ¥çœ‹ç«¯å£è¢«é‚£ä¸ªè¿›ç¨‹å ç”¨ï¼Œç„¶åæ€æ‰é‡å¯æœåŠ¡ï¼</p><p>é™„ä¸ŠNginxçš„è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼š</p><ul><li><p>è½®è¯¢ï¼ˆé»˜è®¤ï¼‰<br>æ¯ä¸ªè¯·æ±‚æŒ‰æ—¶é—´é¡ºåºé€ä¸€åˆ†é…åˆ°ä¸åŒçš„åç«¯æœåŠ¡å™¨ï¼Œå¦‚æœåç«¯æœåŠ¡å™¨downæ‰ï¼Œèƒ½è‡ªåŠ¨å‰”é™¤ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">upstream backserver &#123; </span><br><span class="line">  server 192.168.0.14; </span><br><span class="line">  server 192.168.0.15; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æŒ‡å®šæƒé‡<br>æŒ‡å®šè½®è¯¢å‡ ç‡ï¼Œweightå’Œè®¿é—®æ¯”ç‡æˆæ­£æ¯”ï¼Œç”¨äºåç«¯æœåŠ¡å™¨æ€§èƒ½ä¸å‡çš„æƒ…å†µã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">upstream backserver &#123; </span><br><span class="line">  server 192.168.0.14 weight=10; </span><br><span class="line">  server 192.168.0.15 weight=10; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>IPç»‘å®š ip_hash<br>æ¯ä¸ªè¯·æ±‚æŒ‰è®¿é—®ipçš„hashç»“æœåˆ†é…ï¼Œè¿™æ ·æ¯ä¸ªè®¿å®¢å›ºå®šè®¿é—®ä¸€ä¸ªåç«¯æœåŠ¡å™¨ï¼Œå¯ä»¥è§£å†³sessionçš„é—®é¢˜ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">upstream backserver &#123; </span><br><span class="line">  ip_hash; </span><br><span class="line">  server 192.168.0.14:88; </span><br><span class="line">  server 192.168.0.15:80; </span><br><span class="line">&#125; </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line"> - fairï¼ˆç¬¬ä¸‰æ–¹ï¼‰</span><br><span class="line">æŒ‰åç«¯æœåŠ¡å™¨çš„å“åº”æ—¶é—´æ¥åˆ†é…è¯·æ±‚ï¼Œå“åº”æ—¶é—´çŸ­çš„ä¼˜å…ˆåˆ†é…ã€‚</span><br><span class="line">```bash</span><br><span class="line">upstream backserver &#123; </span><br><span class="line">  server 192.168.0.14:88; </span><br><span class="line">  server 192.168.0.15:80;</span><br><span class="line">  fair; </span><br><span class="line">&#125; </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line"> - url_hashï¼ˆç¬¬ä¸‰æ–¹ï¼‰</span><br><span class="line">æŒ‰è®¿é—®urlçš„<span class="built_in">hash</span>ç»“æœæ¥åˆ†é…è¯·æ±‚ï¼Œä½¿æ¯ä¸ªurlå®šå‘åˆ°åŒä¸€ä¸ªåç«¯æœåŠ¡å™¨ï¼Œåç«¯æœåŠ¡å™¨ä¸ºç¼“å­˜æ—¶æ¯”è¾ƒæœ‰æ•ˆã€‚ </span><br><span class="line">```bash</span><br><span class="line">upstream backserver &#123; </span><br><span class="line"></span><br><span class="line">  server squid1:3128; </span><br><span class="line">  server squid2:3128; </span><br><span class="line"></span><br><span class="line">  <span class="built_in">hash</span> <span class="variable">$request_uri</span>; </span><br><span class="line">  hash_method crc32; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> nginx </tag>
            
            <tag> proxy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaå­¦ä¹ ç³»åˆ—æ–‡ç« ç¬¬ä¹ç¯‡ï¼šJavaä¸­æ³›å‹çš„å­¦ä¹ </title>
      <link href="/post/d9ad2c86.html"/>
      <url>/post/d9ad2c86.html</url>
      
        <content type="html"><![CDATA[<h3 id="ä»€ä¹ˆæ˜¯æ³›å‹"><a href="#ä»€ä¹ˆæ˜¯æ³›å‹" class="headerlink" title="ä»€ä¹ˆæ˜¯æ³›å‹"></a>ä»€ä¹ˆæ˜¯æ³›å‹</h3><p>Java æ³›å‹ï¼ˆgenericsï¼‰æ˜¯ JDK5 ä¸­å¼•å…¥çš„ä¸€ä¸ªæ–°ç‰¹æ€§, æ³›å‹æä¾›äº†ç¼–è¯‘æ—¶ç±»å‹å®‰å…¨æ£€æµ‹æœºåˆ¶ï¼Œè¯¥æœºåˆ¶å…è®¸ç¨‹åºå‘˜åœ¨ç¼–è¯‘æ—¶æ£€æµ‹åˆ°éæ³•çš„ç±»å‹ã€‚<strong>æ³›å‹çš„æœ¬è´¨æ˜¯å‚æ•°åŒ–ç±»å‹</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´æ‰€æ“ä½œçš„æ•°æ®ç±»å‹è¢«æŒ‡å®šä¸ºä¸€ä¸ªå‚æ•°ã€‚(PHPå°±ä¸éœ€è¦æ³›å‹ï¼Œå“ˆå“ˆ)</p><a id="more"></a><p>ä¸‹é¢æˆ‘ä»¬çœ‹ä¸€é“å…³äºJavaæ³›å‹çš„ç»å…¸æµ‹è¯•é¢˜ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; list1 = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">List&lt;Integer&gt; list2 = <span class="keyword">new</span> ArrayList&lt;Integer&gt;();</span><br><span class="line"></span><br><span class="line">System.out.println(list1.getClass() == list2.getClass());</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç æœ€ç»ˆç»“æœè¾“å‡ºçš„æ˜¯ä»€ä¹ˆï¼Ÿä¸äº†è§£æ³›å‹çš„å’Œå¾ˆç†Ÿæ‚‰æ³›å‹çš„åŒå­¦åº”è¯¥èƒ½å¤Ÿç­”å‡ºæ¥ï¼Œè€Œå¯¹æ³›å‹æœ‰æ‰€äº†è§£ï¼Œä½†æ˜¯äº†è§£ä¸æ·±å…¥çš„åŒå­¦å¯èƒ½ä¼šç­”é”™ã€‚</p><p>æ­£ç¡®ç­”æ¡ˆæ˜¯ trueã€‚</p><p>ä¸Šé¢æåˆ°äº†æ³›å‹çš„æœ¬è´¨æ˜¯ç±»å‹å‚æ•°åŒ–ï¼Œå¦‚ä½•è§£é‡Šç±»å‹å‚æ•°åŒ–å‘¢ï¼Ÿ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Cache</span> </span>&#123;</span><br><span class="line">   Object value;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> Object <span class="title">getValue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       <span class="keyword">return</span> value;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setValue</span><span class="params">(Object value)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">this</span>.value = value;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·çš„ Cache æ˜¯èƒ½å¤Ÿå­˜å–ä»»ä½•ç±»å‹çš„å€¼ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨ä½¿ç”¨çš„æ—¶å€™ä¼šæœ‰ç‚¹éº»çƒ¦ã€‚æˆ‘ä»¬è¦è·å–çœŸæ­£çš„ç±»å‹ï¼Œå°±è¦è¿›è¡Œç±»å‹çš„å¼ºåˆ¶è½¬æ¢äº†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Cache cache = <span class="keyword">new</span> Cache();</span><br><span class="line">cache.setValue(<span class="number">134</span>);</span><br><span class="line"><span class="keyword">int</span> value = (<span class="keyword">int</span>) cache.getValue();</span><br><span class="line">cache.setValue(<span class="string">"hello"</span>);</span><br><span class="line">String value1 = (String) cache.getValue();</span><br></pre></td></tr></table></figure><p>è¿™æ ·çš„ç¼–ç¨‹çœŸçš„æ˜¯å¤ªéº»çƒ¦äº†ï¼Œä¸‡ä¸€å¿˜è®°äº†å­˜æ”¾å˜é‡çš„ç±»å‹ï¼Œç¨‹åºåœ¨è¿è¡Œçš„æ—¶å€™å°±ä¼šæŠ¥ç±»å‹è½¬æ¢é”™è¯¯ã€‚äºæ˜¯åœ¨JDK5 ä¸­å¼•ç”¨çš„æ³›å‹ç»™æˆ‘ä»¬å¸¦æ¥äº†å¦ä¸€ç•ªç¼–ç¨‹ä½“éªŒã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Cache</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">   T value;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> Object <span class="title">getValue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       <span class="keyword">return</span> value;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setValue</span><span class="params">(T value)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">this</span>.value = value;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™å°±æ˜¯æ³›å‹ï¼Œå®ƒå°† value è¿™ä¸ªå±æ€§çš„ç±»å‹ä¹Ÿå‚æ•°åŒ–äº†ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„å‚æ•°åŒ–ç±»å‹ã€‚å†çœ‹å®ƒçš„ä½¿ç”¨æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Cache&lt;String&gt; cache1 = <span class="keyword">new</span> Cache&lt;String&gt;();</span><br><span class="line">cache1.setValue(<span class="string">"123"</span>);</span><br><span class="line">String value2 = cache1.getValue();</span><br><span class="line"></span><br><span class="line">Cache&lt;Integer&gt; cache2 = <span class="keyword">new</span> Cache&lt;Integer&gt;();</span><br><span class="line">cache2.setValue(<span class="number">123</span>);</span><br><span class="line"><span class="keyword">int</span> value3 = cache2.getValue();</span><br></pre></td></tr></table></figure><p>æœ€æ˜¾è€Œæ˜“è§çš„å¥½å¤„å°±æ˜¯å®ƒä¸å†éœ€è¦å¯¹å–å‡ºæ¥çš„ç»“æœè¿›è¡Œå¼ºåˆ¶è½¬æ¢äº†ã€‚ä½†ï¼Œè¿˜æœ‰å¦å¤–ä¸€ç‚¹ä¸åŒã€‚æ³›å‹é™¤äº†å¯ä»¥å°†ç±»å‹å‚æ•°åŒ–å¤–ï¼Œè€Œå‚æ•°ä¸€æ—¦ç¡®å®šå¥½ï¼Œå¦‚æœç±»ä¼¼ä¸åŒ¹é…ï¼Œç¼–è¯‘å™¨å°±ä¸é€šè¿‡ã€‚<br>ç»¼åˆä¸Šé¢ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸‹é¢çš„ç»“è®º:</p><ul><li>ä¸æ™®é€šçš„ Object ä»£æ›¿ä¸€åˆ‡ç±»å‹è¿™æ ·ç®€å•ç²—æš´è€Œè¨€ï¼Œæ³›å‹ä½¿å¾—æ•°æ®çš„ç±»åˆ«å¯ä»¥åƒå‚æ•°ä¸€æ ·ç”±å¤–éƒ¨ä¼ é€’è¿›æ¥ã€‚å®ƒæä¾›äº†ä¸€ç§æ‰©å±•èƒ½åŠ›ã€‚å®ƒæ›´ç¬¦åˆé¢å‘æŠ½è±¡å¼€å‘çš„è½¯ä»¶ç¼–ç¨‹å®—æ—¨ã€‚</li><li>å½“å…·ä½“çš„ç±»å‹ç¡®å®šåï¼Œæ³›å‹åˆæä¾›äº†ä¸€ç§ç±»å‹æ£€æµ‹çš„æœºåˆ¶ï¼Œåªæœ‰ç›¸åŒ¹é…çš„æ•°æ®æ‰èƒ½æ­£å¸¸çš„èµ‹å€¼ï¼Œå¦åˆ™ç¼–è¯‘å™¨å°±ä¸é€šè¿‡ã€‚æ‰€ä»¥è¯´ï¼Œå®ƒæ˜¯ä¸€ç§ç±»å‹å®‰å…¨æ£€æµ‹æœºåˆ¶ï¼Œä¸€å®šç¨‹åº¦ä¸Šæé«˜äº†è½¯ä»¶çš„å®‰å…¨æ€§é˜²æ­¢å‡ºç°ä½çº§çš„å¤±è¯¯ã€‚</li><li>æ³›å‹æé«˜äº†ç¨‹åºä»£ç çš„å¯è¯»æ€§ï¼Œä¸å¿…è¦ç­‰åˆ°è¿è¡Œçš„æ—¶å€™æ‰å»å¼ºåˆ¶è½¬æ¢ï¼Œåœ¨å®šä¹‰æˆ–è€…å®ä¾‹åŒ–é˜¶æ®µï¼Œå› ä¸º Cache<String> è¿™ä¸ªç±»å‹æ˜¾åŒ–çš„æ•ˆæœï¼Œç¨‹åºå‘˜èƒ½å¤Ÿä¸€ç›®äº†ç„¶çŒœæµ‹å‡ºä»£ç è¦æ“ä½œçš„æ•°æ®ç±»å‹ã€‚</li></ul><h3 id="æ³›å‹çš„å®šä¹‰å’Œä½¿ç”¨"><a href="#æ³›å‹çš„å®šä¹‰å’Œä½¿ç”¨" class="headerlink" title="æ³›å‹çš„å®šä¹‰å’Œä½¿ç”¨"></a>æ³›å‹çš„å®šä¹‰å’Œä½¿ç”¨</h3><p>æ³›å‹æŒ‰ç…§ä½¿ç”¨æƒ…å†µå¯ä»¥åˆ†ä¸º 3 ç§ã€‚</p><ul><li>æ³›å‹ç±»</li><li>æ³›å‹æ–¹æ³•</li><li>æ³›å‹æ¥å£</li></ul><h4 id="æ³›å‹ç±»"><a href="#æ³›å‹ç±»" class="headerlink" title="æ³›å‹ç±»"></a>æ³›å‹ç±»</h4><p>é‚£å¦‚ä½•å®šä¹‰æ³›å‹ç±»å‘¢ï¼Ÿ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">   T field;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°–æ‹¬å· &lt;&gt; ä¸­çš„ T è¢«ç§°ä½œæ˜¯ç±»å‹å‚æ•°ï¼Œç”¨äºæŒ‡ä»£ä»»ä½•ç±»å‹ã€‚äº‹å®ä¸Šï¼ŒT åªæ˜¯ä¸€ç§ä¹ æƒ¯æ€§å†™æ³•ï¼Œå¦‚æœä½ æ„¿æ„ã€‚ä½ å¯ä»¥è¿™æ ·å†™ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span>&lt;<span class="title">TMD</span>&gt; </span>&#123;</span><br><span class="line">   TMD field;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†å‡ºäºè§„èŒƒçš„ç›®çš„ï¼ŒJava è¿˜æ˜¯å»ºè®®æˆ‘ä»¬ç”¨å•ä¸ªå¤§å†™å­—æ¯æ¥ä»£è¡¨ç±»å‹å‚æ•°ã€‚å¸¸è§çš„å¦‚ï¼š </p><ul><li>T ä»£è¡¨ä¸€èˆ¬çš„ä»»ä½•ç±»ã€‚ </li><li>E ä»£è¡¨Element çš„æ„æ€ï¼Œæˆ–è€…æ˜¯Exception å¼‚å¸¸çš„æ„æ€</li><li>K ä»£è¡¨ Key çš„æ„æ€</li><li>V ä»£è¡¨ Value çš„æ„æ€ï¼Œé€šå¸¸ä¸ K ä¸€èµ·é…åˆä½¿ç”¨</li><li>S ä»£è¡¨ Subtype çš„æ„æ€</li></ul><p>å¦‚æœä¸€ä¸ªç±»è¢« <T> çš„å½¢å¼å®šä¹‰ï¼Œé‚£ä¹ˆå®ƒå°±è¢«ç§°ä¸ºæ³›å‹ç±»ã€‚é‚£ä¹ˆå¯¹äºæ³›å‹ç±»æ€ä¹ˆæ ·ä½¿ç”¨å‘¢ï¼Ÿ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Test&lt;String&gt; test1 = <span class="keyword">new</span> Test&lt;&gt;();</span><br><span class="line">Test&lt;Integer&gt; test2 = <span class="keyword">new</span> Test&lt;&gt;();</span><br></pre></td></tr></table></figure><p>åªè¦åœ¨å¯¹æ³›å‹ç±»åˆ›å»ºå®ä¾‹çš„æ—¶å€™ï¼Œåœ¨å°–æ‹¬å·ä¸­èµ‹å€¼ç›¸åº”çš„ç±»å‹ä¾¿æ˜¯ã€‚T å°±ä¼šè¢«æ›¿æ¢æˆå¯¹åº”çš„ç±»å‹ï¼Œå¦‚ String æˆ–è€…æ˜¯ Integerã€‚ä½ å¯ä»¥ç›¸åƒä¸€ä¸‹ï¼Œå½“ä¸€ä¸ªæ³›å‹ç±»è¢«åˆ›å»ºæ—¶ï¼Œå†…éƒ¨è‡ªåŠ¨æ‰©å±•æˆä¸‹é¢çš„ä»£ç ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span>&lt;<span class="title">String</span>&gt; </span>&#123;</span><br><span class="line">   String field;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œæ³›å‹ç±»ä¸æ˜¯åªèƒ½æ¥å—ä¸€ä¸ªç±»å‹å‚æ•°ï¼Œå®ƒè¿˜å¯ä»¥è¿™æ ·æ¥å—å¤šä¸ªç±»å‹å‚æ•°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MultiType</span> &lt;<span class="title">E</span>,<span class="title">T</span>&gt;</span>&#123;</span><br><span class="line">   E value1;</span><br><span class="line">   T value2;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> E <span class="title">getValue1</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="keyword">return</span> value1;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> T <span class="title">getValue2</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="keyword">return</span> value2;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ³›å‹æ–¹æ³•"><a href="#æ³›å‹æ–¹æ³•" class="headerlink" title="æ³›å‹æ–¹æ³•"></a>æ³›å‹æ–¹æ³•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test1</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> &lt;T&gt; <span class="function"><span class="keyword">void</span> <span class="title">testMethod</span><span class="params">(T t)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³›å‹æ–¹æ³•ä¸æ³›å‹ç±»ç¨æœ‰ä¸åŒçš„åœ°æ–¹æ˜¯ï¼Œç±»å‹å‚æ•°ä¹Ÿå°±æ˜¯å°–æ‹¬å·é‚£ä¸€éƒ¨åˆ†æ˜¯å†™åœ¨è¿”å›å€¼å‰é¢çš„ã€‚<T> ä¸­çš„ T è¢«ç§°ä¸ºç±»å‹å‚æ•°ï¼Œè€Œæ–¹æ³•ä¸­çš„ T è¢«ç§°ä¸ºå‚æ•°åŒ–ç±»å‹ï¼Œå®ƒä¸æ˜¯è¿è¡Œæ—¶çœŸæ­£çš„å‚æ•°ã€‚</p><p>å½“ç„¶ï¼Œå£°æ˜çš„ç±»å‹å‚æ•°ï¼Œå…¶å®ä¹Ÿæ˜¯å¯ä»¥å½“ä½œè¿”å›å€¼çš„ç±»å‹çš„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span>  &lt;T&gt; <span class="function">T <span class="title">testMethod1</span><span class="params">(T t)</span></span>&#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³›å‹ç±»ä¸æ³›å‹æ–¹æ³•çš„å…±å­˜ç°è±¡:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span>&lt;<span class="title">T</span>&gt;</span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testMethod</span><span class="params">(T t)</span></span>&#123;</span><br><span class="line">       System.out.println(t.getClass().getName());</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">public</span> &lt;T&gt; <span class="function">T <span class="title">testMethod1</span><span class="params">(T t)</span></span>&#123;</span><br><span class="line">       <span class="keyword">return</span> t;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼ŒTest1<T> æ˜¯æ³›å‹ç±»ï¼ŒtestMethod æ˜¯æ³›å‹ç±»ä¸­çš„æ™®é€šæ–¹æ³•ï¼Œè€Œ testMethod1 æ˜¯ä¸€ä¸ªæ³›å‹æ–¹æ³•ã€‚è€Œæ³›å‹ç±»ä¸­çš„ç±»å‹å‚æ•°ä¸æ³›å‹æ–¹æ³•ä¸­çš„ç±»å‹å‚æ•°æ˜¯æ²¡æœ‰ç›¸åº”çš„è”ç³»çš„ï¼Œ<strong>æ³›å‹æ–¹æ³•å§‹ç»ˆä»¥è‡ªå·±å®šä¹‰çš„ç±»å‹å‚æ•°ä¸ºå‡†</strong>ã€‚</p><p>æ‰€ä»¥ï¼Œé’ˆå¯¹ä¸Šé¢çš„ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·ç¼–å†™æµ‹è¯•ä»£ç ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Test1&lt;String&gt; t = <span class="keyword">new</span> Test1();</span><br><span class="line">t.testMethod(<span class="string">"generic"</span>);</span><br><span class="line">Integer i = t.testMethod1(<span class="keyword">new</span> Integer(<span class="number">1</span>));</span><br></pre></td></tr></table></figure><p>æ³›å‹ç±»çš„å®é™…ç±»å‹å‚æ•°æ˜¯ Stringï¼Œè€Œä¼ é€’ç»™æ³›å‹æ–¹æ³•çš„ç±»å‹å‚æ•°æ˜¯ Integerï¼Œä¸¤è€…ä¸æƒ³å¹²ã€‚</p><p>ä½†æ˜¯ï¼Œä¸ºäº†é¿å…æ··æ·†ï¼Œå¦‚æœåœ¨ä¸€ä¸ªæ³›å‹ç±»ä¸­å­˜åœ¨æ³›å‹æ–¹æ³•ï¼Œé‚£ä¹ˆä¸¤è€…çš„ç±»å‹å‚æ•°æœ€å¥½ä¸è¦åŒåã€‚æ¯”å¦‚ï¼ŒTest<T> ä»£ç å¯ä»¥æ›´æ”¹ä¸ºè¿™æ ·</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test1</span>&lt;<span class="title">T</span>&gt;</span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">testMethod</span><span class="params">(T t)</span></span>&#123;</span><br><span class="line">       System.out.println(t.getClass().getName());</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">public</span>  &lt;E&gt; <span class="function">E <span class="title">testMethod1</span><span class="params">(E e)</span></span>&#123;</span><br><span class="line">       <span class="keyword">return</span> e;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ³›å‹æ¥å£"><a href="#æ³›å‹æ¥å£" class="headerlink" title="æ³›å‹æ¥å£"></a>æ³›å‹æ¥å£</h3><p>æ³›å‹æ¥å£å®šä¹‰ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Iterable</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é€šé…ç¬¦-ï¼Ÿ"><a href="#é€šé…ç¬¦-ï¼Ÿ" class="headerlink" title="é€šé…ç¬¦ ï¼Ÿ"></a>é€šé…ç¬¦ ï¼Ÿ</h3><p>é™¤äº†ç”¨ <T> è¡¨ç¤ºæ³›å‹å¤–ï¼Œè¿˜æœ‰ <?> è¿™ç§å½¢å¼ã€‚ï¼Ÿ è¢«ç§°ä¸ºé€šé…ç¬¦ã€‚å¯èƒ½æœ‰åŒå­¦ä¼šæƒ³ï¼Œå·²ç»æœ‰äº† <T> çš„å½¢å¼äº†ï¼Œä¸ºä»€ä¹ˆè¿˜è¦å¼•è¿› <?> è¿™æ ·çš„æ¦‚å¿µå‘¢ï¼Ÿ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sub</span> <span class="keyword">extends</span> <span class="title">Base</span></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Sub sub = <span class="keyword">new</span> Sub();</span><br><span class="line">Base base = sub;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç æ˜¾ç¤ºï¼ŒBase æ˜¯ Sub çš„çˆ¶ç±»ï¼Œå®ƒä»¬ä¹‹é—´æ˜¯ç»§æ‰¿å…³ç³»ï¼Œæ‰€ä»¥ Sub çš„å®ä¾‹å¯ä»¥ç»™ä¸€ä¸ª Base å¼•ç”¨èµ‹å€¼ï¼Œé‚£ä¹ˆ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Sub&gt; lsub = <span class="keyword">new</span> ArrayList&lt;Sub&gt;();</span><br><span class="line">List&lt;Base&gt; lbase = lsub;</span><br></pre></td></tr></table></figure><p>æœ€åä¸€è¡Œä»£ç æˆç«‹å—ï¼Ÿç¼–è¯‘ä¼šé€šè¿‡å—ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯<strong>é€šè¿‡ä¸äº†ç¼–è¯‘</strong>çš„ã€‚</p><p>ç¼–è¯‘å™¨ä¸ä¼šè®©å®ƒé€šè¿‡çš„ã€‚Sub æ˜¯ Base çš„å­ç±»ï¼Œä¸ä»£è¡¨ List<Sub> å’Œ List<Base> æœ‰ç»§æ‰¿å…³ç³»ã€‚</p><p>ä½†æ˜¯ï¼Œåœ¨ç°å®ç¼–ç ä¸­ï¼Œç¡®å®æœ‰è¿™æ ·çš„éœ€æ±‚ï¼Œå¸Œæœ›æ³›å‹èƒ½å¤Ÿå¤„ç†æŸä¸€èŒƒå›´å†…çš„æ•°æ®ç±»å‹ï¼Œæ¯”å¦‚æŸä¸ªç±»å’Œå®ƒçš„å­ç±»ï¼Œå¯¹æ­¤ Java å¼•å…¥äº†é€šé…ç¬¦è¿™ä¸ªæ¦‚å¿µã€‚</p><p>æ‰€ä»¥ï¼Œ<strong>é€šé…ç¬¦çš„å‡ºç°æ˜¯ä¸ºäº†æŒ‡å®šæ³›å‹ä¸­çš„ç±»å‹èŒƒå›´</strong>ã€‚</p><p>é€šé…ç¬¦æœ‰ 3 ç§å½¢å¼:</p><ul><li>&lt;?&gt; è¢«ç§°ä½œæ— é™å®šçš„é€šé…ç¬¦</li><li>&lt;? extends T&gt; è¢«ç§°ä½œæœ‰ä¸Šé™çš„é€šé…ç¬¦</li><li>&lt;? super T&gt; è¢«ç§°ä½œæœ‰ä¸‹é™çš„é€šé…ç¬¦</li></ul><h3 id="æ— é™å®šé€šé…ç¬¦"><a href="#æ— é™å®šé€šé…ç¬¦" class="headerlink" title="æ— é™å®šé€šé…ç¬¦"></a>æ— é™å®šé€šé…ç¬¦</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testWildCards</span><span class="params">(Collection&lt;?&gt; collection)</span></span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæ–¹æ³•å†…çš„å‚æ•°æ˜¯è¢«æ— é™å®šé€šé…ç¬¦ä¿®é¥°çš„ Collection å¯¹è±¡ï¼Œå®ƒéšç•¥åœ°è¡¨è¾¾äº†ä¸€ä¸ªæ„å›¾æˆ–è€…å¯ä»¥è¯´æ˜¯é™å®šï¼Œé‚£å°±æ˜¯ testWidlCards() è¿™ä¸ªæ–¹æ³•å†…éƒ¨æ— éœ€å…³æ³¨ Collection ä¸­çš„çœŸå®ç±»å‹ï¼Œ<strong>å› ä¸ºå®ƒæ˜¯æœªçŸ¥çš„</strong>ã€‚æ‰€ä»¥ï¼Œä½ åªèƒ½è°ƒç”¨ Collection ä¸­ä¸ç±»å‹æ— å…³çš„æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestWildCards</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testWildCards</span><span class="params">(Collection&lt;?&gt; collection)</span></span>&#123;</span><br><span class="line">        #æŠ¥é”™</span><br><span class="line">        collection.add(<span class="number">123</span>);</span><br><span class="line">        #æŠ¥é”™</span><br><span class="line">        collection.add(<span class="string">"hello"</span>);</span><br><span class="line">        #æŠ¥é”™</span><br><span class="line">        collection.add(<span class="keyword">new</span> Object());</span><br><span class="line"></span><br><span class="line">        collection.iterator().next();</span><br><span class="line">        collection.size();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå½“ &lt;?&gt; å­˜åœ¨æ—¶ï¼ŒCollection å¯¹è±¡ä¸§å¤±äº† add() æ–¹æ³•çš„åŠŸèƒ½ï¼Œç¼–è¯‘å™¨ä¸é€šè¿‡ã€‚<br>æˆ‘ä»¬å†çœ‹ä¸‹é¢çš„ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">List&lt;?&gt; wildlist = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">wildlist.add(<span class="number">123</span>);<span class="comment">// ç¼–è¯‘ä¸é€šè¿‡</span></span><br></pre></td></tr></table></figure><p>æœ‰äººè¯´ï¼Œ&lt;?&gt; æä¾›äº†åªè¯»çš„åŠŸèƒ½ï¼Œä¹Ÿå°±æ˜¯å®ƒåˆ å‡äº†å¢åŠ å…·ä½“ç±»å‹å…ƒç´ çš„èƒ½åŠ›ï¼Œåªä¿ç•™ä¸å…·ä½“ç±»å‹æ— å…³çš„åŠŸèƒ½ã€‚å®ƒä¸ç®¡è£…è½½åœ¨è¿™ä¸ªå®¹å™¨å†…çš„å…ƒç´ æ˜¯ä»€ä¹ˆç±»å‹ï¼Œå®ƒåªå…³å¿ƒå…ƒç´ çš„æ•°é‡ã€å®¹å™¨æ˜¯å¦ä¸ºç©ºï¼Ÿæˆ‘æƒ³è¿™ç§éœ€æ±‚è¿˜æ˜¯å¾ˆå¸¸è§çš„å§ã€‚</p><p>æœ‰åŒå­¦å¯èƒ½ä¼šæƒ³ï¼Œ&lt;?&gt; æ—¢ç„¶ä½œç”¨è¿™ä¹ˆæ¸ºå°ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆè¿˜è¦å¼•ç”¨å®ƒå‘¢ï¼Ÿ</p><p>ä¸ªäººè®¤ä¸ºï¼Œæé«˜äº†ä»£ç çš„å¯è¯»æ€§ï¼Œç¨‹åºå‘˜çœ‹åˆ°è¿™æ®µä»£ç æ—¶ï¼Œå°±èƒ½å¤Ÿè¿…é€Ÿå¯¹æ­¤å»ºç«‹æç®€æ´çš„å°è±¡ï¼Œèƒ½å¤Ÿå¿«é€Ÿæ¨æ–­æºç ä½œè€…çš„æ„å›¾ã€‚</p><h3 id="lt-extends-T-gt"><a href="#lt-extends-T-gt" class="headerlink" title="&lt;? extends T&gt;"></a>&lt;? extends T&gt;</h3><p>&lt;?&gt; ä»£è¡¨ç€ç±»å‹æœªçŸ¥ï¼Œä½†æ˜¯æˆ‘ä»¬çš„ç¡®éœ€è¦å¯¹äºç±»å‹çš„æè¿°å†ç²¾ç¡®ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨ä¸€ä¸ªèŒƒå›´å†…ç¡®å®šç±»åˆ«ï¼Œæ¯”å¦‚ç±»å‹ A åŠ ç±»å‹ A çš„å­ç±»éƒ½å¯ä»¥ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSub</span><span class="params">(Collection&lt;? extends Base&gt; para)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œpara è¿™ä¸ª Collection æ¥å— Base åŠ Base çš„å­ç±»çš„ç±»å‹ã€‚ä½†æ˜¯ï¼Œå®ƒä»ç„¶ä¸§å¤±äº†å†™æ“ä½œçš„èƒ½åŠ›ã€‚ä¹Ÿå°±æ˜¯è¯´:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">para.add(<span class="keyword">new</span> Sub());</span><br><span class="line">para.add(<span class="keyword">new</span> Base());</span><br></pre></td></tr></table></figure><p>ä»ç„¶ç¼–è¯‘ä¸é€šè¿‡ã€‚æ²¡æœ‰å…³ç³»ï¼Œæˆ‘ä»¬ä¸çŸ¥é“å…·ä½“ç±»å‹ï¼Œä½†æ˜¯æˆ‘ä»¬è‡³å°‘æ¸…æ¥šäº†ç±»å‹çš„èŒƒå›´ã€‚</p><h3 id="lt-super-T-gt"><a href="#lt-super-T-gt" class="headerlink" title="&lt;? super T&gt;"></a>&lt;? super T&gt;</h3><p>è¿™ä¸ªå’Œ &lt;? extends T&gt; ç›¸å¯¹åº”ï¼Œä»£è¡¨ T åŠ T çš„è¶…ç±»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSuper</span><span class="params">(Collection&lt;? <span class="keyword">super</span> Sub&gt; para)</span></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line">`</span><br></pre></td></tr></table></figure><p>&lt;? super T&gt; ç¥å¥‡çš„åœ°æ–¹åœ¨äºï¼Œå®ƒæ‹¥æœ‰ä¸€å®šç¨‹åº¦çš„å†™æ“ä½œçš„èƒ½åŠ›ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSuper</span><span class="params">(Collection&lt;? <span class="keyword">super</span> Sub&gt; para)</span></span>&#123;</span><br><span class="line">   para.add(<span class="keyword">new</span> Sub());<span class="comment">//ç¼–è¯‘é€šè¿‡</span></span><br><span class="line">   para.add(<span class="keyword">new</span> Base());<span class="comment">//ç¼–è¯‘ä¸é€šè¿‡</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é€šé…ç¬¦ä¸ç±»å‹å‚æ•°çš„åŒºåˆ«"><a href="#é€šé…ç¬¦ä¸ç±»å‹å‚æ•°çš„åŒºåˆ«" class="headerlink" title="é€šé…ç¬¦ä¸ç±»å‹å‚æ•°çš„åŒºåˆ«"></a>é€šé…ç¬¦ä¸ç±»å‹å‚æ•°çš„åŒºåˆ«</h3><p>ä¸€èˆ¬è€Œè¨€ï¼Œé€šé…ç¬¦èƒ½å¹²çš„äº‹æƒ…éƒ½å¯ä»¥ç”¨ç±»å‹å‚æ•°æ›¿æ¢ã€‚æ¯”å¦‚:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testWildCards</span><span class="params">(Collection&lt;?&gt; collection)</span></span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥è¢«</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> &lt;T&gt; <span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">(Collection&lt;T&gt; collection)</span></span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å–ä»£ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœç”¨æ³›å‹æ–¹æ³•æ¥å–ä»£é€šé…ç¬¦ï¼Œé‚£ä¹ˆä¸Šé¢ä»£ç ä¸­ collection æ˜¯èƒ½å¤Ÿè¿›è¡Œå†™æ“ä½œçš„ã€‚åªä¸è¿‡è¦è¿›è¡Œå¼ºåˆ¶è½¬æ¢ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> &lt;T&gt; <span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">(Collection&lt;T&gt; collection)</span></span>&#123;</span><br><span class="line">   collection.add((T)<span class="keyword">new</span> Integer(<span class="number">12</span>));</span><br><span class="line">   collection.add((T)<span class="string">"123"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œç±»å‹å‚æ•°é€‚ç”¨äºå‚æ•°ä¹‹é—´çš„ç±»åˆ«ä¾èµ–å…³ç³»ï¼Œä¸¾ä¾‹è¯´æ˜:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test2</span> &lt;<span class="title">T</span>,<span class="title">E</span> <span class="keyword">extends</span> <span class="title">T</span>&gt;</span>&#123;</span><br><span class="line">   T value1;</span><br><span class="line">   E value2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> &lt;D,S extends D&gt; <span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">(D d,S s)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>E ç±»å‹æ˜¯ T ç±»å‹çš„å­ç±»ï¼Œæ˜¾ç„¶è¿™ç§æƒ…å†µç±»å‹å‚æ•°æ›´é€‚åˆã€‚<br>æœ‰ä¸€ç§æƒ…å†µæ˜¯ï¼Œé€šé…ç¬¦å’Œç±»å‹å‚æ•°ä¸€èµ·ä½¿ç”¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> &lt;T&gt; <span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">(T t,Collection&lt;? extends T&gt; collection)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœä¸€ä¸ªæ–¹æ³•çš„è¿”å›ç±»å‹ä¾èµ–äºå‚æ•°çš„ç±»å‹ï¼Œé‚£ä¹ˆé€šé…ç¬¦ä¹Ÿæ— èƒ½ä¸ºåŠ›ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> T <span class="title">test1</span><span class="params">(T t)</span></span>&#123;</span><br><span class="line">   <span class="keyword">return</span> value1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç±»å‹æ“¦é™¤"><a href="#ç±»å‹æ“¦é™¤" class="headerlink" title="ç±»å‹æ“¦é™¤"></a>ç±»å‹æ“¦é™¤</h3><p>æ³›å‹æ˜¯ Java 1.5 ç‰ˆæœ¬æ‰å¼•è¿›çš„æ¦‚å¿µï¼Œåœ¨è¿™ä¹‹å‰æ˜¯æ²¡æœ‰æ³›å‹çš„æ¦‚å¿µçš„ï¼Œä½†æ˜¾ç„¶ï¼Œæ³›å‹ä»£ç èƒ½å¤Ÿå¾ˆå¥½åœ°å’Œä¹‹å‰ç‰ˆæœ¬çš„ä»£ç å¾ˆå¥½åœ°å…¼å®¹ã€‚</p><p>è¿™æ˜¯å› ä¸ºï¼Œæ³›å‹ä¿¡æ¯åªå­˜åœ¨äºä»£ç ç¼–è¯‘é˜¶æ®µï¼Œåœ¨è¿›å…¥ JVM ä¹‹å‰ï¼Œä¸æ³›å‹ç›¸å…³çš„ä¿¡æ¯ä¼šè¢«æ“¦é™¤æ‰ï¼Œä¸“ä¸šæœ¯è¯­å«åš<strong>ç±»å‹æ“¦é™¤</strong>ã€‚</p><p>é€šä¿—åœ°è®²ï¼Œæ³›å‹ç±»å’Œæ™®é€šç±»åœ¨ java è™šæ‹Ÿæœºå†…æ˜¯æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«çš„åœ°æ–¹ã€‚å›é¡¾æ–‡ç« å¼€å§‹æ—¶çš„é‚£æ®µä»£ç :</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; list1 = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">List&lt;Integer&gt; list2 = <span class="keyword">new</span> ArrayList&lt;Integer&gt;();</span><br><span class="line"></span><br><span class="line">System.out.println(list1.getClass() == list2.getClass());</span><br></pre></td></tr></table></figure><p>æ‰“å°çš„ç»“æœä¸º true æ˜¯å› ä¸º List<String> å’Œ List<Integer> åœ¨ jvm ä¸­çš„ Class éƒ½æ˜¯ List.classã€‚</p><p>æ³›å‹ä¿¡æ¯è¢«æ“¦é™¤äº†ã€‚</p><p>å¯èƒ½åŒå­¦ä¼šé—®ï¼Œé‚£ä¹ˆç±»å‹ String å’Œ Integer æ€ä¹ˆåŠï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯æ³›å‹è½¬è¯‘ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Erasure</span> &lt;<span class="title">T</span>&gt;</span>&#123;</span><br><span class="line">   T object;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="title">Erasure</span><span class="params">(T object)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">this</span>.object = object;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Erasure æ˜¯ä¸€ä¸ªæ³›å‹ç±»ï¼Œæˆ‘ä»¬æŸ¥çœ‹å®ƒåœ¨è¿è¡Œæ—¶çš„çŠ¶æ€ä¿¡æ¯å¯ä»¥é€šè¿‡åå°„ã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Erasure&lt;String&gt; erasure = <span class="keyword">new</span> Erasure&lt;String&gt;(<span class="string">"hello"</span>);</span><br><span class="line">Class eclz = erasure.getClass();</span><br><span class="line">System.out.println(<span class="string">"erasure class is:"</span>+eclz.getName());</span><br><span class="line"></span><br><span class="line">#æ‰“å°çš„ç»“æœæ˜¯</span><br><span class="line">erasure class is:com.frank.test.Erasure</span><br></pre></td></tr></table></figure><p>Class çš„ç±»å‹ä»ç„¶æ˜¯ Erasure å¹¶ä¸æ˜¯ Erasure<T> è¿™ç§å½¢å¼ï¼Œé‚£æˆ‘ä»¬å†çœ‹çœ‹æ³›å‹ç±»ä¸­ T çš„ç±»å‹åœ¨ jvm ä¸­æ˜¯ä»€ä¹ˆå…·ä½“ç±»å‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Field[] fs = eclz.getDeclaredFields();</span><br><span class="line"><span class="keyword">for</span> ( Field f:fs) &#123;</span><br><span class="line">   System.out.println(<span class="string">"Field name "</span>+f.getName()+<span class="string">" type:"</span>+f.getType().getName());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#æ‰“å°ç»“æœæ˜¯</span><br><span class="line">Field name object type:java.lang.Object</span><br></pre></td></tr></table></figure><p>é‚£æˆ‘ä»¬å¯ä¸å¯ä»¥è¯´ï¼Œæ³›å‹ç±»è¢«ç±»å‹æ“¦é™¤åï¼Œç›¸åº”çš„ç±»å‹å°±è¢«æ›¿æ¢æˆ Object ç±»å‹å‘¢ï¼Ÿ</p><p>è¿™ç§è¯´æ³•ï¼Œä¸å®Œå…¨æ­£ç¡®ã€‚ æˆ‘ä»¬æ›´æ”¹ä¸€ä¸‹ä»£ç ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Erasure</span> &lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">String</span>&gt;</span>&#123; </span><br><span class="line"></span><br><span class="line">   T object;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="title">Erasure</span><span class="params">(T object)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">this</span>.object = object;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#ç°åœ¨å†çœ‹æµ‹è¯•ç»“æœï¼š</span><br><span class="line">Field name object type:java.lang.String</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ç°åœ¨å¯ä»¥ä¸‹ç»“è®ºäº†ï¼Œåœ¨æ³›å‹ç±»è¢«ç±»å‹æ“¦é™¤çš„æ—¶å€™ï¼Œä¹‹å‰æ³›å‹ç±»ä¸­çš„ç±»å‹å‚æ•°éƒ¨åˆ†å¦‚æœæ²¡æœ‰æŒ‡å®šä¸Šé™ï¼Œå¦‚ <T> åˆ™ä¼šè¢«è½¬è¯‘æˆæ™®é€šçš„ Object ç±»å‹ï¼Œå¦‚æœæŒ‡å®šäº†ä¸Šé™å¦‚ <T extends String> åˆ™ç±»å‹å‚æ•°å°±è¢«æ›¿æ¢æˆç±»å‹ä¸Šé™ã€‚</p><p>æ‰€ä»¥ï¼Œåœ¨åå°„ä¸­:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Erasure</span> &lt;<span class="title">T</span>&gt;</span>&#123;</span><br><span class="line">   T object;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="title">Erasure</span><span class="params">(T object)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">this</span>.object = object;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(T object)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>add() è¿™ä¸ªæ–¹æ³•å¯¹åº”çš„ Method çš„ç­¾ååº”è¯¥æ˜¯ Object.classã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Erasure&lt;String&gt; erasure = <span class="keyword">new</span> Erasure&lt;String&gt;(<span class="string">"hello"</span>);</span><br><span class="line">Class eclz = erasure.getClass();</span><br><span class="line">System.out.println(<span class="string">"erasure class is:"</span>+eclz.getName());</span><br><span class="line"></span><br><span class="line">Method[] methods = eclz.getDeclaredMethods();</span><br><span class="line"><span class="keyword">for</span> ( Method m:methods )&#123;</span><br><span class="line">   System.out.println(<span class="string">" method:"</span>+m.toString());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#æ‰“å°ç»“æœæ˜¯</span><br><span class="line">method:<span class="keyword">public</span> <span class="keyword">void</span> com.frank.test.Erasure.add(java.lang.Object)</span><br></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä½ è¦åœ¨åå°„ä¸­æ‰¾åˆ° add å¯¹åº”çš„ Methodï¼Œä½ åº”è¯¥è°ƒç”¨ getDeclaredMethod(â€œaddâ€,Object.class) å¦åˆ™ç¨‹åºä¼šæŠ¥é”™ï¼Œæç¤ºæ²¡æœ‰è¿™ä¹ˆä¸€ä¸ªæ–¹æ³•ï¼ŒåŸå› å°±æ˜¯ç±»å‹æ“¦é™¤çš„æ—¶å€™ï¼ŒT è¢«æ›¿æ¢æˆ Object ç±»å‹äº†ã€‚</p><h3 id="æ³›å‹ä¸­å€¼å¾—æ³¨æ„çš„åœ°æ–¹"><a href="#æ³›å‹ä¸­å€¼å¾—æ³¨æ„çš„åœ°æ–¹" class="headerlink" title="æ³›å‹ä¸­å€¼å¾—æ³¨æ„çš„åœ°æ–¹"></a>æ³›å‹ä¸­å€¼å¾—æ³¨æ„çš„åœ°æ–¹</h3><h4 id="æ³›å‹ç±»æˆ–è€…æ³›å‹æ–¹æ³•ä¸­ï¼Œä¸æ¥å—-8-ç§åŸºæœ¬æ•°æ®ç±»å‹ã€‚"><a href="#æ³›å‹ç±»æˆ–è€…æ³›å‹æ–¹æ³•ä¸­ï¼Œä¸æ¥å—-8-ç§åŸºæœ¬æ•°æ®ç±»å‹ã€‚" class="headerlink" title="æ³›å‹ç±»æˆ–è€…æ³›å‹æ–¹æ³•ä¸­ï¼Œä¸æ¥å— 8 ç§åŸºæœ¬æ•°æ®ç±»å‹ã€‚"></a>æ³›å‹ç±»æˆ–è€…æ³›å‹æ–¹æ³•ä¸­ï¼Œä¸æ¥å— 8 ç§åŸºæœ¬æ•°æ®ç±»å‹ã€‚</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¿™ç§æ˜¯é”™è¯¯çš„ä½¿ç”¨æ–¹å¼</span></span><br><span class="line">List&lt;<span class="keyword">int</span>&gt; li = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">List&lt;<span class="keyword">boolean</span>&gt; li = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">// éœ€è¦ä½¿ç”¨å®ƒä»¬å¯¹åº”çš„åŒ…è£…ç±»</span></span><br><span class="line">List&lt;Integer&gt; li = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">List&lt;Boolean&gt; li1 = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">`</span><br></pre></td></tr></table></figure><h4 id="å¯¹æ³›å‹æ–¹æ³•çš„å›°æƒ‘"><a href="#å¯¹æ³›å‹æ–¹æ³•çš„å›°æƒ‘" class="headerlink" title="å¯¹æ³›å‹æ–¹æ³•çš„å›°æƒ‘"></a>å¯¹æ³›å‹æ–¹æ³•çš„å›°æƒ‘</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> &lt;T&gt; <span class="function">T <span class="title">test</span><span class="params">(T t)</span></span>&#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ‰çš„åŒå­¦å¯èƒ½å¯¹äºè¿ç»­çš„ä¸¤ä¸ª T æ„Ÿåˆ°å›°æƒ‘ï¼Œå…¶å® <T> æ˜¯ä¸ºäº†è¯´æ˜ç±»å‹å‚æ•°ï¼Œæ˜¯å£°æ˜,è€Œåé¢çš„ä¸å¸¦å°–æ‹¬å·çš„ T æ˜¯æ–¹æ³•çš„è¿”å›å€¼ç±»å‹ã€‚<br>ä½ å¯ä»¥ç›¸åƒä¸€ä¸‹ï¼Œå¦‚æœ test() è¿™æ ·è¢«è°ƒç”¨:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">test(<span class="string">"123"</span>);</span><br><span class="line"><span class="comment">// é‚£ä¹ˆå®é™…ä¸Šç›¸å½“äº</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">test</span><span class="params">(String t)</span></span>;</span><br></pre></td></tr></table></figure><h4 id="Java-ä¸èƒ½åˆ›å»ºå…·ä½“ç±»å‹çš„æ³›å‹æ•°ç»„"><a href="#Java-ä¸èƒ½åˆ›å»ºå…·ä½“ç±»å‹çš„æ³›å‹æ•°ç»„" class="headerlink" title="Java ä¸èƒ½åˆ›å»ºå…·ä½“ç±»å‹çš„æ³›å‹æ•°ç»„"></a>Java ä¸èƒ½åˆ›å»ºå…·ä½“ç±»å‹çš„æ³›å‹æ•°ç»„</h4><p>è¿™å¥è¯å¯èƒ½éš¾ä»¥ç†è§£ï¼Œç”¨ä»£ç æ¥è¯´æ˜ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Integer&gt;[] li2 = <span class="keyword">new</span> ArrayList&lt;Integer&gt;[];</span><br><span class="line">List&lt;Boolean&gt; li3 = <span class="keyword">new</span> ArrayList&lt;Boolean&gt;[];</span><br></pre></td></tr></table></figure><p>è¿™ä¸¤è¡Œä»£ç æ˜¯æ— æ³•åœ¨ç¼–è¯‘å™¨ä¸­ç¼–è¯‘é€šè¿‡çš„ã€‚åŸå› è¿˜æ˜¯ç±»å‹æ“¦é™¤å¸¦æ¥çš„å½±å“ã€‚</p><p>List<Integer> å’Œ List<Boolean> åœ¨ jvm ä¸­ç­‰åŒäºList<Object> ï¼Œæ‰€æœ‰çš„ç±»å‹ä¿¡æ¯éƒ½è¢«æ“¦é™¤ï¼Œç¨‹åºä¹Ÿæ— æ³•åˆ†è¾¨ä¸€ä¸ªæ•°ç»„ä¸­çš„å…ƒç´ ç±»å‹å…·ä½“æ˜¯ List<Integer>ç±»å‹è¿˜æ˜¯ List<Boolean> ç±»å‹ã€‚ä½†æ˜¯ï¼Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">List&lt;?&gt;[] li3 = <span class="keyword">new</span> ArrayList&lt;?&gt;[<span class="number">10</span>];</span><br><span class="line">li3[<span class="number">1</span>] = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">List&lt;?&gt; v = li3[<span class="number">1</span>];</span><br></pre></td></tr></table></figure><p>å€ŸåŠ©äºæ— é™å®šé€šé…ç¬¦å´å¯ä»¥ï¼Œå‰é¢è®²è¿‡ ï¼Ÿ ä»£è¡¨æœªçŸ¥ç±»å‹ï¼Œæ‰€ä»¥å®ƒæ¶‰åŠçš„æ“ä½œéƒ½åŸºæœ¬ä¸Šä¸ç±»å‹æ— å…³ï¼Œå› æ­¤ jvm ä¸éœ€è¦é’ˆå¯¹å®ƒå¯¹ç±»å‹ä½œåˆ¤æ–­ï¼Œå› æ­¤å®ƒèƒ½ç¼–è¯‘é€šè¿‡ï¼Œä½†æ˜¯ï¼Œåªæä¾›äº†æ•°ç»„ä¸­çš„å…ƒç´ å› ä¸ºé€šé…ç¬¦åŸå› ï¼Œå®ƒåªèƒ½è¯»ï¼Œä¸èƒ½å†™ã€‚æ¯”å¦‚ï¼Œä¸Šé¢çš„ v è¿™ä¸ªå±€éƒ¨å˜é‡ï¼Œå®ƒåªèƒ½è¿›è¡Œ get() æ“ä½œï¼Œä¸èƒ½è¿›è¡Œ add() æ“ä½œï¼Œè¿™ä¸ªåœ¨å‰é¢é€šé…ç¬¦çš„å†…å®¹å°èŠ‚ä¸­å·²ç»è®²è¿‡ã€‚</p><h3 id="æ³›å‹ï¼Œå¹¶ä¸ç¥å¥‡"><a href="#æ³›å‹ï¼Œå¹¶ä¸ç¥å¥‡" class="headerlink" title="æ³›å‹ï¼Œå¹¶ä¸ç¥å¥‡"></a>æ³›å‹ï¼Œå¹¶ä¸ç¥å¥‡</h3><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ³›å‹å…¶å®å¹¶æ²¡æœ‰ä»€ä¹ˆç¥å¥‡çš„åœ°æ–¹ï¼Œæ³›å‹ä»£ç èƒ½åšçš„éæ³›å‹ä»£ç ä¹Ÿèƒ½åšã€‚</p><p>è€Œç±»å‹æ“¦é™¤ï¼Œæ˜¯æ³›å‹èƒ½å¤Ÿä¸ä¹‹å‰çš„ java ç‰ˆæœ¬ä»£ç å…¼å®¹å…±å­˜çš„åŸå› ã€‚</p><p>å¯é‡ä¹Ÿæ­£å› ä¸ºç±»å‹æ“¦é™¤å¯¼è‡´äº†ä¸€äº›éšæ‚£ä¸å±€é™ã€‚</p><p>ä½†ï¼Œæˆ‘è¿˜æ˜¯è¦å»ºè®®å¤§å®¶ä½¿ç”¨æ³›å‹ï¼Œå¦‚å®˜æ–¹æ–‡æ¡£æ‰€è¯´çš„ï¼Œå¦‚æœå¯ä»¥ä½¿ç”¨æ³›å‹çš„åœ°æ–¹ï¼Œå°½é‡ä½¿ç”¨æ³›å‹ã€‚</p><p>æ¯•ç«Ÿå®ƒæŠ½ç¦»äº†æ•°æ®ç±»å‹ä¸ä»£ç é€»è¾‘ï¼Œæœ¬æ„æ˜¯æé«˜ç¨‹åºä»£ç çš„ç®€æ´æ€§å’Œå¯è¯»æ€§ï¼Œå¹¶æä¾›å¯èƒ½çš„ç¼–è¯‘æ—¶ç±»å‹è½¬æ¢å®‰å…¨æ£€æµ‹åŠŸèƒ½ã€‚</p><p>ç±»å‹æ“¦é™¤ä¸æ˜¯æ³›å‹çš„å…¨éƒ¨ï¼Œä½†æ˜¯å®ƒå´èƒ½å¾ˆå¥½åœ°æ£€æµ‹æˆ‘ä»¬å¯¹äºæ³›å‹è¿™ä¸ªæ¦‚å¿µçš„ç†è§£ç¨‹åº¦ã€‚<br><a href="blog.csdn.net/briblue/article/details/76736356">æ¥æºï¼šblog.csdn.net/briblue/article/details/76736356</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Centos 6.x å®‰è£…git</title>
      <link href="/post/7226e685.html"/>
      <url>/post/7226e685.html</url>
      
        <content type="html"><![CDATA[<p>åœ¨Centosä¸Šå®‰è£…è½¯ä»¶æ—¶ï¼Œæˆ‘éƒ½æ˜¯å…ˆæ›´æ–°ä¸€ä¸‹ç³»ç»Ÿçš„yumæºï¼Œä¿æŒyumæºæ˜¯æ¯”è¾ƒæ–°çš„ã€‚</p><a id="more"></a><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum update</span><br></pre></td></tr></table></figure><p>ä¸‹é¢è¿›å…¥ä»Šæ—¥çš„ä¸»é¢˜ï¼Œå®‰è£…gitï¼š</p><p> 1.ä¸‹è½½æºç åŒ…<br>æŸ¥çœ‹ç³»ç»Ÿyumæºä¸­çš„gitçš„ç‰ˆæœ¬ï¼Œå‘ç°æ˜¯æ¯”è¾ƒè€çš„ç‰ˆæœ¬ï¼Œäºæ˜¯é‡‡ç”¨æºç åŒ…ç¼–è¯‘å®‰è£…ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span>/src</span><br><span class="line">wget https://mirrors.edge.kernel.org/pub/software/scm/git/git-2.9.0.tar.gz</span><br></pre></td></tr></table></figure><p> 2.ç¼–è¯‘å®‰è£…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span>/src</span><br><span class="line">tar -zxvf git-2.9.0.tar.gz </span><br><span class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span>/src/git-2.9.0</span><br><span class="line"></span><br><span class="line"><span class="comment">#å®‰è£…åˆ° /usr/local/git</span></span><br><span class="line">./configure prefix=/usr/<span class="built_in">local</span>/git</span><br></pre></td></tr></table></figure><p>make &amp;&amp; make instal æŠ¥é”™</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@iZbp1fuxiq5o2qp7z60ydpZ git-2.9.0]<span class="comment"># make &amp;&amp; make install</span></span><br><span class="line">    CC credential-store.o</span><br><span class="line">In file included from credential-store.c:1:0:</span><br><span class="line">cache.h:40:18: fatal error: zlib.h: No such file or directory</span><br><span class="line"> <span class="comment">#include &lt;zlib.h&gt;</span></span><br></pre></td></tr></table></figure><p>è§£å†³æ–¹æ³•ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å®‰è£…ä¾èµ–</span></span><br><span class="line">yum -y install zlib zlib-devel</span><br></pre></td></tr></table></figure><p>å†æ¬¡æ‰§è¡Œmakeï¼Œä»ç„¶æŠ¥é”™</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/usr/bin/perl Makefile.PL PREFIX=<span class="string">'/usr/local/git'</span> INSTALL_BASE=<span class="string">''</span> --localedir=<span class="string">'/usr/local/git/share/locale'</span></span><br><span class="line">Can<span class="string">'t locate ExtUtils/MakeMaker.pm in @INC (@INC contains: /usr/local/lib64/perl5 /usr/local/share/perl5 /usr/lib64/perl5/vendor_perl /usr/share/perl5/vendor_perl /usr/lib64/perl5 /usr/share/perl5 .) at Makefile.PL line 3.</span></span><br><span class="line"><span class="string">BEGIN failed--compilation aborted at Makefile.PL line 3.</span></span><br><span class="line"><span class="string">make[1]: *** [perl.mak] Error 2</span></span><br><span class="line"><span class="string">make: *** [perl/perl.mak] Error 2</span></span><br></pre></td></tr></table></figure><p>è§£å†³åŠæ³•ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å®‰è£…ä¸‹é¢çš„ä¾èµ–</span></span><br><span class="line">yum install perl-ExtUtils-CBuilder perl-ExtUtils-MakeMaker cpan</span><br></pre></td></tr></table></figure><p>å†æ¬¡æ‰§è¡Œmake &amp; make installï¼Œç¼–è¯‘å®‰è£…æˆåŠŸ</p><p> 3.åˆ›å»ºgitç”¨æˆ·ï¼Œå¹¶å°†/usr/local/gitæ‰€å±ç»„å’Œæ‰€å±ä¸»ä¿®æ”¹æˆgit</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">useradd git</span><br><span class="line"></span><br><span class="line">chown -R git:git /usr/<span class="built_in">local</span>/git</span><br></pre></td></tr></table></figure><p> 4.å°†gitåŠ åˆ°ç³»ç»Ÿç¯å¢ƒå˜é‡é‡Œé¢</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> GIT_HOME=/usr/<span class="built_in">local</span>/git</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$GIT_HOME</span>/bin:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure><p> 5.åˆå§‹åŒ–ä»“åº“</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git init --bare mt-front.git</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¸‹é¢æ˜¯å‡ ç§å…‹éš†æ–¹å¼</span></span><br><span class="line">git <span class="built_in">clone</span> git@xx.xx.xx.xx:/home/git/repository/mt-front.git</span><br><span class="line">git <span class="built_in">clone</span> ssh://git@xx.xx.xx.xx:/home/git/repository/mt-front.git</span><br><span class="line">git <span class="built_in">clone</span> http://git@xx.xx.xx.xx:/home/git/repository/mt-front.git</span><br></pre></td></tr></table></figure><p>æœ¬åœ°cloneçš„æ—¶å€™ä¼šæŠ¥é”™</p><ul><li>æç¤ºgit-upload-packå‘½ä»¤ä¸å­˜åœ¨<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bash: git-upload-pack: <span class="built_in">command</span> not found</span><br><span class="line"><span class="comment">#è§£å†³</span></span><br><span class="line">ln -s /usr/<span class="built_in">local</span>/git/bin/git-upload-pack /usr/bin/git-upload-pack</span><br></pre></td></tr></table></figure></li><li>æç¤ºgit-receive-packå‘½ä»¤ä¸å­˜åœ¨<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bash: git-receive-pack: <span class="built_in">command</span> not found</span><br><span class="line">ln -s /usr/<span class="built_in">local</span>/git/bin/git-receive-pack /usr/bin/git-receive-pack</span><br></pre></td></tr></table></figure></li></ul><p> 7.é…ç½®gitè®°ä½å¯†ç ï¼Œåœ¨gitçš„å…¨å±€é…ç½®æ–‡ä»¶gitconfigæ–‡ä»¶ä¸­æ·»åŠ ä¸‹é¢çš„é…ç½®ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[credential]</span><br><span class="line">helper = store</span><br><span class="line">[user]</span><br><span class="line">name = nick</span><br><span class="line">email = nick@da.com</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mavenè·³è¿‡å•å…ƒæµ‹è¯•-Dmaven.test.skipå’ŒskipTestsçš„åŒºåˆ«</title>
      <link href="/post/64d34904.html"/>
      <url>/post/64d34904.html</url>
      
        <content type="html"><![CDATA[<p>Mavenä¸­æœ‰ä¸¤ç§æ–¹å¼è·³è¿‡å•å…ƒæµ‹è¯•ï¼Œå…¶å®è¿™ä¸¤ç§æ–¹å¼æ˜¯æœ‰ä¸€ç‚¹ä¸åŒçš„ï¼Œå…¶å…·ä½“ä¸åŒå¦‚ä¸‹ï¼š</p><p>-DskipTestsï¼Œä¸æ‰§è¡Œæµ‹è¯•ç”¨ä¾‹ï¼Œä½†ç¼–è¯‘æµ‹è¯•ç”¨ä¾‹ç±»ç”Ÿæˆç›¸åº”çš„classæ–‡ä»¶è‡³target/test-classesä¸‹ã€‚<br>-Dmaven.test.skip=trueï¼Œä¸æ‰§è¡Œæµ‹è¯•ç”¨ä¾‹ï¼Œä¹Ÿä¸ç¼–è¯‘æµ‹è¯•ç”¨ä¾‹ç±»ã€‚</p><a id="more"></a><ol><li>ä½¿ç”¨Dmaven.test.skipï¼Œä¸ä½†è·³è¿‡å•å…ƒæµ‹è¯•çš„è¿è¡Œï¼Œä¹Ÿè·³è¿‡æµ‹è¯•ä»£ç çš„ç¼–è¯‘ã€‚<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn package -Dmaven.test.skip=true</span><br></pre></td></tr></table></figure>ä¹Ÿå¯ä»¥åœ¨pom.xmlæ–‡ä»¶ä¸­ä¿®æ”¹<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugin<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">configuration</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">skip</span>&gt;</span>true<span class="tag">&lt;/<span class="name">skip</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-surefire-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">configuration</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">skip</span>&gt;</span>true<span class="tag">&lt;/<span class="name">skip</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li>ä½¿ç”¨ mvn package -DskipTests è·³è¿‡å•å…ƒæµ‹è¯•ï¼Œä½†æ˜¯ä¼šç»§ç»­ç¼–è¯‘ï¼›å¦‚æœæ²¡æ—¶é—´ä¿®æ”¹å•å…ƒæµ‹è¯•çš„bugï¼Œæˆ–è€…å•å…ƒæµ‹è¯•ç¼–è¯‘é”™è¯¯ã€‚ä½¿ç”¨ä¸Šé¢çš„ï¼Œä¸è¦ç”¨è¿™ä¸ªã€‚<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-surefire-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">configuration</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">skipTests</span>&gt;</span>true<span class="tag">&lt;/<span class="name">skipTests</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> maven </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaå­¦ä¹ ç³»åˆ—æ–‡ç« ç¬¬å…«ç¯‡ï¼šJava8ä¸­æ–¹æ³•å¼•ç”¨</title>
      <link href="/post/bcbb06a2.html"/>
      <url>/post/bcbb06a2.html</url>
      
        <content type="html"><![CDATA[<p>æ–¹æ³•å¼•ç”¨æä¾›äº†éå¸¸æœ‰ç”¨çš„è¯­æ³•ï¼Œå¯ä»¥ç›´æ¥å¼•ç”¨å·²æœ‰Javaç±»æˆ–å¯¹è±¡ï¼ˆå®ä¾‹ï¼‰çš„æ–¹æ³•æˆ–æ„é€ å™¨ã€‚ä¸lambdaè”åˆä½¿ç”¨ï¼Œæ–¹æ³•å¼•ç”¨å¯ä»¥ä½¿è¯­è¨€çš„æ„é€ æ›´ç´§å‡‘ç®€æ´ï¼Œå‡å°‘å†—ä½™ä»£ç ã€‚</p><a id="more"></a><p>ä¸‹é¢ï¼Œæˆ‘ä»¬ä»¥å®šä¹‰äº†4ä¸ªæ–¹æ³•çš„Carè¿™ä¸ªç±»ä½œä¸ºä¾‹å­ï¼ŒåŒºåˆ†Javaä¸­æ”¯æŒçš„4ç§ä¸åŒçš„æ–¹æ³•å¼•ç”¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Car</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Car <span class="title">create</span><span class="params">( <span class="keyword">final</span> Supplier&lt; Car &gt; supplier )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> supplier.get();</span><br><span class="line">    &#125;              </span><br><span class="line">         </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">collide</span><span class="params">( <span class="keyword">final</span> Car car )</span> </span>&#123;</span><br><span class="line">        System.out.println( <span class="string">"Collided "</span> + car.toString() );</span><br><span class="line">    &#125;</span><br><span class="line">         </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">follow</span><span class="params">( <span class="keyword">final</span> Car another )</span> </span>&#123;</span><br><span class="line">        System.out.println( <span class="string">"Following the "</span> + another.toString() );</span><br><span class="line">    &#125;</span><br><span class="line">         </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">repair</span><span class="params">()</span> </span>&#123;   </span><br><span class="line">        System.out.println( <span class="string">"Repaired "</span> + <span class="keyword">this</span>.toString() );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ç§æ–¹æ³•å¼•ç”¨æ˜¯æ„é€ å™¨å¼•ç”¨ï¼Œå®ƒçš„è¯­æ³•æ˜¯Class::newï¼Œæˆ–è€…æ›´ä¸€èˆ¬çš„Class&lt; T &gt;::newã€‚è¯·æ³¨æ„æ„é€ å™¨æ²¡æœ‰å‚æ•°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> Car car = Car.create( Car::<span class="keyword">new</span> );</span><br><span class="line"><span class="keyword">final</span> List&lt; Car &gt; cars = Arrays.asList( car );</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•å¼•ç”¨æ˜¯é™æ€æ–¹æ³•å¼•ç”¨ï¼Œå®ƒçš„è¯­æ³•æ˜¯Class::static_methodã€‚è¯·æ³¨æ„è¿™ä¸ªæ–¹æ³•æ¥å—ä¸€ä¸ªCarç±»å‹çš„å‚æ•°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cars.forEach( Car::collide );</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰ç§æ–¹æ³•å¼•ç”¨æ˜¯ç‰¹å®šç±»çš„ä»»æ„å¯¹è±¡çš„æ–¹æ³•å¼•ç”¨ï¼Œå®ƒçš„è¯­æ³•æ˜¯Class::methodã€‚è¯·æ³¨æ„ï¼Œè¿™ä¸ªæ–¹æ³•æ²¡æœ‰å‚æ•°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cars.forEach( Car::repair );</span><br></pre></td></tr></table></figure><p>æœ€åï¼Œç¬¬å››ç§æ–¹æ³•å¼•ç”¨æ˜¯ç‰¹å®šå¯¹è±¡çš„æ–¹æ³•å¼•ç”¨ï¼Œå®ƒçš„è¯­æ³•æ˜¯instance::methodã€‚è¯·æ³¨æ„ï¼Œè¿™ä¸ªæ–¹æ³•æ¥å—ä¸€ä¸ªCarç±»å‹çš„å‚æ•°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> Car police = Car.create( Car::<span class="keyword">new</span> );</span><br><span class="line">cars.forEach( police::follow );</span><br></pre></td></tr></table></figure><p>è¿è¡Œä¸Šé¢çš„Javaç¨‹åºåœ¨æ§åˆ¶å°ä¸Šä¼šæœ‰ä¸‹é¢çš„è¾“å‡ºï¼ˆCarçš„å®ä¾‹å¯èƒ½ä¸ä¸€æ ·ï¼‰ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Collided com.javacodegeeks.java8.method.references.MethodReferences$Car@<span class="number">7</span>a81197d</span><br><span class="line">Repaired com.javacodegeeks.java8.method.references.MethodReferences$Car@<span class="number">7</span>a81197d</span><br><span class="line">Following the com.javacodegeeks.java8.method.references.MethodReferences$Car@<span class="number">7</span>a81197d</span><br></pre></td></tr></table></figure><p>å…³äºæ–¹æ³•å¼•ç”¨çš„æ›´å¤šè¯¦æƒ…è¯·å‚è€ƒ<a href="https://docs.oracle.com/javase/tutorial/java/javaOO/methodreferences.html" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaå­¦ä¹ ç³»åˆ—æ–‡ç« ç¬¬ä¸ƒç¯‡ï¼šJava8ä¸­æ¥å£çš„é»˜è®¤æ–¹æ³•ä¸é™æ€æ–¹æ³•</title>
      <link href="/post/cca5e66b.html"/>
      <url>/post/cca5e66b.html</url>
      
        <content type="html"><![CDATA[<p>Java8ç”¨é»˜è®¤æ–¹æ³•ä¸é™æ€æ–¹æ³•è¿™ä¸¤ä¸ªæ–°æ¦‚å¿µæ¥æ‰©å±•æ¥å£çš„å£°æ˜ã€‚é»˜è®¤æ–¹æ³•ä½¿æ¥å£æœ‰ç‚¹åƒTraitsï¼ˆScalaä¸­ç‰¹å¾(trait)ç±»ä¼¼äºJavaä¸­çš„Interfaceï¼Œä½†å®ƒå¯ä»¥åŒ…å«å®ç°ä»£ç ï¼Œä¹Ÿå°±æ˜¯ç›®å‰Java8æ–°å¢çš„åŠŸèƒ½ã€‚PHPä¸­ä¹Ÿæœ‰traitè¿™æ ·ä¸€è¯´ï¼Œä»–æ˜¯åœ¨ä¸ç ´åç±»åŸæœ‰çš„ç»§æ‰¿ã€å®ç°å…³ç³»ï¼Œç»™ç±»æ–°åŠ ç›¸åŒçš„æ–¹æ³•ï¼‰ï¼Œä½†ä¸ä¼ ç»Ÿçš„æ¥å£åˆæœ‰äº›ä¸ä¸€æ ·ï¼Œå®ƒå…è®¸åœ¨å·²æœ‰çš„æ¥å£ä¸­æ·»åŠ æ–°æ–¹æ³•ï¼Œè€ŒåŒæ—¶åˆä¿æŒäº†ä¸æ—§ç‰ˆæœ¬ä»£ç çš„å…¼å®¹æ€§ã€‚</p><a id="more"></a><p>é»˜è®¤æ–¹æ³•ä¸æŠ½è±¡æ–¹æ³•ä¸åŒä¹‹å¤„åœ¨äºæŠ½è±¡æ–¹æ³•å¿…é¡»è¦æ±‚å®ç°ï¼Œä½†æ˜¯é»˜è®¤æ–¹æ³•åˆ™æ²¡æœ‰è¿™ä¸ªè¦æ±‚ã€‚ç›¸åï¼Œæ¯ä¸ªæ¥å£éƒ½å¿…é¡»æä¾›ä¸€ä¸ªæ‰€è°“çš„é»˜è®¤å®ç°ï¼Œè¿™æ ·æ‰€æœ‰çš„æ¥å£å®ç°è€…å°†ä¼šé»˜è®¤ç»§æ‰¿å®ƒï¼ˆå¦‚æœæœ‰å¿…è¦çš„è¯ï¼Œå¯ä»¥è¦†ç›–è¿™ä¸ªé»˜è®¤å®ç°ï¼‰ã€‚è®©æˆ‘ä»¬çœ‹çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">interface</span> <span class="title">Defaulable</span> </span>&#123;</span><br><span class="line">    <span class="comment">// Interfaces now allow default methods, the implementer may or </span></span><br><span class="line">    <span class="comment">// may not implement (override) them.</span></span><br><span class="line">    <span class="function"><span class="keyword">default</span> String <span class="title">notRequired</span><span class="params">()</span> </span>&#123; </span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Default implementation"</span>; </span><br><span class="line">    &#125;        </span><br><span class="line">&#125;</span><br><span class="line">         </span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">DefaultableImpl</span> <span class="keyword">implements</span> <span class="title">Defaulable</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line">     </span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">OverridableImpl</span> <span class="keyword">implements</span> <span class="title">Defaulable</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">notRequired</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Overridden implementation"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Defaulableæ¥å£ç”¨å…³é”®å­—defaultå£°æ˜äº†ä¸€ä¸ªé»˜è®¤æ–¹æ³•notRequired()ï¼ŒDefaulableæ¥å£çš„å®ç°è€…ä¹‹ä¸€DefaultableImplå®ç°äº†è¿™ä¸ªæ¥å£ï¼Œå¹¶ä¸”è®©é»˜è®¤æ–¹æ³•ä¿æŒåŸæ ·ã€‚Defaulableæ¥å£çš„å¦ä¸€ä¸ªå®ç°è€…OverridableImplç”¨è‡ªå·±çš„æ–¹æ³•è¦†ç›–äº†é»˜è®¤æ–¹æ³•ã€‚</p><p>Java8å¸¦æ¥çš„å¦ä¸€ä¸ªæœ‰è¶£çš„ç‰¹æ€§æ˜¯æ¥å£å¯ä»¥å£°æ˜ï¼ˆå¹¶ä¸”å¯ä»¥æä¾›å®ç°ï¼‰é™æ€æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">interface</span> <span class="title">DefaulableFactory</span> </span>&#123;</span><br><span class="line">    <span class="comment">// Interfaces now allow static methods</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> Defaulable <span class="title">create</span><span class="params">( Supplier&lt; Defaulable &gt; supplier )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> supplier.get();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢çš„ä¸€å°æ®µä»£ç ç‰‡æ®µæŠŠä¸Šé¢çš„é»˜è®¤æ–¹æ³•ä¸é™æ€æ–¹æ³•é»åˆåˆ°ä¸€èµ·ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">( String[] args )</span> </span>&#123;</span><br><span class="line">    Defaulable defaulable = DefaulableFactory.create( DefaultableImpl::<span class="keyword">new</span> );</span><br><span class="line">    System.out.println( defaulable.notRequired() );</span><br><span class="line">         </span><br><span class="line">    defaulable = DefaulableFactory.create( OverridableImpl::<span class="keyword">new</span> );</span><br><span class="line">    System.out.println( defaulable.notRequired() );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªç¨‹åºçš„æ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Default implementation</span><br><span class="line">Overridden implementation</span><br></pre></td></tr></table></figure><p>åœ¨JVMä¸­ï¼Œé»˜è®¤æ–¹æ³•çš„å®ç°æ˜¯éå¸¸é«˜æ•ˆçš„ï¼Œå¹¶ä¸”é€šè¿‡å­—èŠ‚ç æŒ‡ä»¤ä¸ºæ–¹æ³•è°ƒç”¨æä¾›äº†æ”¯æŒã€‚é»˜è®¤æ–¹æ³•å…è®¸ç»§ç»­ä½¿ç”¨ç°æœ‰çš„Javaæ¥å£ï¼Œè€ŒåŒæ—¶èƒ½å¤Ÿä¿éšœæ­£å¸¸çš„ç¼–è¯‘è¿‡ç¨‹ã€‚è¿™æ–¹é¢å¥½çš„ä¾‹å­æ˜¯å¤§é‡çš„æ–¹æ³•è¢«æ·»åŠ åˆ°java.util.Collectionæ¥å£ä¸­å»ï¼šstream()ï¼ŒparallelStream()ï¼ŒforEach()ï¼ŒremoveIf()ï¼Œâ€¦â€¦</p><p>å°½ç®¡é»˜è®¤æ–¹æ³•éå¸¸å¼ºå¤§ï¼Œä½†æ˜¯åœ¨ä½¿ç”¨é»˜è®¤æ–¹æ³•æ—¶æˆ‘ä»¬éœ€è¦å°å¿ƒæ³¨æ„ä¸€ä¸ªåœ°æ–¹ï¼šåœ¨å£°æ˜ä¸€ä¸ªé»˜è®¤æ–¹æ³•å‰ï¼Œè¯·ä»”ç»†æ€è€ƒæ˜¯ä¸æ˜¯çœŸçš„æœ‰å¿…è¦ä½¿ç”¨é»˜è®¤æ–¹æ³•ï¼Œå› ä¸ºé»˜è®¤æ–¹æ³•ä¼šå¸¦ç»™ç¨‹åºæ­§ä¹‰ï¼Œå¹¶ä¸”åœ¨å¤æ‚çš„ç»§æ‰¿ä½“ç³»ä¸­å®¹æ˜“äº§ç”Ÿç¼–è¯‘é”™è¯¯ã€‚æ›´å¤šè¯¦æƒ…è¯·å‚è€ƒ <a href="https://docs.oracle.com/javase/tutorial/java/IandI/defaultmethods.html" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> interface </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mavenä¸­çš„dependencyManagementå’Œdependencies</title>
      <link href="/post/c65e0153.html"/>
      <url>/post/c65e0153.html</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘å…¬å¸çš„æ•°æ®ä¸­å¿ƒé¡¹ç›®æ˜¯ä½¿ç”¨Mavenè¿›è¡Œç®¡ç†ï¼Œåœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­é‡åˆ°äº†dependencyManagementå’Œdependenciesï¼Œä¸çŸ¥é“å¤§å®¶å¯¹è¿™ä¸¤ä¸ªå…ƒç´ æœ‰ä»€ä¹ˆæƒ³æ³•ï¼Ÿ</p><p>Mavenä½¿ç”¨dependencyManagementå…ƒç´ æ¥æä¾›äº†ä¸€ç§ç®¡ç†ä¾èµ–ç‰ˆæœ¬å·çš„æ–¹å¼ã€‚é€šå¸¸ä¼šåœ¨ä¸€ä¸ªç»„ç»‡æˆ–è€…é¡¹ç›®çš„æœ€é¡¶å±‚çš„çˆ¶POM ä¸­çœ‹åˆ°dependencyManagement å…ƒç´ ã€‚ä½¿ç”¨pom.xmlä¸­çš„dependencyManagementå…ƒç´ èƒ½è®©æ‰€æœ‰åœ¨å­é¡¹ç›®ä¸­å¼•ç”¨ä¸€ä¸ªä¾èµ–è€Œä¸ç”¨æ˜¾å¼çš„åˆ—å‡ºç‰ˆæœ¬å·ã€‚Mavenä¼šæ²¿ç€çˆ¶å­å±‚æ¬¡å‘ä¸Šèµ°ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªæ‹¥æœ‰dependencyManagementå…ƒç´ çš„é¡¹ç›®ï¼Œç„¶åå®ƒå°±ä¼šä½¿ç”¨åœ¨è¿™ä¸ªdependencyManagement å…ƒç´ ä¸­æŒ‡å®šçš„ç‰ˆæœ¬å·ã€‚</p><a id="more"></a><h4 id="dependencyManagement"><a href="#dependencyManagement" class="headerlink" title="dependencyManagement"></a>dependencyManagement</h4><p>ä¾‹å¦‚ï¼Œåœ¨çˆ¶æ¨¡å—ä¸­çš„pomï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.dm<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mt-model<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.dm<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mt-tool<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        </span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencyManagement</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬åœ¨å­æ¨¡å—é‡Œå°±å¯ä»¥è¿™æ ·å¼•ç”¨mt-modelå’Œmt-tool:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.dm<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mt-model<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.dm<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mt-tool<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å‘ç°ä¸¤è€…æœ‰ä»€ä¹ˆåŒºåˆ«äº†ä¹ˆï¼Ÿå…¶å®å°±æ˜¯åœ¨å­æ¨¡å—ä¸­å¼•ç”¨pomæ²¡æœ‰æ·»åŠ ç‰ˆæœ¬å·ã€‚</p><p>è¿™æ ·åšçš„<strong>å¥½å¤„</strong>å°±æ˜¯ï¼šå¦‚æœæœ‰å¤šä¸ªå­é¡¹ç›®éƒ½å¼•ç”¨åŒä¸€æ ·ä¾èµ–ï¼Œåˆ™å¯ä»¥é¿å…åœ¨æ¯ä¸ªä½¿ç”¨çš„å­é¡¹ç›®é‡Œéƒ½å£°æ˜ä¸€ä¸ªç‰ˆæœ¬å·ï¼Œè¿™æ ·å½“æƒ³å‡çº§æˆ–åˆ‡æ¢åˆ°å¦ä¸€ä¸ªç‰ˆæœ¬æ—¶ï¼Œåªéœ€è¦åœ¨é¡¶å±‚çˆ¶å®¹å™¨é‡Œæ›´æ–°ï¼Œè€Œä¸éœ€è¦ä¸€ä¸ªä¸€ä¸ªå­é¡¹ç›®çš„ä¿®æ”¹ ï¼›å¦å¤–å¦‚æœæŸä¸ªå­é¡¹ç›®éœ€è¦å¦å¤–çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œåªéœ€è¦å£°æ˜versionå°±å¯ã€‚<br>dependencyManagementé‡Œåªæ˜¯å£°æ˜ä¾èµ–ï¼Œå¹¶ä¸å®ç°å¼•å…¥ï¼Œå› æ­¤å­é¡¹ç›®éœ€è¦æ˜¾å¼çš„å£°æ˜éœ€è¦ç”¨çš„ä¾èµ–ã€‚</p><h4 id="dependencies"><a href="#dependencies" class="headerlink" title="dependencies"></a>dependencies</h4><p>ç›¸å¯¹äºdependencyManagementï¼Œæ‰€æœ‰å£°æ˜åœ¨dependenciesé‡Œçš„ä¾èµ–éƒ½ä¼šè‡ªåŠ¨å¼•å…¥ï¼Œå¹¶é»˜è®¤è¢«æ‰€æœ‰çš„å­é¡¹ç›®ç»§æ‰¿ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> maven </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring Boot 1.x ä½¿ç”¨Valueæ³¨è§£ç»™é™æ€å˜é‡èµ‹å€¼</title>
      <link href="/post/54acd1d8.html"/>
      <url>/post/54acd1d8.html</url>
      
        <content type="html"><![CDATA[<p>æ˜¨å¤©åœ¨ä½¿ç”¨@Valueæ³¨è§£ç»™é™æ€å˜é‡èµ‹å€¼çš„æ—¶å€™ï¼Œå‘ç°é™æ€å˜é‡çš„å€¼å§‹ç»ˆæ˜¯nullã€‚åæ¥æœç´¢ä¸€ä¸‹å¾—çŸ¥å…¶ä¸­åŸå› ï¼ŒSpring Boot ä¸å…è®¸/ä¸æ”¯æŒæŠŠå€¼æ³¨å…¥åˆ°é™æ€å˜é‡ä¸­ã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥å˜é€šä¸€ä¸‹è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å› ä¸ºSpring Bootæ”¯æŒsetæ–¹æ³•æ³¨å…¥ï¼Œ<br>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨éé™æ€setæ–¹æ³•æ³¨å…¥é™æ€å˜é‡ã€‚</p><a id="more"></a><p>åºŸè¯ä¸å¤šè¯´ï¼Œè´´ä¸Šæˆ‘æ˜¨å¤©å†™çš„ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CoverImageUtil</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String endpoint;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String bucketName;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;oss.endpoint&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setEndpoint</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">        endpoint = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;oss.bucketName&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setBucketName</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">        bucketName = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getImage</span><span class="params">(String path)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isEmpty(path))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// XXXçš„å›¾ç‰‡åœ°å€ https://oss.XXX.com/uploads/8F/70/8F70879210F08AAA6F4A04A3D42F3704.jpg</span></span><br><span class="line">        <span class="keyword">if</span> (path.contains(<span class="string">"oss.XXX.com"</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> path;</span><br><span class="line">        &#125;</span><br><span class="line">        String[] str =  path.split(<span class="string">","</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// mtçš„å›¾ç‰‡åœ°å€</span></span><br><span class="line">        <span class="comment">// key = customer/coverImg/1002,FAFA5EFEAF3CBE3B23B2748D13E629A1,418530,image/jpeg</span></span><br><span class="line">        <span class="comment">// url = https://m-t-tesing.oss-cn-hangzhou.aliyuncs.com/customer/coverImg/1002</span></span><br><span class="line">        StringBuilder url = <span class="keyword">new</span> StringBuilder(<span class="string">"https://"</span>);</span><br><span class="line">        url.append(bucketName)</span><br><span class="line">                .append(<span class="string">"."</span>)</span><br><span class="line">                .append(endpoint)</span><br><span class="line">                .append(<span class="string">"/"</span>)</span><br><span class="line">                .append(str[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> url.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong></p><ol><li>ä»£ç ä¸­éœ€è¦@Componentæ³¨è§£</li><li>setæ–¹æ³•è¦æ˜¯éé™æ€çš„</li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> spring boot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mybatisæ–¹æ³•ä¼ å¤šä¸ªå‚æ•°ï¼ˆä¸‰ç§è§£å†³æ–¹æ¡ˆï¼‰</title>
      <link href="/post/98398c3d.html"/>
      <url>/post/98398c3d.html</url>
      
        <content type="html"><![CDATA[<p>Mybatisçš„Mapperæ¥å£çš„å‚æ•°ï¼Œä¸€èˆ¬æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä½†å¦‚æœä¸æ˜¯å¯¹è±¡ï¼Œå¹¶ä¸”æœ‰å¤šä¸ªå‚æ•°çš„æ—¶å€™æˆ‘ä»¬åº”è¯¥æ€æ ·åšå‘¢ï¼Ÿ</p><p>æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªæƒ³æ³•æ˜¯æŠŠå‚æ•°å°è£…æˆä¸€ä¸ªjava.util.Mapç±»å‹ï¼Œç„¶ååœ¨æ–¹æ³•çš„æ³¨é‡Šä¸Šé¢å†™ä¸Šmapçš„keyæ˜¯ä»€ä¹ˆï¼Œä½†æ˜¯ï¼Œè¿™æ ·çš„åšæ³•æ˜æ˜¾ä¸å¤Ÿç›´è§‚ï¼Œä¸èƒ½å¤Ÿæ¸…æ¥šçš„çœ‹å‡ºæ–¹æ³•çš„å‚æ•°æ˜¯ä»€ä¹ˆï¼Œè€Œä¸”å½±å“åˆ°äº†javaçš„å¤šæ€æ€§ï¼ˆæ–¹æ³•åç›¸åŒï¼Œå‚æ•°æ•°é‡æˆ–ç±»å‹ä¸åŒï¼‰ã€‚</p><a id="more"></a><p> 1.å¤šä¸ªå½¢å‚ä¼ é€’å¤šå‚æ•°<br>Daoå±‚çš„å‡½æ•°æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> User <span class="title">selectUser</span><span class="params">(String name,String area)</span></span>;</span><br></pre></td></tr></table></figure><p>å¯¹åº”çš„Mapper.xmlæ–‡ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectUser"</span> <span class="attr">resultMap</span>=<span class="string">"BaseResultMap"</span>&gt;</span></span><br><span class="line">    select *  from user_user  where user_name = #&#123;0&#125; and user_area=#&#123;1&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œ#{0}ä»£è¡¨æ¥æ”¶çš„æ˜¯daoå±‚ä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œ#{1}ä»£è¡¨daoå±‚ä¸­ç¬¬äºŒå‚æ•°ï¼Œæ›´å¤šå‚æ•°ä»¥æ­¤ç±»æ¨å³å¯ã€‚<br> 2.é‡‡ç”¨Mapä¼ é€’å¤šå‚æ•°<br>Daoå±‚çš„å‡½æ•°æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> User <span class="title">selectUser</span><span class="params">(Map paramMap)</span></span>;</span><br></pre></td></tr></table></figure><p>å¯¹åº”çš„Mapper.xmlæ–‡ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectUser"</span> <span class="attr">resultMap</span>=<span class="string">"BaseResultMap"</span>&gt;</span></span><br><span class="line">   select *  from user_user   where user_name = #&#123;userName,jdbcType=VARCHAR&#125; and user_area=#&#123;userArea,jdbcType=VARCHAR&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Serviceå±‚è°ƒç”¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> User <span class="title">SelectUser</span><span class="params">()</span></span>&#123;</span><br><span class="line">       Map paramMap = <span class="keyword">new</span> hashMap();</span><br><span class="line">       paramMap.put(â€œuserNameâ€,â€å¯¹åº”å…·ä½“çš„å‚æ•°å€¼â€);</span><br><span class="line">       paramMap.put(â€œuserAreaâ€,â€å¯¹åº”å…·ä½“çš„å‚æ•°å€¼â€);</span><br><span class="line">       User user = xxx.selectUser(paramMap);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>è¿™ç§æ–¹æ³•ä¸å¤Ÿç›´è§‚ï¼Œçœ‹åˆ°æ¥å£æ–¹æ³•ä¸èƒ½ç›´æ¥çš„çŸ¥é“éœ€è¦ä¼ é€’çš„å‚æ•°æœ‰å“ªäº›ï¼Ÿ<br> 3.ä½¿ç”¨@paramæ³¨è§£<br>Daoå±‚çš„å‡½æ•°æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> User <span class="title">selectUser</span><span class="params">(@Param(â€œuserNameâ€)</span>String name,@<span class="title">Param</span><span class="params">(â€œuserAreaâ€)</span>String area)</span>;</span><br></pre></td></tr></table></figure><p>å¯¹åº”çš„Mapper.xmlæ–‡ä»¶</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=<span class="string">"selectUser"</span> resultMap=<span class="string">"BaseResultMap"</span>&gt;</span><br><span class="line">   select *  from user_user   where user_name = #&#123;userNameï¼ŒjdbcType=VARCHAR&#125;and user_area=#&#123;userArea,jdbcType=VARCHAR&#125;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure><p>è¿™ç§æ–¹æ³•æœ€å¥½ï¼Œèƒ½è®©å¼€å‘è€…çœ‹åˆ°daoå±‚æ–¹æ³•å°±çŸ¥é“è¯¥ä¼ ä»€ä¹ˆæ ·çš„å‚æ•°ï¼Œåœ¨xmlä¸­ä¹Ÿç›¸æ¯”å…¶ä»–ä¸¤ç§æ–¹æ³•æ¸…æ¥šã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> mybatis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaå­¦ä¹ ç³»åˆ—æ–‡ç« ç¬¬å…­ç¯‡ï¼šé¡¹ç›®å¼€å‘åˆ©å™¨-Maven</title>
      <link href="/post/1c04f2f4.html"/>
      <url>/post/1c04f2f4.html</url>
      
        <content type="html"><![CDATA[<h3 id="ä»€ä¹ˆæ˜¯Maven"><a href="#ä»€ä¹ˆæ˜¯Maven" class="headerlink" title="ä»€ä¹ˆæ˜¯Maven"></a>ä»€ä¹ˆæ˜¯Maven</h3><p>Mavenæ˜¯ç°åœ¨çš„Javaç¨‹åºå‘˜åº”è¯¥éƒ½ä¼šé‡åˆ°æˆ–ä½¿ç”¨çš„ä¸€ä¸ªå·¥å…·ã€‚é‚£Mavenå…·ä½“æ˜¯ä»€ä¹ˆï¼Ÿåˆ°åº•èƒ½å¹²ä»€ä¹ˆï¼Ÿ</p><p>Mavenæ˜¯ä¸€ä¸ªé¡¹ç›®ç®¡ç†å·¥å…·ï¼Œç”¨æ¥ç®¡ç†é¡¹ç›®çš„ç”Ÿå‘½å‘¨æœŸï¼Œå¦‚é¡¹ç›®ä¸­å„ä¸ªé¡¹ç›®ä¹‹é—´çš„ä¾èµ–ç®¡ç†ï¼Œé¡¹ç›®ä¸­ä½¿ç”¨åˆ°çš„jaråŒ…ä¾èµ–ç®¡ç†ï¼Œè¿˜æœ‰è®¸å¤šé¡¹ç›®æ„å»ºçš„æ’ä»¶ç­‰ã€‚ä½¿ç”¨Mavenæœ€å¤§çš„å¥½å¤„å°±æ˜¯ä¸å†éœ€è¦æˆ‘ä»¬æ‰‹å·¥ç»´æŠ¤é¡¹ç›®ä¸­çš„å„ç§jaråŒ…ï¼ŒåŠjaråŒ…éœ€è¦ä¾èµ–çš„å…¶ä»–jaråŒ…ï¼Œä¹Ÿä¸å†éœ€è¦æˆ‘ä»¬è§£å†³å„ç§jaråŒ…ä¹‹é—´çš„å†²çªï¼Œè¿™ä¸€åˆ‡mavenå¸®æˆ‘ä»¬éƒ½åšå¥½äº†ã€‚</p><p>ç›®å‰Javaå¼€å‘ä¸­æµè¡Œçš„é›†æˆå¼€å‘å·¥å…·Ideaå·²ç»é›†æˆäº†Mavenå·¥å…·ï¼Œæ‰“å¼€Ideaçš„è®¾ç½®é€‰æ‹©Mavené¡¹ï¼Œå°±å¯ä»¥çœ‹åˆ°è‡ªå¸¦çš„Mavençš„ä¸€äº›ä¿¡æ¯ã€‚æˆ‘è§‰å¾—Ideaè‡ªå¸¦çš„Mavenå°±æŒºå¥½çš„ï¼Œå°±æ²¡æœ‰å»å†å®‰è£…ä¸€ä¸ªã€‚ä½†æ˜¯ä¹‹å‰ä¸çŸ¥é“Ideaè‡ªå¸¦Mavenå·¥å…·ï¼Œä¸ºæ­¤æœ‰æ¬¡å‡ºç°ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å› ä¸ºä¸¤ä¸ªMavenä»“åº“çš„åŸå› ã€‚åœ¨å…¬å¸çš„ç”µè„‘ä¸Šæˆ‘è‡ªå·±è£…äº†ä¸€ä¸ªMavenï¼Œè‡ªå·±çš„ç”µè„‘ä¸Šæ²¡æœ‰è£…ï¼Œç›´æ¥ä½¿ç”¨Ideaè‡ªå¸¦çš„Mavenã€‚</p><a id="more"></a><h3 id="Mavenä»“åº“"><a href="#Mavenä»“åº“" class="headerlink" title="Mavenä»“åº“"></a>Mavenä»“åº“</h3><p>ä½¿ç”¨ Maven ç»™æˆ‘ä»¬å¸¦æ¥çš„æœ€ç›´æ¥çš„å¸®åŠ©ï¼Œå°±æ˜¯ jar åŒ…å¾—åˆ°äº†ç»Ÿä¸€ç®¡ç†ï¼Œé‚£ä¹ˆè¿™äº› jar åŒ…å­˜æ”¾åœ¨å“ªé‡Œå‘¢ï¼Ÿå®ƒä»¬å°±åœ¨æ‚¨çš„ æœ¬åœ°ä»“åº“ ä¸­ï¼Œä½äº C:\Users\ç”¨æˆ·å.m2 ç›®å½•ä¸‹ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥ä¿®æ”¹è¿™ä¸ªé»˜è®¤åœ°å€ï¼‰ã€‚</p><p>å®é™…ä¸Šå¯å°†æœ¬åœ°ä»“åº“ç†è§£â€œç¼“å­˜â€ï¼Œå› ä¸ºé¡¹ç›®é¦–å…ˆä¼šä»æœ¬åœ°ä»“åº“ä¸­è·å– jar åŒ…ï¼Œå½“æ— æ³•è·å–æŒ‡å®š jar åŒ…çš„æ—¶å€™ï¼Œæœ¬åœ°ä»“åº“ä¼šä» è¿œç¨‹ä»“åº“ï¼ˆæˆ– ä¸­å¤®ä»“åº“ï¼‰ ä¸­ä¸‹è½½ jar åŒ…ï¼Œå¹¶æ”¾å…¥æœ¬åœ°ä»“åº“ä¸­ä»¥å¤‡å°†æ¥ä½¿ç”¨ã€‚è¿™ä¸ªè¿œç¨‹ä»“åº“æ˜¯ Maven å®˜æ–¹æä¾›çš„ï¼Œå¯é€šè¿‡ <a href="http://search.maven.org/" target="_blank" rel="noopener">http://search.maven.org/</a> æ¥è®¿é—®ã€‚è¿™æ ·ä¸€æ¥ï¼Œæœ¬åœ°ä»“åº“ä¼šéšç€é¡¹ç›®çš„ç§¯ç´¯è¶Šæ¥è¶Šå¤§ã€‚é€šè¿‡ä¸‹é¢è¿™å¼ å›¾å¯ä»¥æ¸…æ™°åœ°è¡¨è¾¾é¡¹ç›®ã€æœ¬åœ°ä»“åº“ã€è¿œç¨‹ä»“åº“ä¹‹é—´çš„å…³ç³»ã€‚</p><h3 id="Mavenå‘½ä»¤"><a href="#Mavenå‘½ä»¤" class="headerlink" title="Mavenå‘½ä»¤"></a>Mavenå‘½ä»¤</h3><p>Mavenæ‰§è¡Œå‘½ä»¤æœ‰ä¸¤ç§æ–¹å¼ï¼š</p><ol><li>Interactive Modeï¼ˆäº¤äº’æ¨¡å¼ï¼‰</li><li>Batch Modeï¼ˆæ‰¹å¤„ç†æ¨¡å¼ï¼‰</li></ol><h4 id="äº¤äº’æ¨¡å¼åˆ›å»ºé¡¹ç›®"><a href="#äº¤äº’æ¨¡å¼åˆ›å»ºé¡¹ç›®" class="headerlink" title="äº¤äº’æ¨¡å¼åˆ›å»ºé¡¹ç›®"></a>äº¤äº’æ¨¡å¼åˆ›å»ºé¡¹ç›®</h4><p>æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn archetype:generate</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥ä¼šå‡ºç°ä¸‹é¢çš„é€‰é¡¹ï¼š</p><ul><li>é¡¹ç›® Archetype Versionï¼ˆåŸå‹ç‰ˆæœ¬å·ï¼‰æ˜¯ä»€ä¹ˆï¼Ÿâ€”â€” å¯é€‰æ‹© 1.0 ç‰ˆæœ¬</li><li>é¡¹ç›® groupIdï¼ˆç»„ç»‡åï¼‰ æ˜¯ä»€ä¹ˆï¼Ÿâ€”â€” å¯è¾“å…¥ net.ydstudio</li><li>é¡¹ç›® artifactIdï¼ˆæ„ä»¶åï¼‰æ˜¯ä»€ä¹ˆï¼Ÿâ€”â€” å¯è¾“å…¥ maven-demo</li><li>é¡¹ç›® versionï¼ˆç‰ˆæœ¬å·ï¼‰æ˜¯ä»€ä¹ˆï¼Ÿâ€”â€” å¯è¾“å…¥ 1.0</li><li>é¡¹ç›® packageï¼ˆåŒ…åï¼‰æ˜¯ä»€ä¹ˆï¼Ÿâ€”â€” å¯è¾“å…¥ net.ydstudio.demo</li></ul><h4 id="ä½¿ç”¨æ‰¹å¤„ç†æ¨¡å¼åˆ›å»ºé¡¹ç›®"><a href="#ä½¿ç”¨æ‰¹å¤„ç†æ¨¡å¼åˆ›å»ºé¡¹ç›®" class="headerlink" title="ä½¿ç”¨æ‰¹å¤„ç†æ¨¡å¼åˆ›å»ºé¡¹ç›®"></a>ä½¿ç”¨æ‰¹å¤„ç†æ¨¡å¼åˆ›å»ºé¡¹ç›®</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn archetype:generate -DinteractiveMode=<span class="keyword">false</span> -DarchetypeArtifactId=maven-archetype-webapp -DgroupId=net.ydstudio -DartifactId=maven-demo -Dversion=<span class="number">1.0</span></span><br></pre></td></tr></table></figure><p>åˆ›å»ºé¡¹ç›®è¿™äº‹æˆ‘è§‰å¾—è¿˜æ˜¯ç”¨Ideaæ¥åšï¼Œæ–¹ä¾¿å¿«æ·ã€‚ç”¨å‘½ä»¤åˆ›å»ºçš„è¯ï¼Œå‘½ä»¤æœ‰æ—¶è®°å¾—ä¸å…¨ï¼Œä¸æ˜¯å¾ˆæ–¹ä¾¿ã€‚</p><p>åˆ›å»ºæˆåŠŸä¹‹åçš„é¡¹ç›®ä¸­ä¸€èˆ¬ä¼šæœ‰ä¸‹é¢çš„å‡ ä¸ªç›®å½•ï¼Œå¦‚æœæ²¡æœ‰çš„è¯å°±è‡ªè¡Œåˆ›å»ºã€‚</p><ol><li>src/main/javaï¼Œä¸»è¦ä»£ç å­˜æ”¾çš„åœ°æ–¹</li><li>src/test/javaï¼Œæµ‹è¯•ä»£ç å­˜æ”¾çš„åœ°æ–¹</li><li>src/main/resourcesï¼Œé…ç½®ã€èµ„æºæ–‡ä»¶å­˜æ”¾çš„åœ°æ–¹</li><li>src/main/webapp,Webåº”ç”¨ç›¸å…³ä»£ç å­˜æ”¾çš„åœ°æ–¹</li></ol><p>è¿˜æœ‰ä¸€ä¸ªé‡è¦çš„æ–‡ä»¶ï¼š pom.xmlï¼›pom.xmlç§°ä¸ºProject Object Modelï¼ˆé¡¹ç›®å¯¹è±¡æ¨¡å‹ï¼‰ï¼Œå®ƒç”¨äºæè¿°æ•´ä¸ªMavené¡¹ç›®ï¼Œæ‰€ä»¥ä¹Ÿç§°ä¸ºMavenæè¿°æ–‡ä»¶ã€‚pom.xml æ‰æ˜¯ç†è§£ Maven çš„å…³é”®ç‚¹ï¼Œå¾ˆæœ‰å¿…è¦çœ‹çœ‹å®ƒåˆ°åº•é•¿ä»€ä¹ˆæ ·ã€‚</p><h3 id="pomæ–‡ä»¶"><a href="#pomæ–‡ä»¶" class="headerlink" title="pomæ–‡ä»¶"></a>pomæ–‡ä»¶</h3><p>æ‰“å¼€ç”Ÿæˆçš„pomæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;project xmlns=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span><br><span class="line">        xmlns:xsi=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span><br><span class="line">        xsi:schemaLocation=<span class="string">"http://maven.apache.org/POM/4.0.0</span></span><br><span class="line"><span class="string">        http://maven.apache.org/maven-v4_0_0.xsd"</span>&gt;</span><br><span class="line"></span><br><span class="line">   &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;</span><br><span class="line">   &lt;groupId&gt;net.ydstudio&lt;/groupId&gt;</span><br><span class="line">   &lt;artifactId&gt;maven-demo&lt;/artifactId&gt;</span><br><span class="line">   &lt;version&gt;1.0&lt;/version&gt;</span><br><span class="line">   &lt;packaging&gt;war&lt;/packaging&gt;</span><br><span class="line"></span><br><span class="line">   &lt;name&gt;maven-demo Maven Webapp&lt;/name&gt;</span><br><span class="line">   &lt;url&gt;http:<span class="comment">//maven.apache.org&lt;/url&gt;</span></span><br><span class="line"></span><br><span class="line">   &lt;dependencies&gt;</span><br><span class="line">       &lt;dependency&gt;</span><br><span class="line">           &lt;groupId&gt;junit&lt;/groupId&gt;</span><br><span class="line">           &lt;artifactId&gt;junit&lt;/artifactId&gt;</span><br><span class="line">           &lt;version&gt;3.8.1&lt;/version&gt;</span><br><span class="line">           &lt;scope&gt;test&lt;/scope&gt;</span><br><span class="line">       &lt;/dependency&gt;</span><br><span class="line">   &lt;/dependencies&gt;</span><br><span class="line">   &lt;build&gt;</span><br><span class="line">       &lt;finalName&gt;maven-demo&lt;/finalName&gt;</span><br><span class="line">   &lt;/build&gt;</span><br><span class="line">&lt;/project&gt;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æ¥è§£é‡Šä¸€ä¸‹ï¼š</p><ul><li><p>modelVersion:è¿™ä¸ªæ˜¯pomçš„ç‰ˆæœ¬å·ï¼Œç°åœ¨éƒ½æ˜¯4.0.0çš„ï¼Œå¿…é¡»å¾—æœ‰ï¼Œä½†ä¸éœ€è¦ä¿®æ”¹ã€‚ </p></li><li><p>groupIdã€artifactIdã€versionï¼šåˆ†åˆ«è¡¨ç¤º Maven é¡¹ç›®çš„ç»„ç»‡åã€æ„ä»¶åã€ç‰ˆæœ¬å·ï¼Œå®ƒä»¬ä¸‰ä¸ªåˆèµ·æ¥å°±æ˜¯ Maven åæ ‡ï¼Œæ ¹æ®è¿™ä¸ªåæ ‡å¯ä»¥åœ¨ Maven ä»“åº“ä¸­å¯¹åº”å”¯ä¸€çš„ Maven æ„ä»¶ã€‚</p></li><li><p>packagingï¼šè¡¨ç¤ºè¯¥é¡¹ç›®çš„æ‰“åŒ…æ–¹å¼ï¼Œwar è¡¨ç¤ºæ‰“åŒ…ä¸º war æ–‡ä»¶ï¼Œé»˜è®¤ä¸º jarï¼Œè¡¨ç¤ºæ‰“åŒ…ä¸º jar æ–‡ä»¶ã€‚</p></li><li><p>nameã€urlï¼šè¡¨ç¤ºè¯¥é¡¹ç›®çš„åç§°ä¸ URL åœ°å€ï¼Œæ„ä¹‰ä¸å¤§ï¼Œå¯ä»¥çœç•¥ã€‚</p></li><li><p>dependenciesï¼šå®šä¹‰è¯¥é¡¹ç›®çš„ä¾èµ–å…³ç³»ï¼Œå…¶ä¸­æ¯ä¸€ä¸ª dependency å¯¹åº”ä¸€ä¸ª Maven é¡¹ç›®ï¼Œå¯è§ Maven åæ ‡å†æ¬¡å‡ºç°ï¼Œè¿˜å¤šäº†ä¸€ä¸ª scopeï¼Œè¡¨ç¤ºä½œç”¨åŸŸï¼ˆä¸‹é¢ä¼šæè¿°ï¼‰ã€‚</p></li><li><p>buildï¼šè¡¨ç¤ºä¸æ„å»ºç›¸å…³çš„é…ç½®ï¼Œè¿™é‡Œçš„ finalName è¡¨ç¤ºæœ€ç»ˆæ„å»ºåçš„åç§° maven-demo.warï¼Œè¿™é‡Œçš„ finalName è¿˜å¯ä»¥ä½¿ç”¨å¦ä¸€ç§æ–¹å¼æ¥å®šä¹‰ï¼ˆä¸‹é¢ä¼šæè¿°ï¼‰ã€‚</p></li></ul><p>æˆ‘ä»¬å¯ä»¥åœ¨ pom.xmlä¸­å®šä¹‰ä¸€äº›åˆ—çš„é¡¹ç›®ä¾èµ–ï¼ˆæ„ä»¶åŒ…ï¼‰ï¼Œæ¯ä¸ªæ„ä»¶åŒ…éƒ½ä¼šæœ‰ä¸€ä¸ª Scopeï¼ˆä½œç”¨åŸŸï¼‰ï¼Œå®ƒè¡¨ç¤ºè¯¥æ„ä»¶åŒ…åœ¨ä»€ä¹ˆæ—¶å€™èµ·ä½œç”¨ï¼ŒåŒ…æ‹¬ä»¥ä¸‹äº”ç§ï¼š</p><ol><li>compileï¼šé»˜è®¤ä½œç”¨åŸŸï¼Œåœ¨ç¼–è¯‘ã€æµ‹è¯•ã€è¿è¡Œæ—¶æœ‰æ•ˆ</li><li>testï¼šå¯¹äºæµ‹è¯•æ—¶æœ‰æ•ˆ</li><li>runtimeï¼šå¯¹äºæµ‹è¯•ã€è¿è¡Œæ—¶æœ‰æ•ˆ</li><li>providedï¼šå¯¹äºç¼–è¯‘ã€æµ‹è¯•æ—¶æœ‰æ•ˆï¼Œä½†åœ¨è¿è¡Œæ—¶æ— æ•ˆ</li><li>systemï¼šä¸ provided ç±»ä¼¼ï¼Œä½†ä¾èµ–äºç³»ç»Ÿèµ„</li></ol><h3 id="Mavenå¸¸è§å‘½ä»¤"><a href="#Mavenå¸¸è§å‘½ä»¤" class="headerlink" title="Mavenå¸¸è§å‘½ä»¤"></a>Mavenå¸¸è§å‘½ä»¤</h3><p>å‰é¢æˆ‘ä»¬å·²ç»ä½¿ç”¨äº†å‡ ä¸ª Maven å‘½ä»¤ï¼Œä¾‹å¦‚ï¼šmvn archetype:generateï¼Œmvn tomcat7:run-war ç­‰ã€‚å…¶å®ï¼Œå¯ä½¿ç”¨ä¸¤ç§ä¸åŒçš„æ–¹å¼æ¥æ‰§è¡Œ Maven å‘½ä»¤ï¼š</p><ol><li>mvn &lt;æ’ä»¶&gt;:&lt;ç›®æ ‡&gt; [å‚æ•°]</li><li>mvn &lt;é˜¶æ®µ&gt;<br>ç°åœ¨æˆ‘ä»¬æ¥è§¦åˆ°çš„éƒ½æ˜¯ç¬¬ä¸€ç§æ–¹å¼ï¼Œè€Œç¬¬äºŒç§æ–¹å¼æ‰æ˜¯æˆ‘ä»¬æ—¥å¸¸ä¸­ä½¿ç”¨æœ€é¢‘ç¹çš„ï¼Œä¾‹å¦‚ï¼š</li><li>mvn cleanï¼šæ¸…ç©ºè¾“å‡ºç›®å½•ï¼ˆå³ target ç›®å½•ï¼‰</li><li>mvn compileï¼šç¼–è¯‘æºä»£ç </li><li>mvn packageï¼šç”Ÿæˆæ„ä»¶åŒ…ï¼ˆä¸€èˆ¬ä¸º jar åŒ…æˆ– war åŒ…ï¼‰</li><li>mvn installï¼šå°†æ„ä»¶åŒ…å®‰è£…åˆ°æœ¬åœ°ä»“åº“</li><li>mvn deployï¼šå°†æ„ä»¶åŒ…éƒ¨ç½²åˆ°è¿œç¨‹ä»“åº“</li></ol><p>æ‰§è¡Œ Maven å‘½ä»¤éœ€è¦æ³¨æ„çš„æ˜¯ï¼šå¿…é¡»åœ¨Mavené¡¹ç›®çš„æ ¹ç›®å½•å¤„æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯å½“å‰ç›®å½•ä¸‹ä¸€å®šå­˜åœ¨ä¸€ä¸ªåä¸º pom.xml çš„æ–‡ä»¶ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> maven </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaå­¦ä¹ ç³»åˆ—æ–‡ç« ç¬¬äº”ç¯‡ï¼šè¯´è¯´Javaä¸­çš„å¼‚å¸¸</title>
      <link href="/post/4b7e7a69.html"/>
      <url>/post/4b7e7a69.html</url>
      
        <content type="html"><![CDATA[<p>åœ¨æ­£å¸¸çš„ç¨‹åºè®¾è®¡ä¸­ï¼Œç¨‹åºå¼‚å¸¸å¤„ç†æ˜¯éå¸¸å…³é”®å’Œé‡è¦çš„ä¸€éƒ¨åˆ†ã€‚è¯•æƒ³ä¸€ä¸ªé¡¹ç›®ä¸­æ²¡æœ‰ä¸€ä¸ªå¥½çš„å¼‚å¸¸å¤„ç†ï¼Œè¿™ä¸ªé¡¹ç›®ä¼šæ€ä¹ˆæ ·ï¼Ÿ</p><a id="more"></a><h3 id="ä»€ä¹ˆæ˜¯å¼‚å¸¸"><a href="#ä»€ä¹ˆæ˜¯å¼‚å¸¸" class="headerlink" title="ä»€ä¹ˆæ˜¯å¼‚å¸¸"></a>ä»€ä¹ˆæ˜¯å¼‚å¸¸</h3><p>å¼‚å¸¸å…¶å®æ˜¯ç¨‹åºä¸Šçš„é”™è¯¯ï¼ŒåŒ…æ‹¬ç¨‹åºé€»è¾‘é”™è¯¯å’Œç³»ç»Ÿé”™è¯¯ã€‚æ¯”å¦‚æ•°ç»„ä¸‹æ ‡è¶Šç•Œã€å†…å­˜æº¢å‡ºç­‰ï¼Œè¿™äº›éƒ½æ˜¯æ„å¤–çš„æƒ…å†µï¼Œé”™è¯¯åœ¨æˆ‘ä»¬çš„ç¨‹åºçš„ç¼–å†™è¿‡ç¨‹ä¸­ä¼šç»å¸¸å‘ç”Ÿï¼ŒåŒ…æ‹¬ç¼–è¯‘æœŸé—´å’Œè¿è¡ŒæœŸé—´çš„é”™è¯¯ã€‚åœ¨ç¼–è¯‘æœŸé—´å‡ºç°çš„é”™è¯¯ç¼–è¯‘å™¨ä¼šå¸®åŠ©æˆ‘ä»¬ä¿®æ­£ï¼Œå¯æ˜¯åœ¨è¿è¡ŒæœŸé—´çš„é”™è¯¯ç¼–è¯‘å™¨å°±æ— èƒ½ä¸ºåŠ›äº†ï¼Œå¹¶ä¸”è¿è¡ŒæœŸé—´çš„é”™è¯¯å¾€å¾€æ˜¯éš¾ä»¥é¢„æ–™çš„ã€‚</p><p>ç¨‹åºå‡ºç°äº†é”™è¯¯ï¼Œæˆ‘ä»¬ä¸èƒ½ä¸å»å¤„ç†ï¼Œè¿™æ ·çš„ç¨‹åºçš„å¥å£®æ€§å¤ªå·®äº†ã€‚ä¸ºäº†æé«˜ç¨‹åºçš„å¥å£®æ€§æˆ‘ä»¬è¦åˆç†çš„è§£å†³è¿™äº›é”™è¯¯ï¼äºæ˜¯Javaä¸­æä¾›äº†å¼‚å¸¸çš„å¤„ç†æœºåˆ¶ï¼Œé€šè¿‡å¼‚å¸¸æ¥å¤„ç†ç¨‹åºè¿è¡ŒæœŸé—´ä¸­å‡ºç°çš„é”™è¯¯ã€‚é€šè¿‡è¿™ä¸€ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå¥½çš„æé«˜ç¨‹åºçš„å¥å£®æ€§ã€‚</p><p>Javaæ˜¯ä¸€ä¸ªå…¨é¢çš„é¢å‘å¯¹è±¡è¯­è¨€ï¼Œä¸åƒPHPé‚£æ ·ï¼Œæ—¢æ”¯æŒè¿‡ç¨‹å¼ç¼–ç¨‹ï¼Œä¹Ÿæ”¯æŒé¢å‘å¯¹è±¡ç¼–ç¨‹ã€‚Javaä¸­å¼‚å¸¸çš„çˆ¶ç±»æ˜¯java.lang.Throwableç±»ã€‚åœ¨Javaä¸­å®šä¹‰å¾ˆå¤šçš„çš„å¼‚å¸¸ç±»ï¼Œæ¯”å¦‚OutOfMenoryErrorã€NullPointerExceptionã€IndexOutOfBoundsExceptionç­‰ã€‚</p><h3 id="Exception-ç±»çš„å±‚æ¬¡"><a href="#Exception-ç±»çš„å±‚æ¬¡" class="headerlink" title="Exception ç±»çš„å±‚æ¬¡"></a>Exception ç±»çš„å±‚æ¬¡</h3><p>æ‰€æœ‰çš„å¼‚å¸¸ç±»æ˜¯ä» java.lang.Exception ç±»ç»§æ‰¿çš„å­ç±»ã€‚</p><ul><li>Exception ç±»æ˜¯ Throwableç±»çš„å­ç±»ã€‚é™¤äº†Exceptionç±»å¤–ï¼ŒThrowableè¿˜æœ‰ä¸€ä¸ªå­ç±»Error ã€‚<br>Java ç¨‹åºé€šå¸¸ä¸æ•è·é”™è¯¯ã€‚é”™è¯¯ä¸€èˆ¬å‘ç”Ÿåœ¨ä¸¥é‡æ•…éšœæ—¶ï¼Œå®ƒä»¬åœ¨Javaç¨‹åºå¤„ç†çš„èŒƒç•´ä¹‹å¤–ã€‚</li><li>Error ç”¨æ¥æŒ‡ç¤ºè¿è¡Œæ—¶ç¯å¢ƒå‘ç”Ÿçš„é”™è¯¯ã€‚<br>ä¾‹å¦‚ï¼ŒJVM å†…å­˜æº¢å‡ºã€‚ä¸€èˆ¬åœ°ï¼Œç¨‹åºä¸ä¼šä»é”™è¯¯ä¸­æ¢å¤ã€‚<br>å¼‚å¸¸ç±»æœ‰ä¸¤ä¸ªä¸»è¦çš„å­ç±»ï¼šIOException ç±»å’Œ RuntimeException ç±»ã€‚</li></ul><p>Exceptionï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ç»å¸¸è§åˆ°çš„ä¸€äº›å¼‚å¸¸æƒ…å†µï¼Œä¾‹å¦‚NullPointerExceptionã€IndexOutOfBoundsExceptionç­‰ï¼Œè¿™äº›å¼‚å¸¸æ—¶æ˜¯æˆ‘ä»¬å¯ä»¥å¤„ç†çš„å¼‚å¸¸ã€‚</p><p>Exceptionç±»çš„å¼‚å¸¸åŒ…æ‹¬checked exceptionå’Œunchecked exceptionï¼ˆunchecked exceptionä¹Ÿç§°ä½œè¿è¡Œæ—¶å¼‚å¸¸RuntimeExceptionï¼ŒExceptionç±»çš„å¼‚å¸¸éƒ½æ˜¯åœ¨è¿è¡ŒæœŸé—´å‘ç”Ÿçš„ï¼‰ï¼Œå¯¹äºè¿è¡Œæ—¶å¼‚å¸¸ï¼ŒJavaç¼–è¯‘å™¨ä¸è¦æ±‚å¿…é¡»è¿›è¡Œå¼‚å¸¸å¤„ç†æ•è·å¤„ç†æˆ–è€…æŠ›å‡ºï¼Œè¿™ä¸ªç”±ç¨‹åºå‘˜è‡ªè¡Œå†³å®šã€‚</p><p>checked exceptionï¼ˆæ£€æŸ¥å¼‚å¸¸ï¼‰ï¼Œä¹Ÿç§°ä¸ºéè¿è¡Œæ—¶å¼‚å¸¸ï¼ˆè¿è¡Œæ—¶å¼‚å¸¸ä»¥å¤–çš„å¼‚å¸¸å°±æ˜¯éè¿è¡Œæ—¶å¼‚å¸¸ï¼‰ï¼ŒJavaç¼–è¯‘å™¨å¼ºåˆ¶ç¨‹åºå‘˜å¿…é¡»æ•è·å¤„ç†ï¼Œæ¯”å¦‚å¸¸è§çš„IOExceptionå’ŒSQLExceptionã€‚å¯¹äºéè¿è¡Œæ—¶å¼‚å¸¸å¦‚æœä¸è¿›è¡Œæ•è·æˆ–è€…æŠ›å‡ºå¤„ç†ï¼ŒJavaç¼–è¯‘å™¨éƒ½ä¸ä¼šé€šè¿‡ã€‚</p><p>åœ¨ç½‘ä¸Šæ‰¾äº†ä¸€ä¸ªå›¾ï¼Œèƒ½å¤Ÿå¾ˆæ¸…æ¥šçš„æè¿°åœ¨Javaä¸­ï¼Œ<strong>å¼‚å¸¸ç±»çš„ç»“æ„å±‚æ¬¡</strong>ï¼ˆæœ‰äº›æ—¶å€™è¯­è¨€å°±ç•¥æ˜¾è‹ç™½ï¼Œä¸å¦‚å›¾ç‰‡æˆ–è€…è§†é¢‘è¡¨ç°åŠ›ä¸°å¯Œï¼‰ã€‚</p><p><img src="http://mmbiz.qpic.cn/mmbiz_jpg/eQPyBffYbucQFWMv8Ix897PkJgliafiaVavLbzN8oE8tib6bWI5aONicssXV7RHUPaLib6BNiag50QfpLGNGTNGtM7nA/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1" alt="image"><br>åœ¨Javaä¸­ï¼Œæ‰€æœ‰çš„å¼‚å¸¸éƒ½æ˜¯ç»§æ‰¿è‡³java.lang.Throwableç±»ã€‚Errorç±»æ˜¯errorç±»å‹å¼‚å¸¸çš„çˆ¶ç±»ï¼ŒExceptionç±»æ˜¯exceptionç±»å‹å¼‚å¸¸çš„çˆ¶ç±»ï¼ŒRuntimeExceptionç±»æ˜¯æ‰€æœ‰è¿è¡Œæ—¶å¼‚å¸¸çš„çˆ¶ç±»ï¼ŒRuntimeExceptionä»¥å¤–çš„å¹¶ä¸”ç»§æ‰¿Exceptionçš„ç±»æ˜¯éè¿è¡Œæ—¶å¼‚å¸¸ã€‚</p><ul><li><p>å…¸å‹çš„RuntimeExceptionåŒ…æ‹¬NullPointerExceptionã€IndexOutOfBoundsExceptionã€IllegalArgumentExceptionç­‰ã€‚</p></li><li><p>å…¸å‹çš„éRuntimeExceptionåŒ…æ‹¬IOExceptionã€SQLExceptionç­‰ã€‚</p></li></ul><h3 id="Javaå¦‚ä½•å¤„ç†å¼‚å¸¸"><a href="#Javaå¦‚ä½•å¤„ç†å¼‚å¸¸" class="headerlink" title="Javaå¦‚ä½•å¤„ç†å¼‚å¸¸"></a>Javaå¦‚ä½•å¤„ç†å¼‚å¸¸</h3><p>åœ¨Javaä¸­å¦‚æœéœ€è¦å¤„ç†å¼‚å¸¸ï¼Œå¿…é¡»å…ˆå¯¹å¼‚å¸¸è¿›è¡Œæ•è·ï¼ˆè¿™ä¸€ç‚¹æ˜¯å’ŒPHPæ˜¯ç›¸åŒçš„ï¼‰ã€‚ä½¿ç”¨tryå’Œcatchå…³é”®å­—è¿›è¡Œå¤„ç†ã€‚å…·ä½“çš„è§„åˆ™å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">  <span class="comment">// ç¨‹åºä»£ç </span></span><br><span class="line">&#125;<span class="keyword">catch</span>(å¼‚å¸¸ç±»å‹<span class="number">1</span> å¼‚å¸¸çš„å˜é‡å<span class="number">1</span>)&#123;</span><br><span class="line">  <span class="comment">// ç¨‹åºä»£ç </span></span><br><span class="line">&#125;<span class="keyword">catch</span>(å¼‚å¸¸ç±»å‹<span class="number">2</span> å¼‚å¸¸çš„å˜é‡å<span class="number">2</span>)&#123;</span><br><span class="line">  <span class="comment">// ç¨‹åºä»£ç </span></span><br><span class="line">&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">  <span class="comment">// ç¨‹åºä»£ç </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥æ®µå®é™…çš„ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExcepTest</span></span>&#123;</span><br><span class="line"> </span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span></span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">     File file = <span class="keyword">new</span> File(<span class="string">"/Users/sam/a.txt"</span>);</span><br><span class="line">     <span class="keyword">if</span>(!file.exists())</span><br><span class="line">       file.createNewFile();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">       e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¢«tryå—åŒ…å›´çš„ä»£ç è¯´æ˜è¿™æ®µä»£ç å¯èƒ½ä¼šå‘ç”Ÿå¼‚å¸¸ï¼Œä¸€æ—¦å‘ç”Ÿå¼‚å¸¸ï¼Œå¼‚å¸¸ä¾¿ä¼šè¢«catchæ•è·åˆ°ï¼Œç„¶åéœ€è¦åœ¨catchå—ä¸­è¿›è¡Œå¼‚å¸¸å¤„ç†ã€‚è¿™æ˜¯ä¸€ç§å¤„ç†å¼‚å¸¸çš„æ–¹å¼ã€‚åœ¨Javaä¸­è¿˜æä¾›äº†å¦ä¸€ç§å¼‚å¸¸å¤„ç†æ–¹å¼å³æŠ›å‡ºå¼‚å¸¸ï¼Œé¡¾åæ€ä¹‰ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€æ—¦å‘ç”Ÿå¼‚å¸¸ï¼Œæˆ‘æŠŠè¿™ä¸ªå¼‚å¸¸æŠ›å‡ºå»ï¼Œè®©è°ƒç”¨è€…å»è¿›è¡Œå¤„ç†ï¼Œè‡ªå·±ä¸è¿›è¡Œå…·ä½“çš„å¤„ç†ï¼Œæ­¤æ—¶éœ€è¦ç”¨åˆ°throwå’Œthrowså…³é”®å­—ã€‚</p><p>æˆ‘ä»¬çœ‹ä¸‹é¢çš„ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line">           createFile();</span><br><span class="line">       &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">           <span class="comment">// <span class="doctag">TODO:</span> handle exception</span></span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line">    </span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">createFile</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">       File file = <span class="keyword">new</span> File(<span class="string">"/Users/sam/a.txt);</span></span><br><span class="line"><span class="string">       if(!file.exists())</span></span><br><span class="line"><span class="string">           file.createNewFile();</span></span><br><span class="line"><span class="string">   &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç å’Œä¸Šé¢ä¸€æ®µä»£ç çš„åŒºåˆ«æ˜¯ï¼Œåœ¨å®é™…çš„createFileæ–¹æ³•ä¸­å¹¶æ²¡æœ‰æ•è·å¼‚å¸¸ï¼Œè€Œæ˜¯ç”¨throwså…³é”®å­—å£°æ˜æŠ›å‡ºå¼‚å¸¸ï¼Œå³å‘ŠçŸ¥è°ƒç”¨è€…æ­¤æ–¹æ³•å¯èƒ½ä¼šæŠ›å‡ºIOExceptionï¼Œéœ€è¦è°ƒç”¨è€…è¿›è¡Œæ•è·å¤„ç†ã€‚é‚£ä¹ˆåœ¨mainæ–¹æ³•ä¸­è°ƒç”¨createFileæ–¹æ³•çš„æ—¶å€™ï¼Œé‡‡ç”¨tryâ€¦catchå—è¿›è¡Œäº†å¼‚å¸¸æ•è·å¤„ç†ã€‚</p><p>è¿˜å¯ä»¥ä½¿ç”¨throwå…³é”®å­—è¿›è¡ŒæŠ›å‡ºå¼‚å¸¸ã€‚çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> exception;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by Sam on 18/6/17.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        People people = <span class="keyword">new</span> People(<span class="string">"Sam"</span>,<span class="keyword">new</span> Byte(<span class="string">"25"</span>));</span><br><span class="line">        people.sayAge();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="class"><span class="keyword">class</span> <span class="title">People</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Byte age;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">People</span><span class="params">(String name, Byte age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Byte <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(Byte age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Byte <span class="title">sayAge</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (age &gt; Byte.MIN_VALUE)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> MyException(<span class="string">"å¹´é¾„å¤ªå¤§äº†"</span>,<span class="string">"100"</span> );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyException</span> <span class="keyword">extends</span> <span class="title">RuntimeException</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String code;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyException</span><span class="params">(String message, String code)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(message);</span><br><span class="line">        <span class="keyword">this</span>.code = code;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> code;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCode</span><span class="params">(String code)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.code = code;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢å°±æ˜¯åˆ©ç”¨throwå…³é”®å­—è¿›è¡Œæ‰‹åŠ¨æŠ›å‡ºå¼‚å¸¸ã€‚è°ƒç”¨è€…å¯ä»¥æ•è·å¤„ç†å¼‚å¸¸ï¼Œä¹Ÿå¯ä»¥ä¸ç”¨å¤„ç†å¼‚å¸¸ã€‚ä¸‹é¢æˆ‘ä»¬å°±ä¿®æ”¹ä¸€ä¸‹ä»£ç è¿›è¡Œæ•è·å¤„ç†ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        People people = <span class="keyword">new</span> People(<span class="string">"Sam"</span>,<span class="keyword">new</span> Byte(<span class="string">"25"</span>));</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            people.sayAge();</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            System.out.println(e);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">ç¨‹åºè¾“å‡ºï¼š</span><br><span class="line">exception.MyException: å¹´é¾„å¤ªå¤§äº†</span><br></pre></td></tr></table></figure><p>ä¹Ÿå°±è¯´åœ¨Javaä¸­è¿›è¡Œå¼‚å¸¸å¤„ç†çš„è¯ï¼Œå¯¹äºå¯èƒ½ä¼šå‘ç”Ÿå¼‚å¸¸çš„ä»£ç ï¼Œå¯ä»¥é€‰æ‹©ä¸‰ç§æ–¹æ³•æ¥è¿›è¡Œå¼‚å¸¸å¤„ç†ï¼š</p><p>1ã€å¯¹ä»£ç å—ç”¨try..catchè¿›è¡Œå¼‚å¸¸æ•è·å¤„ç†ï¼›</p><p>2ã€åœ¨è¯¥ä»£ç çš„æ–¹æ³•ä½“å¤–ç”¨throwsè¿›è¡ŒæŠ›å‡ºå£°æ˜ï¼Œå‘ŠçŸ¥æ­¤æ–¹æ³•çš„è°ƒç”¨è€…è¿™æ®µä»£ç å¯èƒ½ä¼šå‡ºç°è¿™äº›å¼‚å¸¸ï¼Œä½ éœ€è¦è°¨æ…å¤„ç†ã€‚æ­¤æ—¶æœ‰ä¸¤ç§æƒ…å†µï¼š</p><p>å¦‚æœå£°æ˜æŠ›å‡ºçš„å¼‚å¸¸æ˜¯éè¿è¡Œæ—¶å¼‚å¸¸ï¼Œæ­¤æ–¹æ³•çš„è°ƒç”¨è€…å¿…é¡»æ˜¾ç¤ºåœ°ç”¨try..catchå—è¿›è¡Œæ•è·æˆ–è€…ç»§ç»­å‘ä¸Šå±‚æŠ›å‡ºå¼‚å¸¸ã€‚</p><p>å¦‚æœå£°æ˜æŠ›å‡ºçš„å¼‚å¸¸æ˜¯è¿è¡Œæ—¶å¼‚å¸¸ï¼Œæ­¤æ–¹æ³•çš„è°ƒç”¨è€…å¯ä»¥é€‰æ‹©åœ°è¿›è¡Œå¼‚å¸¸æ•è·å¤„ç†ã€‚</p><p>3ã€åœ¨ä»£ç å—ç”¨throwæ‰‹åŠ¨æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸å¯¹è±¡ï¼Œæ­¤æ—¶ä¹Ÿæœ‰ä¸¤ç§æƒ…å†µï¼Œè·Ÿ2ï¼‰ä¸­çš„ç±»ä¼¼ï¼š</p><p>å¦‚æœæŠ›å‡ºçš„å¼‚å¸¸å¯¹è±¡æ˜¯éè¿è¡Œæ—¶å¼‚å¸¸ï¼Œæ­¤æ–¹æ³•çš„è°ƒç”¨è€…å¿…é¡»æ˜¾ç¤ºåœ°ç”¨try..catchå—è¿›è¡Œæ•è·æˆ–è€…ç»§ç»­å‘ä¸Šå±‚æŠ›å‡ºå¼‚å¸¸ã€‚</p><p>å¦‚æœæŠ›å‡ºçš„å¼‚å¸¸å¯¹è±¡æ˜¯è¿è¡Œæ—¶å¼‚å¸¸ï¼Œæ­¤æ–¹æ³•çš„è°ƒç”¨è€…å¯ä»¥é€‰æ‹©åœ°è¿›è¡Œå¼‚å¸¸æ•è·å¤„ç†ã€‚ï¼ˆå¦‚æœæœ€ç»ˆå°†å¼‚å¸¸æŠ›ç»™mainæ–¹æ³•ï¼Œåˆ™ç›¸å½“äºäº¤ç»™jvmè‡ªåŠ¨å¤„ç†ï¼Œæ­¤æ—¶jvmä¼šç®€å•åœ°æ‰“å°å¼‚å¸¸ä¿¡æ¯ï¼‰</p><p>å…³äºJavaçš„å¼‚å¸¸æœºåˆ¶å°±æš‚æ—¶è¯´åˆ°è¿™é‡Œã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> exception </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaå­¦ä¹ ç³»åˆ—æ–‡ç« ç¬¬å››ç¯‡ï¼šè¯´è¯´Javaçš„ä¸‰å¤§ç‰¹æ€§</title>
      <link href="/post/2b809338.html"/>
      <url>/post/2b809338.html</url>
      
        <content type="html"><![CDATA[<p>Javaè¯­è¨€æä¾›ç±»ã€æ¥å£å’Œç»§æ‰¿ç­‰é¢å‘å¯¹è±¡çš„ç‰¹æ€§ï¼Œä¸ºäº†ç®€å•èµ·è§ï¼Œåªæ”¯æŒç±»ä¹‹é—´çš„å•ç»§æ‰¿ï¼Œä½†æ”¯æŒæ¥å£ä¹‹é—´çš„å¤šç»§æ‰¿ï¼Œå¹¶æ”¯æŒç±»ä¸æ¥å£ä¹‹é—´çš„å®ç°æœºåˆ¶ï¼ˆå…³é”®å­—ä¸ºimplementsï¼‰ã€‚Javaè¯­è¨€å…¨é¢æ”¯æŒåŠ¨æ€ç»‘å®šï¼Œè€ŒC++è¯­è¨€åªå¯¹è™šå‡½æ•°ä½¿ç”¨åŠ¨æ€ç»‘å®šã€‚æ€»ä¹‹ï¼ŒJavaè¯­è¨€æ˜¯ä¸€ä¸ªçº¯çš„é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡è¯­è¨€ã€‚</p><a id="more"></a><p>è¯´åˆ°é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œé‚£å°±ä¸å¾—ä¸æé¢å‘å¯¹è±¡ç¼–ç¨‹çš„ä¸‰å¤§ç‰¹æ€§ï¼šç»§æ‰¿ã€å°è£…å’Œå¤šæ€ã€‚é‚£ä¸‹é¢æˆ‘ä»¬å…ˆæ¥è¯´ä¸€è¯´å°è£…ã€‚</p><p>å°è£…éšè—äº†ç±»çš„å†…éƒ¨å®ç°æœºåˆ¶ï¼Œå¯ä»¥åœ¨ä¸æƒ³å½±å“ä½¿ç”¨çš„æƒ…å†µä¸‹æ”¹å˜ç±»çš„å†…éƒ¨ç»“æ„ï¼ŒåŒæ—¶ä¹Ÿä¿æŠ¤äº†æ•°æ®ã€‚å¯¹å¤–ç•Œä¹Ÿå¯ä»¥éšè—å†…éƒ¨çš„ç»†èŠ‚ï¼Œåªæš´éœ²ç»™å¤–ç•Œè®¿é—®çš„æ–¹æ³•ã€‚</p><p>ç»§æ‰¿å¯ä»¥å¤ç”¨çˆ¶ç±»çš„ä»£ç ã€‚ä¸¤ä¸ªç±»ä¹‹é—´è‹¥å­˜åœ¨is-açš„å…³ç³»ï¼Œå°±å¯ä»¥ä½¿ç”¨ç»§æ‰¿ï¼Œä»è€Œè¾¾åˆ°ä»£ç çš„å¤ç”¨ï¼ŒåŒæ—¶ä¹Ÿç»™å¤šæ€çš„å®ç°åšäº†é“ºå«ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬åªè¦è¯´è¯´é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­çš„å¤šæ€ã€‚æ‰€è°“çš„å¤šæ€å°±æ˜¯æŒ‡ç¨‹åºä¸­å®šä¹‰çš„å¼•ç”¨å˜é‡æ‰€æŒ‡å‘çš„å…·ä½“ç±»å‹å’Œé€šè¿‡è¯¥å¼•ç”¨å˜é‡å‘å‡ºçš„æ–¹æ³•è°ƒç”¨åœ¨ç¼–ç¨‹æ—¶å¹¶ä¸ç¡®å®šï¼Œè€Œæ˜¯åœ¨ç¨‹åºçš„è¿è¡ŒæœŸé—´æ‰ç¡®å®šï¼Œå³ä¸€ä¸ªå¼•ç”¨å˜é‡åˆ°åº•ä¼šæŒ‡å‘å“ªä¸ªç±»çš„å®ä¾‹å¯¹è±¡ï¼Œè¯¥å¼•ç”¨å˜é‡å‘å‡ºçš„æ–¹æ³•è°ƒç”¨åˆ°åº•æ˜¯å“ªä¸ªç±»ä¸­å®ç°çš„æ–¹æ³•ï¼Œå¿…é¡»åœ¨ç¨‹åºè¿è¡ŒæœŸé—´æ‰èƒ½ç¡®å®šï¼Œè¿™å°±æ˜¯æ‰€è°“çš„åŠ¨æ€ç»‘å®šï¼ˆdynamic bindingï¼‰ã€‚</p><p>æ—¢ç„¶å¤šæ€é‚£ä¹ˆé‡è¦ï¼Œé‚£ä¹ˆå¤šæ€åˆ°åº•æœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿ</p><ol><li>å¯æ›¿æ¢æ€§</li><li>æ¶ˆé™¤ç±»å‹ä¹‹é—´çš„è€¦åˆå…³ç³»</li><li>å¯æ‰©å……æ€§</li><li>æ¥å£æ€§</li><li>çµæ´»æ€§</li><li>ç®€åŒ–æ€§</li></ol><p><strong>Javaå®ç°å¤šæ€æœ‰ä¸‰ä¸ªå¿…è¦çš„æ¡ä»¶ï¼šç»§æ‰¿ã€é‡å†™ã€å‘ä¸Šè½¬å‹</strong></p><ol><li>ç»§æ‰¿ï¼šåœ¨å¤šæ€ä¸­å¿…é¡»å­˜åœ¨æœ‰ç»§æ‰¿å…³ç³»çš„å­ç±»å’Œçˆ¶ç±»ã€‚</li><li>é‡å†™ï¼šå­ç±»å¯¹çˆ¶ç±»ä¸­æŸäº›æ–¹æ³•è¿›è¡Œé‡å†™å®šä¹‰ï¼Œåœ¨è°ƒç”¨è¿™äº›æ–¹æ³•æ—¶å°±ä¼šè°ƒç”¨å­ç±»çš„æ–¹æ³•ã€‚</li><li>å‘ä¸Šè½¬å‹ï¼šåœ¨å¤šæ€ä¸­éœ€è¦å°†çˆ¶ç±»çš„å¼•ç”¨æŒ‡å‘å­ç±»ï¼Œåªæœ‰è¿™æ ·è¯¥å¼•ç”¨æ‰èƒ½å¤Ÿå…·å¤‡è°ƒç”¨çˆ¶ç±»å’Œå­ç±»çš„æ–¹æ³•ã€‚</li></ol><p>å¤šæ€çš„å®ç°æ–¹å¼</p><h4 id="1-ç»§æ‰¿é‡å†™"><a href="#1-ç»§æ‰¿é‡å†™" class="headerlink" title="1. ç»§æ‰¿é‡å†™"></a>1. ç»§æ‰¿é‡å†™</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">eat</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">work</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Cat</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">eat</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"åƒé±¼"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">work</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"æŠ“è€é¼ "</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Dog</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">eat</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"åƒéª¨å¤´"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">work</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"çœ‹å®¶"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        Animal a = <span class="keyword">new</span> Cat();  <span class="comment">// å‘ä¸Šè½¬å‹</span></span><br><span class="line">        a.eat();               <span class="comment">// è°ƒç”¨çš„æ˜¯ Cat çš„ eat</span></span><br><span class="line"></span><br><span class="line">        Animal b = <span class="keyword">new</span> Dog();  <span class="comment">// å‘ä¸Šè½¬å‹</span></span><br><span class="line">        b.eat();               <span class="comment">// è°ƒç”¨çš„æ˜¯ Dog çš„ eat</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥åŸºäºç»§æ‰¿å®ç°çš„å¤šæ€å¯ä»¥æ€»ç»“å¦‚ä¸‹ï¼šå¯¹äºå¼•ç”¨å­ç±»çš„çˆ¶ç±»ç±»å‹ï¼Œåœ¨å¤„ç†è¯¥å¼•ç”¨æ—¶ï¼Œå®ƒé€‚ç”¨äºç»§æ‰¿è¯¥çˆ¶ç±»çš„æ‰€æœ‰å­ç±»ï¼Œå­ç±»å¯¹è±¡çš„ä¸åŒï¼Œå¯¹æ–¹æ³•çš„å®ç°ä¹Ÿå°±ä¸åŒï¼Œæ‰§è¡Œç›¸åŒåŠ¨ä½œäº§ç”Ÿçš„è¡Œä¸ºä¹Ÿå°±ä¸åŒã€‚<br>å¦‚æœçˆ¶ç±»æ˜¯æŠ½è±¡ç±»ï¼Œé‚£ä¹ˆå­ç±»å¿…é¡»è¦å®ç°çˆ¶ç±»ä¸­æ‰€æœ‰çš„æŠ½è±¡æ–¹æ³•ï¼Œè¿™æ ·è¯¥çˆ¶ç±»æ‰€æœ‰çš„å­ç±»ä¸€å®šå­˜åœ¨ç»Ÿä¸€çš„å¯¹å¤–æ¥å£ï¼Œä½†å…¶å†…éƒ¨çš„å…·ä½“å®ç°å¯ä»¥å„å¼‚ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨é¡¶å±‚ç±»æä¾›çš„ç»Ÿä¸€æ¥å£æ¥å¤„ç†è¯¥å±‚æ¬¡çš„æ–¹æ³•ã€‚</p><h4 id="2-åŸºäºæ¥å£å®ç°å¤šæ€"><a href="#2-åŸºäºæ¥å£å®ç°å¤šæ€" class="headerlink" title="2.åŸºäºæ¥å£å®ç°å¤šæ€"></a>2.åŸºäºæ¥å£å®ç°å¤šæ€</h4><p>ç»§æ‰¿æ˜¯é€šè¿‡é‡å†™çˆ¶ç±»çš„åŒä¸€æ–¹æ³•çš„å‡ ä¸ªä¸åŒå­ç±»æ¥ä½“ç°çš„ï¼Œé‚£ä¹ˆå°±å¯å°±æ˜¯é€šè¿‡å®ç°æ¥å£å¹¶è¦†ç›–æ¥å£ä¸­åŒä¸€æ–¹æ³•çš„å‡ ä¸åŒçš„ç±»ä½“ç°çš„ã€‚</p><p>åœ¨æ¥å£çš„å¤šæ€ä¸­ï¼ŒæŒ‡å‘æ¥å£çš„å¼•ç”¨å¿…é¡»æ˜¯æŒ‡å®šè¿™å®ç°äº†è¯¥æ¥å£çš„ä¸€ä¸ªç±»çš„å®ä¾‹ç¨‹åºï¼Œåœ¨è¿è¡Œæ—¶ï¼Œæ ¹æ®å¯¹è±¡å¼•ç”¨çš„å®é™…ç±»å‹æ¥æ‰§è¡Œå¯¹åº”çš„æ–¹æ³•ã€‚</p><p>ç»§æ‰¿éƒ½æ˜¯å•ç»§æ‰¿ï¼Œåªèƒ½ä¸ºä¸€ç»„ç›¸å…³çš„ç±»æä¾›ä¸€è‡´çš„æœåŠ¡æ¥å£ã€‚ä½†æ˜¯æ¥å£å¯ä»¥æ˜¯å¤šç»§æ‰¿å¤šå®ç°ï¼Œå®ƒèƒ½å¤Ÿåˆ©ç”¨ä¸€ç»„ç›¸å…³æˆ–è€…ä¸ç›¸å…³çš„æ¥å£è¿›è¡Œç»„åˆä¸æ‰©å……ï¼Œèƒ½å¤Ÿå¯¹å¤–æä¾›ä¸€è‡´çš„æœåŠ¡æ¥å£ã€‚æ‰€ä»¥å®ƒç›¸å¯¹äºç»§æ‰¿æ¥è¯´æœ‰æ›´å¥½çš„çµæ´»æ€§ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> oop </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaå­¦ä¹ ç³»åˆ—æ–‡ç« ç¬¬ä¸‰ç¯‡ï¼šè¯´è¯´equalså’Œ==</title>
      <link href="/post/28107323.html"/>
      <url>/post/28107323.html</url>
      
        <content type="html"><![CDATA[<p>åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­æˆ‘ä»¬å†™è¿‡è¿™æ ·çš„ä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç›´æ¥èµ‹å€¼</span></span><br><span class="line">String str1 = <span class="string">"hello world"</span>;</span><br><span class="line"><span class="comment">// æ„é€ æ–¹æ³•</span></span><br><span class="line">String str2 = <span class="keyword">new</span> String(<span class="string">"hello world"</span>);</span><br><span class="line"></span><br><span class="line">String str3 = <span class="string">"hello world"</span>;</span><br><span class="line"></span><br><span class="line">String str4 = <span class="keyword">new</span> String(<span class="string">"hello world"</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(str1==str2);</span><br><span class="line">System.out.println(str1==str3);</span><br><span class="line">System.out.println(str2==str4);</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ç°åœ¨éƒ½çŸ¥é“äº†å®ƒä»¬çš„è¾“å‡ºçš„ç»“æœï¼Œåˆ†åˆ«æ˜¯falseã€trueå’Œfalseã€‚</p><a id="more"></a><h3 id="æ˜¯åœ¨æ¯”è¾ƒä»€ä¹ˆ"><a href="#æ˜¯åœ¨æ¯”è¾ƒä»€ä¹ˆ" class="headerlink" title="==æ˜¯åœ¨æ¯”è¾ƒä»€ä¹ˆ"></a>==æ˜¯åœ¨æ¯”è¾ƒä»€ä¹ˆ</h3><p>åœ¨ã€Šthink in javaã€‹è¿™æœ¬ä¹¦é‡Œæœ‰è¿™æ ·çš„ä¸€å¥è¯â€œå…³ç³»æ“ä½œç¬¦ç”Ÿæˆçš„æ˜¯ä¸€ä¸ªå¸ƒå°”çš„ç»“æœï¼Œå®ƒä»¬è®¡ç®—çš„æ˜¯æ“ä½œæ•°ä¹‹é—´å€¼çš„å…³ç³»â€ã€‚ç®€å•çš„è¯´å°±æ˜¯==å·æ˜¯ç”¨æ¥æ¯”è¾ƒå€¼æ˜¯å¦ç›¸ç­‰ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> n = <span class="number">30</span>;</span><br><span class="line">        <span class="keyword">int</span> m = <span class="number">30</span>;</span><br><span class="line">        </span><br><span class="line">        System.out.println(n == m);</span><br><span class="line">        </span><br><span class="line">        String str = <span class="keyword">new</span> String(<span class="string">"hello world"</span>);</span><br><span class="line"></span><br><span class="line">        String str1 = <span class="keyword">new</span> String(<span class="string">"hello world"</span>);</span><br><span class="line"></span><br><span class="line">        String str2 = <span class="keyword">new</span> String(<span class="string">"hello world"</span>);</span><br><span class="line">        </span><br><span class="line">        System.out.println(str1 == str2);</span><br><span class="line">        str1 = str;</span><br><span class="line">        str2 = str;</span><br><span class="line">        System.out.println(str1 == str2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç çš„è¾“å‡ºç»“æœå¯èƒ½å¤§å®¶éƒ½çŸ¥é“æ˜¯trueã€falseå’Œtrueã€‚ä¹Ÿè®¸ä¼šæœ‰äººä¼šæœ‰ç–‘é—®ï¼Œé‚£æˆ‘ä»¬æ¥å¥½å¥½çš„è§£é‡Šä¸€ä¸‹ï¼š</p><p>n == mç»“æœä¸ºtrueï¼Œè¿™ä¸ªå¾ˆå®¹æ˜“ç†è§£ï¼Œå˜é‡nå’Œå˜é‡må­˜å‚¨çš„å€¼éƒ½ä¸º3ï¼Œè‚¯å®šæ˜¯ç›¸ç­‰çš„ã€‚è€Œä¸ºä»€ä¹ˆstr1å’Œstr2ä¸¤æ¬¡æ¯”è¾ƒçš„ç»“æœä¸åŒï¼Ÿè¦ç†è§£è¿™ä¸ªå…¶å®åªéœ€è¦ç†è§£åŸºæœ¬æ•°æ®ç±»å‹å˜é‡å’ŒéåŸºæœ¬æ•°æ®ç±»å‹å˜é‡çš„åŒºåˆ«ã€‚å¯¹äºJavaä¸­çš„8ä¸­åŸºæœ¬ç±»å‹ï¼ˆ4ç§æ•´å‹byteã€shortã€intã€longï¼Œ2ç§æµ®ç‚¹å‹floatã€doubleï¼Œä¸€ä¸ªbooleanå‹ï¼Œè¿˜æœ‰ä¸€ä¸ªå­—ç¬¦å‹charï¼‰çš„å˜é‡ï¼Œå˜é‡æœ¬èº«å­˜å‚¨çš„å°±æ˜¯å€¼ï¼Œå…³ç³»æ“ä½œç¬¦==è¿›è¡Œæ¯”è¾ƒæ—¶ï¼Œæ¯”è¾ƒçš„å°±æ˜¯å€¼æœ¬èº«ã€‚æ‰€ä»¥ä¸Šé¢çš„ n == mçš„æ¯”è¾ƒå°±æ˜¯3 == 3ï¼Œè¿™ä¸ªè‚¯å®šç»“æœæ˜¯trueå•Šï¼</p><p>å¯¹äºé‚£äº›å¼•ç”¨ç±»å‹çš„å˜é‡å¦‚str1ï¼Œå˜é‡å­˜å‚¨çš„å¹¶ä¸æ˜¯å€¼æœ¬èº«ï¼Œè€Œæ˜¯å…¶å…³è”å¯¹è±¡åœ¨å†…å­˜çš„åœ°å€ã€‚æ‰€ä»¥å˜é‡str1ä¸­å­˜å‚¨çš„æ˜¯å®ƒæŒ‡å‘çš„å¯¹è±¡åœ¨å†…å­˜ä¸­çš„å­˜å‚¨åœ°å€ï¼Œå¹¶ä¸æ˜¯â€œå€¼â€æœ¬èº«ï¼Œä¹Ÿå°±æ˜¯è¯´å¹¶ä¸æ˜¯ç›´æ¥å­˜å‚¨çš„å­—ç¬¦ä¸²â€hello worldâ€ã€‚è¿™é‡Œé¢çš„å¼•ç”¨å’ŒC/C++ä¸­çš„æŒ‡é’ˆå¾ˆç±»ä¼¼ã€‚å› æ­¤åœ¨ç”¨==å¯¹str1å’Œstr2è¿›è¡Œç¬¬ä¸€æ¬¡æ¯”è¾ƒæ—¶ï¼Œå¾—åˆ°çš„ç»“æœæ˜¯falseã€‚å› æ­¤å®ƒä»¬åˆ†åˆ«æŒ‡å‘çš„æ˜¯ä¸åŒçš„å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä»¬å®é™…å­˜å‚¨çš„å†…å­˜åœ°å€ä¸åŒã€‚è€Œåœ¨ç¬¬äºŒæ¬¡æ¯”è¾ƒæ—¶ï¼Œéƒ½è®©str1å’Œstr2æŒ‡å‘äº†stræŒ‡å‘çš„å¯¹è±¡ï¼Œé‚£ä¹ˆå¾—åˆ°çš„ç»“æœæ¯«æ— ç–‘é—®æ˜¯trueã€‚</p><h3 id="equalsåˆæ˜¯åœ¨æ¯”è¾ƒä»€ä¹ˆ"><a href="#equalsåˆæ˜¯åœ¨æ¯”è¾ƒä»€ä¹ˆ" class="headerlink" title="equalsåˆæ˜¯åœ¨æ¯”è¾ƒä»€ä¹ˆ"></a>equalsåˆæ˜¯åœ¨æ¯”è¾ƒä»€ä¹ˆ</h3><p>equalsæ–¹æ³•æ˜¯åŸºç±»Objectä¸­çš„æ–¹æ³•ï¼Œå› æ­¤å¯¹äºæ‰€æœ‰ç»§æ‰¿Objectçš„ç±»éƒ½æœ‰è¯¥æ–¹æ³•ã€‚å…ˆçœ‹ä¸€ä¸‹ä¸‹é¢çš„ä»£ç ï¼ŒçŒœçŒœè¾“å‡ºçš„ç»“æœæ˜¯ä»€ä¹ˆ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;;</span><br><span class="line"></span><br><span class="line">        Object object1 = <span class="keyword">new</span> Object();</span><br><span class="line">        Object object2 = <span class="keyword">new</span> Object();</span><br><span class="line"></span><br><span class="line">        Object object3 = object1;</span><br><span class="line"></span><br><span class="line">        System.out.println(object1.equals(object2));</span><br><span class="line">        System.out.println(object1.equals(object3));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç çš„è¾“å‡ºç»“æœæ˜¯falseã€trueã€‚æˆ‘ä»¬æ¥çœ‹çœ‹Objectç±»ä¸­equalsæºç æ˜¯ä»€ä¹ˆæ ·çš„ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object obj)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">this</span> == obj);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨Objectç±»ä¸­çš„equalsæ–¹æ³•æ˜¯ç”¨æ¥æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡çš„å¼•ç”¨æ˜¯å¦ç›¸ç­‰ï¼Œå³æ˜¯ä¸¤ä¸ªå˜é‡çš„å¼•ç”¨æ˜¯å¦æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ã€‚</p><p>é‚£ä¸‹é¢çš„ä»£ç è‚¯å®šä¼šæœ‰äººæœ‰ç–‘é—®äº†ï¼Œä¸ºå•¥è¾“å‡ºçš„ç»“æœæ˜¯true</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;;</span><br><span class="line"></span><br><span class="line">        String str1 = <span class="keyword">new</span> String(<span class="string">"hello"</span>);</span><br><span class="line"></span><br><span class="line">        String str2 = <span class="keyword">new</span> String(<span class="string">"hello"</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(str1.equals(str2));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¦æƒ³çŸ¥é“æ˜¯ä¸ºä»€ä¹ˆï¼Œæˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹Stringç±»çš„equalsçš„æºç å°±çŸ¥é“æ˜¯æ€ä¹ˆå›äº‹äº†ï¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object anObject)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span> == anObject) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (anObject <span class="keyword">instanceof</span> String) &#123;</span><br><span class="line">        String anotherString = (String)anObject;</span><br><span class="line">        <span class="keyword">int</span> n = value.length;</span><br><span class="line">        <span class="keyword">if</span> (n == anotherString.value.length) &#123;</span><br><span class="line">            <span class="keyword">char</span> v1[] = value;</span><br><span class="line">            <span class="keyword">char</span> v2[] = anotherString.value;</span><br><span class="line">            <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> (n-- != <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (v1[i] != v2[i])</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">                i++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Stringç±»å¯¹equalsæ–¹æ³•è¿›è¡Œäº†é‡å†™ï¼Œç”¨æ¥æ¯”è¾ƒæŒ‡å‘çš„å­—ç¬¦ä¸²å¯¹è±¡æ‰€å­˜å‚¨çš„å­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰ã€‚</p><p>Javaä¸­å…¶ä»–çš„ç±»ä¾‹å¦‚Doubleã€Dateã€Integerç­‰ï¼Œéƒ½å¯¹equalsè¿›è¡Œé‡å†™ï¼Œæ¥æ¯”è¾ƒæŒ‡å‘çš„å¯¹è±¡å­˜å‚¨çš„å†…å®¹æ˜¯å¦ç›¸ç­‰ã€‚</p><p>æˆ‘ä»¬æ¥æ€»ç»“ä¸€ä¸‹ï¼š</p><ol><li>å¯¹äº==ï¼Œå¦‚æœä½œç”¨äºåŸºæœ¬æ•°æ®ç±»å‹çš„å˜é‡ï¼Œåˆ™ç›´æ¥æ¯”è¾ƒä¸¤æ“ä½œæ•°çš„å€¼æ˜¯å¦ç›¸ç­‰ï¼›å¦‚æœä½œç”¨äºå¼•ç”¨ç±»å‹çš„å˜é‡ï¼Œåˆ™æ¯”è¾ƒçš„å¼•ç”¨å˜é‡æ‰€æŒ‡å‘çš„å¯¹è±¡çš„åœ°å€ã€‚</li><li>å¯¹äºequalsï¼Œå¦‚æœç±»å¯¹equalsæ²¡æœ‰è¿›è¡Œé‡å†™ï¼Œåˆ™æ¯”è¾ƒçš„æ˜¯å¼•ç”¨ç±»å‹çš„å˜é‡æ‰€æŒ‡å‘çš„å¯¹è±¡åœ°å€ï¼›è¯¸å¦‚Stringç±»å¯¹equalsæ–¹æ³•è¿›è¡Œäº†é‡å†™ï¼Œæ¯”è¾ƒçš„åˆ™æ˜¯å¼•ç”¨å˜é‡æ‰€æŒ‡å‘çš„å¯¹è±¡çš„å†…å®¹ã€‚</li><li>æ³¨æ„equalsæ–¹æ³•ä¸èƒ½ä½œç”¨äºåŸºæœ¬æ•°æ®ç±»å‹çš„å˜é‡</li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> String </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaå­¦ä¹ ç³»åˆ—æ–‡ç« ç¬¬ä¸€ç¯‡ï¼šåŸºæœ¬å˜é‡ç±»å‹</title>
      <link href="/post/c4de9814.html"/>
      <url>/post/c4de9814.html</url>
      
        <content type="html"><![CDATA[<p>Javaæœ‰ç€ä¸°å¯Œçš„å˜é‡ç±»å‹ï¼Œæœ‰8ç§åŸºæœ¬æ•°æ®ç±»å‹ï¼Œä»¥åŠä»–ä»¬å¯¹åº”çš„åŒ…è£…ç±»å‹ï¼Œè¿˜æœ‰æ•°ç»„é›†åˆç­‰ä¼—å¤šå˜é‡ç±»å‹ã€‚ç›¸æ¯”ä¹‹ä¸‹PHPçš„æ•°æ®ç±»å‹å°±ç›¸å¯¹å°‘å¤šäº†ï¼ŒPHPåªæœ‰å¸ƒå°”ç±»å‹ï¼ˆBooleanï¼‰ã€æ•´å‹ï¼ˆIntegerï¼‰ã€æµ®ç‚¹å‹ï¼ˆFloatï¼‰ã€æ•°ç»„ï¼ˆArrayï¼‰ã€å­—ç¬¦ä¸²ï¼ˆStringï¼‰ã€å¯¹è±¡ï¼ˆObjectï¼‰ã€èµ„æºç±»å‹ï¼ˆResourceï¼‰å’ŒNULLã€‚æœ¬æ–‡æˆ‘ä»¬å…ˆä»¥åŸºæœ¬æ•°æ®ç±»å‹ä¸ºä¸»ï¼Œå…¶ä»–çš„ç±»å‹ä¸ºè¾…ã€‚</p><a id="more"></a><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">type identifier [ = value][, identifier [= value] ...] ;</span><br><span class="line">æ ¼å¼è¯´æ˜ï¼štypeä¸ºJavaæ•°æ®ç±»å‹ã€‚identifieræ˜¯å˜é‡åã€‚å¯ä»¥ä½¿ç”¨é€—å·éš”å¼€æ¥å£°æ˜å¤šä¸ªåŒç±»å‹å˜é‡ã€‚</span><br></pre></td></tr></table></figure><p>ä¸‹é¢æˆ‘å°±ç®€å•çš„ä¸¾å‡ ä¸ªå˜é‡å£°æ˜çš„ä¾‹å­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">byte</span> a,b,c;</span><br><span class="line"><span class="keyword">short</span> e = g = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> f = <span class="number">1000</span>;</span><br><span class="line"><span class="keyword">boolean</span> h = <span class="keyword">false</span>;</span><br><span class="line"><span class="keyword">char</span> i = <span class="string">'a'</span>;</span><br></pre></td></tr></table></figure><h3 id="Javaçš„ä¸¤å¤§æ•°æ®ç±»å‹ï¼š"><a href="#Javaçš„ä¸¤å¤§æ•°æ®ç±»å‹ï¼š" class="headerlink" title="Javaçš„ä¸¤å¤§æ•°æ®ç±»å‹ï¼š"></a>Javaçš„ä¸¤å¤§æ•°æ®ç±»å‹ï¼š</h3><ol><li>å†…ç½®æ•°æ®ç±»å‹</li><li>å¼•ç”¨æ•°æ®ç±»å‹<h3 id="å†…ç½®æ•°æ®ç±»å‹"><a href="#å†…ç½®æ•°æ®ç±»å‹" class="headerlink" title="å†…ç½®æ•°æ®ç±»å‹"></a>å†…ç½®æ•°æ®ç±»å‹</h3>Javaè¯­è¨€æä¾›äº†å…«ç§åŸºæœ¬æ•°æ®ç±»å‹ã€‚å…­ç§æ•°å­—ç±»å‹ï¼ˆå››ä¸ªæ•´æ•°å‹ï¼Œä¸¤ä¸ªæµ®ç‚¹å‹ï¼‰ï¼Œä¸€ç§å­—ç¬¦ç±»å‹ï¼Œè¿˜æœ‰ä¸€ç§æ˜¯å¸ƒå°”å‹ã€‚Javaä¸­çš„æ•°å­—ç±»å‹éƒ½æ˜¯æ— ç¬¦å·ï¼ˆunsignedï¼‰çš„ï¼Œä¸åƒCè¯­è¨€å’ŒC++é‚£æ ·è¿˜æä¾›æœ‰ç¬¦å·çš„ç±»å‹ã€‚åœ¨åç»­çš„MySQLå­¦ä¹ ä¸­ï¼Œä½ ä¼šå‘ç°MySQLä¸­å­—æ®µçš„ç±»å‹é‡Œé¢ä¼šæœ‰æ— ç¬¦å·è¿™ä¸ªå±æ€§ï¼Œè¿™æ ·å°±ä¼šå‡ºç°MySQLçš„å­—æ®µæ˜ å°„æˆJavaå˜é‡æ—¶ï¼Œä¼šæœ‰å–å€¼èŒƒå›´ä¸åŒçš„é—®é¢˜ã€‚<h4 id="byte"><a href="#byte" class="headerlink" title="byte"></a>byte</h4></li></ol><ul><li>byte å ç”¨ä¸€ä¸ªå­—èŠ‚çš„å†…å­˜ï¼›</li><li>æœ€å°å€¼æ˜¯-128ï¼ˆ-2^7)ï¼Œ æœ€å¤§å€¼æ˜¯127ï¼ˆ2^7-1ï¼‰ï¼›</li><li>é»˜è®¤å€¼æ˜¯0ï¼Œå¯¹åº”çš„åŒ…è£…ç±»å‹æ˜¯Byte,åŒ…è£…ç±»å‹çš„é»˜è®¤å€¼æ˜¯nullï¼›</li><li>ä¾‹å­ï¼šbyte a = 10ï¼›</li></ul><h4 id="short"><a href="#short" class="headerlink" title="short"></a>short</h4><ul><li>short å ç”¨ä¸¤ä¸ªå­—èŠ‚çš„å†…å­˜ï¼›</li><li>æœ€å°å€¼æ˜¯-32768ï¼ˆ-2^15ï¼‰ï¼Œ æœ€å¤§å€¼æ˜¯32767ï¼ˆ2^15-1ï¼‰</li><li>é»˜è®¤å€¼æ˜¯0ï¼Œå¯¹åº”çš„åŒ…è£…ç±»å‹æ˜¯Short,é»˜è®¤å€¼æ˜¯nullï¼›</li><li>ä¾‹å­ï¼šshort a = 1200ï¼›</li></ul><h4 id="char"><a href="#char" class="headerlink" title="char"></a>char</h4><ul><li>char å ç”¨ä¸¤ä¸ªå­—èŠ‚çš„å†…å­˜ï¼Œé‡‡ç”¨ Unicode ç¼–ç ï¼›</li><li>æœ€å°å€¼æ˜¯ \u0000ï¼ˆå³ä¸º0ï¼‰ï¼›</li><li>æœ€å¤§å€¼æ˜¯ \uffffï¼ˆå³ä¸º65,535ï¼‰ï¼›</li><li>char å¯ä»¥å‚¨å­˜ä»»ä½•å­—ç¬¦ï¼ˆéƒ¨åˆ†ç”Ÿåƒ»çš„ä¸­æ–‡å­—ç¬¦å¯èƒ½ä¸è¡Œï¼‰ï¼›</li><li>ä¾‹å­ï¼šchar letter = â€˜Aâ€™;ã€‚</li></ul><h4 id="int"><a href="#int" class="headerlink" title="int"></a>int</h4><ul><li>int å ç”¨å››ä¸ªå­—èŠ‚çš„å†…å­˜ï¼›</li><li>æœ€å°å€¼æ˜¯-2,147,483,648ï¼ˆ-2^31ï¼‰ï¼Œ æœ€å¤§å€¼æ˜¯2,147,483,6478ï¼ˆ2^31-1ï¼‰</li><li>é»˜è®¤å€¼æ˜¯0ï¼Œå¯¹åº”çš„åŒ…è£…ç±»å‹æ˜¯ Integerï¼Œé»˜è®¤å€¼æ˜¯nullï¼›</li><li>ä¸€èˆ¬çš„æ•´å‹å˜é‡é»˜è®¤ä¸º int ç±»å‹</li><li>ä¾‹å­ï¼šint a = -10020ï¼›</li></ul><h4 id="long"><a href="#long" class="headerlink" title="long"></a>long</h4><ul><li>long å ç”¨å…«ä¸ªå­—èŠ‚çš„å†…å­˜ï¼›</li><li>æœ€å°å€¼æ˜¯ -9,223,372,036,854,775,808ï¼ˆ-2^63ï¼‰ï¼Œæœ€å¤§å€¼æ˜¯ 9,223,372,036,854,775,807ï¼ˆ2^63-1ï¼‰ï¼Œè¿™ç§ç±»å‹ä¸»è¦ä½¿ç”¨åœ¨éœ€è¦æ¯”è¾ƒå¤§æ•´æ•°çš„ç³»ç»Ÿä¸Šï¼›</li><li>é»˜è®¤å€¼æ˜¯ 0Lï¼Œå¯¹åº”çš„åŒ…è£…ç±»å‹æ˜¯ Longï¼Œé»˜è®¤å€¼æ˜¯nullï¼›</li><li>ä¾‹å­ï¼šlong a = 100000Lï¼ŒLong b = -200000Lã€‚<br>â€œLâ€ç†è®ºä¸Šä¸åˆ†å¤§å°å†™ï¼Œä½†æ˜¯è‹¥å†™æˆâ€lâ€å®¹æ˜“ä¸æ•°å­—â€1â€æ··æ·†ï¼Œä¸å®¹æ˜“åˆ†è¾©ã€‚æ‰€ä»¥æœ€å¥½å¤§å†™ã€‚</li></ul><h4 id="float"><a href="#float" class="headerlink" title="float"></a>float</h4><ul><li>float å ç”¨å››ä¸ªå­—èŠ‚çš„å†…å­˜ï¼›</li><li>é»˜è®¤å€¼æ˜¯ 0.0fï¼›æµ®ç‚¹æ•°ä¸èƒ½ç”¨æ¥è¡¨ç¤ºç²¾ç¡®çš„å€¼ï¼Œå¦‚è´§å¸ï¼Œå­˜å‚¨è´§å¸æ¨èä½¿ç”¨ BigDecimalï¼›å¯¹åº”çš„åŒ…è£…ç±»å‹æ˜¯Floatï¼Œé»˜è®¤å€¼æ˜¯nullï¼›</li><li>ä¾‹å­ï¼šfloat f1 = 234.58fï¼›</li></ul><h4 id="double"><a href="#double" class="headerlink" title="double"></a>double</h4><ul><li>double å ç”¨å…«ä¸ªå­—èŠ‚çš„å†…å­˜ï¼›</li><li>é»˜è®¤å€¼æ˜¯ 0.0dï¼›doubleä¸èƒ½ç”¨æ¥è¡¨ç¤ºç²¾ç¡®çš„å€¼ï¼Œå¦‚è´§å¸ï¼Œå­˜å‚¨è´§å¸æ¨èä½¿ç”¨BigDecimalï¼›å¯¹åº”çš„åŒ…è£…ç±»å‹æ˜¯Doubleï¼Œé»˜è®¤å€¼æ˜¯nullï¼›</li><li>ä¾‹å­ï¼šdouble d1 = 234.05dï¼›double d2 = 467.90;<br>æ³¨æ„ï¼šä¸å¸¦ä»»ä½•æ ‡å¿—çš„æµ®ç‚¹å‹æ•°æ®ï¼Œç³»ç»Ÿé»˜è®¤æ˜¯doubleç±»å‹ã€‚</li></ul><h4 id="boolean"><a href="#boolean" class="headerlink" title="boolean"></a>boolean</h4><ul><li>boolean(JVMè§„èŒƒæ²¡æœ‰æ˜ç¡®è§„å®šå…¶æ‰€å çš„ç©ºé—´å¤§å°ï¼›</li><li>åªæœ‰ä¸¤ä¸ªå–å€¼ï¼Œtrueå’Œfalse;</li><li>é»˜è®¤å€¼false,å¯¹åº”çš„åŒ…è£…ç±»å‹æ˜¯Booleanï¼Œé»˜è®¤å€¼æ˜¯nullï¼›</li><li>ä¾‹å­ï¼š boolean b = false;</li></ul><h4 id="void"><a href="#void" class="headerlink" title="void"></a>void</h4><ul><li>å¯¹åº”åŒ…è£…ç±»å‹Voidï¼Œä¸å¸¸ç”¨</li></ul><p>byteã€intã€longå’Œshortè¿˜å¯ä»¥ä½¿ç”¨16è¿›åˆ¶å’Œ8è¿›åˆ¶çš„æ–¹å¼æ ‡è¯†ï¼Œé»˜è®¤éƒ½æ˜¯ä½¿ç”¨10è¿›åˆ¶ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> decimal = <span class="number">100</span>;</span><br><span class="line"><span class="keyword">int</span> octal = <span class="number">0144</span>;</span><br><span class="line"><span class="keyword">int</span> hexa =  <span class="number">0x64</span>;</span><br></pre></td></tr></table></figure><h3 id="è‡ªåŠ¨ç±»å‹è½¬æ¢"><a href="#è‡ªåŠ¨ç±»å‹è½¬æ¢" class="headerlink" title="è‡ªåŠ¨ç±»å‹è½¬æ¢"></a>è‡ªåŠ¨ç±»å‹è½¬æ¢</h3><p>æ•´å‹å’Œå­—ç¬¦å‹æ•°æ®å¯ä»¥æ··åˆè¿ç®—ï¼Œä¸åŒçš„ç±»å‹çš„æ•°æ®å…ˆè½¬åŒ–æˆåŒä¸€ç±»å‹ï¼Œç„¶åè¿›è¡Œè®¡ç®—ã€‚</p><p>ä½â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”&gt;é«˜</p><p>byte-&gt;short,charâ€”&gt; int â€”&gt;float â€”&gt; longâ€”&gt; double </p><p>æ•°æ®ç±»å‹è½¬æ¢å¿…é¡»æ»¡è¶³ä¸‹é¢çš„è§„åˆ™ï¼š</p><ul><li>ä¸èƒ½å¯¹booleanç±»å‹è¿›è¡Œç±»å‹è½¬æ¢</li><li>ä¸èƒ½æŠŠå¯¹è±¡ç±»å‹è½¬æ¢æˆä¸ç›¸å¹²ç±»çš„å¯¹è±¡</li><li>æŠŠç±»å‹èŒƒå›´å¤§çš„è½¬æ¢æˆç±»å‹èŒƒå›´å°çš„æ—¶å€™å¿…é¡»ä½¿ç”¨å¼ºåˆ¶ç±»å‹è½¬æ¢</li><li>å¼ºåˆ¶è½¬æ¢çš„è¿‡ç¨‹ä¸­ä¼šå‡ºç°æº¢å‡ºæˆ–æŸå¤±ç²¾åº¦</li></ul><h3 id="å¼•ç”¨ç±»å‹"><a href="#å¼•ç”¨ç±»å‹" class="headerlink" title="å¼•ç”¨ç±»å‹"></a>å¼•ç”¨ç±»å‹</h3><ul><li>åœ¨Javaä¸­å¼•ç”¨ç±»å‹å˜é‡æŒ‡å‘ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ç§å˜é‡åœ¨å®šä¹‰çš„æ—¶å€™ï¼Œè¢«å£°æ˜æˆç‰¹å®šçš„ç±»å‹ï¼Œæ¯”å¦‚ Manã€Studentç­‰ã€‚å˜é‡ç±»å‹ä¸€ä½†ç¡®å®šä¹‹åç±»å‹å°±ä¸èƒ½æ”¹å˜ã€‚è¿™ä¸€ç‚¹å’ŒåŠ¨æ€è„šæœ¬è¯­è¨€PHPæœ‰ç€å¾ˆå¤§çš„ä¸åŒï¼ŒPHPä¸­çš„å˜é‡å®šä¹‰åä»èƒ½ä¿å­˜å…¶ä»–ç±»å‹çš„å˜é‡ï¼›</li><li>æ‰€ç”¨å¼•ç”¨ç±»å‹çš„é»˜è®¤å€¼éƒ½æ˜¯nullï¼›</li></ul><p>å†™äºï¼š2018-06-06 14:56</p><p>ä¿®æ”¹ï¼š2018-06-06 22:56</p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> String </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaå­¦ä¹ ç³»åˆ—æ–‡ç« ç¬¬äºŒç¯‡ï¼šå­—ç¬¦ä¸²</title>
      <link href="/post/9d613e12.html"/>
      <url>/post/9d613e12.html</url>
      
        <content type="html"><![CDATA[<p>åœ¨ä¼—å¤šçš„ç¼–ç¨‹è¯­è¨€é‡Œé¢ï¼Œå­—ç¬¦ä¸²éƒ½è¢«å¹¿æ³›çš„ä½¿ç”¨ã€‚åœ¨Javaä¸­å­—ç¬¦ä¸²å±äºå¯¹è±¡ï¼Œè¯­è¨€æä¾›äº†Stringç±»æ¥åˆ›å»ºå’Œæ“ä½œå­—ç¬¦ä¸²ã€‚</p><a id="more"></a><h3 id="å­—ç¬¦ä¸²Stringç®€å•çŸ¥è¯†"><a href="#å­—ç¬¦ä¸²Stringç®€å•çŸ¥è¯†" class="headerlink" title="å­—ç¬¦ä¸²Stringç®€å•çŸ¥è¯†"></a>å­—ç¬¦ä¸²Stringç®€å•çŸ¥è¯†</h3><p>Javaæä¾›ä¸¤ç§æ–¹å¼æ¥å®šä¹‰å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">å®šä¹‰å­—ç¬¦ä½¿ç”¨å•å¼•å·ï¼Œå®šä¹‰å­—ç¬¦ä¸²ä½¿ç”¨åŒå¼•å·ï¼›</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›´æ¥èµ‹å€¼</span></span><br><span class="line">String str1 = <span class="string">"hello world"</span>;</span><br><span class="line"><span class="comment">// æ„é€ æ–¹æ³•</span></span><br><span class="line">String str2 = <span class="keyword">new</span> String(<span class="string">"hello world"</span>);</span><br></pre></td></tr></table></figure><p>é€šè¿‡å¯¹Stringæºç çš„æŸ¥çœ‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">String</span></span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span>, <span class="title">Comparable</span>&lt;<span class="title">String</span>&gt;, <span class="title">CharSequence</span> </span>&#123;</span><br><span class="line">    <span class="comment">/** The value is used for character storage. */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">char</span> value[];</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** Cache the hash code for the string */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> hash; <span class="comment">// Default to 0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/** use serialVersionUID from JDK 1.0.2 for interoperability */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = -<span class="number">6849794470754667710L</span>;</span><br><span class="line"></span><br><span class="line">    â€¦â€¦</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»ä¸Šé¢çš„ä»£ç æˆ‘ä»¬å¯ä»¥å¾—å‡ºä¸¤ç‚¹ç»“è®ºï¼š</p><ol><li>Javaä¸­çš„Stringç±»è¢«finalä¿®é¥°ã€‚åœ¨Javaä¸­è¢«finalä¿®é¥°çš„ç±»ä¸å…è®¸è¢«ç»§æ‰¿ï¼Œå¹¶ä¸”æˆå‘˜æ–¹æ³•é»˜è®¤è¢«finalä¿®é¥°ã€‚åœ¨æ—©æœŸçš„JVMçš„ç‰ˆæœ¬ï¼Œè¢«finalä¿®é¥°çš„æ–¹æ³•ä¼šè¢«è½¬ä¸ºå†…åµŒè°ƒç”¨å€Ÿæ­¤æ¥æå‡æ‰§è¡Œæ•ˆç‡ï¼Œä½†æ˜¯ä»Java1.5/6ä¹‹åï¼Œè¿™ç§æ–¹å¼å°±è¢«å–æ¶ˆäº†ã€‚åœ¨ä¹‹åçš„ç‰ˆæœ¬é‡Œï¼Œfinalä¿®é¥°ç±»åªæ˜¯ä¸ºäº†ä¸è®©ç±»è¢«ç»§æ‰¿ã€‚</li><li>Stringç±»æ˜¯é€šè¿‡charæ•°ç»„ä¿å­˜å­—ç¬¦ä¸²çš„ã€‚</li></ol><p>å¯¹å­—ç¬¦ä¸²çš„æ¯ä¸€æ¬¡æ“ä½œï¼Œä¾‹å¦‚è¿æ¥å­ä¸²éƒ½ä¼šé‡æ–°åˆ›å»ºä¸€ä¸ªæ–°çš„Stringå¯¹è±¡ã€‚æˆ‘ä»¬å¯ä»¥ä»Stringä¸­çš„concatæ–¹æ³•æºç ä¸­å¯ä»¥çœ‹å‡ºè¿™ä¸€ç‚¹ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">concat</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> otherLen = str.length();</span><br><span class="line">    <span class="keyword">if</span> (otherLen == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> len = value.length;</span><br><span class="line">    <span class="keyword">char</span> buf[] = Arrays.copyOf(value, len + otherLen);</span><br><span class="line">    str.getChars(buf, len);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> String(buf, <span class="keyword">true</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å½“è¢«è¿æ¥çš„å­ä¸²çš„é•¿åº¦ä¸º0æ—¶ï¼Œç›´æ¥è¿”å›è‡ªèº«ï¼Œè¿æ¥ä¸€ä¸ªé•¿åº¦ä¸ä¸º0çš„å­ä¸²ï¼Œé€šè¿‡charæ•°ç»„çš„ç³»åˆ—æ“ä½œï¼Œé‡æ–°ç”Ÿæˆä¸€ä¸ªæ–°çš„Stringå¯¹è±¡ã€‚<br>æ‰€ä»¥åœ¨æ­¤è¦æ³¨æ„<strong>å¯¹Stringç±»å¯¹è±¡çš„ä»»ä½•æ”¹å˜éƒ½ä¸å½±å“åˆ°åŸå¯¹è±¡ï¼Œç›¸å…³çš„ä»»ä½•changeæ“ä½œéƒ½ä¼šç”Ÿæˆæ–°çš„å¯¹è±¡ã€‚</strong></p><h3 id="æ·±å…¥ç†è§£å­—ç¬¦ä¸²String"><a href="#æ·±å…¥ç†è§£å­—ç¬¦ä¸²String" class="headerlink" title="æ·±å…¥ç†è§£å­—ç¬¦ä¸²String"></a>æ·±å…¥ç†è§£å­—ç¬¦ä¸²String</h3><p>ä¸Šé¢å†™äº†ä¸¤ç§å®šä¹‰å­—ç¬¦ä¸²çš„æ–¹å¼ï¼Œä¸çŸ¥é“å¤§å®¶çŸ¥é“è¿™ä¸¤ç§æ–¹å¼çš„åŒºåˆ«å’Œè”ç³»ä¹ˆï¼Ÿ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç›´æ¥èµ‹å€¼</span></span><br><span class="line">String str1 = <span class="string">"hello world"</span>;</span><br><span class="line"><span class="comment">// æ„é€ æ–¹æ³•</span></span><br><span class="line">String str2 = <span class="keyword">new</span> String(<span class="string">"hello world"</span>);</span><br><span class="line"></span><br><span class="line">String str3 = <span class="string">"hello world"</span>;</span><br><span class="line"></span><br><span class="line">String str4 = <span class="keyword">new</span> String(<span class="string">"hello world"</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(str1==str2);</span><br><span class="line">System.out.println(str1==str3);</span><br><span class="line">System.out.println(str2==str4);</span><br></pre></td></tr></table></figure><p>ä½ èƒ½ç›´æ¥è¯´å‡ºä¸Šé¢çš„æ‰§è¡Œç»“æœä¹ˆï¼Ÿå¦‚æœä¸èƒ½è¯·ç»§ç»­å¾€ä¸‹çœ‹ï¼Œèƒ½çš„è¯ä¹Ÿè¯·ç»§ç»­å¾€ä¸‹çœ‹ã€‚<br>å…·ä½“çš„ç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">false</span></span><br><span class="line"><span class="keyword">true</span></span><br><span class="line"><span class="keyword">false</span></span><br></pre></td></tr></table></figure><p>åœ¨classæ–‡ä»¶ä¸­æœ‰ä¸€éƒ¨åˆ†æ¥å­˜å‚¨ç¼–è¯‘æœŸé—´ç”Ÿæˆçš„å­—é¢å¸¸é‡ä»¥åŠç¬¦å·å¼•ç”¨ï¼Œè¿™éƒ¨åˆ†å«åšclassæ–‡ä»¶å¸¸é‡æ± ï¼Œåœ¨è¿è¡ŒæœŸé—´å¯¹åº”ç€æ–¹æ³•åŒºçš„è¿è¡Œæ—¶å¸¸é‡æ± ã€‚åœ¨ä¸Šè¿°çš„ä»£ç ä¸­String str1 = â€œhello worldâ€;å’ŒString str2 = new String(â€œhello worldâ€);éƒ½åœ¨ç¼–è¯‘æœŸç”Ÿæˆäº†å­—é¢å¸¸é‡å’Œç¬¦å·å¼•ç”¨ï¼Œè¿è¡ŒæœŸé—´å­—é¢å¸¸é‡â€hello worldâ€éƒ½è¢«å­˜å‚¨åœ¨è¿è¡Œæ—¶å¸¸é‡æ± ã€‚JVMæ‰§è¡Œå¼•æ“ä¼šåœ¨è¿è¡Œæ—¶å¸¸é‡æ± ä¸­æŸ¥æ‰¾æ˜¯å¦å­˜åœ¨ç›¸åŒçš„å­—é¢å¸¸é‡ï¼Œè‹¥æœ‰åˆ™ç›´æ¥å°†å¼•ç”¨æŒ‡å‘å·²ç»å­˜åœ¨çš„å­—é¢å¸¸é‡ï¼›å¦åˆ™åœ¨è¿è¡Œæ—¶å¸¸é‡æ± ä¸­å¼€è¾Ÿä¸€ä¸ªæ–°çš„ç©ºé—´æ¥å­˜å‚¨è¯¥å­—é¢é‡ï¼Œå¹¶å°†å¼•ç”¨æŒ‡å‘è¯¥å­—é¢å¸¸é‡ï¼Œé€šè¿‡è¿™ç§æ–¹å¼æ¥æŠŠStringå¯¹è±¡è·Ÿå¼•ç”¨ç»‘å®šã€‚</p><p>é€šè¿‡newå…³é”®å­—ç”Ÿæˆå¯¹è±¡è¿™ä¸ªè¿‡ç¨‹æ˜¯åœ¨å †heapä¸­è¿›è¡Œçš„ï¼Œè€Œåœ¨å †è¿›è¡Œå¯¹è±¡ç”Ÿæˆè¿‡ç¨‹ä¸­ï¼Œä¸ä¼šæœ‰æ£€æŸ¥å¯¹è±¡æ˜¯å¦å·²ç»å­˜åœ¨è¿™ä¸ªè¡Œä¸ºã€‚å› æ­¤é€šè¿‡newæ¥åˆ›å»ºå¯¹è±¡ï¼Œåˆ›å»ºå‡ºæ¥çš„ä¸€å®šæ˜¯æ–°çš„å¯¹è±¡ï¼Œå³åœ¨å†…å­˜ä¸­æœ‰ç€æ–°çš„å†…å­˜åœ°å€ï¼Œä½†å­—ç¬¦ä¸²çš„å†…å®¹æ˜¯ç›¸åŒçš„ã€‚</p><p>ä¸‹é¢æ˜¯Javaä¸­ä¸åŒå˜é‡åœ¨å†…å­˜ä¸­å­˜æ”¾çš„ä½ç½®ï¼š</p><table><thead><tr><th>å˜é‡</th><th>å†…å­˜ä½ç½®</th></tr></thead><tbody><tr><td>newå‡ºæ¥çš„å¯¹è±¡</td><td>heap å †</td></tr><tr><td>å±€éƒ¨å˜é‡ã€åŸºæœ¬æ•°æ®ç±»å‹</td><td>stack æ ˆ</td></tr><tr><td>é™æ€å˜é‡ã€å­—ç¬¦ä¸²ã€å¸¸é‡</td><td>data segment æ•°æ®åŒº</td></tr><tr><td>ä»£ç </td><td>code segment ä»£ç åŒº</td></tr></tbody></table><h3 id="Stringã€StringBufferã€StringBuilderçš„åŒºåˆ«"><a href="#Stringã€StringBufferã€StringBuilderçš„åŒºåˆ«" class="headerlink" title="Stringã€StringBufferã€StringBuilderçš„åŒºåˆ«"></a>Stringã€StringBufferã€StringBuilderçš„åŒºåˆ«</h3><p>ä¸ºä»€ä¹ˆå·²ç»å­˜åœ¨äº†Stringäº†ï¼Œè¿˜ä¼šå‡ºç°StringBufferã€StringBuilderï¼Ÿ<br>å¦‚æœä¸€ä¸ªå­—ç¬¦ä¸²éœ€è¦è¿æ¥10000æ¬¡å…¶ä»–çš„å­—ç¬¦ä¸²ï¼Œå®ç°ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        </span><br><span class="line">        String string = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">10000</span>;i++)&#123;</span><br><span class="line">            string = string.concat(<span class="string">"hello"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç ä¸æ–­çš„newå­—ç¬¦ä¸²å¯¹è±¡ï¼Œå‰é¢å·²ç»è¯´äº†é‡è¦çš„ä¸€ç‚¹<strong>å¯¹Stringç±»å¯¹è±¡çš„ä»»ä½•æ”¹å˜éƒ½ä¸å½±å“åˆ°åŸå¯¹è±¡ï¼Œç›¸å…³çš„ä»»ä½•changeæ“ä½œéƒ½ä¼šç”Ÿæˆæ–°çš„å¯¹è±¡ã€‚</strong>ï¼Œè¿™ç§ä»£ç å°†ä¼šæœ‰å¤šå¤§çš„å†…å­˜æ¶ˆè€—ã€‚è¿™ä¸ªæ—¶å€™æƒ³å¿…å¤§å®¶å·²ç»æœ‰äº†ç‚¹ç­”æ¡ˆã€‚æˆ‘å°†ä¸Šè¿°çš„ä»£ç ç¨å¾®çš„ä¿®æ”¹ä¸€ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        </span><br><span class="line">        String string = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">10000</span>;i++)&#123;</span><br><span class="line">            string += <span class="string">"hello"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸¤éƒ¨åˆ†ä»£ç çœ‹ä¼¼åªæœ‰ä¸€ç‚¹å·®å¼‚ï¼Œå…¶å®ä¸¤è€…çš„å†…å­˜æ¶ˆè€—æœ‰ç€å¤©å¤§çš„å·®åˆ«ã€‚æˆ‘ä»¬é€šè¿‡javapå‘½ä»¤æ¥åç¼–è¯‘.classæ–‡ä»¶ã€‚å…·ä½“å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">D:\work\javaLearn\out\production\javaLearn&gt;javap -c Main</span><br><span class="line">Compiled from <span class="string">"Main.java"</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Main</span><span class="params">()</span></span>;</span><br><span class="line">    Code:</span><br><span class="line">       <span class="number">0</span>: aload_0</span><br><span class="line">       1: invokespecial #1                  // Method java/lang/Object."&lt;init&gt;":()V</span><br><span class="line">       <span class="number">4</span>: <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(java.lang.String[])</span></span>;</span><br><span class="line">    Code:</span><br><span class="line">       0: ldc           #2                  // String</span><br><span class="line">       <span class="number">2</span>: astore_1</span><br><span class="line">       <span class="number">3</span>: iconst_0</span><br><span class="line">       <span class="number">4</span>: istore_2</span><br><span class="line">       <span class="number">5</span>: iload_2</span><br><span class="line">       <span class="number">6</span>: sipush        <span class="number">10000</span></span><br><span class="line">       <span class="number">9</span>: if_icmpge     <span class="number">38</span></span><br><span class="line">      12: new           #3                  // class java/lang/StringBuilder</span><br><span class="line">      <span class="number">15</span>: dup</span><br><span class="line">      16: invokespecial #4                  // Method java/lang/StringBuilder."&lt;init&gt;":()V</span><br><span class="line">      <span class="number">19</span>: aload_1</span><br><span class="line">      20: invokevirtual #5                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;</span><br><span class="line">      23: ldc           #6                  // String hello</span><br><span class="line">      25: invokevirtual #5                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;</span><br><span class="line">      28: invokevirtual #7                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;</span><br><span class="line">      <span class="number">31</span>: astore_1</span><br><span class="line">      <span class="number">32</span>: iinc          <span class="number">2</span>, <span class="number">1</span></span><br><span class="line">      <span class="number">35</span>: goto          <span class="number">5</span></span><br><span class="line">      <span class="number">38</span>: <span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»ä¸Šé¢åç¼–è¯‘å‡ºæ¥çš„å­—èŠ‚ç ä¸­å¯ä»¥çœ‹å‡ºä¸€ç‚¹é—¨é“ï¼šstring+=â€helloâ€çš„æ“ä½œäº‹å®ä¸Šä¼šè‡ªåŠ¨è¢«JVMä¼˜åŒ–æˆStringBuilderç±»çš„appendæ“ä½œã€‚</p><p>é‚£ä¹ˆæœ‰äººä¼šé—®æ—¢ç„¶æœ‰äº†StringBuilderç±»ï¼Œä¸ºä»€ä¹ˆè¿˜éœ€è¦StringBufferç±»ï¼ŸæŸ¥çœ‹æºä»£ç ä¾¿ä¸€ç›®äº†ç„¶ï¼Œäº‹å®ä¸Šï¼ŒStringBuilderå’ŒStringBufferç±»æ‹¥æœ‰çš„æˆå‘˜å±æ€§ä»¥åŠæˆå‘˜æ–¹æ³•åŸºæœ¬ç›¸åŒï¼ŒåŒºåˆ«æ˜¯StringBufferç±»çš„æˆå‘˜æ–¹æ³•å‰é¢å¤šäº†ä¸€ä¸ªå…³é”®å­—ï¼šsynchronizedï¼Œä¸ç”¨å¤šè¯´ï¼Œè¿™ä¸ªå…³é”®å­—æ˜¯åœ¨å¤šçº¿ç¨‹è®¿é—®æ—¶èµ·åˆ°å®‰å…¨ä¿æŠ¤ä½œç”¨çš„,ä¹Ÿå°±æ˜¯è¯´StringBufferæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p><p>æˆ‘ä»¬æ¥çœ‹ä¸‹é¢çš„ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        String str1 = <span class="string">"I "</span>+<span class="string">"love "</span>+<span class="string">"you"</span>;</span><br><span class="line">        String str2 = <span class="string">"I "</span>;</span><br><span class="line">        String str3 = <span class="string">"love "</span>;</span><br><span class="line">        String str4 = <span class="string">"you "</span>;</span><br><span class="line"></span><br><span class="line">        String str5 = str2 + str3 + str4;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”¨javapå‘½ä»¤æ¥åç¼–è¯‘.classæ–‡ä»¶ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">D:\work\javaLearn\out\production\javaLearn&gt;javap -c Main</span><br><span class="line">Compiled from <span class="string">"Main.java"</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Main</span><span class="params">()</span></span>;</span><br><span class="line">    Code:</span><br><span class="line">       <span class="number">0</span>: aload_0</span><br><span class="line">       1: invokespecial #1                  // Method java/lang/Object."&lt;init&gt;":()V</span><br><span class="line">       <span class="number">4</span>: <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(java.lang.String[])</span></span>;</span><br><span class="line">    Code:</span><br><span class="line">       0: ldc           #2                  // String I love you</span><br><span class="line">       <span class="number">2</span>: astore_1</span><br><span class="line">       3: ldc           #3                  // String I</span><br><span class="line">       <span class="number">5</span>: astore_2</span><br><span class="line">       6: ldc           #4                  // String love</span><br><span class="line">       <span class="number">8</span>: astore_3</span><br><span class="line">       9: ldc           #5                  // String you</span><br><span class="line">      <span class="number">11</span>: astore        <span class="number">4</span></span><br><span class="line">      13: new           #6                  // class java/lang/StringBuilder</span><br><span class="line">      <span class="number">16</span>: dup</span><br><span class="line">      17: invokespecial #7                  // Method java/lang/StringBuilder."&lt;init&gt;":()V</span><br><span class="line">      <span class="number">20</span>: aload_2</span><br><span class="line">      21: invokevirtual #8                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;</span><br><span class="line">      <span class="number">24</span>: aload_3</span><br><span class="line">      25: invokevirtual #8                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;</span><br><span class="line">      <span class="number">28</span>: aload         <span class="number">4</span></span><br><span class="line">      30: invokevirtual #8                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;</span><br><span class="line">      33: invokevirtual #9                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;</span><br><span class="line">      <span class="number">36</span>: astore        <span class="number">5</span></span><br><span class="line">      <span class="number">38</span>: <span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>str1åœ¨ç¼–è¯‘ä¹‹åå°±è¢«ç›´æ¥èµ‹å€¼ä¸ºâ€I love youâ€;str5å´æ²¡æœ‰ä»€ä¹ˆæ“ä½œã€‚ç»¼ä¸Šæ‰€è¿°æˆ‘ä»¬å¯ä»¥å¾—å‡ºä¸€äº›ç»“è®ºï¼š</p><ol><li>å¯¹äºç›´æ¥é€šè¿‡åŠ å·ç›¸è¿å­—ç¬¦ä¸²æ•ˆç‡é«˜ï¼Œå› ä¸ºç¼–è¯‘å™¨ç›´æ¥ç¡®å®šäº†å®ƒçš„å€¼ã€‚å°±åƒä¸Šé¢çš„â€I â€œ+â€love â€œ+â€youâ€;çš„å­—ç¬¦ä¸²ç›¸åŠ ï¼Œåœ¨ç¼–è¯‘æœŸé—´å°±è¢«ä¼˜åŒ–æˆäº†â€I love youâ€œã€‚</li><li>å¯¹äºé—´æ¥ç›¸åŠ çš„ï¼Œå½¢å¦‚str2 + str3 + str4;ç¼–è¯‘æœŸä¸ä¼šè¿›è¡Œä¼˜åŒ–ã€‚</li><li>å¯¹äºæ‰§è¡Œæ•ˆç‡æ¥è¯´StringBuilder &gt; StringBuffer &gt; Stringï¼Œä½†è¿™ä¸ªä¹Ÿä¸æ˜¯ç»å¯¹çš„ã€‚æ¯”å¦‚String str = â€œhelloâ€+ â€œworldâ€çš„æ•ˆç‡å°±æ¯” StringBuilder st  = new StringBuilder().append(â€œhelloâ€).append(â€œworldâ€)è¦é«˜ã€‚ä½†æ˜¯ï¼Œå½“å­—ç¬¦ä¸²ç›¸åŠ çš„æ“ä½œæˆ–è€…å­—ç¬¦æ”¹åŠ¨çš„æƒ…å†µè¾ƒå°‘çš„æ—¶å€™ï¼Œé‡‡ç”¨Stringè‚¯å®šæ˜¯æ¯”è¾ƒå¥½çš„ï¼›å½“å­—ç¬¦ä¸²çš„æ“ä½œè¾ƒå¤šçš„æ—¶å€™æ¨èä½¿ç”¨StringBuilderï¼Œå¦‚æœè€ƒè™‘åˆ°çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œæ— ç–‘é‡‡ç”¨StringBufferæ˜¯æœ€åˆé€‚çš„ã€‚<h3 id="å¸¸è§çš„å­—ç¬¦ä¸²ç›¸å…³çš„é¢è¯•é¢˜"><a href="#å¸¸è§çš„å­—ç¬¦ä¸²ç›¸å…³çš„é¢è¯•é¢˜" class="headerlink" title="å¸¸è§çš„å­—ç¬¦ä¸²ç›¸å…³çš„é¢è¯•é¢˜"></a>å¸¸è§çš„å­—ç¬¦ä¸²ç›¸å…³çš„é¢è¯•é¢˜</h3></li><li>ä¸‹é¢çš„ä»£ç è¾“å‡ºçš„ç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">String a = <span class="string">"hello2"</span>; ã€€ã€€</span><br><span class="line">String b = <span class="string">"hello"</span> + <span class="number">2</span>; ã€€ã€€</span><br><span class="line">System.out.println((a == b));</span><br></pre></td></tr></table></figure>ç»“æœæ˜¯trueï¼Œå®ƒString b = â€œhelloâ€ + 2; è¢«ç¼–è¯‘å™¨ä¼˜åŒ–æˆäº†String b = â€œhello2â€; æ‰€ä»¥è¿è¡Œæ—¶å­—ç¬¦ä¸²aå’ŒbæŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ã€‚</li><li>ä¸‹é¢çš„ä»£ç è¾“å‡ºçš„ç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">String a = <span class="string">"hello2"</span>; ã€€  </span><br><span class="line">String b = <span class="string">"hello"</span>;       </span><br><span class="line">String c = b + <span class="number">2</span>;       </span><br><span class="line">System.out.println((a == c));</span><br></pre></td></tr></table></figure>è¾“å‡ºç»“æœä¸º:falseã€‚ç”±äºæœ‰ç¬¦å·å¼•ç”¨çš„å­˜åœ¨ï¼Œæ‰€ä»¥  String c = b + 2;ä¸ä¼šåœ¨ç¼–è¯‘æœŸé—´è¢«ä¼˜åŒ–ï¼Œä¸ä¼šæŠŠb+2å½“åšå­—é¢å¸¸é‡æ¥å¤„ç†çš„ï¼Œé€šè¿‡StringBuilderç”Ÿæˆäº†ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œå› æ­¤è¿™ç§æ–¹å¼ç”Ÿæˆçš„å¯¹è±¡äº‹å®ä¸Šæ˜¯ä¿å­˜åœ¨å †ä¸Šçš„ã€‚</li><li>ä¸‹é¢çš„ä»£ç è¾“å‡ºçš„ç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">String a = <span class="string">"hello2"</span>;</span><br><span class="line"><span class="keyword">final</span> String b = <span class="string">"hello"</span>; </span><br><span class="line">String c = b + <span class="number">2</span>; </span><br><span class="line">System.out.println((a == c));</span><br></pre></td></tr></table></figure>è¾“å‡ºç»“æœä¸ºï¼štrueã€‚å¯¹äºè¢«finalä¿®é¥°çš„å˜é‡ï¼Œä¼šåœ¨classæ–‡ä»¶å¸¸é‡æ± ä¸­ä¿å­˜ä¸€ä¸ªå‰¯æœ¬ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸ä¼šé€šè¿‡è¿æ¥è€Œè¿›è¡Œè®¿é—®ï¼Œå¯¹finalå˜é‡çš„è®¿é—®åœ¨ç¼–è¯‘æœŸé—´éƒ½ä¼šç›´æ¥è¢«æ›¿ä»£ä¸ºçœŸå®çš„å€¼ã€‚é‚£ä¹ˆString c = b + 2;åœ¨ç¼–è¯‘æœŸé—´å°±ä¼šè¢«ä¼˜åŒ–æˆï¼šString c = â€œhelloâ€ + 2;</li></ol><p>å­—ç¬¦ä¸²çš„æ•…äº‹å°±æš‚æ—¶è¯´åˆ°è¿™é‡Œï¼Œåç»­æœ‰çš„è¯å°±ç»§ç»­æ›´æ–°ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> String </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CentOS 6.x ä¸‹å®‰è£…Zookeeper</title>
      <link href="/post/d229aadf.html"/>
      <url>/post/d229aadf.html</url>
      
        <content type="html"><![CDATA[<p>ç›®å‰åœ¨ç ”ç©¶dubboè¿™ä¸ªå›½å†…æµè¡Œçš„RPCæ¡†æ¶ï¼Œå®ç°å»ä¸­å¿ƒè¯çš„å¾®æœåŠ¡éœ€è¦ç”¨åˆ°Zookeeper,æ‰€ä»¥ä»Šå¤©æ¥è¯´è¯´å¦‚ä½•å®‰è£…Zookeeperã€‚<br>Zookeeperçš„<a href="https://mirrors.tuna.tsinghua.edu.cn/apache/zookeeper/" target="_blank" rel="noopener">å®˜æ–¹ä¸‹è½½åœ°å€</a></p><a id="more"></a><p>æŸ¥çœ‹Centosç‰ˆæœ¬ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/issue</span><br><span class="line"></span><br><span class="line">[root@iZwz99xkrnh5xy0cqp8aofZ tomcat]<span class="comment"># cat /etc/issue</span></span><br><span class="line">CentOS release 6.9 (Final)</span><br><span class="line">Kernel \r on an \m</span><br></pre></td></tr></table></figure><p> 1.ä¸‹è½½å®‰è£…åŒ…åˆ°/usr/local/src/ç›®å½•ä¸‹ï¼Œå¹¶åˆ›å»ºå®‰è£…ç›®å½•/usr/local/zookeeperã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span>/src/</span><br><span class="line"><span class="comment">#è¿™é‡Œä½¿ç”¨3.4.10ï¼Œæ²¡æœ‰ä½¿ç”¨è¾ƒé«˜çš„ç‰ˆæœ¬</span></span><br><span class="line">wget https://mirrors.tuna.tsinghua.edu.cn/apache/zookeeper/zookeeper-3.4.10/zookeeper-3.4.10.tar.gz</span><br><span class="line">mkdir /usr/<span class="built_in">local</span>/zookeeper</span><br></pre></td></tr></table></figure><p> 2.è§£å‹å®‰è£…åŒ…,å¹¶å°†è§£å‹åçš„æ–‡ä»¶æ‹·è´åˆ°/usr/local/zookeeper</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf zookeeper-3.4.10.tar.gz</span><br><span class="line">cp -R /usr/<span class="built_in">local</span>/zookeeper/zookeeper-3.4.10/*  /usr/<span class="built_in">local</span>/zookeeper</span><br></pre></td></tr></table></figure><p>3.æ·»åŠ ç³»ç»Ÿå˜é‡åˆ°/etc/profile</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> ZOOKEEPER_HOME=/usr/<span class="built_in">local</span>/zookeeper</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$ZOOKEEPER_HOME</span>/bin:<span class="variable">$PATH</span></span><br><span class="line"><span class="built_in">export</span> PATH</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå‘½ä»¤ source /etc/profileä½¿é…ç½®æ–‡ä»¶ç«‹å³ç”Ÿæ•ˆ</p><p>4.åˆ›å»ºzookeeperé…ç½®æ–‡ä»¶,å¹¶ä½œç›¸åº”çš„é…ç½®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span>  /usr/<span class="built_in">local</span>/zookeeper/conf/</span><br><span class="line">cp zoo_sample.cfg zoo.cfg</span><br><span class="line"></span><br><span class="line"><span class="comment">#é…ç½®zookeeper</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æœåŠ¡å™¨ä¸å®¢æˆ·ç«¯ä¹‹é—´äº¤äº’çš„åŸºæœ¬æ—¶é—´å•å…ƒï¼ˆmsï¼‰</span></span><br><span class="line"></span><br><span class="line">tickTime=2000</span><br><span class="line"></span><br><span class="line"><span class="comment">#é…ç½®ä¿å­˜æ•°æ®æ–‡ä»¶å¤¹</span></span><br><span class="line"></span><br><span class="line">dataDir=/usr/<span class="built_in">local</span>/zookeeper/data</span><br><span class="line"></span><br><span class="line"><span class="comment">#é…ç½®ä¿å­˜æ—¥å¿—æ–‡ä»¶å¤¹ï¼Œå½“æ­¤é…ç½®ä¸å­˜åœ¨æ—¶é»˜è®¤è·¯å¾„ä¸dataDirä¸€è‡´</span></span><br><span class="line"></span><br><span class="line">dataLogDir=/var/<span class="built_in">log</span>/zookeeper</span><br><span class="line"></span><br><span class="line"><span class="comment">#å®¢æˆ·ç«¯è®¿é—®zookeeperçš„ç«¯å£å·</span></span><br><span class="line"></span><br><span class="line">clientPort=2181</span><br></pre></td></tr></table></figure><p>5.zookeeperç›¸å…³å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å¯åŠ¨æœåŠ¡ï¼šzkServer.sh start</span><br><span class="line">æŸ¥çœ‹çŠ¶æ€ï¼šzkServer.sh status</span><br><span class="line">å…³é—­æœåŠ¡ï¼šzkServer.sh stop</span><br><span class="line">é‡å¯æœåŠ¡ï¼šzkServer.sh restart</span><br></pre></td></tr></table></figure><p>è‡³æ­¤ï¼Œzookeeperå®‰è£…å®Œæˆ</p>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> zookeeper </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CentOS 6.x ä¸‹yumå®‰è£…Tomcat8</title>
      <link href="/post/30e8c768.html"/>
      <url>/post/30e8c768.html</url>
      
        <content type="html"><![CDATA[<p>åºŸè¯ä¸å¤šè¯´ï¼Œä»Šå¤©å‡†å¤‡åœ¨Centosä¸Šå®‰è£…tomcatï¼Œå­¦javaä¸ä¼štomcatï¼Œé‚£ä¸å°±æ˜¯ç™½å­¦Javaä¹ˆï¼Ÿ<br>æŸ¥çœ‹Centosç‰ˆæœ¬ï¼š</p><a id="more"></a><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/issue</span><br><span class="line"></span><br><span class="line">[root@iZwz99xkrnh5xy0cqp8aofZ tomcat]<span class="comment"># cat /etc/issue</span></span><br><span class="line">CentOS release 6.9 (Final)</span><br><span class="line">Kernel \r on an \m</span><br></pre></td></tr></table></figure><p>é€šè¿‡yumå¥½å¤„å…¶å®å¾ˆå¤šï¼Œç¯å¢ƒå˜é‡ä¸ç”¨é…ç½®ï¼Œé…ç½®æ–‡ä»¶æ”¾åœ¨å¤§å®¶éƒ½ç†Ÿæ‚‰çš„åœ°æ–¹ï¼Œé€šè¿‡rpm -ql xxxå¯ä»¥çŸ¥é“å…¨éƒ¨æ–‡ä»¶çš„åœ°æ–¹ç­‰ç­‰ã€‚</p><p> 1.å®‰è£…Tomcat<br>è‡ªå¸¦çš„yumæºé‡Œé¢çš„Tomcatç‰ˆæœ¬è¿‡ä½ï¼Œæ‰€ä»¥æˆ‘å‡†å¤‡å®‰è£…Tomcat8ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span>/src/</span><br><span class="line">// ä¸‹è½½è„šæœ¬</span><br><span class="line"><span class="comment"># git clone https://github.com/boundlessgeo/rpm-tomcat8.git &amp;&amp; cd rpm-tomcat8</span></span><br><span class="line">// å®‰è£…rpmæ‰“åŒ…å·¥å…·</span><br><span class="line"><span class="comment"># yum -y install rpmdevtools</span></span><br><span class="line">// æ‰“åŒ…rpmåŒ…</span><br><span class="line"><span class="comment"># ./make_rpm.sh</span></span><br><span class="line">// å®‰è£…ä¾èµ–</span><br><span class="line"><span class="comment"># yum install -y redhat-lsb-core</span></span><br><span class="line">// å®‰è£…Tomcat8</span><br><span class="line"><span class="comment"># rpm -ivh rpmbuild/RPMS/noarch/boundless-server-tomcat8-8.0.47-5.noarch.rpm</span></span><br><span class="line"></span><br><span class="line">å¤‡æ³¨ï¼šä¸»è¦æ˜¯è¿™ä¸ªè„šæœ¬https://github.com/boundlessgeo/rpm-tomcat8ï¼Œæƒ³è¦å“ªä¸ªç‰ˆæœ¬å¯ä»¥ç›´æ¥ä¸Šå»è¿™é‡Œä¿®æ”¹æ–‡ä»¶å³å¯ã€‚</span><br></pre></td></tr></table></figure><p> 2.è®¾ç½®å¼€æœºå¯åŠ¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chkconfig tomcat8 on</span><br></pre></td></tr></table></figure><p> 3.å¸¸ç”¨çš„å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// æœåŠ¡çŠ¶æ€</span><br><span class="line">service tomcat8 status</span><br><span class="line">// æœåŠ¡å¯åŠ¨</span><br><span class="line">service tomcat8 start</span><br><span class="line">// æœåŠ¡åœæ­¢</span><br><span class="line">service tomcat8 stop</span><br><span class="line">// æœåŠ¡é‡å¯</span><br><span class="line">service tomcat8 restart</span><br></pre></td></tr></table></figure><p>4.å¸è½½Tomcat</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -e boundless-server-tomcat8.noarch</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> tomcat </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring Boot 1.xé›†æˆspring-boot-devtoolså¼€å‘æ—¶å®ç°çƒ­éƒ¨ç½²</title>
      <link href="/post/e13b17d3.html"/>
      <url>/post/e13b17d3.html</url>
      
        <content type="html"><![CDATA[<p><strong>çƒ­éƒ¨ç½²</strong><br>å¤§å®¶éƒ½çŸ¥é“åœ¨é¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¸¸å¸¸ä¼šæ”¹åŠ¨é¡µé¢æ•°æ®æˆ–è€…ä¿®æ”¹æ•°æ®ç»“æ„ï¼Œä¸ºäº†æ˜¾ç¤ºæ”¹åŠ¨æ•ˆæœï¼Œå¾€å¾€éœ€è¦é‡å¯åº”ç”¨æŸ¥çœ‹æ”¹å˜æ•ˆæœï¼Œå…¶å®å°±æ˜¯é‡æ–°ç¼–è¯‘ç”Ÿæˆäº†æ–°çš„Classæ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶é‡Œè®°å½•ç€å’Œä»£ç ç­‰å¯¹åº”çš„å„ç§ä¿¡æ¯ï¼Œç„¶åClassæ–‡ä»¶å°†è¢«è™šæ‹Ÿæœºçš„ClassLoaderåŠ è½½ã€‚<br>è€Œçƒ­éƒ¨ç½²æ­£æ˜¯åˆ©ç”¨äº†è¿™ä¸ªç‰¹ç‚¹ï¼Œå®ƒç›‘å¬åˆ°å¦‚æœæœ‰Classæ–‡ä»¶æ”¹åŠ¨äº†ï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ClaassLoaderè¿›è¡ŒåŠ è½½è¯¥æ–‡ä»¶ï¼Œç»è¿‡ä¸€ç³»åˆ—çš„è¿‡ç¨‹ï¼Œæœ€ç»ˆå°†ç»“æœå‘ˆç°åœ¨æˆ‘ä»¬çœ¼å‰ã€‚</p><a id="more"></a><p><strong>ç±»åŠ è½½æœºåˆ¶</strong><br>Javaä¸­çš„ç±»ç»è¿‡ç¼–è¯‘å™¨å¯ä»¥æŠŠä»£ç ç¼–è¯‘ä¸ºå­˜å‚¨å­—èŠ‚ç çš„Classæ–‡ä»¶ï¼Œè¯¥Classæ–‡ä»¶å­˜å‚¨äº†å„ç§ä¿¡æ¯ï¼Œæœ€ç»ˆè¦åŠ è½½åˆ°è™šæ‹Ÿæœºä¸­è¿è¡Œä½¿ç”¨ã€‚ç±»åŠ è½½æœºåˆ¶ï¼ˆæ‘˜è‡ªã€Šæ·±å…¥ç†è§£ Java è™šæ‹Ÿæœºã€‹ï¼‰è™šæ‹ŸæœºæŠŠæè¿°ç±»çš„æ•°æ®ä»Classæ–‡ä»¶åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå¹¶å¯¹æ•°æ®è¿›è¡Œæ ¡éªŒã€è½¬æ¢è§£æå’Œåˆå§‹åŒ–ï¼Œæœ€ç»ˆå½¢æˆå¯ä»¥è¢«è™šæ‹Ÿæœºç›´æ¥ä½¿ç”¨çš„Javaç±»å‹ã€‚</p><p><strong>Spring Bootå®ç°çƒ­éƒ¨ç½²</strong><br>Spring Bootå®ç°çƒ­éƒ¨ç½²æœ‰å¦‚ä¸‹æ–¹å¼ï¼š</p><ol><li>ä½¿ç”¨ <a href="https://github.com/spring-projects/spring-loaded" target="_blank" rel="noopener">Spring Loaded</a></li><li>ä½¿ç”¨ <a href="https://github.com/spring-projects/spring-boot/tree/master/spring-boot-samples/spring-boot-sample-devtools" target="_blank" rel="noopener">spring-boot-devtools</a></li></ol><p><strong>Spring Loaded</strong><br>è¿™ç§æ–¹å¼æ˜¯ä»¥Mavenæ’ä»¶çš„å½¢å¼å»åŠ è½½ï¼Œæ‰€ä»¥å¯åŠ¨æ—¶ä½¿ç”¨é€šè¿‡Mavenå‘½ä»¤mvn spring-boot:runå¯åŠ¨ï¼Œè€Œé€šè¿‡Application.runæ–¹å¼å¯åŠ¨çš„ä¼šæ— æ•ˆï¼Œå› ä¸ºé€šè¿‡åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶ï¼Œå·²ç»ç»•å¼€äº†Mavenæ’ä»¶æœºåˆ¶ã€‚<br>pomé›†æˆæ–¹å¼ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springloaded<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.5.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>spring-boot-devtools</strong><br>è¿™ç§æ–¹å¼æ— è®ºæ€ä¹ˆå¯åŠ¨åº”ç”¨ï¼Œéƒ½å¯ä»¥è¾¾åˆ°ä¿®æ”¹æ–‡ä»¶åé‡å¯åº”ç”¨ã€‚<br>pomé›†æˆï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- çƒ­éƒ¨ç½²æ¨¡å— --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span> <span class="comment">&lt;!-- è¿™ä¸ªéœ€è¦ä¸º true çƒ­éƒ¨ç½²æ‰æœ‰æ•ˆ --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>é›†æˆæ³¨æ„</strong></p><ol><li>å¦‚æœå‘ç°æ²¡æœ‰çƒ­éƒ¨ç½²æ•ˆæœï¼Œåˆ™éœ€è¦æ£€æŸ¥IDEé…ç½®ä¸­æœ‰æ²¡æœ‰æ‰“å¼€è‡ªåŠ¨ç¼–è¯‘ã€‚</li><li>å¦‚æœä½¿ç”¨Thymeleafæ¨¡æ¿å¼•æ“ï¼Œéœ€è¦æŠŠæ¨¡æ¿é»˜è®¤ç¼“å­˜è®¾ç½®ä¸ºfalse<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#ç¦æ­¢thymeleafç¼“å­˜ï¼ˆå»ºè®®ï¼šå¼€å‘ç¯å¢ƒè®¾ç½®ä¸ºfalseï¼Œç”Ÿæˆç¯å¢ƒè®¾ç½®ä¸ºtrueï¼‰</span><br><span class="line">spring.thymeleaf.cache=<span class="keyword">false</span></span><br></pre></td></tr></table></figure></li><li>é’ˆå¯¹devtoolsçš„å¯ä»¥æŒ‡å®šç›®å½•æˆ–è€…æ’é™¤ç›®å½•æ¥è¿›è¡Œçƒ­éƒ¨ç½²<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#æ·»åŠ é‚£ä¸ªç›®å½•çš„æ–‡ä»¶éœ€è¦restart</span><br><span class="line">spring.devtools.restart.additional-paths=src/main/java</span><br><span class="line">#æ’é™¤é‚£ä¸ªç›®å½•çš„æ–‡ä»¶ä¸éœ€è¦restart</span><br><span class="line">spring.devtools.restart.exclude=<span class="keyword">static</span><span class="comment">/**,public/**</span></span><br></pre></td></tr></table></figure><strong>è®¾ç½®ideaè®©ä»–å®ç°æ–‡ä»¶ä¿®æ”¹è‡ªåŠ¨é‡å¯é¡¹ç›®</strong><ol><li>æ‰¾åˆ°ideaçš„Preferences -&gt; Build, Execution, Deployment -&gt; Compilerï¼Œå‹¾é€‰Build project automatically</li><li>å›åˆ°ideaæ­£å¸¸ç•Œé¢ï¼ŒMacä½¿ç”¨å¿«æ·é”®shift+option+command+/ï¼Œwindowä¸Šçš„å¿«æ·é”®æ˜¯Shift+Ctrl+Alt+/ï¼Œæ‰“å¼€Registryï¼Œå‹¾é€‰compiler.automake.allow.when.app.runningcompiler.automake.allow.when.app.running</li></ol></li></ol><p>é€šè¿‡ä»¥ä¸Šçš„è®¾ç½®å°±å¯ä»¥åœ¨ä¸é‡å¯æœåŠ¡çš„æƒ…å†µä¸‹åŠ è½½htmlï¼Œä½†å¦‚æœä¿®æ”¹javaæ–‡ä»¶ï¼ŒæœåŠ¡åœ¨å‡ ç§’åä¼šè‡ªåŠ¨é‡å¯ï¼Œå¦‚æœä¸å¸Œæœ›æœåŠ¡é‡å¯éœ€è¦åœ¨application.propertiesæˆ–application.ymlä¸­æ·»åŠ spring.devtools.reatart.enable=false</p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> spring boot </tag>
            
            <tag> spring-boot-devtools </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mavené¡¹ç›®å‡ºç°â€œè¯·ä½¿ç”¨ -source 8 æˆ–æ›´é«˜ç‰ˆæœ¬ä»¥å¯ç”¨ lambda è¡¨è¾¾å¼â€</title>
      <link href="/post/db29c21a.html"/>
      <url>/post/db29c21a.html</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¤©åœ¨ç¼–è¯‘é¡¹ç›®çš„æ—¶å€™å‡ºç°â€œè¯·ä½¿ç”¨ -source 8 æˆ–æ›´é«˜ç‰ˆæœ¬ä»¥å¯ç”¨ lambda è¡¨è¾¾å¼â€çš„é—®é¢˜ã€‚è¿™ä¸ªé—®é¢˜æ˜¯æ€ä¹ˆå‡ºç°çš„å‘¢ï¼Ÿ<br>å…¶å®æ˜¯è‡ªå·±Mavençš„é»˜è®¤JDKçš„ç‰ˆæœ¬è¿‡ä½çš„åŸå› ï¼Œè²Œä¼¼JDKçš„ç‰ˆæœ¬é»˜è®¤ä¸ºJDK1.5ã€‚çŸ¥é“é—®é¢˜çš„æ‰€åœ¨ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç€æ‰‹è§£å†³äº†ã€‚</p><a id="more"></a><ol><li>åœ¨Mavenä¸­æŒ‡å®šJDKçš„ç‰ˆæœ¬<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"..."</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">source</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">target</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li>åœ¨Mavençš„settings.xmlé‡Œé¢æŒ‡å®šå…¨å±€JDKç¼–è¯‘ç‰ˆæœ¬<br>å³é”®ç‚¹å‡»é¡¹ç›®æ‰¾åˆ°Mavenï¼Œæ‰¾åˆ°å…³äºsettings.xmlé€‰é¡¹ï¼Œæ‰“å¼€settings.xmlæ–‡ä»¶ï¼Œå†™å…¥ä¸‹é¢çš„å†…å®¹ï¼š<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">profiles</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">profile</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">id</span>&gt;</span>jdk-1.8<span class="tag">&lt;/<span class="name">id</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">activation</span>&gt;</span>  </span><br><span class="line">          <span class="tag">&lt;<span class="name">activeByDefault</span>&gt;</span>true<span class="tag">&lt;/<span class="name">activeByDefault</span>&gt;</span>  </span><br><span class="line">          <span class="tag">&lt;<span class="name">jdk</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">jdk</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;/<span class="name">activation</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">properties</span>&gt;</span>  </span><br><span class="line">          <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span>  </span><br><span class="line">          <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span>  </span><br><span class="line">          <span class="tag">&lt;<span class="name">maven.compiler.compilerVersion</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.compilerVersion</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;/<span class="name">properties</span>&gt;</span>   </span><br><span class="line">  ã€€<span class="tag">&lt;/<span class="name">profile</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">profiles</span>&gt;</span></span><br></pre></td></tr></table></figure>ç„¶åé‡æ–°ç¼–è¯‘å°±å¯ä»¥äº†</li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> maven </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring Boot 1.x æ•´åˆmybatis,å¹¶è‡ªåŠ¨ç”Ÿæˆmapperå’Œå®ä½“</title>
      <link href="/post/e5912e16.html"/>
      <url>/post/e5912e16.html</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘ä¸€ç›´éƒ½åœ¨å­¦ä¹ Javaï¼Œå‘ç°ç›®å‰Javaæ‹›è˜ä¸­ï¼Œmybatiså‡ºç°çš„é¢‘ç‡æŒºé«˜çš„ï¼Œå¯èƒ½æ˜¯ç›®å‰Javaå¼€å‘ä¸­ä½¿ç”¨æ¯”è¾ƒå¤šçš„æ•°æ®åº“ORMæ¡†æ¶ã€‚äºæ˜¯æˆ‘å‡†å¤‡ç ”ç©¶ä¸‹Spring Boot 1.x å’Œmybatisçš„æ•´åˆã€‚</p><a id="more"></a><p> 1.åœ¨pom.xmlæ–‡ä»¶ä¸­æ·»åŠ ä¸‹é¢çš„é…ç½®</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0.29<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-jpa<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"> <span class="comment">&lt;!-- è¿™ä¸ªæ˜¯å®˜æ–¹çš„mybatisä¾èµ–ï¼Œè¿™ä¸ªä½ ä¸åŠ æ²¡æ³•ç”¨å™» --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- è¿™ä¸ªæ˜¯è‡ªåŠ¨ç”Ÿæˆmapperç­‰çš„ä¾èµ–ï¼Œå¿…é¡»å¾—åŠ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.generator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-generator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--è¿™ä¸ªæ˜¯è‡ªåŠ¨ç”Ÿæˆmapperç­‰çš„ä¾èµ–ï¼Œå¿…é¡»å¾—åŠ  https://mvnrepository.com/artifact/org.mybatis.generator/mybatis-generator-core --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.generator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-generator-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.generator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-generator-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                    <span class="comment">&lt;!--é…ç½®æ–‡ä»¶å­˜æ”¾çš„åœ°å€--&gt;</span></span><br><span class="line">                    <span class="comment">&lt;!--&lt;configurationFile&gt;src/main/resources/mybatis-generator/generatorConfig.xml&lt;/configurationFile&gt;--&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">verbose</span>&gt;</span>true<span class="tag">&lt;/<span class="name">verbose</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">overwrite</span>&gt;</span>true<span class="tag">&lt;/<span class="name">overwrite</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><p> 2.åœ¨application.propertiesé…ç½®æ–‡ä»¶ä¸­è¿›è¡Œæ•°æ®åº“å’Œmybatisæ‰«æçš„é…ç½®</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">spring.datasource.driver-class-name=com.mysql.jdbc.Driver</span><br><span class="line">spring.datasource.url=jdbc:mysql://localhost:3306/yddy?useUnicode=true&amp;characterEncoding=UTF-8&amp;serverTimezone=UTC</span><br><span class="line">spring.datasource.username=root</span><br><span class="line">spring.datasource.password=123456</span><br><span class="line"></span><br><span class="line">mybatis.config-locations=classpath:mybatis-config.xml</span><br><span class="line"># mapperæ–‡ä»¶</span><br><span class="line">mybatis.mapper-locations=classpath:mapper/*.xml #è¿™é‡Œç›´æ¥å†™*ï¼Œå¯¹åé¢è‡ªå®šä¹‰sqlï¼Œç¼–å†™xxxExt.xmlæœ‰å¥½å¤„ï¼Œè‡ªåŠ¨æ‰«æåˆ°è¿™äº›æ–‡ä»¶ï¼Œä¸ç”¨å†æ”¹é…ç½®äº†</span><br><span class="line">mybatis.type-aliases-package=com.dameiweb.learn.model</span><br><span class="line">logging.level.com.dameiweb.learn.dao=debug</span><br><span class="line"></span><br><span class="line">#mybatis.config = mybatis é…ç½®æ–‡ä»¶åç§°</span><br><span class="line">#mybatis.mapperLocations = mapper xml æ–‡ä»¶åœ°å€</span><br><span class="line">#mybatis.typeAliasesPackage = å®ä½“ç±»åŒ…è·¯å¾„</span><br><span class="line">#mybatis.typeHandlersPackage = type handlers å¤„ç†å™¨åŒ…è·¯å¾„</span><br><span class="line">#mybatis.check-config-location = æ£€æŸ¥ mybatis é…ç½®æ˜¯å¦å­˜åœ¨ï¼Œä¸€èˆ¬å‘½åä¸º mybatis-config.xml</span><br><span class="line">#mybatis.executorType = æ‰§è¡Œæ¨¡å¼ã€‚é»˜è®¤æ˜¯ SIMPLE</span><br></pre></td></tr></table></figure><p>3.mybatisçš„é…ç½®å’Œè‡ªåŠ¨ç”Ÿæˆmapperçš„é…ç½®<br>åœ¨resourceç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªgeneratorConfig.xmlå’Œmybatis-config.xmlã€‚å†…å®¹å¦‚ä¸‹ï¼š<br>generatorConfig.xmlå†…å®¹</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE generatorConfiguration</span></span><br><span class="line"><span class="meta">        PUBLIC "-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN"</span></span><br><span class="line"><span class="meta">        "http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">generatorConfiguration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">classPathEntry</span> <span class="attr">location</span>=<span class="string">"C:\Users\nick\.m2\repository/mysql/mysql-connector-java/5.1.46/mysql-connector-java-5.1.46.jar"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context</span> <span class="attr">id</span>=<span class="string">"DB2Tables"</span>    <span class="attr">targetRuntime</span>=<span class="string">"MyBatis3"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">commentGenerator</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suppressDate"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suppressAllComments"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">commentGenerator</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--æ•°æ®åº“é“¾æ¥åœ°å€è´¦å·å¯†ç --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">jdbcConnection</span> <span class="attr">driverClass</span>=<span class="string">"com.mysql.jdbc.Driver"</span> <span class="attr">connectionURL</span>=<span class="string">"jdbc:mysql://localhost:3306/yddy?useUnicode=true&amp;amp;characterEncoding=UTF-8&amp;amp;serverTimezone=UTC"</span> <span class="attr">userId</span>=<span class="string">"root"</span> <span class="attr">password</span>=<span class="string">"123456"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">jdbcConnection</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaTypeResolver</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"forceBigDecimals"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">javaTypeResolver</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--ç”ŸæˆModelç±»å­˜æ”¾ä½ç½®--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaModelGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"com.dameiweb.learn.model"</span> <span class="attr">targetProject</span>=<span class="string">"src/main/java"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"enableSubPackages"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- ä»æ•°æ®åº“è¿”å›çš„å€¼è¢«æ¸…ç†å‰åçš„ç©ºæ ¼ --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"trimStrings"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">javaModelGenerator</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--ç”Ÿæˆæ˜ å°„æ–‡ä»¶å­˜æ”¾ä½ç½®--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">sqlMapGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"mapper"</span> <span class="attr">targetProject</span>=<span class="string">"src/main/resources"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"enableSubPackages"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">sqlMapGenerator</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--ç”ŸæˆDaoç±»å­˜æ”¾ä½ç½®--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- å®¢æˆ·ç«¯ä»£ç ï¼Œç”Ÿæˆæ˜“äºä½¿ç”¨çš„é’ˆå¯¹Modelå¯¹è±¡å’ŒXMLé…ç½®æ–‡ä»¶ çš„ä»£ç </span></span><br><span class="line"><span class="comment">                type="ANNOTATEDMAPPER",ç”ŸæˆJava Model å’ŒåŸºäºæ³¨è§£çš„Mapperå¯¹è±¡</span></span><br><span class="line"><span class="comment">                type="MIXEDMAPPER",ç”ŸæˆåŸºäºæ³¨è§£çš„Java Model å’Œç›¸åº”çš„Mapperå¯¹è±¡</span></span><br><span class="line"><span class="comment">                type="XMLMAPPER",ç”ŸæˆSQLMap XMLæ–‡ä»¶å’Œç‹¬ç«‹çš„Mapperæ¥å£</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaClientGenerator</span> <span class="attr">type</span>=<span class="string">"XMLMAPPER"</span> <span class="attr">targetPackage</span>=<span class="string">"com.dameiweb.learn.dao"</span> <span class="attr">targetProject</span>=<span class="string">"src/main/java"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"enableSubPackages"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">javaClientGenerator</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">    <span class="tag">&lt;/<span class="name">context</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">generatorConfiguration</span>&gt;</span></span><br></pre></td></tr></table></figure><p>mybatis-config.xmlçš„å†…å®¹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE configuration PUBLIC "-//mybatis.org//DTD Config 3.0//EN" "http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"callSettersOnNulls"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"cacheEnabled"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"lazyLoadingEnabled"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"aggressiveLazyLoading"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"multipleResultSetsEnabled"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"useColumnLabel"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"useGeneratedKeys"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"autoMappingBehavior"</span> <span class="attr">value</span>=<span class="string">"PARTIAL"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"defaultExecutorType"</span> <span class="attr">value</span>=<span class="string">"SIMPLE"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"mapUnderscoreToCamelCase"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"localCacheScope"</span> <span class="attr">value</span>=<span class="string">"SESSION"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"jdbcTypeForNull"</span> <span class="attr">value</span>=<span class="string">"NULL"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">alias</span>=<span class="string">"Integer"</span> <span class="attr">type</span>=<span class="string">"java.lang.Integer"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">alias</span>=<span class="string">"Long"</span> <span class="attr">type</span>=<span class="string">"java.lang.Long"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">alias</span>=<span class="string">"HashMap"</span> <span class="attr">type</span>=<span class="string">"java.util.HashMap"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">alias</span>=<span class="string">"LinkedHashMap"</span> <span class="attr">type</span>=<span class="string">"java.util.LinkedHashMap"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">alias</span>=<span class="string">"ArrayList"</span> <span class="attr">type</span>=<span class="string">"java.util.ArrayList"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">alias</span>=<span class="string">"LinkedList"</span> <span class="attr">type</span>=<span class="string">"java.util.LinkedList"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™æ ·æˆ‘ä»¬å°±é…ç½®å¥½äº†Spring Bootå’Œmybatisä¸mybatisè‡ªåŠ¨ç”Ÿæˆmapperå’Œå®ä½“çš„åŠŸèƒ½ã€‚è¿™æ ·æˆ‘ä»¬è¦ç”ŸæˆæŸä¸ªè¡¨çš„å®ä½“å’Œmapperçš„æ—¶å€™ï¼Œåªéœ€è¦åœ¨generatorConfig.xmlä¸­javaClientGeneratoræ ‡ç­¾ä¹‹åæ·»åŠ ä¸‹é¢çš„å†…å®¹å³å¯ã€‚<br>æ­¤å¤„æˆ‘ä»¬å·²yd_moviesè¡¨ä¸ºä¾‹(ä¸»è¦æ•°æ®åº“è¡¨åå­—ä¸è¦ç”¨å¤æ•°ï¼Œè¿™ä¸ªè¡¨åè‚¯å®šæ˜¯æˆ‘ä¹‹å‰è„‘å­æŠ½äº†ï¼Œæä¸ªå¤æ•°çš„åå­—)</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">&lt;!--ç”Ÿæˆå¯¹åº”è¡¨åŠç±»å--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span>  <span class="attr">tableName</span>=<span class="string">"yd_movies"</span> <span class="attr">domainObjectName</span>=<span class="string">"Movie"</span> <span class="attr">enableCountByExample</span>=<span class="string">"false"</span> <span class="attr">enableUpdateByExample</span>=<span class="string">"false"</span></span></span><br><span class="line"><span class="tag">               <span class="attr">enableDeleteByExample</span>=<span class="string">"false"</span> <span class="attr">enableSelectByExample</span>=<span class="string">"false"</span> <span class="attr">selectByExampleQueryId</span>=<span class="string">"false"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">columnOverride</span> <span class="attr">column</span>=<span class="string">"cover_photos"</span> <span class="attr">javaType</span>=<span class="string">"java.lang.String"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">columnOverride</span> <span class="attr">column</span>=<span class="string">"cover_photos_loc"</span> <span class="attr">javaType</span>=<span class="string">"java.lang.String"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">columnOverride</span> <span class="attr">column</span>=<span class="string">"pubdates"</span> <span class="attr">javaType</span>=<span class="string">"java.lang.String"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">columnOverride</span> <span class="attr">column</span>=<span class="string">"photographs_origin"</span> <span class="attr">javaType</span>=<span class="string">"java.lang.String"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">columnOverride</span> <span class="attr">column</span>=<span class="string">"photographs_origin_loc"</span> <span class="attr">javaType</span>=<span class="string">"java.lang.String"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">columnOverride</span> <span class="attr">column</span>=<span class="string">"languages"</span> <span class="attr">javaType</span>=<span class="string">"java.lang.String"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">columnOverride</span> <span class="attr">column</span>=<span class="string">"awards"</span> <span class="attr">javaType</span>=<span class="string">"java.lang.String"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">columnOverride</span> <span class="attr">column</span>=<span class="string">"summary"</span> <span class="attr">javaType</span>=<span class="string">"java.lang.String"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--columnOverrideä½¿ç”¨è¿™ä¸ªæ ‡ç­¾æ˜¯ä¸ºäº†é˜²æ­¢æ•°æ®åº“å­—æ®µç±»å‹ä¸ºtextæ—¶å€™ï¼Œmybatisä¼šç”ŸæˆxxxxWithBLOBsæ–‡ä»¶ã€‚--&gt;</span></span><br></pre></td></tr></table></figure><p>ç„¶åç‚¹å‡»ideaå³ä¾§Maven projectsï¼Œå°±å¯ä»¥çœ‹åˆ°mybatis-generateä¸‹çš„mybatis-generateï¼šgenerateï¼ŒåŒå‡»mybatis-generateï¼šgenerateå³å¯ã€‚</p><p><strong>generator æ³¨æ„ç‚¹ï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯BUG<br>å°±æ˜¯åœ¨ç”Ÿæˆçš„æ—¶å€™ï¼Œåœ¨ç¬¬äºŒæ¬¡ç”Ÿæˆçš„æ—¶å€™ï¼Œdao å’Œentity éƒ½ä¼šç›´æ¥è¦†ç›–ï¼Œè€ŒMapper.xml ä¼šç›´æ¥è¿½åŠ ï¼Œå¯¼è‡´è¿è¡ŒæŠ¥é”™ï¼Œè€Œä¸”å¾ˆéš¾æ‰¾ã€‚</strong></p><p>4.mybatisè‡ªå®šä¹‰sql<br>å½“æˆ‘ä»¬éœ€è¦è‡ªå®šä¹‰sqlçš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸èƒ½æŠŠè¿™äº›ä¹Ÿæ”¾åˆ°mapperæ–‡ä»¶ä¸­ã€‚ä¸ç„¶ï¼Œå½“æ•°æ®åº“è¡¨çš„å­—æ®µæœ‰æ›´æ–°éœ€è¦é‡æ–°ç”Ÿæˆmapperçš„æ—¶å€™ï¼Œè¿™æ ·æˆ‘ä»¬è‡ªå®šä¹‰çš„sqlä¸å°±è¢«è¦†ç›–æ²¡äº†ä¹ˆï¼æ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨MovieMapper.xmlçš„åŒçº§ç›®å½•é‡Œï¼Œæ–°å»ºä¸€ä¸ªMovieMapperExt.xmlæ–‡ä»¶ï¼ŒæŠŠè‡ªå®šä¹‰çš„sqlæ”¾åˆ°è¿™é‡Œï¼Œä¾‹å­å¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">MovieMapperExt.xmlæ–‡ä»¶å†…å®¹</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.dameiweb.learn.dao.MovieMapper"</span> &gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectByCondition"</span>  <span class="attr">resultMap</span>=<span class="string">"BaseResultMap"</span> <span class="attr">parameterType</span>=<span class="string">"com.dameiweb.learn.dto.MovieRequest"</span>&gt;</span></span><br><span class="line">    SELECT yd_movies.* FROM yd_movies</span><br><span class="line">    LEFT JOIN yd_r_movie_countries ON yd_movies.id = yd_r_movie_countries.movie_id</span><br><span class="line">    LEFT JOIN yd_countries cou ON yd_r_movie_countries.country_id = cou.id</span><br><span class="line">    LEFT JOIN yd_r_movie_category ON yd_movies.id = yd_r_movie_category.movie_id</span><br><span class="line">    LEFT JOIN yd_category cat ON yd_r_movie_category.category_id = cat.id</span><br><span class="line">    LEFT JOIN yd_r_movie_actor ON yd_movies.id = yd_r_movie_actor.movie_id</span><br><span class="line">    LEFT JOIN yd_actors a ON yd_r_movie_actor.actor_id = a.id</span><br><span class="line"></span><br><span class="line">    WHERE</span><br><span class="line">    yd_movies.status = 1</span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"movieRequest.title != null"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      AND yd_movies.title LIKE "%"#&#123;movieRequest.title&#125;"%"</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"movieRequest.country != null"</span>&gt;</span></span><br><span class="line">      AND cou.id = #&#123;movieRequest.country&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"movieRequest.category != null"</span>&gt;</span></span><br><span class="line">      AND cat.id = #&#123;movieRequest.category&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"movieRequest.year != null"</span>&gt;</span></span><br><span class="line">      AND year = #&#123;movieRequest.year&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"movieRequest.rate != null"</span>&gt;</span></span><br><span class="line">      AND rate &gt;= #&#123;movieRequest.rate&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"movieRequest.rate != null"</span>&gt;</span></span><br><span class="line">      AND rate &amp;lt; (#&#123;movieRequest.rate&#125;+1)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"movieRequest.subtype != null"</span>&gt;</span></span><br><span class="line">      AND yd_movies.subtype = #&#123;movieRequest.subtype&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    GROUP BY yd_movies.id</span><br><span class="line">    ORDER BY updated_at DESC, year</span><br><span class="line">  <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> spring boot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring Bootæ¡†æ¶ä¸­è¯»å–é…ç½®çš„å‡ ç§æ–¹å¼</title>
      <link href="/post/28da4df8.html"/>
      <url>/post/28da4df8.html</url>
      
        <content type="html"><![CDATA[<p>ç°åœ¨å¼€å‘çš„ä¸»åŠ›è¯­è¨€å·²ç»ä»PHPè½¬å‘Javaï¼Œç›®å‰å‚ä¸æˆ–è´Ÿè´£å…¬å¸çš„å‡ ä¸ªé¡¹ç›®éƒ½æ˜¯ä½¿ç”¨Spring Bootæ¡†æ¶ã€‚ç”¨äº†Javaä¹‹åï¼Œå¯¹æ¯”PHPå°±ä¸€ä¸ªæ„Ÿè§‰ï¼šç¹çï¼ŒJavaæ¯”PHPç¹ççš„å¾ˆï¼ç”±äºè‡ªå·±å¹³æ—¶ä¹Ÿåœ¨åŠªåŠ›å­¦ä¹ Javaä¸­ï¼Œä»Šå¤©è¶ç€æœ‰ç©ºé—²æ¥æ€»ç»“ä¸€ä¸‹Spring Bootä¸­è¯»å–é…ç½®çš„å‡ ç§æ–¹å¼ï¼ŒåŠ æ·±ä¸€ä¸‹è‡ªå·±çš„å°è±¡ã€‚</p><a id="more"></a><p><strong>è¯»å–applicationæ–‡ä»¶</strong><br>åœ¨application.ymlæˆ–è€…propertiesæ–‡ä»¶ä¸­æ·»åŠ ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">info.address=RPC</span><br><span class="line">info.company=Spring</span><br><span class="line">info.degree=high</span><br></pre></td></tr></table></figure><p> 1.@Valueæ³¨è§£è¯»å–æ–¹å¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InfoConfig</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;info.address&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;info.company&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> String company;</span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;info.degree&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> String degree;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getAddress</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAddress</span><span class="params">(String address)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.address = address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getCompany</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> company;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCompany</span><span class="params">(String company)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.company = company;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDegree</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> degree;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDegree</span><span class="params">(String degree)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.degree = degree;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> 2.@ConfigurationPropertiesæ³¨è§£è¯»å–æ–¹å¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ConfigurationProperties</span>(prefix = <span class="string">"info"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InfoConfig</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line">    <span class="keyword">private</span> String company;</span><br><span class="line">    <span class="keyword">private</span> String degree;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getAddress</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAddress</span><span class="params">(String address)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.address = address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getCompany</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> company;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCompany</span><span class="params">(String company)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.company = company;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDegree</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> degree;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDegree</span><span class="params">(String degree)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.degree = degree;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¯»å–æŒ‡å®šæ–‡ä»¶</strong><br>èµ„æºç›®å½•ä¸‹å»ºç«‹config/db-config.properties:</p><p>db.username=root<br>db.password=123456</p><ol><li><p>@PropertySource+@Valueæ³¨è§£è¯»å–æ–¹å¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@PropertySource</span>(value =  &#123;</span><br><span class="line">    <span class="string">"config/db-config.properties"</span>&#125;</span><br><span class="line">)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DBConfig1</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;db.username&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;db.password&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUsername</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUsername</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.username = username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getPassword</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPassword</span><span class="params">(String password)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.password = password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><em>æ³¨æ„ï¼š@PropertySourceä¸æ”¯æŒymlæ–‡ä»¶è¯»å–ã€‚</em></p></li><li><p>@PropertySource+@ConfigurationPropertiesæ³¨è§£è¯»å–æ–¹å¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ConfigurationProperties</span>(prefix = <span class="string">"db"</span>)</span><br><span class="line"><span class="meta">@PropertySource</span>(value = &#123;<span class="string">"config/db-config.properties"</span>&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DBConfig2</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUsername</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUsername</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.username = username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getPassword</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPassword</span><span class="params">(String password)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.password = password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>Environmentè¯»å–æ–¹å¼ </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> Environment environment;</span><br><span class="line"></span><br><span class="line">environment.getProperty(<span class="string">"info.degree"</span>);</span><br></pre></td></tr></table></figure></li></ol><p>ä»ä»¥ä¸Šç¤ºä¾‹æ¥çœ‹ï¼ŒSpring Bootå¯ä»¥é€šè¿‡@PropertySource,@Value,@Environment,@ConfigurationPropertiesçš„ç›¸äº’é…åˆæ¥è¯»å–é…ç½®æ–‡ä»¶çš„å†…å®¹ï¼Œè¯»å–å•ä¸ªçš„é…ç½®Environmentæ— ç–‘æ˜¯æœ€éœ¸é“çš„æ–¹æ³•ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> spring boot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è§£å†³Javaå¼‚å¸¸java.security.InvalidKeyException: Illegal key size</title>
      <link href="/post/4770bec.html"/>
      <url>/post/4770bec.html</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘å…¬å¸å‡†å¤‡å¯¹æ¥é©¬èœ‚çªçš„æ¥å£ï¼Œä»Šå¤©åœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­å‡ºç°äº†ä¸‹é¢çš„é—®é¢˜ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java.security.InvalidKeyException: Illegal key size</span><br></pre></td></tr></table></figure><a id="more"></a><p>é€šè¿‡ä»”ç»†é˜…è¯»é©¬èœ‚çªçš„demoæ—¶å‘ç°ï¼Œä»–ä»¬åœ¨demoé‡Œå†™äº†ä¸‹é¢ä¸€æ®µè¯ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">è¯´æ˜ï¼šå¼‚å¸¸java.security.InvalidKeyException:illegal Key Sizeçš„è§£å†³æ–¹æ¡ˆ</span><br><span class="line">åœ¨å®˜æ–¹ç½‘ç«™ä¸‹è½½JCEæ— é™åˆ¶æƒé™ç­–ç•¥æ–‡ä»¶ï¼ˆJDK7çš„ä¸‹è½½åœ°å€ï¼š</span><br><span class="line">  http://www.oracle.com/technetwork/java/javase/downloads/jce-7-download-432124.html</span><br><span class="line">ä¸‹è½½åè§£å‹ï¼Œå¯ä»¥çœ‹åˆ°local_policy.jarå’ŒUS_export_policy.jarä»¥åŠreadme.txt</span><br><span class="line">å¦‚æœå®‰è£…äº†JREï¼Œå°†ä¸¤ä¸ªjaræ–‡ä»¶æ”¾åˆ°%JRE_HOME%\lib\securityç›®å½•ä¸‹è¦†ç›–åŸæ¥çš„æ–‡ä»¶</span><br><span class="line">å¦‚æœå®‰è£…äº†JDKï¼Œå°†ä¸¤ä¸ªjaræ–‡ä»¶æ”¾åˆ°%JDK_HOME%\jre\lib\securityç›®å½•ä¸‹è¦†ç›–åŸæ¥æ–‡ä»¶</span><br></pre></td></tr></table></figure><p>åæ¥ç™¾åº¦å¾—çŸ¥è¿™é‡Œé¢è¿˜æœ‰å…¶ä»–åŸå› ï¼š<br>å¦‚æœå¯†é’¥å¤§äº128, ä¼šæŠ›å‡ºjava.security.InvalidKeyException: Illegal key size å¼‚å¸¸. å› ä¸ºå¯†é’¥é•¿åº¦æ˜¯å—é™åˆ¶çš„, javaè¿è¡Œæ—¶ç¯å¢ƒè¯»åˆ°çš„æ˜¯å—é™çš„policyæ–‡ä»¶. æ–‡ä»¶ä½äº${java_home}/jre/lib/security, è¿™ç§é™åˆ¶æ˜¯å› ä¸ºç¾å›½å¯¹è½¯ä»¶å‡ºå£çš„æ§åˆ¶.</p><p>ç”±äºç°åœ¨æˆ‘ç”¨çš„æ˜¯Java8ï¼Œæ‰€ä»¥æˆ‘æŠŠè§£å†³åŠæ³•æ•´ç†å¦‚ä¸‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">åœ¨å®˜æ–¹ç½‘ç«™ä¸‹è½½JCEæ— é™åˆ¶æƒé™ç­–ç•¥æ–‡ä»¶</span><br><span class="line">JDK7çš„ä¸‹è½½åœ°å€: http://www.oracle.com/technetwork/java/javase/downloads/jce-7-download-432124.html</span><br><span class="line">JDK8çš„ä¸‹è½½åœ°å€: http://www.oracle.com/technetwork/java/javase/downloads/jce8-download-2133166.html</span><br></pre></td></tr></table></figure><p>ä¸‹è½½åè§£å‹ï¼Œå¯ä»¥çœ‹åˆ°local_policy.jarå’ŒUS_export_policy.jarä»¥åŠreadme.txt<br>å¦‚æœå®‰è£…äº†JREï¼Œå°†ä¸¤ä¸ªjaræ–‡ä»¶æ”¾åˆ°%JRE_HOME%\lib\securityç›®å½•ä¸‹è¦†ç›–åŸæ¥çš„æ–‡ä»¶<br>å¦‚æœå®‰è£…äº†JDKï¼Œè¿˜è¦å°†ä¸¤ä¸ªjaræ–‡ä»¶ä¹Ÿæ”¾åˆ°%JDK_HOME%\jre\lib\securityç›®å½•ä¸‹è¦†ç›–åŸæ¥æ–‡ä»¶</p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä»€ä¹ˆæ˜¯ç¼“å­˜é›ªå´©å’Œç¼“å­˜ç©¿é€</title>
      <link href="/post/d9968bcf.html"/>
      <url>/post/d9968bcf.html</url>
      
        <content type="html"><![CDATA[<p> <strong>1. ç¼“å­˜é›ªå´©</strong></p><p>å¦‚æœç¼“å­˜é›†ä¸­åœ¨ä¸€æ®µæ—¶é—´å†…å¤±æ•ˆï¼Œå‘ç”Ÿå¤§é‡çš„ç¼“å­˜ç©¿é€ï¼Œæ‰€æœ‰çš„æŸ¥è¯¢éƒ½è½åœ¨æ•°æ®åº“ä¸Šï¼Œé€ æˆäº†ç¼“å­˜é›ªå´©ã€‚è¿™ä¸ªæ²¡æœ‰å®Œç¾è§£å†³åŠæ³•ï¼Œä½†å¯ä»¥åˆ†æç”¨æˆ·è¡Œä¸ºï¼Œå°½é‡è®©å¤±æ•ˆæ—¶é—´ç‚¹å‡åŒ€åˆ†å¸ƒã€‚å¤§å¤šæ•°ç³»ç»Ÿè®¾è®¡è€…è€ƒè™‘ç”¨åŠ é”æˆ–è€…é˜Ÿåˆ—çš„æ–¹å¼ä¿è¯ç¼“å­˜çš„å•çº¿ç¨‹ï¼ˆè¿›ç¨‹ï¼‰å†™ï¼Œä»è€Œé¿å…å¤±æ•ˆæ—¶å¤§é‡çš„å¹¶å‘è¯·æ±‚è½åˆ°åº•å±‚å­˜å‚¨ç³»ç»Ÿä¸Šã€‚</p><a id="more"></a><p>è§£å†³åŠæ³•</p><ul><li>åœ¨ç¼“å­˜å¤±æ•ˆåï¼Œé€šè¿‡åŠ é”æˆ–è€…é˜Ÿåˆ—æ¥æ§åˆ¶è¯»æ•°æ®åº“å†™ç¼“å­˜çš„çº¿ç¨‹æ•°é‡ã€‚æ¯”å¦‚å¯¹æŸä¸ªkeyåªå…è®¸ä¸€ä¸ªçº¿ç¨‹æŸ¥è¯¢æ•°æ®å’Œå†™ç¼“å­˜ï¼Œå…¶ä»–çº¿ç¨‹ç­‰å¾…ã€‚</li><li>å¯ä»¥é€šè¿‡ç¼“å­˜reloadæœºåˆ¶ï¼Œé¢„å…ˆå»æ›´æ–°ç¼“å­˜ï¼Œå†å³å°†å‘ç”Ÿå¤§å¹¶å‘è®¿é—®å‰æ‰‹åŠ¨è§¦å‘åŠ è½½ç¼“å­˜ã€‚</li><li>ä¸åŒçš„keyï¼Œè®¾ç½®ä¸åŒçš„è¿‡æœŸæ—¶é—´ï¼Œè®©ç¼“å­˜å¤±æ•ˆçš„æ—¶é—´ç‚¹å°½é‡å‡åŒ€ã€‚</li><li>åšäºŒçº§ç¼“å­˜ï¼Œæˆ–è€…åŒç¼“å­˜ç­–ç•¥ã€‚A1ä¸ºåŸå§‹ç¼“å­˜ï¼ŒA2ä¸ºæ‹·è´ç¼“å­˜ï¼ŒA1å¤±æ•ˆæ—¶ï¼Œå¯ä»¥è®¿é—®A2ï¼ŒA1ç¼“å­˜å¤±æ•ˆæ—¶é—´è®¾ç½®ä¸ºçŸ­æœŸï¼ŒA2è®¾ç½®ä¸ºé•¿æœŸã€‚</li></ul><p> <strong>2. ç¼“å­˜ç©¿é€</strong></p><p>ç¼“å­˜ç©¿é€æ˜¯æŒ‡æŸ¥è¯¢ä¸€ä¸ªä¸€å®šä¸å­˜åœ¨çš„æ•°æ®ï¼Œç”±äºç¼“å­˜æ˜¯ä¸å‘½ä¸­æ—¶éœ€è¦ä»æ•°æ®åº“æŸ¥è¯¢ï¼ŒæŸ¥ä¸åˆ°æ•°æ®åˆ™ä¸å†™å…¥ç¼“å­˜ï¼Œè¿™å°†å¯¼è‡´è¿™ä¸ªä¸å­˜åœ¨çš„æ•°æ®æ¯æ¬¡è¯·æ±‚éƒ½è¦åˆ°æ•°æ®åº“å»æŸ¥è¯¢ï¼Œé€ æˆç¼“å­˜ç©¿é€ã€‚</p><p>è§£å†³åŠæ³•</p><ul><li>å¯¹æ‰€æœ‰å¯èƒ½æŸ¥è¯¢çš„å‚æ•°ä»¥hashå½¢å¼å­˜å‚¨ï¼Œåœ¨æ§åˆ¶å±‚å…ˆè¿›è¡Œæ ¡éªŒï¼Œä¸ç¬¦åˆåˆ™ä¸¢å¼ƒã€‚è¿˜æœ‰æœ€å¸¸è§çš„åˆ™æ˜¯é‡‡ç”¨å¸ƒéš†è¿‡æ»¤å™¨ï¼Œå°†æ‰€æœ‰å¯èƒ½å­˜åœ¨çš„æ•°æ®å“ˆå¸Œåˆ°ä¸€ä¸ªè¶³å¤Ÿå¤§çš„bitmapä¸­ï¼Œä¸€ä¸ªä¸€å®šä¸å­˜åœ¨çš„æ•°æ®ä¼šè¢«è¿™ä¸ªbitmapæ‹¦æˆªæ‰ï¼Œä»è€Œé¿å…äº†å¯¹åº•å±‚å­˜å‚¨ç³»ç»Ÿçš„æŸ¥è¯¢å‹åŠ›ã€‚</li><li>ä¹Ÿå¯ä»¥é‡‡ç”¨ä¸€ä¸ªæ›´ä¸ºç®€å•ç²—æš´çš„æ–¹æ³•ï¼Œå¦‚æœä¸€ä¸ªæŸ¥è¯¢è¿”å›çš„æ•°æ®ä¸ºç©ºï¼ˆä¸ç®¡æ˜¯æ•°æ®ä¸å­˜åœ¨ï¼Œè¿˜æ˜¯ç³»ç»Ÿæ•…éšœï¼‰ï¼Œæˆ‘ä»¬ä»ç„¶æŠŠè¿™ä¸ªç©ºç»“æœè¿›è¡Œç¼“å­˜ï¼Œä½†å®ƒçš„è¿‡æœŸæ—¶é—´ä¼šå¾ˆçŸ­ï¼Œæœ€é•¿ä¸è¶…è¿‡äº”åˆ†é’Ÿã€‚</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> redis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQLä¸­çœŸæ­£æ„ä¹‰ä¸Šçš„UTF8ç¼–ç </title>
      <link href="/post/451d6526.html"/>
      <url>/post/451d6526.html</url>
      
        <content type="html"><![CDATA[<p>æ€»æ‰€å‘¨çŸ¥ï¼Œç›®å‰çš„è½¯ä»¶ä½“ç³»ä¸­è¿ç”¨æœ€å¹¿æ³›çš„æ˜¯Unicodeå­—ç¬¦é›†ï¼Œè€Œå…¶ä¸­è¿ç”¨æœ€å¤šçš„ç¼–ç è§„åˆ™å°±æ˜¯UTF-8ã€‚ç”¨UTF-8æœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿç®€å•çš„æ¥è¯´æœ‰ä¸€ä¸‹å‡ ç§å¥½å¤„ï¼š</p><ol><li>ä¹±ç ä¸ä¼šæ‰©æ•£, GB2312åœ¨ä¸¢å¤±ä¸€å­—èŠ‚ç­‰æƒ…å†µä¸‹ä¼šé€ æˆåç»­æ‰€æœ‰æ–‡å­—å˜æˆä¹±ç ã€‚</li><li>ä¸ä¼šäº§ç”Ÿé”™è¯¯çš„æœç´¢ç»“æœ, GB2312åœ¨æœç´¢çš„æ—¶å€™ç›¸é‚»ä¸¤ä¸ªä¸­æ–‡ä¼šæ‹¼å‡ºä¸€ä¸ªæ–°çš„å­—ç¬¦ï¼Œå¯¼è‡´å‡ºç°é”™è¯¯çš„æœç´¢ç»“æœã€‚</li><li>æ›´å¤§çš„å­—ç¬¦é›†ã€‚</li><li>å¾ˆå¤šè¯­è¨€ç›´æ¥æ”¯æŒ UTF-8ï¼Œéƒ¨åˆ†è¯­è¨€å­˜å‚¨å­—ç¬¦ä¸²åˆ°å†…å­˜æ—¶ç›´æ¥ä½¿ç”¨UTF-8ç¼–ç ã€‚</li><li>ä¸ GB2312/GB18030ç›¸æ¯”, UTF-8æ˜¯ä¸€ä¸ªé€šç”¨è§£å†³æ–¹æ¡ˆã€‚</li><li>Unicode ä¸€ç›´æœ‰äººç»´æŠ¤ï¼Œè€Œ GB18030 ä¸‹ä¸€æ¬¡æ›´æ–°ä¸çŸ¥é“ä¼šæ˜¯ä»€ä¹ˆæ—¶å€™äº†ã€‚å¦å¯¹äºä¸­æ–‡, UTF-8å’ŒGB2312åœ¨gzipå‹ç¼©åéƒ½å·®ä¸å¤šï¼Œæ‰€ä»¥ç”¨æ¥åšç½‘é¡µå¯¹å¸¦å®½å½±å“å¾ˆå°ã€‚<a id="more"></a>MySQLä¸­ä¹Ÿæœ‰UTF-8ç¼–ç ï¼Œä»–è¿˜æœ‰å¦å¤–ä¸€ä¸ªç§°å‘¼å«åšutf8mb3ï¼Œè¯¥å­—ç¬¦é›†æ¯ä¸ªå­—ç¬¦æœ€å¤šä½¿ç”¨ä¸‰ä¸ªå­—èŠ‚ã€‚ä¸‰ä¸ªå­—èŠ‚çš„UTF-8æœ€å¤§èƒ½ç¼–ç çš„ Unicodeå­—ç¬¦æ˜¯0xffffï¼Œä¹Ÿå°±æ˜¯Unicodeä¸­çš„åŸºæœ¬å¤šæ–‡ç§å¹³é¢ï¼ˆBMPï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä»»ä½•ä¸åœ¨åŸºæœ¬å¤šæ–‡æœ¬å¹³é¢çš„ Unicodeå­—ç¬¦ï¼Œéƒ½æ— æ³•ä½¿ç”¨MySQLçš„UTF-8ç¼–ç å­˜å‚¨ã€‚åŒ…æ‹¬Emojiè¡¨æƒ…ï¼ˆEmojiæ˜¯ä¸€ç§ç‰¹æ®Šçš„Unicode ç¼–ç ï¼Œå¸¸è§äºioså’Œ androidæ‰‹æœºä¸Šï¼‰ï¼Œå’Œå¾ˆå¤šä¸å¸¸ç”¨çš„æ±‰å­—ï¼Œä»¥åŠä»»ä½•æ–°å¢çš„ Unicodeå­—ç¬¦ç­‰ç­‰ã€‚è¿™æ ·çš„è¯å°±ä¼šå‡ºç°ä¸€äº›ç‰¹æ®Šå­—ç¬¦æ— æ³•ä¿å­˜åˆ°MySQLä¸­ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥è§£å†³è¿™ä¸ªç¼–ç çš„é—®é¢˜ï¼</li></ol><p>éšç€Unicodeçš„å­—ç¬¦é›†çš„è§„èŒƒç¡®å®šï¼Œä»¥åŠä»–çš„å¹¿æ³›åº”ç”¨ï¼ŒMySQLå®˜æ–¹è‡ªå·±ä¹Ÿå‘ç°äº†è¿™ä¸ªé—®é¢˜ï¼Œäºæ˜¯ä¹å®˜æ–¹åœ¨MySQL5.5.3çš„æ—¶å€™æ¨å‡ºäº†utf8mb4ç¼–ç ï¼Œï¼ˆä»–æ‰æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„UTF-8ç¼–ç ï¼‰mb4å°±æ˜¯most bytes 4çš„æ„æ€ï¼Œä¸“é—¨ç”¨æ¥å…¼å®¹å››å­—èŠ‚çš„unicodeã€‚utf8mb4æ˜¯utf8çš„è¶…é›†ï¼Œé™¤äº†å°†ç¼–ç æ”¹ä¸ºutf8mb4å¤–ä¸éœ€è¦åšå…¶ä»–è½¬æ¢ã€‚</p><p>å¯¹äºæ–°å¢çš„utf8mb4ç¼–ç å®˜æ–¹æœ‰ä¸ªå°å»ºè®®å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Tip: To save space with utf8mb4, use VARCHAR instead of CHAR. Otherwise, MySQL must reserve four bytes <span class="keyword">for</span> each character <span class="keyword">in</span> a CHAR CHARACTER SET utf8mb4 column because that is the maximum possible length. For example, MySQL must reserve 40 bytes <span class="keyword">for</span> a CHAR(10) CHARACTER SET utf8mb4 column.</span><br><span class="line">å¤§æ„å¦‚ä¸‹ï¼š</span><br><span class="line">ä¸ºäº†èŠ‚çœç©ºé—´ utf8mb4ï¼Œè¯·ä½¿ç”¨ VARCHARè€Œä¸æ˜¯CHARã€‚å¦åˆ™ï¼ŒMySQLå¿…é¡»ä¸ºCHAR CHARACTER SET utf8mb4åˆ—ä¸­çš„æ¯ä¸ªå­—ç¬¦ä¿ç•™å››ä¸ªå­—èŠ‚ï¼Œå› ä¸ºè¿™æ˜¯æœ€å¤§å¯èƒ½çš„é•¿åº¦ã€‚ä¾‹å¦‚ï¼ŒMySQLå¿…é¡»ä¸ºä¸€CHAR(10) CHARACTER SET utf8mb4 åˆ—ä¿ç•™40ä¸ªå­—èŠ‚ã€‚</span><br></pre></td></tr></table></figure><p>é‚£å¦‚ä½•è®¾ç½®MySQLçš„ç¼–ç å‘¢ï¼Ÿ</p><ol><li><p>æŸ¥çœ‹æ•°æ®åº“æœåŠ¡å™¨çš„ç‰ˆæœ¬ï¼Œä½äº5.5.3åˆ™ä¸æ”¯æŒutf8mb4ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">select VERSION();</span><br><span class="line"></span><br><span class="line">+-----------+</span><br><span class="line">| VERSION() |</span><br><span class="line">+-----------+</span><br><span class="line">| 5.5.53    |</span><br><span class="line">+-----------+</span><br></pre></td></tr></table></figure></li><li><p>æŸ¥çœ‹æ•°æ®åº“çš„ç¼–ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show variables like &apos;character%&apos;;</span><br><span class="line"></span><br><span class="line">+--------------------------+-----------------------------------+</span><br><span class="line">| Variable_name            | Value                             |</span><br><span class="line">+--------------------------+-----------------------------------+</span><br><span class="line">| character_set_client     | utf8                              |</span><br><span class="line">| character_set_connection | utf8                              |</span><br><span class="line">| character_set_database   | utf8                              |</span><br><span class="line">| character_set_filesystem | binary                            |</span><br><span class="line">| character_set_results    | utf8                              |</span><br><span class="line">| character_set_server     | utf8                              |</span><br><span class="line">| character_set_system     | utf8                              |</span><br><span class="line">| character_sets_dir       | C:\phpStudy\MySQL\share\charsets\ |</span><br><span class="line">+--------------------------+-----------------------------------+</span><br></pre></td></tr></table></figure><p>å°†ä¸Šè¿°utf8å…¨éƒ¨ä¿®æ”¹æˆutf8mb4ï¼Œç¼–è¾‘mysqlçš„é…ç½®æ–‡ä»¶/etc/my.cnfï¼ˆå…·ä½“è¿˜å¯ä»¥å‚ç…§æ–‡ç« <a href="https://www.ydstudio.net/archives/25.html" target="_blank" rel="noopener">Centos6.9ä¸Šæ­å»ºlnmpç¯å¢ƒ</a>ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/my.cnf</span><br><span class="line"></span><br><span class="line">[mysqld]</span><br><span class="line">character-set-server=utf8mb4 </span><br><span class="line">collation-server=utf8_general_ci </span><br><span class="line">sql_mode=<span class="string">'NO_ENGINE_SUBSTITUTION'</span></span><br><span class="line"></span><br><span class="line">[mysql]</span><br><span class="line">default-character-set = utf8mb4</span><br><span class="line"></span><br><span class="line">[mysql.server]</span><br><span class="line">default-character-set = utf8mb4</span><br><span class="line"></span><br><span class="line">[mysqld_safe]</span><br><span class="line">default-character-set = utf8mb4</span><br><span class="line"></span><br><span class="line">[client]</span><br><span class="line">default-character-set = utf8mb4</span><br><span class="line"></span><br><span class="line"><span class="comment">#é‡å¯mysql</span></span><br><span class="line">service mysqld restart</span><br><span class="line"></span><br><span class="line"><span class="comment">#å†æ¬¡æŸ¥çœ‹</span></span><br><span class="line">mysql&gt; show variables like <span class="string">'character%'</span>;</span><br><span class="line">+--------------------------+-----------------------------------+</span><br><span class="line">| Variable_name            | Value                             |</span><br><span class="line">+--------------------------+-----------------------------------+</span><br><span class="line">| character_set_client     | utf8mb4                           |</span><br><span class="line">| character_set_connection | utf8mb4                           |</span><br><span class="line">| character_set_database   | utf8mb4                           |</span><br><span class="line">| character_set_filesystem | binary                            |</span><br><span class="line">| character_set_results    | utf8mb4                           |</span><br><span class="line">| character_set_server     | utf8mb4                           |</span><br><span class="line">| character_set_system     | utf8mb4                           |</span><br><span class="line">| character_sets_dir       | C:\phpStudy\MySQL\share\charsets\ |</span><br><span class="line">+--------------------------+-----------------------------------+</span><br></pre></td></tr></table></figure><p>è¿™æ ·æˆ‘ä»¬çš„æ•°æ®åº“å°±ç¼–ç å°±å…¨éƒ½è®¾ç½®æˆäº†utf8mb4,ä¸€äº›ç‰¹æ®Šçš„ä¸­æ–‡å­—ç¬¦å’ŒEmojiè¡¨æƒ…ç¬¦å°±å¯ä»¥æˆåŠŸçš„ä¿å­˜åœ¨æ•°æ®åº“ä¸­äº†</p></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHPå¦‚ä½•é€šè¿‡å¼€å¯Opcacheæ¥æé«˜æ€§èƒ½</title>
      <link href="/post/924aacb8.html"/>
      <url>/post/924aacb8.html</url>
      
        <content type="html"><![CDATA[<p>åœ¨å¼€å¯Opcacheä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯Opcache:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">OPcache é€šè¿‡å°† PHP è„šæœ¬é¢„ç¼–è¯‘çš„å­—èŠ‚ç å­˜å‚¨åˆ°å…±äº«å†…å­˜ä¸­æ¥æå‡ PHP çš„æ€§èƒ½ï¼Œ å­˜å‚¨é¢„ç¼–è¯‘å­—èŠ‚ç çš„å¥½å¤„å°±æ˜¯ çœå»äº†æ¯æ¬¡åŠ è½½å’Œè§£æ PHP è„šæœ¬çš„å¼€é”€ã€‚</span><br><span class="line">PHP 5.5.0 åŠåç»­ç‰ˆæœ¬ä¸­å·²ç»ç»‘å®šäº† OPcache æ‰©å±•ã€‚ å¯¹äº PHP 5.2ï¼Œ5.3 å’Œ 5.4 ç‰ˆæœ¬å¯ä»¥ä½¿ç”¨ Â» PECL æ‰©å±•ä¸­çš„ OPcache åº“ã€‚</span><br></pre></td></tr></table></figure><a id="more"></a><p>ä¸‹é¢æ¥è¯´è¯´å¦‚ä½•å®‰è£…Opcache,ä¸åŒçš„PHPç‰ˆæœ¬å®‰è£…çš„æ–¹æ³•ç¨æœ‰ä¸åŒï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">OPcache åªèƒ½ç¼–è¯‘ä¸ºå…±äº«æ‰©å±•ã€‚ å¦‚æœä½ ä½¿ç”¨ --<span class="built_in">disable</span>-all å‚æ•° ç¦ç”¨äº†é»˜è®¤æ‰©å±•çš„æ„å»ºï¼Œ é‚£ä¹ˆå¿…é¡»ä½¿ç”¨ --<span class="built_in">enable</span>-opcache é€‰é¡¹æ¥å¼€å¯ OPcacheã€‚</span><br><span class="line">ç¼–è¯‘ä¹‹åï¼Œå°±å¯ä»¥ä½¿ç”¨ zend_extension æŒ‡ä»¤æ¥å°† OPcache æ‰©å±•åŠ è½½åˆ° PHP ä¸­ã€‚åœ¨é Windows å¹³å°ä½¿ç”¨ zend_extension=/full/path/to/opcache.soï¼Œ</span><br><span class="line">Windowså¹³å°ä½¿ç”¨ zend_extension=C:\path\to\php_opcache.dll</span><br><span class="line"></span><br><span class="line">PHP 5.2,5.3å’Œ 5.4ç‰ˆæœ¬ä¸­æ²¡æœ‰å’ŒPHPæ†ç»‘ï¼Œéœ€è¦è‡ªè¡Œå®‰è£…ï¼Œè¿™é‡Œä¸åšè¯´æ˜ã€‚</span><br></pre></td></tr></table></figure><p>å®˜æ–¹å‡ºäº†ä¸€ä¸ªæ¨èé…ç½®å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ä½¿ç”¨ä¸‹åˆ—æ¨èè®¾ç½®æ¥è·å¾—è¾ƒå¥½çš„ æ€§èƒ½ï¼š</span><br><span class="line"></span><br><span class="line">opcache.memory_consumption=128</span><br><span class="line">opcache.interned_strings_buffer=8</span><br><span class="line">opcache.max_accelerated_files=4000</span><br><span class="line">opcache.revalidate_freq=60</span><br><span class="line">opcache.fast_shutdown=1</span><br><span class="line">opcache.enable_cli=1</span><br><span class="line">ä½ ä¹Ÿå¯ä»¥ç¦ç”¨ opcache.save_comments å¹¶ä¸”å¯ç”¨ opcache.enable_file_overrideã€‚ éœ€è¦æé†’çš„æ˜¯ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ä¸Šè¿°é…ç½®ä¹‹å‰ï¼Œå¿…é¡»ç»è¿‡ä¸¥æ ¼æµ‹è¯•ã€‚ å› ä¸ºä¸Šè¿°é…ç½®å­˜åœ¨ä¸€ä¸ªå·²çŸ¥é—®é¢˜ï¼Œå®ƒä¼šå¼•å‘ä¸€äº›æ¡†æ¶å’Œåº”ç”¨çš„å¼‚å¸¸ï¼Œ å°¤å…¶æ˜¯åœ¨å­˜åœ¨æ–‡æ¡£ä½¿ç”¨äº†å¤‡æ³¨æ³¨è§£çš„æ—¶å€™ã€‚</span><br></pre></td></tr></table></figure><p><strong>é…ç½®æ‰©å±•çš„æ—¶å€™æ³¨æ„ä»¥ä¸‹é—®é¢˜</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">åœ¨php.iniä¸­å¢åŠ opcacheæ—¶éœ€è¦ä½¿ç”¨zend_extensionï¼Œè€Œä¸æ˜¯extensionï¼Œä¸ç„¶ä¼šå¾—åˆ°ä»¥ä¸‹WARNING</span><br><span class="line"></span><br><span class="line">PHP Warning: PHP Startup: Invalid library (appears to be a Zend Extension, try loading using zend_extension=opcache.so from php.ini) <span class="keyword">in</span> Unknown on line 0</span><br></pre></td></tr></table></figure><p>ç”±äºæˆ‘è‡ªå·±çš„æœåŠ¡å™¨å®‰è£…çš„PHP7ï¼Œå·²ç»å®‰è£…äº†Opcacheï¼Œæ‰€ä»¥æˆ‘åªéœ€åœ¨php.iniæ–‡ä»¶ä¸­é…ç½®ä»¥ä¸‹å†…å®¹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">zend_extension=/usr/local/php/lib/php/extensions/no-debug-non-zts-20151012/opcache.so</span><br><span class="line"></span><br><span class="line">[opcache]</span><br><span class="line"></span><br><span class="line">;å¼€å…³æ‰“å¼€</span><br><span class="line">opcache.enable=1</span><br><span class="line">;è®¾ç½®å…±äº«å†…å­˜å¤§å°, å•ä½ä¸ºï¼šMb</span><br><span class="line">opcache.memory_consumption=128</span><br><span class="line">opcache.interned_strings_buffer=8</span><br><span class="line">opcache.max_accelerated_files=4000</span><br><span class="line">opcache.revalidate_freq=60</span><br><span class="line">opcache.fast_shutdown=1</span><br><span class="line">opcache.enable_cli=1</span><br><span class="line"></span><br><span class="line">æœ¬æ¬¡æ¶‰åŠåˆ°çš„æœ‰ä¸¤ä¸ªå‚æ•°</span><br><span class="line"></span><br><span class="line">revalidate_freqï¼Œé»˜è®¤2</span><br><span class="line">æ£€æŸ¥è„šæœ¬æ—¶é—´æˆ³æ˜¯å¦æœ‰æ›´æ–°çš„å‘¨æœŸï¼Œä»¥ç§’ä¸ºå•ä½ã€‚ è®¾ç½®ä¸º 0 ä¼šå¯¼è‡´é’ˆå¯¹æ¯ä¸ªè¯·æ±‚ï¼Œ OPcache éƒ½ä¼šæ£€æŸ¥è„šæœ¬æ›´æ–°</span><br><span class="line"></span><br><span class="line">validate_timestampsï¼Œé»˜è®¤1</span><br><span class="line">å¦‚æœå¯ç”¨ï¼Œé‚£ä¹ˆ OPcache ä¼šæ¯éš” opcache.revalidate_freq è®¾å®šçš„ç§’æ•° æ£€æŸ¥è„šæœ¬æ˜¯å¦æ›´æ–°ã€‚ å¦‚æœç¦ç”¨æ­¤é€‰é¡¹ï¼Œä½ å¿…é¡»ä½¿ç”¨ opcache_reset() æˆ–è€… opcache_invalidate() å‡½æ•°æ¥æ‰‹åŠ¨é‡ç½® OPcacheï¼Œä¹Ÿå¯ä»¥ é€šè¿‡é‡å¯ Web æœåŠ¡å™¨æ¥ä½¿æ–‡ä»¶ç³»ç»Ÿæ›´æ”¹ç”Ÿæ•ˆã€‚</span><br></pre></td></tr></table></figure><p><strong>æœ€åé‡å¯Nginxå’ŒPHPå³å¯</strong></p><p>ä¸‹é¢æ˜¯OPcache å¯ç”¨çš„é…ç½®æŒ‡ä»¤å®Œæ•´åˆ—è¡¨ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line">; Determines <span class="keyword">if</span> Zend OPCache is enabled</span><br><span class="line">;opcache.enable=0</span><br><span class="line"></span><br><span class="line">; Determines <span class="keyword">if</span> Zend OPCache is enabled <span class="keyword">for</span> the CLI version of PHP</span><br><span class="line">;opcache.enable_cli=0</span><br><span class="line"></span><br><span class="line">; The OPcache shared memory storage size.</span><br><span class="line">;opcache.memory_consumption=64</span><br><span class="line"></span><br><span class="line">; The amount of memory <span class="keyword">for</span> interned strings <span class="keyword">in</span> Mbytes.</span><br><span class="line">;opcache.interned_strings_buffer=4</span><br><span class="line"></span><br><span class="line">; The maximum number of keys (scripts) <span class="keyword">in</span> the OPcache <span class="built_in">hash</span> table.</span><br><span class="line">; Only numbers between 200 and 1000000 are allowed.</span><br><span class="line">;opcache.max_accelerated_files=2000</span><br><span class="line"></span><br><span class="line">; The maximum percentage of <span class="string">"wasted"</span> memory until a restart is scheduled.</span><br><span class="line">;opcache.max_wasted_percentage=5</span><br><span class="line"></span><br><span class="line">; When this directive is enabled, the OPcache appends the current working</span><br><span class="line">; directory to the script key, thus eliminating possible collisions between</span><br><span class="line">; files with the same name (basename). Disabling the directive improves</span><br><span class="line">; performance, but may <span class="built_in">break</span> existing applications.</span><br><span class="line">;opcache.use_cwd=1</span><br><span class="line"></span><br><span class="line">; When disabled, you must reset the OPcache manually or restart the</span><br><span class="line">; webserver <span class="keyword">for</span> changes to the filesystem to take effect.</span><br><span class="line">;opcache.validate_timestamps=1</span><br><span class="line"></span><br><span class="line">; How often (<span class="keyword">in</span> seconds) to check file timestamps <span class="keyword">for</span> changes to the shared</span><br><span class="line">; memory storage allocation. (<span class="string">"1"</span> means validate once per second, but only</span><br><span class="line">; once per request. <span class="string">"0"</span> means always validate)</span><br><span class="line">;opcache.revalidate_freq=2</span><br><span class="line"></span><br><span class="line">; Enables or disables file search <span class="keyword">in</span> include_path optimization</span><br><span class="line">;opcache.revalidate_path=0</span><br><span class="line"></span><br><span class="line">; If disabled, all PHPDoc comments are dropped from the code to reduce the</span><br><span class="line">; size of the optimized code.</span><br><span class="line">;opcache.save_comments=1</span><br><span class="line"></span><br><span class="line">; If enabled, a fast shutdown sequence is used <span class="keyword">for</span> the accelerated code</span><br><span class="line">; Depending on the used Memory Manager this may cause some incompatibilities.</span><br><span class="line">;opcache.fast_shutdown=0</span><br><span class="line"></span><br><span class="line">; Allow file existence override (file_exists, etc.) performance feature.</span><br><span class="line">;opcache.enable_file_override=0</span><br><span class="line"></span><br><span class="line">; A bitmask, <span class="built_in">where</span> each bit enables or disables the appropriate OPcache</span><br><span class="line">; passes</span><br><span class="line">;opcache.optimization_level=0xffffffff</span><br><span class="line"></span><br><span class="line">;opcache.inherited_hack=1</span><br><span class="line">;opcache.dups_fix=0</span><br><span class="line"></span><br><span class="line">; The location of the OPcache blacklist file (wildcards allowed).</span><br><span class="line">; Each OPcache blacklist file is a text file that holds the names of files</span><br><span class="line">; that should not be accelerated. The file format is to add each filename</span><br><span class="line">; to a new line. The filename may be a full path or just a file prefix</span><br><span class="line">; (i.e., /var/www/x  blacklists all the files and directories <span class="keyword">in</span> /var/www</span><br><span class="line">; that start with <span class="string">'x'</span>). Line starting with a ; are ignored (comments).</span><br><span class="line">;opcache.blacklist_filename=</span><br><span class="line"></span><br><span class="line">; Allows exclusion of large files from being cached. By default all files</span><br><span class="line">; are cached.</span><br><span class="line">;opcache.max_file_size=0</span><br><span class="line"></span><br><span class="line">; Check the cache checksum each N requests.</span><br><span class="line">; The default value of <span class="string">"0"</span> means that the checks are disabled.</span><br><span class="line">;opcache.consistency_checks=0</span><br><span class="line"></span><br><span class="line">; How long to <span class="built_in">wait</span> (<span class="keyword">in</span> seconds) <span class="keyword">for</span> a scheduled restart to begin <span class="keyword">if</span> the cache</span><br><span class="line">; is not being accessed.</span><br><span class="line">;opcache.force_restart_timeout=180</span><br><span class="line"></span><br><span class="line">; OPcache error_log file name. Empty string assumes <span class="string">"stderr"</span>.</span><br><span class="line">;opcache.error_log=</span><br><span class="line"></span><br><span class="line">; All OPcache errors go to the Web server <span class="built_in">log</span>.</span><br><span class="line">; By default, only fatal errors (level 0) or errors (level 1) are logged.</span><br><span class="line">; You can also <span class="built_in">enable</span> warnings (level 2), info messages (level 3) or</span><br><span class="line">; debug messages (level 4).</span><br><span class="line">;opcache.log_verbosity_level=1</span><br><span class="line"></span><br><span class="line">; Preferred Shared Memory back-end. Leave empty and <span class="built_in">let</span> the system decide.</span><br><span class="line">;opcache.preferred_memory_model=</span><br><span class="line"></span><br><span class="line">; Protect the shared memory from unexpected writing during script execution.</span><br><span class="line">; Useful <span class="keyword">for</span> internal debugging only.</span><br><span class="line">;opcache.protect_memory=0</span><br><span class="line"></span><br><span class="line">; Allows calling OPcache API <span class="built_in">functions</span> only from PHP scripts <span class="built_in">which</span> path is</span><br><span class="line">; started from specified string. The default <span class="string">""</span> means no restriction</span><br><span class="line">;opcache.restrict_api=</span><br><span class="line"></span><br><span class="line">; Mapping base of shared memory segments (<span class="keyword">for</span> Windows only). All the PHP</span><br><span class="line">; processes have to map shared memory into the same address space. This</span><br><span class="line">; directive allows to manually fix the <span class="string">"Unable to reattach to base address"</span></span><br><span class="line">; errors.</span><br><span class="line">;opcache.mmap_base=</span><br><span class="line"></span><br><span class="line">; Enables and sets the second level cache directory.</span><br><span class="line">; It should improve performance when SHM memory is full, at server restart or</span><br><span class="line">; SHM reset. The default <span class="string">""</span> disables file based caching.</span><br><span class="line">;opcache.file_cache=</span><br><span class="line"></span><br><span class="line">; Enables or disables opcode caching <span class="keyword">in</span> shared memory.</span><br><span class="line">;opcache.file_cache_only=0</span><br><span class="line"></span><br><span class="line">; Enables or disables checksum validation when script loaded from file cache.</span><br><span class="line">;opcache.file_cache_consistency_checks=1</span><br><span class="line"></span><br><span class="line">; Implies opcache.file_cache_only=1 <span class="keyword">for</span> a certain process that failed to</span><br><span class="line">; reattach to the shared memory (<span class="keyword">for</span> Windows only). Explicitly enabled file</span><br><span class="line">; cache is required.</span><br><span class="line">;opcache.file_cache_fallback=1</span><br><span class="line"></span><br><span class="line">; Enables or disables copying of PHP code (text segment) into HUGE PAGES.</span><br><span class="line">; This should improve performance, but requires appropriate OS configuration.</span><br><span class="line">;opcache.huge_code_pages=0</span><br><span class="line"></span><br><span class="line">; Validate cached file permissions.</span><br><span class="line">; opcache.validate_permission=0</span><br><span class="line"></span><br><span class="line">; Prevent name collisions <span class="keyword">in</span> chroot<span class="string">'ed environment.</span></span><br><span class="line"><span class="string">; opcache.validate_root=0</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring Bootçš„ä¸‰ç§å¯åŠ¨æ–¹å¼</title>
      <link href="/post/9de93e14.html"/>
      <url>/post/9de93e14.html</url>
      
        <content type="html"><![CDATA[<p>Spring Bootæœ‰ä»¥ä¸‹ä¸‰ç§å¯åŠ¨æ–¹å¼ï¼Œæœ€åä¸€ç§æˆ‘ä»¬å¯ä»¥å¾ˆå¥½çš„è®¾ç½®ä¸åŒç¯å¢ƒä½¿ç”¨ä¸åŒçš„é…ç½®æ–‡ä»¶ã€‚</p><p>1.IDE è¿è¡ŒApplicationè¿™ä¸ªç±»çš„mainæ–¹æ³•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">package com.dameiweb.girl;</span><br><span class="line"></span><br><span class="line">import org.springframework.boot.SpringApplication;</span><br><span class="line">import org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"></span><br><span class="line">@SpringBootApplication</span><br><span class="line">public class GirlApplication &#123;</span><br><span class="line"></span><br><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">SpringApplication.run(GirlApplication.class, args);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><a id="more"></a><p>2.åœ¨springbootçš„åº”ç”¨çš„æ ¹ç›®å½•ä¸‹è¿è¡Œmvn spring-boot:run</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">$ mvn spring-boot:run</span><br><span class="line">[INFO] Scanning <span class="keyword">for</span> projects...</span><br><span class="line">Downloading: http://maven.aliyun.com/nexus/content/groups/public/org/apache/maven/plugins/maven-help-plugin/2.2/maven-help-plugin-2.2.pom</span><br><span class="line">Downloaded: http://maven.aliyun.com/nexus/content/groups/public/org/apache/maven/plugins/maven-help-plugin/2.2/maven-help-plugin-2.2.pom (0 B at 0 B/s)</span><br><span class="line">Downloading: http://maven.aliyun.com/nexus/content/groups/public/org/apache/maven/plugins/maven-help-plugin/2.2/maven-help-plugin-2.2.jar</span><br><span class="line">Downloaded: http://maven.aliyun.com/nexus/content/groups/public/org/apache/maven/plugins/maven-help-plugin/2.2/maven-help-plugin-2.2.jar (0 B at 0 B/s)</span><br><span class="line">Downloading: http://maven.aliyun.com/nexus/content/groups/public/org/codehaus/codehaus-parent/3/codehaus-parent-3.pom</span><br><span class="line">Downloaded: http://maven.aliyun.com/nexus/content/groups/public/org/codehaus/codehaus-parent/3/codehaus-parent-3.pom (0 B at 0 B/s)</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[INFO] Building girl 0.0.1-SNAPSHOT</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] &gt;&gt;&gt; spring-boot-maven-plugin:1.5.9.RELEASE:run (default-cli) &gt; <span class="built_in">test</span>-compile @ girl &gt;&gt;&gt;</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] --- maven-resources-plugin:2.6:resources (default-resources) @ girl ---</span><br><span class="line">[INFO] Using <span class="string">'UTF-8'</span> encoding to copy filtered resources.</span><br><span class="line">[INFO] Copying 3 resources</span><br><span class="line">[INFO] Copying 0 resource</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] --- maven-compiler-plugin:3.1:compile (default-compile) @ girl ---</span><br><span class="line">[INFO] Nothing to compile - all classes are up to date</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] --- maven-resources-plugin:2.6:testResources (default-testResources) @ girl ---</span><br><span class="line">[INFO] Using <span class="string">'UTF-8'</span> encoding to copy filtered resources.</span><br><span class="line">[INFO] skip non existing resourceDirectory D:\work\girl\src\<span class="built_in">test</span>\resources</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] --- maven-compiler-plugin:3.1:testCompile (default-testCompile) @ girl ---</span><br><span class="line">[INFO] Nothing to compile - all classes are up to date</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] &lt;&lt;&lt; spring-boot-maven-plugin:1.5.9.RELEASE:run (default-cli) &lt; <span class="built_in">test</span>-compile @ girl &lt;&lt;&lt;</span><br><span class="line">[INFO]</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] --- spring-boot-maven-plugin:1.5.9.RELEASE:run (default-cli) @ girl ---</span><br></pre></td></tr></table></figure><p>3.åœ¨springbootçš„åº”ç”¨çš„æ ¹ç›®å½•ä¸‹ mvn install ç”Ÿæˆjaråè¿è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">å…ˆæ‰§è¡Œ mvn install</span><br><span class="line">å†æ‰§è¡Œ java -jar target/girl-0.0.1-SNAPSHOT.jar --spring.profile.active=prod</span><br><span class="line"></span><br><span class="line">java -jar target/girl-0.0.1-SNAPSHOT.jar --spring.profile.active=prod</span><br><span class="line"></span><br><span class="line">  .   ____          _            __ _ _</span><br><span class="line"> /\\ / ___<span class="string">'_ __ _ _(_)_ __  __ _ \ \ \ \</span></span><br><span class="line"><span class="string">( ( )\___ | '</span>_ | <span class="string">'_| | '</span>_ \/ _` | \ \ \ \</span><br><span class="line"> \\/  ___)| |_)| | | | | || (_| |  ) ) ) )</span><br><span class="line">  <span class="string">'  |____| .__|_| |_|_| |_\__, | / / / /</span></span><br><span class="line"><span class="string"> =========|_|==============|___/=/_/_/_/</span></span><br><span class="line"><span class="string"> :: Spring Boot ::        (v1.5.9.RELEASE)</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> spring boot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaé‡Œæœ‰å“ªäº›è¯­æ³•ç³–</title>
      <link href="/post/1f95052d.html"/>
      <url>/post/1f95052d.html</url>
      
        <content type="html"><![CDATA[<p>è¯­æ³•ç³–ï¼ˆSyntactic Sugarï¼‰ï¼Œä¹Ÿç§°ç³–è¡£è¯­æ³•ï¼ŒæŒ‡åœ¨è®¡ç®—æœºè¯­è¨€ä¸­æ·»åŠ çš„æŸç§è¯­æ³•ï¼Œè¿™ç§è¯­æ³•å¯¹è¯­è¨€æœ¬èº«åŠŸèƒ½æ¥è¯´æ²¡æœ‰ä»€ä¹ˆå½±å“ï¼Œåªæ˜¯ä¸ºäº†æ–¹ä¾¿ç¨‹åºå‘˜çš„å¼€å‘ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚è¯´ç™½äº†ï¼Œè¯­æ³•ç³–å°±æ˜¯å¯¹ç°æœ‰è¯­æ³•çš„ä¸€ä¸ªå°è£…ã€‚</p><a id="more"></a><p>Javaä½œä¸ºä¸€ç§ä¸å¹³å°æ— å…³çš„é«˜çº§è¯­è¨€ï¼Œå½“ç„¶ä¹Ÿå«æœ‰è¯­æ³•ç³–ï¼Œè¿™äº›è¯­æ³•ç³–å¹¶ä¸è¢«è™šæ‹Ÿæœºæ‰€æ”¯æŒï¼Œåœ¨ç¼–è¯‘æˆå­—èŠ‚ç é˜¶æ®µå°±è‡ªåŠ¨è½¬æ¢æˆç®€å•å¸¸ç”¨è¯­æ³•ã€‚<br>è¯­æ³•ç³–çš„å¤§æ¦‚æœ‰ä¸‰ä¸ªç‰¹æ€§ï¼š</p><ol><li>æé«˜ç¨‹åºå¼€å‘æ•ˆç‡</li><li>ç¨‹åºæ€§èƒ½ä¸å—å½±å“</li><li>è§„é¿coderå¯èƒ½å› æ‰‹è¯¯è€Œå‡ºç°çš„é”™è¯¯</li></ol><p>é‚£Javaæœ‰å“ªäº›è¯­æ³•ç³–å‘¢ï¼ŸJavaå¤§æ¦‚æœ‰å¦‚ä¸‹6ä¸ªè¯­æ³•ç³–ï¼š</p><ol><li>æ³›å‹ä¸ç±»å‹æ“¦é™¤</li><li>è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±</li><li>å˜é•¿å‚æ•°</li><li>å¢å¼ºforå¾ªç¯</li><li>å†…éƒ¨ç±»</li><li>æšä¸¾ç±»</li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaå‡ºç°é”™è¯¯Implicit super constructor  **  is undefined for default constructor. Must define an explicit constructor</title>
      <link href="/post/7764f1f8.html"/>
      <url>/post/7764f1f8.html</url>
      
        <content type="html"><![CDATA[<p>å…¬å¸å¼€å±•æ–°çš„é¡¹ç›®ï¼Œè¦æ±‚ä½¿ç”¨Javaï¼Œç»™ä¸€ä¸ªæœˆçš„å­¦ä¹ æ—¶é—´ã€‚(<strong><strong>å—äº¬ä¸€äº›æ¯”è¾ƒå¤§çš„å…¬å¸ä¹Ÿå¼€å§‹è½¬å‘Javaï¼Œè¯­è¨€ç¯å¢ƒå‘äº†æ”¹å˜ï¼Œå­¦ä¹ Javaä¹Ÿæ˜¯å¤§åŠ¿æ‰€è¶‹ã€‚2018å¹´1æœˆ26æ—¥ä¿®æ”¹</strong></strong>)ï¼Œåªå¥½å¼€å§‹å­¦ä¹ Javaï¼è¯´å¥½æœ‰ç³»ç»Ÿçš„åŸ¹è®­ï¼Œç»“æœæˆ‘ç°åœ¨åœ¨è‡ªå­¦ï¼åœ¨å­¦ä¹ javaçš„æ—¶å€™ï¼Œé‡åˆ°äº†ä¸‹é¢çš„é—®é¢˜ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Implicit <span class="keyword">super</span> constructor <span class="title">People</span><span class="params">()</span> is undefined <span class="keyword">for</span> <span class="keyword">default</span> constructor. Must define an explicit constructor</span></span><br></pre></td></tr></table></figure><a id="more"></a><p>å¤§è‡´çš„æ„æ€æ˜¯çˆ¶ç±»æ²¡æœ‰å®šä¹‰é»˜è®¤çš„æ— å‚æ•°çš„æ„é€ æ–¹æ³•ï¼Œçˆ¶ç±»å¿…é¡»å®šä¹‰ä¸€ä¸ªæ— å‚çš„æ„é€ æ–¹æ³•ã€‚ç»è¿‡ä¸€ç•ªç ”ç©¶å¾—çŸ¥ï¼ŒJavaä¸­æœ‰ä¸€ä¸‹çš„è§„åˆ™ï¼š å› ä¸ºä½ çš„çˆ¶ç±»å·²ç»å®šä¹‰äº†ä¸€ä¸ªæœ‰å‚çš„æ„é€ å‡½æ•°å¹¶ä¸”çˆ¶ç±»ä¸­æ²¡æœ‰é»˜è®¤çš„æ— å‚æ„é€ æ–¹æ³•ï¼Œæ­¤æ—¶ç¼–è¯‘å™¨ä¸ä¼šä¸ºä½ è°ƒç”¨é»˜è®¤çš„æ„é€ å‡½æ•°ï¼Œ å½“å­ç±»ç»§æ‰¿æ—¶ï¼Œå¿…é¡»åœ¨è‡ªå·±çš„æ„é€ å‡½æ•°æ˜¾å¼è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼Œè‡ªå·±æ‰èƒ½ç¡®ä¿å­ç±»åœ¨åˆå§‹åŒ–å‰çˆ¶ç±»ä¼šè¢«å®ä¾‹åŒ–ï¼Œ å¦‚æœä½ çˆ¶ç±»ä¸­æœ‰æ— å‚çš„æ„é€ å‡½æ•°ï¼Œå­ç±»å°±ä¸ä¼šå¼ºåˆ¶è¦æ±‚è°ƒç”¨ï¼Œå³ä½ å†™çš„é‚£ä¸ªå°±å¯ä»¥é€šè¿‡ï¼Œ ç¼–è¯‘å™¨ä¼šé»˜è®¤å¸®ä½ è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°ã€‚</p><p>ä¿®æ”¹åçš„ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//çˆ¶ç±»</span></span><br><span class="line"><span class="keyword">package</span> dmw;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">People</span> </span>&#123;</span><br><span class="line"><span class="keyword">public</span> String name;</span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">int</span> age;</span><br><span class="line"><span class="keyword">protected</span> String gender;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">People</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">People</span><span class="params">(<span class="keyword">int</span> age,String name,String gender)</span></span>&#123;</span><br><span class="line"><span class="keyword">this</span>.age = age;</span><br><span class="line"><span class="keyword">this</span>.name =name;</span><br><span class="line"><span class="keyword">this</span>.gender=gender;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span></span>&#123;</span><br><span class="line"> <span class="keyword">return</span> <span class="keyword">this</span>.age;</span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line"> <span class="function"><span class="keyword">public</span> String <span class="title">getGender</span><span class="params">()</span></span>&#123;</span><br><span class="line"> <span class="keyword">return</span> <span class="keyword">this</span>.gender;</span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">boolean</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span></span>;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">boolean</span> <span class="title">setGender</span><span class="params">(String gender)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å­ç±»</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> dmw;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword">extends</span> <span class="title">People</span> </span>&#123; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">(<span class="keyword">int</span> age, String name, String gender)</span> </span>&#123;</span><br><span class="line"><span class="keyword">super</span>(age, name, gender);</span><br><span class="line"><span class="comment">// TODO Auto-generated constructor stub</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.age = age;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">setGender</span><span class="params">(String gender)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.gender = gender;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="http://blog.csdn.net/children_of_light/article/details/54985869" target="_blank" rel="noopener">eclipseçš„mavené…ç½®</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨javaå’Œjavacå‘½ä»¤æ¥ç¼–è¯‘è¿è¡ŒJava</title>
      <link href="/post/5d2bd789.html"/>
      <url>/post/5d2bd789.html</url>
      
        <content type="html"><![CDATA[<p>åºŸè¯ä¸å¤šè¯´ï¼Œç›´å¥”ä¸»é¢˜!</p><a id="more"></a><p> 1.å…ˆåˆ›å»ºä¸€ä¸ªTest.javaçš„æ–‡ä»¶ï¼Œé‡Œé¢ä¿å­˜çš„å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> void main(String[] args)&#123;</span><br><span class="line">        System.out.println(<span class="string">"hello world!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">`</span><br></pre></td></tr></table></figure><p> 2.ä½¿ç”¨javacç¼–è¯‘Test.javaæ–‡ä»¶ï¼Œç¼–è¯‘é€šè¿‡ä¼šç”Ÿæˆä¸€ä¸ªTest.classçš„æ–‡ä»¶</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">C:\Users\nick\Desktop&gt;javac Test.java</span><br><span class="line"></span><br><span class="line">C:\Users\nick\Desktop&gt;</span><br></pre></td></tr></table></figure><p> 3.ä½¿ç”¨java Testå‘½ä»¤æ‰§è¡ŒTest.classæ–‡ä»¶</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\nick\Desktop&gt;java Test</span><br><span class="line">hello world!</span><br><span class="line"></span><br><span class="line">C:\Users\nick\Desktop&gt;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Centos6.9å®‰è£…ElasticSearch2.x</title>
      <link href="/post/971cda27.html"/>
      <url>/post/971cda27.html</url>
      
        <content type="html"><![CDATA[<p>æˆ‘è¿™é‡Œå®‰è£…çš„æ˜¯ElasticSearch2.xç³»åˆ—ã€‚<br><a href="https://www.elastic.co/guide/en/elasticsearch/reference/2.4/setup-repositories.html" target="_blank" rel="noopener">ElasticSearchå®˜æ–¹æ–‡æ¡£</a><br>1.æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦å·²ç»å®‰è£…äº†jdk</p><a id="more"></a><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum list installed |grep java</span><br></pre></td></tr></table></figure><p>è‹¥æœ‰è‡ªå¸¦å®‰è£…çš„JDKï¼Œå¦‚ä½•å¸è½½CentOSç³»ç»Ÿè‡ªå¸¦Javaç¯å¢ƒ?</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å¸è½½JDKç›¸å…³æ–‡ä»¶è¾“å…¥ï¼šyum -y remove java-1.7.0-openjdk*</span><br><span class="line">å¸è½½tzdata-javaè¾“å…¥ï¼šyum -y remove tzdata-java.noarch</span><br></pre></td></tr></table></figure><p><em>æ³¨</em>ï¼šâ€œ*â€è¡¨ç¤ºå¸è½½æ‰java 1.7.0çš„æ‰€æœ‰openjdkç›¸å…³æ–‡ä»¶<br>2.æŸ¥çœ‹yumåº“ä¸­çš„Javaå®‰è£…åŒ…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">yum -y list java*</span><br><span class="line">[root@iZwz99xkrnh5xy0cqp8aofZ ~]<span class="comment"># yum -y list java*</span></span><br><span class="line">Loaded plugins: security</span><br><span class="line">Installed Packages</span><br><span class="line">java-1.8.0-openjdk.x86_64                                                                        1:1.8.0.151-1.b12.el6_9                                                             @updates</span><br><span class="line">java-1.8.0-openjdk-debug.x86_64                                                                  1:1.8.0.151-1.b12.el6_9                                                             @updates</span><br><span class="line">java-1.8.0-openjdk-demo.x86_64                                                                   1:1.8.0.151-1.b12.el6_9                                                             @updates</span><br><span class="line">java-1.8.0-openjdk-demo-debug.x86_64                                                             1:1.8.0.151-1.b12.el6_9                                                             @updates</span><br><span class="line">java-1.8.0-openjdk-devel.x86_64                                                                  1:1.8.0.151-1.b12.el6_9                                                             @updates</span><br><span class="line">java-1.8.0-openjdk-devel-debug.x86_64                                                            1:1.8.0.151-1.b12.el6_9                                                             @updates</span><br><span class="line">java-1.8.0-openjdk-headless.x86_64                                                               1:1.8.0.151-1.b12.el6_9                                                             @updates</span><br><span class="line">java-1.8.0-openjdk-headless-debug.x86_64                                                         1:1.8.0.151-1.b12.el6_9                                                             @updates</span><br><span class="line">java-1.8.0-openjdk-javadoc.noarch                                                                1:1.8.0.151-1.b12.el6_9                                                             @updates</span><br><span class="line">java-1.8.0-openjdk-javadoc-debug.noarch                                                          1:1.8.0.151-1.b12.el6_9                                                             @updates</span><br><span class="line">java-1.8.0-openjdk-src.x86_64                                                                    1:1.8.0.151-1.b12.el6_9                                                             @updates</span><br><span class="line">java-1.8.0-openjdk-src-debug.x86_64                                                              1:1.8.0.151-1.b12.el6_9                                                             @updates</span><br><span class="line">Available Packages</span><br><span class="line">java-1.5.0-gcj.x86_64                                                                            1.5.0.0-29.1.el6                                                                    base    </span><br><span class="line">java-1.5.0-gcj-devel.x86_64                                                                      1.5.0.0-29.1.el6                                                                    base    </span><br><span class="line">java-1.5.0-gcj-javadoc.x86_64                                                                    1.5.0.0-29.1.el6                                                                    base    </span><br><span class="line">java-1.5.0-gcj-src.x86_64                                                                        1.5.0.0-29.1.el6                                                                    base    </span><br><span class="line">java-1.6.0-openjdk.x86_64                                                                        1:1.6.0.41-1.13.13.1.el6_8                                                          base    </span><br><span class="line">java-1.6.0-openjdk-demo.x86_64                                                                   1:1.6.0.41-1.13.13.1.el6_8                                                          base    </span><br><span class="line">java-1.6.0-openjdk-devel.x86_64                                                                  1:1.6.0.41-1.13.13.1.el6_8                                                          base    </span><br><span class="line">java-1.6.0-openjdk-javadoc.x86_64                                                                1:1.6.0.41-1.13.13.1.el6_8                                                          base    </span><br><span class="line">java-1.6.0-openjdk-src.x86_64                                                                    1:1.6.0.41-1.13.13.1.el6_8                                                          base    </span><br><span class="line">java-1.7.0-openjdk.x86_64                                                                        1:1.7.0.161-2.6.12.0.el6_9                                                          updates </span><br><span class="line">java-1.7.0-openjdk-demo.x86_64                                                                   1:1.7.0.161-2.6.12.0.el6_9                                                          updates </span><br><span class="line">java-1.7.0-openjdk-devel.x86_64                                                                  1:1.7.0.161-2.6.12.0.el6_9                                                          updates </span><br><span class="line">java-1.7.0-openjdk-javadoc.noarch                                                                1:1.7.0.161-2.6.12.0.el6_9                                                          updates </span><br><span class="line">java-1.7.0-openjdk-src.x86_64                                                                    1:1.7.0.161-2.6.12.0.el6_9                                                          updates </span><br><span class="line">java-clearsilver.i686                                                                            0.10.5-16.el6                                                                       epel    </span><br><span class="line">java-dirq.noarch                                                                                 1.4-1.el6                                                                           epel    </span><br><span class="line">java-dirq-javadoc.noarch                                                                         1.4-1.el6                                                                           epel    </span><br><span class="line">java-service-wrapper.x86_64                                                                      3.2.5-23.el6                                                                        epel    </span><br><span class="line">java-service-wrapper-javadoc.noarch                                                              3.2.5-23.el6                                                                        epel    </span><br><span class="line">java-sleep.noarch                                                                                2.1-6.el6                                                                           epel    </span><br><span class="line">java-sleep-javadoc.noarch                                                                        2.1-6.el6                                                                           epel    </span><br><span class="line">java_cup.x86_64                                                                                  1:0.10k-5.el6                                                                       base    </span><br><span class="line">java_cup-javadoc.x86_64                                                                          1:0.10k-5.el6                                                                       base    </span><br><span class="line">java_cup-manual.x86_64                                                                           1:0.10k-5.el6                                                                       base    </span><br><span class="line">javacc.x86_64                                                                                    4.1-0.5.el6                                                                         base    </span><br><span class="line">javacc-demo.x86_64                                                                               4.1-0.5.el6                                                                         base    </span><br><span class="line">javacc-manual.x86_64                                                                             4.1-0.5.el6                                                                         base    </span><br><span class="line">javassist.noarch                                                                                 3.9.0-6.el6                                                                         base    </span><br><span class="line">javassist-javadoc.noarch                                                                         3.9.0-6.el6                                                                         base    </span><br><span class="line">javastroke.x86_64                                                                                0.5.1-33.el6                                                                        epel    </span><br><span class="line">javatar.noarch                                                                                   2.5-5.el6                                                                           epel    </span><br><span class="line">javatar-javadoc.noarch</span><br></pre></td></tr></table></figure><p>ä»¥yumåº“ä¸­çš„java-1.8ä¸ºä¾‹ï¼Œå°†java-1.8.0çš„æ‰€æœ‰ç›¸å…³Javaç¨‹åºéƒ½å®‰è£…ä¸Šã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install java-1.8.0-openjdk*</span><br></pre></td></tr></table></figure><p>3.æŸ¥çœ‹åˆšå®‰è£…çš„Javaç‰ˆæœ¬ä¿¡æ¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">java -version å¯æŸ¥çœ‹Javaç‰ˆæœ¬</span><br><span class="line">[root@iZwz99xkrnh5xy0cqp8aofZ ~]<span class="comment"># java -version</span></span><br><span class="line">openjdk version <span class="string">"1.8.0_151"</span></span><br><span class="line">OpenJDK Runtime Environment (build 1.8.0_151-b12)</span><br><span class="line">OpenJDK 64-Bit Server VM (build 25.151-b12, mixed mode)</span><br></pre></td></tr></table></figure><p>4.é€šè¿‡rpmå®‰è£…ElasticSearch</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">å…ˆä¸‹è½½å¹¶å®‰è£…å…¬å…±ç­¾åå¯†é’¥</span><br><span class="line">rpm --import https://artifacts.elastic.co/GPG-KEY-elasticsearch</span><br><span class="line">å†å®‰è£…rpmçš„repository</span><br><span class="line">[elasticsearch-2.x]</span><br><span class="line">name=Elasticsearch repository <span class="keyword">for</span> 2.x packages</span><br><span class="line">baseurl=https://packages.elastic.co/elasticsearch/2.x/centos</span><br><span class="line">gpgcheck=1</span><br><span class="line">gpgkey=https://packages.elastic.co/GPG-KEY-elasticsearch</span><br><span class="line">enabled=1</span><br></pre></td></tr></table></figure><p>å®‰è£…ElasticSearch</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install elasticsearch  </span><br><span class="line">sudo dnf install elasticsearch </span><br><span class="line">sudo zypper install elasticsearch</span><br><span class="line"></span><br><span class="line">ä½¿ç”¨yumåœ¨CentOSå’Œæ—§çš„åŸºäºRed Hatåˆ†å‘</span><br><span class="line">ä½¿ç”¨dnfçš„Fedoraå’Œå…¶ä»–æ–°çš„Red Hatåˆ†å‘</span><br><span class="line">ä½¿ç”¨zypperåŸºäºåˆ†å¸ƒçš„OpenSUSE</span><br><span class="line"></span><br><span class="line">å¦‚æœä½ å«Œéº»çƒ¦å¯ä»¥ä¹‹å‰ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•å®‰è£…ï¼š</span><br><span class="line">wget https://download.elastic.co/elasticsearch/release/org/elasticsearch/distribution/rpm/elasticsearch/2.4.2/elasticsearch-2.4.2.rpm</span><br><span class="line"></span><br><span class="line">sha1sum elasticsearch-5.6.5.rpm</span><br><span class="line">sudo rpm --install elasticsearch-5.6.5.rpm</span><br></pre></td></tr></table></figure><p>5.ä½¿ç”¨chkconfigå‘½ä»¤å°†Elasticsearché…ç½®ä¸ºåœ¨ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨å¯åŠ¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo chkconfig --add elasticsearch</span><br><span class="line"></span><br><span class="line">ä¸‹é¢çš„å‘½ä»¤å¯åŠ¨æˆ–è€…å…³é—­elasticsearchæœåŠ¡</span><br><span class="line"></span><br><span class="line">sudo -i service elasticsearch start</span><br><span class="line">sudo -i service elasticsearch stop</span><br></pre></td></tr></table></figure><p>6.å¯åŠ¨elasticsearchæœåŠ¡æŠ¥é”™</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@iZwz99xkrnh5xy0cqp8aofZ src]<span class="comment"># service elasticsearch start</span></span><br><span class="line">Starting elasticsearch: OpenJDK 64-Bit Server VM warning: If the number of processors is expected to increase from one, <span class="keyword">then</span> you should configure the number of parallel GC threads appropriately using -XX:ParallelGCThreads=N</span><br><span class="line">OpenJDK 64-Bit Server VM warning: INFO: os::commit_memory(0x0000000085330000, 2060255232, 0) failed; error=<span class="string">'Cannot allocate memory'</span> (errno=12)</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># There is insufficient memory for the Java Runtime Environment to continue.</span></span><br><span class="line"><span class="comment"># Native memory allocation (mmap) failed to map 2060255232 bytes for committing reserved memory.</span></span><br><span class="line"><span class="comment"># An error report file with more information is saved as:</span></span><br><span class="line"><span class="comment"># /tmp/hs_err_pid23700.log</span></span><br><span class="line">                                                           [FAILED]</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯å› ä¸ºæœºå™¨çš„å†…å­˜ä¸è¶³ï¼Œå¯ç”¨å†…å­˜å°‘äº1G,è§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">vim  /etc/elasticsearch/jvm.options </span><br><span class="line"><span class="comment">##å¯ç”¨å¦‚ä¸‹ä¸¤é¡¹</span></span><br><span class="line"> -Xms4g                   </span><br><span class="line"> -Xmx4g</span><br><span class="line"><span class="comment">##å…³é—­å¦‚ä¸‹ä¸¤é¡¹</span></span><br><span class="line"><span class="comment">##-Xms2g                    </span></span><br><span class="line"><span class="comment">##-Xmx2g</span></span><br></pre></td></tr></table></figure><p>7.é…ç½®å¤–ç½‘å¯ç”¨è®¿é—®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ä¿®æ”¹é…ç½®æ–‡ä»¶</span><br><span class="line">vim/etc/elasticsearch/elasticsearch.yml</span><br><span class="line">ä¿®æ”¹æˆï¼šnetwork.host: 0.0.0.0</span><br></pre></td></tr></table></figure><p>è‡³æ­¤ï¼Œelasticsearchçš„åŸºæœ¬é…ç½®å®Œæˆï¼</p>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> elasticSearch </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Centos6å®‰è£…Mongodb</title>
      <link href="/post/ab77d2e6.html"/>
      <url>/post/ab77d2e6.html</url>
      
        <content type="html"><![CDATA[<p>1.è¿è¡Œä¸‹é¢å‘½ä»¤æŸ¥çœ‹æœåŠ¡å™¨ä¸­æ˜¯å¦å­˜åœ¨Mongodbçš„æº</p><a id="more"></a><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum info mongo-10gen</span><br></pre></td></tr></table></figure><p>ç»“æœæç¤ºæ²¡æœ‰ç›¸å…³åŒ¹é…çš„ä¿¡æ¯ ï¼Œè¯´æ˜ç³»ç»Ÿä¸­çš„yumæºä¸åŒ…å«MongoDBçš„ç›¸å…³èµ„æºï¼Œæ‰€ä»¥è¦åœ¨ä½¿ç”¨yumå‘½ä»¤å®‰è£…MongoDBå‰éœ€è¦å¢åŠ yumæºã€‚<br>2.é…ç½®åŒ…ç®¡ç†ç³»ç»Ÿï¼ˆyumï¼‰<br>åˆ›å»ºä¸€ä¸ª/etc/yum.repos.d/mongodb-org-3.6.repoæ–‡ä»¶ï¼Œä»¥ä¾¿æ‚¨å¯ä»¥ç›´æ¥ä½¿ç”¨å®‰è£…MongoDB yumã€‚å†™å…¥ä¸€ä¸‹å†…å®¹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[mongodb-org-3.6]</span><br><span class="line">name=MongoDB Repository</span><br><span class="line">baseurl=https://repo.mongodb.org/yum/redhat/<span class="variable">$releasever</span>/mongodb-org/3.6/x86_64/</span><br><span class="line">gpgcheck=1</span><br><span class="line">enabled=1</span><br><span class="line">gpgkey=https://www.mongodb.org/static/pgp/server-3.6.asc</span><br></pre></td></tr></table></figure><p>3.å®‰è£…MongoDBåŒ…<br>è¦å®‰è£…æœ€æ–°çš„ç¨³å®šç‰ˆæœ¬çš„MongoDBï¼Œè¯·å‘å‡ºä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y mongodb-org</span><br></pre></td></tr></table></figure><p>è¦å®‰è£…ç‰¹å®šç‰ˆæœ¬çš„MongoDBï¼Œè¯·åˆ†åˆ«æŒ‡å®šæ¯ä¸ªç»„ä»¶åŒ…ï¼Œå¹¶å°†ç‰ˆæœ¬å·é™„åŠ åˆ°åŒ…åç§°ï¼Œå¦‚ä¸‹ä¾‹æ‰€ç¤ºï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y mongodb-org-3.6.0 mongodb-org-server-3.6.0 mongodb-org-shell-3.6.0 mongodb-org-mongos-3.6.0 mongodb-org-tools-3.6.0</span><br></pre></td></tr></table></figure><p>4.åœ¨é˜¿é‡Œäº‘ä¸Šå®‰å…¨ç»„æ·»åŠ ä¸€æ¡è§„åˆ™,å¹¶åœ¨Centosä¸­çš„iptablesæ·»åŠ ä¸€æ¡è®°å½•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#é˜¿é‡Œäº‘å®‰å…¨ç»„è§„åˆ™</span></span><br><span class="line">å…è®¸ è‡ªå®šä¹‰ TCP 27017/27017åœ°å€æ®µè®¿é—®  0.0.0.0/0</span><br><span class="line"></span><br><span class="line"><span class="comment">#iptables</span></span><br><span class="line">-A INPUT -p tcp -m tcp --dport 27017 -j ACCEPT </span><br><span class="line"></span><br><span class="line"><span class="comment">#é‡å¯iptables</span></span><br><span class="line">/etc/init.d/iptables restart</span><br></pre></td></tr></table></figure><p>5.å¼€æœºè‡ªå¯åŠ¨,æ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chkconfig mongod on</span><br></pre></td></tr></table></figure><p>6.Mongodbå¯åŠ¨ã€å…³é—­å’Œé‡å¯å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å¯åŠ¨</span></span><br><span class="line">service mongod start</span><br><span class="line"><span class="comment">#å…³é—­</span></span><br><span class="line">service mongod stop</span><br><span class="line"><span class="comment">#restart</span></span><br><span class="line">service mongod restart</span><br></pre></td></tr></table></figure><p><em>END Mongodbå®‰è£…ç»“æŸ</em></p>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> mongodb </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nginxå‡ºç°The plain HTTP request was sent to HTTPS port</title>
      <link href="/post/38efc407.html"/>
      <url>/post/38efc407.html</url>
      
        <content type="html"><![CDATA[<p>Nginxçªç„¶å‡ºç°äº†ä¸‹é¢çš„é—®é¢˜ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The plain HTTP request was sent to HTTPS port</span><br></pre></td></tr></table></figure><p>åœ¨åšå®¢é…ç½®sslè¯ä¹¦çš„æ—¶å€™ï¼Œåšå®¢çš„httpsåœ°å€å’Œhttpåœ°å€æ˜¯éƒ½èƒ½è®¿é—®ï¼Œä¸è¿‡ï¼Œä»Šå¤©çªç„¶å‘ç°åšå®¢è®¿é—®å‡ºç°ä¸Šé¢çš„é—®é¢˜ï¼Œç»è¿‡ç™¾åº¦æ‰¾åˆ°äº†é—®é¢˜çš„è§£å†³åŠæ³•ï¼Œåœ¨æ­¤è®°å½•ä¸€ä¸‹ã€‚</p><a id="more"></a><p>è§£å†³åŠæ³•ï¼š</p><p>åˆ æ‰ssl on; å¹¶åœ¨ listen 443; 443ååŠ ä¸Šsslå³å¯ã€‚<br>Nginxæœ€æ–°é…ç½®æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen     80;</span><br><span class="line">    listen     443 ssl; </span><br><span class="line">    </span><br><span class="line">    server_name  www.ydstudio.net  ydstudio.net;</span><br><span class="line">    <span class="built_in">set</span> <span class="variable">$my_server_name</span> <span class="variable">$scheme</span>://<span class="variable">$server_name</span>;</span><br><span class="line">    root  html;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$host</span> = <span class="string">'ydstudio.net'</span>) &#123;</span><br><span class="line">      rewrite ^ https://www.ydstudio.net<span class="variable">$request_uri</span>? permanent;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">#é˜²æ­¢ipè®¿é—®ï¼Œå¦‚http://xxx.xxx.xxx.xxxæˆ–è€…https://xxx.xxx.xxx.xxx</span></span><br><span class="line">    <span class="keyword">if</span> ( <span class="variable">$host</span> ~* <span class="string">"\d+\.\d+\.\d+\.\d+"</span> ) &#123;</span><br><span class="line">        rewrite ^ https://<span class="variable">$server_name</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ( <span class="variable">$my_server_name</span> != https://<span class="variable">$server_name</span> ) &#123;</span><br><span class="line">       <span class="built_in">return</span>      301 https://<span class="variable">$server_name</span><span class="variable">$request_uri</span>;</span><br><span class="line">       <span class="comment">#rewrite ^ https://$server_name$request_uri? permanent;</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    location / &#123;</span><br><span class="line">       try_files <span class="variable">$uri</span> <span class="variable">$uri</span>/ /index.php<span class="variable">$is_args</span><span class="variable">$args</span>;</span><br><span class="line">       index index.php  index.html index.htm;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">#error_page  404              /404.html;</span></span><br><span class="line">    <span class="comment"># redirect server error pages to the static page /50x.html</span></span><br><span class="line">    error_page   500 502 503 504  /50x.html;</span><br><span class="line">    location = /50x.html &#123;</span><br><span class="line">        root   /usr/share/nginx/html;</span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    <span class="comment"># pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span></span><br><span class="line">    location ~ \.php$ &#123;</span><br><span class="line">       <span class="comment">#root           html;</span></span><br><span class="line">       fastcgi_pass   127.0.0.1:9000;</span><br><span class="line">       fastcgi_index  index.php;</span><br><span class="line">       fastcgi_param  SCRIPT_FILENAME  html/typecho/<span class="variable">$fastcgi_script_name</span>;</span><br><span class="line">       include        fastcgi_params;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    location ~ .*\.(gif|jpg|jpeg|png|bmp|swf)$ &#123;</span><br><span class="line">        <span class="comment">#expiresæŒ‡ä»¤è®¾ç½®æµè§ˆå™¨ç¼“å­˜è¿‡æœŸæ—¶é—´</span></span><br><span class="line">        <span class="comment">#å¯ä»¥åœ¨httpã€serverã€locationä¸‰ä¸ªä½œç”¨åŸŸä¸­è®¾ç½®</span></span><br><span class="line">        <span class="comment">#ç¼“å­˜å›¾ç‰‡æˆ–è§†é¢‘30å¤©</span></span><br><span class="line">        expires 30d;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    location ~ .*\.(js|css)?$ &#123;</span><br><span class="line">        <span class="comment">#ç¼“å­˜js/css 1å°æ—¶</span></span><br><span class="line">        expires 1h;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">#ssl on;</span></span><br><span class="line">    ssl_certificate   cert/214353452860792.pem;</span><br><span class="line">    ssl_certificate_key  cert/214353452860792.key;</span><br><span class="line">    ssl_session_timeout 5m;</span><br><span class="line">    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;</span><br><span class="line">    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;</span><br><span class="line">    ssl_prefer_server_ciphers on;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHPå‡ºç°Deprecated Automatically populating  is deprecated and will be removed in a future version</title>
      <link href="/post/96d1bc5c.html"/>
      <url>/post/96d1bc5c.html</url>
      
        <content type="html"><![CDATA[<p>æœ¬åœ°æ–°æ­å»ºçš„PHPç¯å¢ƒï¼Œå‡ºç°ä¸‹é¢çš„é—®é¢˜ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Deprecated Automatically populating <span class="variable">$HTTP_RAW_POST_DATA</span> is deprecated and will be removed <span class="keyword">in</span> a future version. To avoid this warning <span class="built_in">set</span> <span class="string">'always_populate_raw_post_data'</span> to <span class="string">'-1'</span> <span class="keyword">in</span> php.ini and use the php://input stream instead. <span class="keyword">in</span> Unknown on line 0</span><br><span class="line">Warning: Cannot modify header information - headers already sent <span class="keyword">in</span> Unknown on line 0</span><br></pre></td></tr></table></figure><a id="more"></a><p>è¿™ä¸ªé—®é¢˜å’ŒPHPç‰ˆæœ¬æœ‰å…³ç³»ï¼ŒPHP 5.6å·²ç»åºŸå¼ƒäº†$HTTP_RAW_POST_DATAã€‚<br>è§£å†³æ–¹æ³•ï¼š<br>ä¿®æ”¹php.ini</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">always_populate_raw_post_data = -1</span><br></pre></td></tr></table></figure><p>é‡å¯PHPå³å¯</p>]]></content>
      
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHPå‡ºç°ä»¥ä¸‹é”™è¯¯Cannot find module (IP-MIB)</title>
      <link href="/post/82ed83ea.html"/>
      <url>/post/82ed83ea.html</url>
      
        <content type="html"><![CDATA[<p>æŸ¥çœ‹PHPç‰ˆæœ¬çš„æ—¶å€™å‡ºç°ä¸‹é¢çš„é—®é¢˜ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">php -v</span><br><span class="line"></span><br><span class="line">MIB search path: c:/usr/share/snmp/mibs</span><br><span class="line">Cannot find module (IP-MIB): At line 0 <span class="keyword">in</span> (none)</span><br><span class="line">Cannot find module (IF-MIB): At line 0 <span class="keyword">in</span> (none)</span><br><span class="line">Cannot find module (TCP-MIB): At line 0 <span class="keyword">in</span> (none)</span><br><span class="line">Cannot find module (UDP-MIB): At line 0 <span class="keyword">in</span> (none)</span><br><span class="line">Cannot find module (HOST-RESOURCES-MIB): At line 0 <span class="keyword">in</span> (none)</span><br><span class="line">Cannot find module (SNMPv2-MIB): At line 0 <span class="keyword">in</span> (none)</span><br><span class="line">Cannot find module (SNMPv2-SMI): At line 0 <span class="keyword">in</span> (none)</span><br><span class="line">Cannot find module (NOTIFICATION-LOG-MIB): At line 0 <span class="keyword">in</span> (none)</span><br><span class="line">Cannot find module (UCD-SNMP-MIB): At line 0 <span class="keyword">in</span> (none)</span><br><span class="line">Cannot find module (UCD-DEMO-MIB): At line 0 <span class="keyword">in</span> (none)</span><br><span class="line">Cannot find module (SNMP-TARGET-MIB): At line 0 <span class="keyword">in</span> (none)</span><br><span class="line">Cannot find module (NET-SNMP-AGENT-MIB): At line 0 <span class="keyword">in</span> (none)</span><br><span class="line">Cannot find module (DISMAN-EVENT-MIB): At line 0 <span class="keyword">in</span> (none)</span><br><span class="line">Cannot find module (SNMP-VIEW-BASED-ACM-MIB): At line 0 <span class="keyword">in</span> (none)</span><br><span class="line">Cannot find module (SNMP-COMMUNITY-MIB): At line 0 <span class="keyword">in</span> (none)</span><br><span class="line">Cannot find module (SNMP-FRAMEWORK-MIB): At line 0 <span class="keyword">in</span> (none)</span><br><span class="line">Cannot find module (SNMP-MPD-MIB): At line 0 <span class="keyword">in</span> (none)</span><br><span class="line">Cannot find module (SNMP-USER-BASED-SM-MIB): At line 0 <span class="keyword">in</span> (none)</span><br><span class="line">Cannot find module (SNMP-NOTIFICATION-MIB): At line 0 <span class="keyword">in</span> (none)</span><br><span class="line">Cannot find module (SNMPv2-TM): At line 0 <span class="keyword">in</span> (none)</span><br><span class="line">PHP 7.0.12 (cli) (built: Oct 13 2016 11:04:07) ( NTS )</span><br><span class="line">Copyright (c) 1997-2016 The PHP Group</span><br><span class="line">Zend Engine v3.0.0, Copyright (c) 1998-2016 Zend Technologies</span><br></pre></td></tr></table></figure><a id="more"></a><p>è§£å†³åŠæ³•ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å…³æ‰snmpæ‰©å±•</span></span><br><span class="line"><span class="comment">#windows</span></span><br><span class="line">æ³¨é‡Šæ‰ extension=php_snmp.dll</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQLå‡ºç°1267çš„é”™è¯¯</title>
      <link href="/post/75a1fb40.html"/>
      <url>/post/75a1fb40.html</url>
      
        <content type="html"><![CDATA[<p>æ‰§è¡ŒSQLçš„æ—¶å€™ï¼ŒMySQLå‡ºç°äº†ä¸‹é¢çš„1267çš„é”™è¯¯ï¼Œæç¤ºä¸å­—ç¬¦é›†æœ‰å…³ç³»ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1267 - Illegal mix of collations (utf8_unicode_ci,IMPLICIT) and (utf8_general_ci,IMPLICIT) <span class="keyword">for</span> operation <span class="string">'='</span></span><br></pre></td></tr></table></figure><a id="more"></a><p>æŸ¥æ‰¾é—®é¢˜çš„æ—¶å€™ï¼Œå‘ç°æœ‰ä¸€å¼ è¡¨æ˜¯ä»å…¶ä»–åœ°æ–¹æ‹·è´è¿‡æ¥çš„ï¼Œè¿™ä¸ªè¡¨å’Œæˆ‘ä»¬ç›®å‰é¡¹ç›®ä¸­çš„è¡¨ï¼Œç¨å¾®æœ‰ç‚¹ä¸åŒã€‚æ•°æ®è¡¨ä¸­å­—ç¬¦ä¸²ç±»å‹çš„å­—æ®µï¼Œä¸ä»…æœ‰å­—ç¬¦é›†è¿™ä¸ªå±æ€§ï¼Œè¿˜æœ‰ä¸€ä¸ªæ’åºè§„åˆ™çš„å±æ€§ã€‚æ‹·è´è¿‡æ¥çš„è¡¨çš„å­—ç¬¦ä¸²ç±»å‹çš„å­—æ®µçš„æ’åºè§„åˆ™æ˜¯utf8_unicode_ciï¼Œè€Œæˆ‘ä»¬çš„é¡¹ç›®ä¸­çš„æ˜¯utf8_general_ciï¼Œä¿®æ”¹ä¹‹åå†æ¬¡æ‰§è¡Œä¸Šè¿°çš„SQLï¼Œå°±æ²¡æœ‰å‡ºç°ä¸Šé¢çš„é”™è¯¯ï¼<br>ä¸‹é¢æ˜¯é—®é¢˜çš„ç®€å•æ€»ç»“ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ci(caseinsensitiveå¤§å°å†™ä¸æ•æ„Ÿ)</span><br><span class="line">utf8_unicode_ciå’Œutf8_general_ciå¯¹ä¸­ã€è‹±æ–‡æ¥è¯´æ²¡æœ‰å®è´¨çš„å·®åˆ«ã€‚</span><br><span class="line">utf8_general_ciæ ¡å¯¹é€Ÿåº¦å¿«ï¼Œä½†å‡†ç¡®åº¦ç¨å·®ã€‚</span><br><span class="line">utf8_unicode_ciå‡†ç¡®åº¦é«˜ï¼Œä½†æ ¡å¯¹é€Ÿåº¦ç¨æ…¢ã€‚</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ çš„åº”ç”¨æœ‰å¾·è¯­ã€æ³•è¯­æˆ–è€…ä¿„è¯­ï¼Œè¯·ä¸€å®šä½¿ç”¨utf8_unicode_ciã€‚ä¸€èˆ¬ç”¨utf8_general_ciå°±å¤Ÿäº†ï¼Œåˆ°ç°åœ¨ä¹Ÿæ²¡å‘ç°é—®é¢˜ã€‚ã€‚ã€‚</p><p>è¯¦ç»†æ€»ç»“ï¼š</p><p>1ã€å¯¹äºä¸€ç§è¯­è¨€ä»…å½“ä½¿ç”¨utf8_unicode_ciæ’åºåšçš„ä¸å¥½æ—¶ï¼Œæ‰æ‰§è¡Œä¸å…·ä½“è¯­è¨€ç›¸å…³çš„utf8å­—ç¬¦é›†æ ¡å¯¹è§„åˆ™ã€‚ä¾‹å¦‚ï¼Œå¯¹äºå¾·è¯­å’Œæ³•è¯­ï¼Œutf8_unicode_ciå·¥ä½œçš„å¾ˆå¥½ï¼Œå› æ­¤ä¸å†éœ€è¦ä¸ºè¿™ä¸¤ç§è¯­è¨€åˆ›å»ºç‰¹æ®Šçš„utf8æ ¡å¯¹è§„åˆ™ã€‚<br>2ã€utf8_general_ciä¹Ÿé€‚ç”¨ä¸å¾·è¯­å’Œæ³•è¯­ï¼Œé™¤äº†â€˜?â€™ç­‰äºâ€˜sâ€™ï¼Œè€Œä¸æ˜¯â€˜ssâ€™ä¹‹å¤–ã€‚å¦‚æœä½ çš„åº”ç”¨èƒ½å¤Ÿæ¥å—è¿™äº›ï¼Œé‚£ä¹ˆåº”è¯¥ä½¿ç”¨ utf8_general_ciï¼Œå› ä¸ºå®ƒé€Ÿåº¦å¿«ã€‚å¦åˆ™ï¼Œä½¿ç”¨utf8_unicode_ciï¼Œå› ä¸ºå®ƒæ¯”è¾ƒå‡†ç¡®ã€‚<br>ç”¨ä¸€å¥è¯æ¦‚å†µä¸Šé¢è¿™æ®µè¯ï¼šutf8_unicode_ciæ¯”è¾ƒå‡†ç¡®ï¼Œutf8_general_cié€Ÿåº¦æ¯”è¾ƒå¿«ã€‚é€šå¸¸æƒ…å†µä¸‹ utf8_general_ciçš„å‡†ç¡®æ€§å°±å¤Ÿæˆ‘ä»¬ç”¨çš„äº†ï¼Œåœ¨æˆ‘çœ‹è¿‡å¾ˆå¤šç¨‹åºæºç åï¼Œå‘ç°å®ƒä»¬å¤§å¤šæ•°ä¹Ÿç”¨çš„æ˜¯utf8_general_ciï¼Œæ‰€ä»¥æ–°å»ºæ•°æ® åº“æ—¶ä¸€èˆ¬é€‰ç”¨utf8_general_ciå°±å¯ä»¥äº†ã€‚</p><h4 id="å¦‚ä½•åœ¨MySQL5-0ä¸­ä½¿ç”¨UTF8"><a href="#å¦‚ä½•åœ¨MySQL5-0ä¸­ä½¿ç”¨UTF8" class="headerlink" title="å¦‚ä½•åœ¨MySQL5.0ä¸­ä½¿ç”¨UTF8"></a>å¦‚ä½•åœ¨MySQL5.0ä¸­ä½¿ç”¨UTF8</h4><p>åœ¨ my.cnfä¸­å¢åŠ ä¸‹åˆ—å‚æ•°<br>å¤åˆ¶ä»£ç ä»£ç å¦‚ä¸‹:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">init_connect=<span class="string">'SET NAMES utf8'</span></span><br><span class="line">default-character-set=utf8</span><br><span class="line">default-collation = utf8_general_ci</span><br></pre></td></tr></table></figure><p>æ‰§è¡ŒæŸ¥è¯¢ mysql&gt; show variables; ç›¸å…³å¦‚ä¸‹:  </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">character_set_client | utf8 </span><br><span class="line">character_set_connection | utf8 </span><br><span class="line">character_set_database | utf8 </span><br><span class="line">character_set_results | utf8 </span><br><span class="line">character_set_server | utf8 </span><br><span class="line">character_set_system | utf8</span><br><span class="line">collation_connection | utf8_general_ci </span><br><span class="line">collation_database | utf8_general_ci </span><br><span class="line">collation_server | utf8_general_ci</span><br></pre></td></tr></table></figure><p>ä¸ªäººè§è§£ï¼Œå¯¹äºæ•°æ®åº“çš„ä½¿ç”¨ï¼Œutf8_general å·²ç»è¶³å¤Ÿçš„å‡†ç¡®ï¼Œå¹¶ä¸”ç›¸è¾ƒä¸  utf8_unicodeé€Ÿåº¦ä¸Šæœ‰ä¼˜åŠ¿ï¼Œå›ºå¯æ”¾å¿ƒé‡‡ç”¨ä¹‹</p>]]></content>
      
      
      
        <tags>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¿®æ”¹sshçš„é»˜è®¤22ç«¯å£</title>
      <link href="/post/68417c42.html"/>
      <url>/post/68417c42.html</url>
      
        <content type="html"><![CDATA[<p>åœ¨å›½å¤–ä¹°çš„vpsé˜²æ­¢åˆ«äººæ‰«æç«¯å£ï¼Œäºæ˜¯æˆ‘æŠŠsshé»˜è®¤çš„22ç«¯å£ä¿®æ”¹ä¸€ä¸‹ã€‚<br>1.ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼š/etc/ssh/sshd_config ï¼Œæ‰¾åˆ°</p><a id="more"></a><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#port 22</span></span><br></pre></td></tr></table></figure><p>2.å…ˆå°†Port 22 å‰é¢çš„ # å·å»æ‰ï¼Œå¹¶å¦èµ·ä¸€è¡Œã€‚å¦‚å®šä¹‰SSHç«¯å£å·ä¸º33322ï¼Œåˆ™è¾“å…¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Port 33322</span><br></pre></td></tr></table></figure><p>è‡ªå®šä¹‰ç«¯å£é€‰æ‹©å»ºè®®åœ¨ä¸‡ä½çš„ç«¯å£ï¼ˆå¦‚ï¼š10000-65535ä¹‹é—´ï¼‰<br>ä¹Ÿè®¸æ‚¨ä¼šé—®ä¸ºä»€ä¹ˆè¦å…ˆæŠŠport 22å‰é¢çš„ # å»æ‰å‘¢ï¼Ÿå› ä¸ºåœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œ# æ˜¯Linuxçš„æ³¨é‡Šå­—ç¬¦ã€‚æ³¨é‡Šå­—ç¬¦åçš„ä»£ç ç¨‹åºæ˜¯ä¸ä¼šæ‰§è¡Œçš„ã€‚SSHé»˜è®¤çš„ï¼ˆå³éæ‰‹åŠ¨æŒ‡å®šï¼‰ç«¯å£ä¸º22ï¼Œæ‰€ä»¥é…ç½®æ–‡ä»¶åœ¨é»˜è®¤çš„æƒ…å†µä¸‹ä»¥æ³¨é‡Šå­—ç¬¦å‡ºç°ã€‚å½“éœ€è¦æŒ‡å®šå…¶å®ƒç«¯å£æˆ–å¤šç«¯å£åŒæ—¶è®¿é—®æ—¶ï¼Œå°±è¦åˆ æ‰æ³¨é‡Šç¬¦å·ï¼Œå‘ŠçŸ¥ç¨‹åºæŒ‰ç…§æ‚¨çš„æ„æ„¿æ¥æ‰§è¡Œå“åº”æ“ä½œã€‚<br>ä»¥ä¸Šæ“ä½œï¼Œæ‰‹åŠ¨æŒ‡å®šSSHç«¯å£ä¸º22å’Œ33322ï¼ˆåŒç«¯å£å·ï¼‰ï¼Œä¿ç•™22æ˜¯ä¸ºäº†é˜²æ­¢ä¸ªåˆ«é˜²ç«å¢™å±è”½äº†å…¶å®ƒç«¯å£å¯¼è‡´æ— æ³•è¿æ¥VPSï¼ˆå¦‚æ²¡å•ç‹¬æŒ‡å®š22ï¼Œæ–°æŒ‡å®šçš„33322ç«¯å£é˜²ç«å¢™ä¹Ÿæ²¡æ”¾è¡Œï¼Œé‚£ä¹ˆå¯èƒ½æ— æ³•é€šè¿‡SSHè¿æ¥VPSæˆ–æœåŠ¡å™¨ï¼‰ã€‚ä¸ºäº†é˜²æ­¢ä¸å¿…è¦é—®é¢˜çš„äº§ç”Ÿï¼Œæ‰€ä»¥è¦ç»™è‡ªå·±ä¿ç•™æ¡â€œåè·¯â€ã€‚<br>3ã€ä¿®æ”¹å®Œæ¯•åï¼Œé‡å¯SSHæœåŠ¡ï¼Œå¹¶é€€å‡ºå½“å‰è¿æ¥çš„SSHç«¯å£ã€‚ï¼ˆå¦‚å›¾ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service sshd restart</span><br></pre></td></tr></table></figure><p>CentOSä¸‹SSHé»˜è®¤ç«¯å£22ä¿®æ”¹æˆå…¶ä»–ç«¯å£<br>4.é‡å¯å®Œæ¯•ï¼Œå°è¯•ä½¿ç”¨æ–°ç«¯å£ç™»é™†<br>è¿æ¥æˆåŠŸï¼Œéœ€è¦é‡æ–°æ·»åŠ SSH-RSAéªŒè¯ï¼Œç‚¹å‡»æ˜¯ï¼ˆæˆ–Yesï¼‰å³å¯ã€‚<br>5.è‹¥èƒ½æ­£å¸¸è®¿é—®ï¼Œè¿”å›ç¬¬ä¸€æ­¥ï¼Œæ ¹æ®ç¬¬äºŒæ­¥çš„æ“ä½œå°†åŸport 22æ•´æ®µæ³¨é‡Šæˆ–åˆ æ‰ï¼Œå†æŒ‰ç¬¬ä¸‰æ­¥é‡å¯SSHå³å¯ã€‚<br>ä»¥ä¸Šæ­¥éª¤é‡å¯åä½¿ç”¨é»˜è®¤22å·ç«¯å£æ— æ³•è¿›å…¥SSHï¼Œè¾¾åˆ°ç›®çš„ã€‚<br>ã€è¯·æ³¨æ„ã€‘ï¼š<br>å¦‚æœæ‚¨å¯ç”¨äº†é˜²ç«å¢™iptablesï¼Œé‚£ä¹ˆå¿…é¡»å…ˆæ·»åŠ æ–°å¼€çš„33322ç«¯å£<br>è¡¥å……ï¼šiptableså¼€æ”¾ç«¯å£ç«¯ç¤ºä¾‹<br>ä¸ºäº†æ–¹ä¾¿ä¸¾ä¾‹è¯´æ˜ï¼Œå°±ç›´æ¥æ‹¿æ¥ä¸€æ®µæˆ‘çš„ç°æœ‰æœåŠ¡å™¨ä¸Šè¿è¡Œçš„é˜²ç«å¢™iptableså†…å®¹ã€‚</p><p>è¯·æ³¨æ„ï¼šåé¢çš„æ³¨é‡Šè¯´æ˜æ–‡å­—ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/sysconfig/iptables</span><br><span class="line"></span><br><span class="line"><span class="comment"># Firewall configuration written by system-config-firewall</span></span><br><span class="line"><span class="comment"># Manual customization of this file is not recommended.</span></span><br><span class="line">*filter</span><br><span class="line">:INPUT ACCEPT [0:0]</span><br><span class="line">:FORWARD ACCEPT [0:0]</span><br><span class="line">:OUTPUT ACCEPT [0:0]</span><br><span class="line">-A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT</span><br><span class="line">-A INPUT -p icmp -j ACCEPT</span><br><span class="line">-A INPUT -i lo -j ACCEPT</span><br><span class="line">-A INPUT -m state --state NEW -m tcp -p tcp --dport 22 -j ACCEPT <span class="comment"># ï¼ˆsshç«¯å£ï¼‰</span></span><br><span class="line">-A INPUT -m state --state NEW -m tcp -p tcp --dport 80 -j ACCEPT <span class="comment"># ï¼ˆwebç«¯å£ï¼‰</span></span><br><span class="line">-A INPUT -m state --state NEW -m tcp -p tcp --dport 21 -j ACCEPT <span class="comment"># ï¼ˆftpç«¯å£ï¼‰</span></span><br><span class="line">-A INPUT -j REJECT --reject-with icmp-host-prohibited</span><br><span class="line">-A FORWARD -j REJECT --reject-with icmp-host-prohibited</span><br><span class="line">COMMIT</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹å®Œé˜²ç«å¢™iptablesåï¼Œéœ€è¦é‡æ–°å¯åŠ¨ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/iptables restart</span><br><span class="line"><span class="comment"># æˆ–è€…</span></span><br><span class="line">service iptables restart</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šiptablesé…ç½®æ–‡ä»¶å­˜æ”¾ä½ç½®æ˜¯ï¼š/etc/sysconfig/iptables<br>ä¿å­˜å‘½ä»¤ï¼šservice iptables save<br>ä½¿ç”¨å‘½ä»¤ï¼šiptables -L -n å¯ä»¥æŸ¥çœ‹å½“å‰iptablesçš„å¼€æ”¾ç«¯å£æƒ…å†µã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¿…æœ(xunsearch) å¤šå€¼å±æ€§çš„å¤„ç†</title>
      <link href="/post/10379547.html"/>
      <url>/post/10379547.html</url>
      
        <content type="html"><![CDATA[<p>æˆ‘ä¹‹å‰ä½¿ç”¨Yii2æ¡†æ¶åšäº†ä¸€ä¸ªç”µå½±ç½‘ç«™<a href="http://www.dy360.net" target="_blank" rel="noopener">dy360.net</a>,ç½‘ç«™çš„æœç´¢æ˜¯é€šè¿‡MySQLçš„likeå®ç°ï¼Œæœç´¢çš„æ¡ä»¶å¾ˆå¤šï¼Œæ‹…å¿ƒä»¥åæ•°æ®è¶Šæ¥è¶Šå¤šï¼Œä¼šæ‹–å®ç½‘ç«™çš„é€Ÿåº¦ï¼Œäºæ˜¯æƒ³é€šè¿‡æœç´¢å¼•æ“æ¥è§£å†³ï¼ å¼€å§‹å‡†å¤‡ä½¿ç”¨sphinxï¼Œç ”ç©¶å‘ç°ä¸å¤ªå¥½ä½¿ã€‚åå‘ç°è¿…æœ(xunsearch)ï¼Œæ–‡æ¡£æ¯”è¾ƒæ¸…æ¥šï¼Œä¸Šæ‰‹æ¯”è¾ƒç®€å•ï¼Œå¹¶ä¸”æœ‰Yii2çš„composeråŒ…ï¼Œäºæ˜¯å†³å®šä½¿ç”¨è¿…æœã€‚</p><a id="more"></a><p>ä½¿ç”¨çš„è¿‡ç¨‹ä¸­é‡åˆ°è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼šä¸€éƒ¨ç”µå½±æœ‰å¤šä¸ªæ¼”å‘˜ï¼Œå‡ºå“å›½å®¶æˆ–åœ°åŒºï¼Œå…¶å®å°±æ˜¯æ–‡æ¡£çš„å¤šå€¼å±æ€§çš„æ–°å»ºã€æœç´¢çš„é—®é¢˜ã€‚æˆ‘ç ”ç©¶äº†ä¸€ä¸‹ï¼Œæœ€ç»ˆç»“å±€æ–¹æ¡ˆå¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#é¡¹ç›®çš„é…ç½®æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line">project.name = yddy</span><br><span class="line">project.default_charset = utf-8</span><br><span class="line">server.index = 8383</span><br><span class="line">server.search = 8384</span><br><span class="line"></span><br><span class="line">[id]</span><br><span class="line"><span class="built_in">type</span> = id</span><br><span class="line">phrase = yes</span><br><span class="line"></span><br><span class="line">[summary]</span><br><span class="line"><span class="built_in">type</span> = body</span><br><span class="line">cutlen=900</span><br><span class="line"></span><br><span class="line">[year]</span><br><span class="line"><span class="built_in">type</span> = numeric</span><br><span class="line">phrase = yes</span><br><span class="line">index = self</span><br><span class="line"> </span><br><span class="line">[actors_text]</span><br><span class="line"><span class="built_in">type</span> = string</span><br><span class="line">index = self</span><br><span class="line">tokenizer = split(/)</span><br><span class="line"></span><br><span class="line">[category_id]</span><br><span class="line"><span class="built_in">type</span> = string</span><br><span class="line">index = self</span><br><span class="line">tokenizer = split(,)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[country_id]</span><br><span class="line"><span class="built_in">type</span> = string</span><br><span class="line">index = self</span><br><span class="line">tokenizer = split(,)</span><br><span class="line">phrase = yes</span><br></pre></td></tr></table></figure><p>å…¶å®å°±æ˜¯ä½¿ç”¨è¿…æœçš„tokenizeråˆ†è¯å™¨ï¼Œæ–‡æ¡£ä¸Šå…·ä½“çš„è¯­æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">tokenizer åˆ†è¯å™¨</span><br><span class="line"></span><br><span class="line">é»˜è®¤ä¸º default é‡‡ç”¨å†…ç½®çš„åŠŸèƒ½å¼ºå¤§çš„ scws åˆ†è¯ï¼Œé€‚åˆç»å¤§å¤šæ•°å­—ç¬¦ä¸²å­—æ®µã€‚ä¹Ÿå¯ä»¥æŒ‡å®šè‡ªå®šä¹‰åˆ†è¯å™¨ï¼Œ æ ¼å¼ä¸º name æˆ– name(arg) ä¸¤ç§å½¢å¼ï¼Œå…¶ä¸­ name æ˜¯åˆ†è¯å™¨åç§°ï¼Œarg åˆ™æ˜¯ä¼ é€’ç»™åˆ†è¯å™¨æ„é€ å‡½æ•°çš„å‚æ•°ã€‚ è‡ªå®šä¹‰åˆ†è¯å™¨éœ€è¦åœ¨ lib/ ç›®å½•ä¸‹ç¼–å†™åä¸º XSTokenizerName çš„åˆ†è¯ç±»å¹¶å®ç°æ¥å£ XSTokenizerï¼Œ å†…ç½®æ”¯æŒçš„åˆ†è¯å™¨æœ‰ä»¥ä¸‹å‡ ç§ï¼š</span><br><span class="line"></span><br><span class="line">full è¡¨ç¤ºæœ¬å­—æ®µçš„å€¼æ•´ä½“ä½œä¸ºä¸€ä¸ªæ£€ç´¢è¯ï¼Œåƒå„ç§ ID éƒ½é€‚åˆè¿™ç§æƒ…å†µ</span><br><span class="line">none è¡¨ç¤ºæœ¬å­—æ®µæ²¡æœ‰ä»»ä½•è¯æ±‡ç”¨äºç´¢å¼•</span><br><span class="line">split([ ]) è¡¨ç¤ºæ ¹æ®å‚æ•°åˆ†å‰²å†…å®¹ï¼Œé»˜è®¤å‚æ•°ä¸ºç©ºæ ¼ï¼Œè‹¥å‚æ•°ä»¥ / å¼€å¤´å¹¶ä»¥ / ç»“å°¾åˆ™ å†…éƒ¨è°ƒç”¨ preg_split(arg, ..) æ¥åˆ†å‰²å–è¯ï¼Œä»¥æ”¯æŒæ­£åˆ™æˆ–å…¶å®ƒç‰¹æ®Šå­—ç¬¦åˆ†å‰²</span><br><span class="line">xlen([2]) è¡¨ç¤ºæ ¹æ®æŒ‡å®šå‚æ•°é•¿åº¦åˆ†æ®µå–è¯ï¼Œå¦‚ ABCDEF =&gt; AB + CD + EF</span><br><span class="line">xstep([2]) è¡¨ç¤ºæ ¹æ®æŒ‡å®šå‚æ•°æ­¥é•¿é€æ®µå–è¯ï¼Œå¦‚ ABCDEF =&gt; AB + ABCD + ABCDEF</span><br><span class="line">scws([3]) è¡¨ç¤ºé‡‡ç”¨æŒ‡å®šå‚æ•°ä¸ºå¤åˆç­‰çº§çš„ scws åˆ†è¯ï¼Œï¼ˆè‹¥æ— ç‰¹æ®Šå¤åˆéœ€æ±‚ï¼Œæ— éœ€æŒ‡å®šï¼‰</span><br><span class="line">tokenizer = default</span><br></pre></td></tr></table></figure><p>ç„¶åï¼Œæ ¹æ®ä¸åŒæƒ…å†µä½¿ç”¨ä¸åŒçš„åˆ†å‰²å‚æ•°ï¼Œè­¬å¦‚ï¼Œæœ‰çš„ä½¿ç”¨â€™/â€˜ï¼Œæœ‰çš„ä½¿ç”¨â€™,â€™ã€‚<br>æœ€åï¼Œæœç´¢ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">public static <span class="keyword">function</span> search(<span class="variable">$params</span>)&#123;</span><br><span class="line">        <span class="variable">$db</span> = Yii::<span class="variable">$app</span>-&gt;xunsearch-&gt;getDatabase(<span class="string">'yddy'</span>);</span><br><span class="line">        <span class="variable">$xs</span> = <span class="variable">$db</span>-&gt;xs;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$search</span> = <span class="variable">$xs</span>-&gt;getSearch();</span><br><span class="line"></span><br><span class="line">        <span class="variable">$keywords</span> = <span class="variable">$params</span>[<span class="string">'word'</span>];</span><br><span class="line">        <span class="keyword">if</span>(empty(<span class="variable">$keywords</span>))&#123;</span><br><span class="line">            <span class="variable">$keywords</span> =<span class="string">''</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$search</span> = <span class="variable">$search</span>-&gt;setQuery(<span class="variable">$keywords</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$category</span>=<span class="variable">$params</span>[<span class="string">'category'</span>])&#123;</span><br><span class="line">            <span class="variable">$search</span>-&gt;addQueryTerm(<span class="string">'category_id'</span>,<span class="variable">$category</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$country</span>=<span class="variable">$params</span>[<span class="string">'country'</span>])&#123;</span><br><span class="line">            <span class="variable">$search</span>-&gt;addQueryTerm(<span class="string">'country_id'</span>,<span class="variable">$country</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>( (empty(<span class="variable">$params</span>[<span class="string">'other'</span>]) ) &amp;&amp; (<span class="variable">$year</span> = intval(<span class="variable">$params</span>[<span class="string">'year'</span>])) &amp;&amp; is_numeric(<span class="variable">$params</span>[<span class="string">'year'</span>]))&#123;</span><br><span class="line">            <span class="variable">$search</span>-&gt;addQueryTerm(<span class="string">'year'</span>,<span class="variable">$year</span>);</span><br><span class="line"></span><br><span class="line">        &#125;elseif((<span class="variable">$params</span>[<span class="string">'other'</span>] == <span class="string">'ago'</span>) &amp;&amp; (<span class="variable">$year</span> = intval(<span class="variable">$params</span>[<span class="string">'year'</span>])) )&#123;</span><br><span class="line">            //<span class="variable">$search</span>-&gt;addRange(<span class="string">'year'</span>,1900,1978);</span><br><span class="line">            <span class="variable">$search</span>-&gt;addRange(<span class="string">'year'</span>,1900,<span class="variable">$year</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>( <span class="variable">$rating</span>=intval(<span class="variable">$params</span>[<span class="string">'rating'</span>]))&#123;</span><br><span class="line">            <span class="variable">$search</span>-&gt;addQueryTerm(<span class="string">'rate'</span>, <span class="variable">$rating</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$search</span>-&gt;addQueryTerm(<span class="string">'subtype'</span>,<span class="variable">$params</span>[<span class="string">'subtype'</span>]);</span><br><span class="line">        //<span class="variable">$search</span>-&gt;addQueryTerm(<span class="string">'status'</span>,1);</span><br><span class="line">        //<span class="built_in">echo</span> <span class="variable">$search</span>-&gt;getQuery();</span><br><span class="line">        <span class="built_in">return</span> <span class="variable">$search</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> xunsearch </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Centos6.9ä¸Šæ­å»ºlnmpç¯å¢ƒ</title>
      <link href="/post/123335f3.html"/>
      <url>/post/123335f3.html</url>
      
        <content type="html"><![CDATA[<p>æˆ‘å‡†å¤‡æŠŠä¹‹å‰åšçš„<a href="http://www.dy360.net" target="_blank" rel="noopener">www.dy360.net</a>é‡æ–°æèµ·æ¥ï¼Œå°±åœ¨vulträ¸Šä¹°äº†vpsï¼Œäºæ˜¯ä¹æœ‰äº†ä¸‹é¢è¿™ç¯‡æ–‡ç« ã€‚<br>åœ¨vpsä¸Šç³»ç»Ÿæ˜¯Centos6.9ï¼Œè‡³äºä¸ºä»€ä¹ˆä½¿ç”¨Centosï¼Œé‚£æ˜¯å› ä¸ºæˆ‘ä¸ªäººæ¯”è¾ƒç†Ÿæ‚‰Centosï¼</p><a id="more"></a><h4 id="yumå®‰è£…Nginx"><a href="#yumå®‰è£…Nginx" class="headerlink" title="yumå®‰è£…Nginx"></a>yumå®‰è£…Nginx</h4><p>1.æ‰§è¡Œä¸‹é¢çš„yumå‘½ä»¤å®‰è£…Nginx</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install nginx</span><br></pre></td></tr></table></figure><p>å¦‚æœä¸Šé¢å‘½ä»¤æ²¡æœ‰æ‰§è¡ŒæˆåŠŸï¼Œè¯´æ˜ç³»ç»Ÿä¸­yumæºä¸­æ²¡æœ‰Nginxçš„æºï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨æ·»åŠ Nginxçš„æºï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/yum.repos.d/nginx.repo</span><br><span class="line">è¾“å…¥ä¸€ä¸‹å†…å®¹ï¼š</span><br><span class="line"></span><br><span class="line">[nginx]</span><br><span class="line">name=nginx repo</span><br><span class="line">baseurl=http://nginx.org/packages/mainline/centos/6/<span class="variable">$basearch</span>/</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br><span class="line"></span><br><span class="line">ä¿å­˜ä¹‹åæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤æ›´æ–°æº</span><br><span class="line">yum clean all</span><br><span class="line">yum update</span><br></pre></td></tr></table></figure><p>2.å¯åŠ¨Nginx</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service nginx start</span><br></pre></td></tr></table></figure><p>ç°åœ¨Nginxå·²ç»å¯åŠ¨äº†ï¼Œç›´æ¥è®¿é—®æœåŠ¡å™¨å°±èƒ½çœ‹åˆ°Nginxæ¬¢è¿é¡µé¢äº†çš„ã€‚å¦‚æœè¿˜æ— æ³•è®¿é—®ï¼Œåˆ™éœ€é…ç½®ä¸€ä¸‹Linuxé˜²ç«å¢™ã€‚<br>3.é…ç½®é˜²ç«å¢™,å¼€æ”¾80ç«¯å£</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/sysconfig/iptables</span><br><span class="line"></span><br><span class="line">-A INPUT -p tcp -m state --state NEW -m tcp --dport 22 -j ACCEPT</span><br><span class="line"><span class="comment">#å¤åˆ¶ä¸Šé¢ä¸€è¡Œï¼Œå°†22æ”¹æˆ80,ä¿å­˜å³å¯</span></span><br><span class="line">-A INPUT -p tcp -m state --state NEW -m tcp --dport 80 -j ACCEPT</span><br><span class="line"></span><br><span class="line"><span class="comment">#æœ€å¥½é‡å¯ä¸€ä¸‹é˜²ç«å¢™</span></span><br><span class="line">service iptables restart</span><br></pre></td></tr></table></figure><blockquote><p> æ³¨æ„ï¼šå¦‚æœæ˜¯é˜¿é‡Œäº‘çš„ecs,ä½ å¯èƒ½éœ€è¦åœ¨é˜¿é‡Œäº‘çš„ä¸»æœºç®¡ç†åå°ï¼Œæ·»åŠ å®‰å…¨ç»„è§„åˆ™ï¼Œæ–¹å¯å¼€å¯80ç«¯å£</p></blockquote><p>4.è®¾ç½®å¼€æœºå¯åŠ¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chkconfig --list | grep nginx</span><br><span class="line">chkconfig nginx  on</span><br></pre></td></tr></table></figure><p><em>ENDï¼šNginxå®‰è£…é…ç½®å®Œæˆ</em></p><hr><h4 id="yum-å®‰è£…MySQL5-6"><a href="#yum-å®‰è£…MySQL5-6" class="headerlink" title="yum å®‰è£…MySQL5.6"></a>yum å®‰è£…MySQL5.6</h4><p><em>å‚è€ƒ:</em></p><p><a href="https://www.cnblogs.com/007sx/p/7083143.html" target="_blank" rel="noopener">https://www.cnblogs.com/007sx/p/7083143.html</a><br>1.æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦å®‰è£…å…¶ä»–ç‰ˆæœ¬çš„MYSQLæ•°æ®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum list installed | grep mysql</span><br><span class="line">yum -y remove mysql-libs.x86_64</span><br></pre></td></tr></table></figure><p>2.é…ç½®MySQLæº</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget http://repo.mysql.com/mysql-community-release-el6-5.noarch.rpm</span><br><span class="line">rpm -ivh mysql-community-release-el6-5.noarch.rpm</span><br><span class="line">yum repolist all | grep mysql</span><br></pre></td></tr></table></figure><p>3.å®‰è£…MYSQLæ•°æ®åº“<br> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install mysql-community-server -y</span><br></pre></td></tr></table></figure></p><p>4.è®¾ç½®ä¸ºå¼€æœºå¯åŠ¨(2ã€3ã€4éƒ½æ˜¯onä»£è¡¨å¼€æœºè‡ªåŠ¨å¯åŠ¨)<br> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chkconfig --list | grep mysqld</span><br><span class="line">chkconfig mysqld on</span><br></pre></td></tr></table></figure><br>5.å¯åŠ¨mysql<br> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"> service mysqld start</span><br><span class="line"> </span><br><span class="line"> <span class="comment"># æ˜¾ç¤ºå¦‚å›¾ï¼ˆéƒ¨åˆ†ï¼‰</span></span><br><span class="line"> </span><br><span class="line"> PLEASE REMEMBER TO SET A PASSWORD FOR THE MySQL root USER !</span><br><span class="line">To <span class="keyword">do</span> so, start the server, <span class="keyword">then</span> issue the following commands:</span><br><span class="line"></span><br><span class="line">  /usr/bin/mysqladmin -u root password <span class="string">'new-password'</span></span><br><span class="line">  /usr/bin/mysqladmin -u root -h vultr password <span class="string">'new-password'</span></span><br><span class="line"></span><br><span class="line">Alternatively you can run:</span><br><span class="line"></span><br><span class="line">  /usr/bin/mysql_secure_installation</span><br><span class="line"></span><br><span class="line"><span class="built_in">which</span> will also give you the option of removing the <span class="built_in">test</span></span><br><span class="line">databases and anonymous user created by default.  This is</span><br><span class="line">strongly recommended <span class="keyword">for</span> production servers.</span><br><span class="line"></span><br><span class="line">See the manual <span class="keyword">for</span> more instructions.</span><br><span class="line"></span><br><span class="line">Please report any problems at http://bugs.mysql.com/</span><br><span class="line"></span><br><span class="line">The latest information about MySQL is available on the web at</span><br><span class="line"></span><br><span class="line">  http://www.mysql.com</span><br><span class="line"></span><br><span class="line">Support MySQL by buying support/licenses at http://shop.mysql.com</span><br><span class="line"></span><br><span class="line">Note: new default config file not created.</span><br><span class="line">Please make sure your config file is current</span><br><span class="line"></span><br><span class="line">WARNING: Default config file /etc/my.cnf exists on the system</span><br><span class="line">This file will be <span class="built_in">read</span> by default by the MySQL server</span><br><span class="line">If you <span class="keyword">do</span> not want to use this, either remove it, or use the</span><br><span class="line">--defaults-file argument to mysqld_safe when starting the server</span><br><span class="line"></span><br><span class="line">                                                           [  OK  ]</span><br><span class="line">Starting mysqld:                                           [  OK  ]</span><br></pre></td></tr></table></figure><br>6.è®¾ç½®mysqlå¯†ç </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/bin/mysqladmin -u root password <span class="string">'xxxxx'</span></span><br></pre></td></tr></table></figure><p>å®‰å…¨å¤„ç†,çœ‹ä¸æ‡‚è‹±æ–‡ç›´æ¥ä¸€è·¯yeså°±è¡Œ<br> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/bin/mysql_secure_installation</span><br></pre></td></tr></table></figure><br>[æ³¨æ„]2017/12/24æ›´æ–°ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">ä»Šæ—¥å®‰è£…MySQLæ‰§è¡Œä¸Šé¢çš„å‘½ä»¤çš„æ—¶å€™å‡ºç°ä¸‹é¢çš„è¯</span><br><span class="line">In order to <span class="built_in">log</span> into MySQL to secure it, we<span class="string">'ll need the current</span></span><br><span class="line"><span class="string">password for the root user.  If you'</span>ve just installed MySQL, and</span><br><span class="line">you haven<span class="string">'t set the root password yet, the password will be blank,</span></span><br><span class="line"><span class="string">so you should just press enter here.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Enter current password for root (enter for none): </span></span><br><span class="line"><span class="string">OK, successfully used password, moving on...</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Setting the root password ensures that nobody can log into the MySQL</span></span><br><span class="line"><span class="string">root user without the proper authorisation.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">You already have a root password set, so you can safely answer '</span>n<span class="string">'.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Change the root password? [Y/n] Y</span></span><br><span class="line"><span class="string">New password: </span></span><br><span class="line"><span class="string">Re-enter new password: </span></span><br><span class="line"><span class="string">Password updated successfully!</span></span><br><span class="line"><span class="string">Reloading privilege tables..</span></span><br><span class="line"><span class="string"> ... Success!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">æ„æ€æ˜¯rootç”¨æˆ·è®¾ç½®å¯†ç ï¼Œä¹‹å‰æˆ‘ä»¬å·²ç»è®¾ç½®è¿‡äº†ï¼Œè¿™ä¸ªåœ°æ–¹è¾“å…¥â€œnoâ€å³å¯ï¼Œä¸ç„¶ä½ è¿˜è¦é‡æ–°è®¾ç½®rootç”¨æˆ·å¯†ç ã€‚</span></span><br></pre></td></tr></table></figure><p>7.è®¾ç½®utf-8ç¼–ç </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">æŸ¥çœ‹mysqlåŸæœ¬ç¼–ç ï¼š</span><br><span class="line">mysql&gt; show variables like <span class="string">'character%'</span>;</span><br><span class="line">+--------------------------+----------------------------+</span><br><span class="line">| Variable_name            | Value                      |</span><br><span class="line">+--------------------------+----------------------------+</span><br><span class="line">| character_set_client     | utf8                       |</span><br><span class="line">| character_set_connection | utf8                       |</span><br><span class="line">| character_set_database   | latin1                     |</span><br><span class="line">| character_set_filesystem | binary                     |</span><br><span class="line">| character_set_results    | utf8                       |</span><br><span class="line">| character_set_server     | latin1                     |</span><br><span class="line">| character_set_system     | utf8                       |</span><br><span class="line">| character_sets_dir       | /usr/share/mysql/charsets/ |</span><br><span class="line">+--------------------------+----------------------------+</span><br></pre></td></tr></table></figure><p>ç¼–è¾‘mysqlçš„é…ç½®æ–‡ä»¶/etc/my.cnf</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/my.cnf</span><br><span class="line"></span><br><span class="line">[mysqld]</span><br><span class="line">character-set-server=utf8 </span><br><span class="line">collation-server=utf8_general_ci </span><br><span class="line">sql_mode=<span class="string">'NO_ENGINE_SUBSTITUTION'</span></span><br><span class="line"></span><br><span class="line">[mysql]</span><br><span class="line">default-character-set = utf8</span><br><span class="line"></span><br><span class="line">[mysql.server]</span><br><span class="line">default-character-set = utf8</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[mysqld_safe]</span><br><span class="line">default-character-set = utf8</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[client]</span><br><span class="line">default-character-set = utf8</span><br><span class="line"></span><br><span class="line"><span class="comment">#é‡å¯mysql</span></span><br><span class="line">service mysqld restart</span><br><span class="line"></span><br><span class="line"><span class="comment">#å†æ¬¡æŸ¥çœ‹</span></span><br><span class="line"></span><br><span class="line">mysql&gt; show variables like <span class="string">'character%'</span>;</span><br><span class="line">+--------------------------+----------------------------+</span><br><span class="line">| Variable_name            | Value                      |</span><br><span class="line">+--------------------------+----------------------------+</span><br><span class="line">| character_set_client     | utf8                       |</span><br><span class="line">| character_set_connection | utf8                       |</span><br><span class="line">| character_set_database   | utf8                       |</span><br><span class="line">| character_set_filesystem | binary                     |</span><br><span class="line">| character_set_results    | utf8                       |</span><br><span class="line">| character_set_server     | utf8                       |</span><br><span class="line">| character_set_system     | utf8                       |</span><br><span class="line">| character_sets_dir       | /usr/share/mysql/charsets/ |</span><br><span class="line">+--------------------------+----------------------------+</span><br></pre></td></tr></table></figure><p><em>END:åˆ°æ­¤MySQLå®‰è£…é…ç½®æˆåŠŸ</em></p><hr><h4 id="ç¼–è¯‘å®‰è£…PHP7-0-26"><a href="#ç¼–è¯‘å®‰è£…PHP7-0-26" class="headerlink" title="ç¼–è¯‘å®‰è£…PHP7.0.26"></a>ç¼–è¯‘å®‰è£…PHP7.0.26</h4><p><em>å‚è€ƒï¼š</em></p><ol><li><p><a href="https://segmentfault.com/a/1190000005005068" target="_blank" rel="noopener">https://segmentfault.com/a/1190000005005068</a></p></li><li><p><a href="http://blog.csdn.net/tomspcc/article/details/71080991" target="_blank" rel="noopener">http://blog.csdn.net/tomspcc/article/details/71080991</a></p></li></ol><p>1.å®‰è£…PHPæ”¯æŒåº“</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install gcc gcc-c++ libmcrypt-devel mhash-devel libxslt-devel libjpeg libjpeg-devel libpng libpng-devel freetype freetype-devel  libxml2 libxml2-devel zlib zlib-devel glibc glibc-devel glib2 glib2-devel bzip2 bzip2-devel ncurses ncurses-devel curl curl-devel e2fsprogs e2fsprogs-devel krb5 krb5-devel libidn libidn-devel openssl openssl-devel php-mcrypt</span><br></pre></td></tr></table></figure><p>####<br>2.ä¸‹è½½PHP7.0.26æºç åŒ…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget  http://sg2.php.net/distributions/php-7.0.26.tar.gz</span><br></pre></td></tr></table></figure><p>3.ç¼–è¯‘å®‰è£…PHP</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">./configure \</span><br><span class="line">--prefix=/usr/<span class="built_in">local</span>/php \</span><br><span class="line">--<span class="built_in">exec</span>-prefix=/usr/<span class="built_in">local</span>/php \</span><br><span class="line">--bindir=/usr/<span class="built_in">local</span>/php/bin \</span><br><span class="line">--with-fpm-user=www \</span><br><span class="line">--with-fpm-group=www \</span><br><span class="line">--sbindir=/usr/<span class="built_in">local</span>/php/sbin \</span><br><span class="line">--includedir=/usr/<span class="built_in">local</span>/php/include \</span><br><span class="line">--libdir=/usr/<span class="built_in">local</span>/php/lib/php \</span><br><span class="line">--mandir=/usr/<span class="built_in">local</span>/php/php/man \</span><br><span class="line">--with-config-file-path=/usr/<span class="built_in">local</span>/php/etc \</span><br><span class="line">--with-mcrypt=/usr/include \</span><br><span class="line">--with-mhash \</span><br><span class="line">--with-openssl \</span><br><span class="line">--with-mysqli=shared,mysqlnd \</span><br><span class="line">--with-pdo-mysql=shared,mysqlnd \</span><br><span class="line">--with-gd \</span><br><span class="line">--with-iconv \</span><br><span class="line">--with-zlib \</span><br><span class="line">--<span class="built_in">enable</span>-zip \</span><br><span class="line">--<span class="built_in">enable</span>-inline-optimization \</span><br><span class="line">--<span class="built_in">disable</span>-debug \</span><br><span class="line">--<span class="built_in">disable</span>-rpath \</span><br><span class="line">--<span class="built_in">enable</span>-shared \</span><br><span class="line">--<span class="built_in">enable</span>-xml \</span><br><span class="line">--<span class="built_in">enable</span>-bcmath \</span><br><span class="line">--<span class="built_in">enable</span>-shmop \</span><br><span class="line">--<span class="built_in">enable</span>-sysvsem \</span><br><span class="line">--<span class="built_in">enable</span>-mbregex \</span><br><span class="line">--<span class="built_in">enable</span>-mbstring \</span><br><span class="line">--<span class="built_in">enable</span>-ftp \</span><br><span class="line">--<span class="built_in">enable</span>-gd-native-ttf \</span><br><span class="line">--<span class="built_in">enable</span>-pcntl \</span><br><span class="line">--<span class="built_in">enable</span>-sockets \</span><br><span class="line">--with-xmlrpc \</span><br><span class="line">--<span class="built_in">enable</span>-soap \</span><br><span class="line">--without-pear \</span><br><span class="line">--with-gettext \</span><br><span class="line">--<span class="built_in">enable</span>-session \</span><br><span class="line">--with-curl \</span><br><span class="line">--with-jpeg-dir \</span><br><span class="line">--with-freetype-dir \</span><br><span class="line">--<span class="built_in">enable</span>-opcache \</span><br><span class="line">--<span class="built_in">enable</span>-fpm \</span><br><span class="line">--without-gdbm \</span><br><span class="line">--<span class="built_in">disable</span>-fileinfo</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘æŠ¥ä¸‹é¢çš„é”™è¯¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">checking <span class="keyword">for</span> stdarg.h... (cached) yes</span><br><span class="line">checking <span class="keyword">for</span> mcrypt support... yes</span><br><span class="line">configure: error: mcrypt.h not found. Please reinstall libmcrypt.</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤å®‰è£…libmcrypet</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install libmcrypt-devel -y</span><br></pre></td></tr></table></figure><p>è‹¥ä¸Šé¢çš„æ–¹æ³•è§£å†³ä¸äº†ï¼Œå¯ä»¥ç¼–è¯‘å®‰è£…libmcrypet</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span>/src</span><br><span class="line">wget http://softlayer.dl.sourceforge.net/sourceforge/mcrypt/libmcrypt-2.5.8.tar.gz</span><br><span class="line">tar -zxvf libmcrypt-2.5.8.tar.gz</span><br><span class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span>/src/libmcrypt-2.5.8</span><br><span class="line">./configure --prefix=/usr/<span class="built_in">local</span></span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„æ–¹æ³•è¦æ˜¯è¿˜æ˜¯ä¸è¡Œï¼Œé‚£ç”¨ä¸‹é¢çš„æ–¹æ³•ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">å®‰è£…ç¬¬ä¸‰æ–¹yumæº</span><br><span class="line">wget http://www.atomicorp.com/installers/atomic</span><br><span class="line">sh ./atomic</span><br><span class="line"></span><br><span class="line">yum install libmcrypt-devel -y</span><br></pre></td></tr></table></figure><p>4.æœ€åæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œå®ŒæˆPHPçš„å®‰è£…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">make </span><br><span class="line">make install</span><br></pre></td></tr></table></figure><p>5.é…ç½®PHP-FPM</p><ul><li><p>å¢åŠ ç”¨æˆ·&amp;ç”¨æˆ·ç»„</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">groupadd www</span><br><span class="line">useradd -g www www</span><br></pre></td></tr></table></figure></li><li><p>æ‹·è´php-fpm.confæ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp /usr/<span class="built_in">local</span>/php/etc/php-fpm.conf.default /usr/<span class="built_in">local</span>/php/etc/php-fpm.conf</span><br></pre></td></tr></table></figure></li><li><p>æ‹·è´php-fpm includeæ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp usr/<span class="built_in">local</span>/php/etc/php-fpm.d/www.conf.default  www.conf</span><br></pre></td></tr></table></figure></li><li><p>ä»æºç åŒ…é‡Œæ‹·è´php.ini</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp /usr/<span class="built_in">local</span>/src/php-7.0.26/php.ini-production /usr/<span class="built_in">local</span>/php/etc/php.ini</span><br></pre></td></tr></table></figure></li></ul><p>6.å°†PHPåŠ å…¥ç¯å¢ƒå˜é‡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/profile</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/usr/<span class="built_in">local</span>/php/bin</span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure><p>7.php-fpmè‡ªå¯åŠ¨</p><ul><li>ä»æºç åŒ…é‡Œæ‹·è´å¯åŠ¨è„šæœ¬<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp sapi/fpm/init.d.php-fpm /etc/init.d/php-fpm</span><br></pre></td></tr></table></figure></li><li>åŠ å…¥ç³»ç»Ÿå¯åŠ¨é¡¹<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chkconfig php-fpm on</span><br></pre></td></tr></table></figure></li></ul><p>8.é‡å¯PHP</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service php-fpm restart</span><br></pre></td></tr></table></figure><p><em>END:PHPå®‰è£…é…ç½®å®Œæˆ</em></p><hr><h4 id="ç¼–è¯‘å®‰è£…git"><a href="#ç¼–è¯‘å®‰è£…git" class="headerlink" title="ç¼–è¯‘å®‰è£…git"></a>ç¼–è¯‘å®‰è£…git</h4><p><em>å‚è€ƒ:</em><br><a href="http://www.cnblogs.com/fazo/p/5578644.html" target="_blank" rel="noopener">http://www.cnblogs.com/fazo/p/5578644.html</a></p><p>1.å®‰è£…ä¾èµ–çš„åŒ…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install curl-devel expat-devel gettext-devel openssl-devel zlib-devel gcc perl-ExtUtils-MakeMaker</span><br></pre></td></tr></table></figure><p>2.ä¸‹è½½æºç åŒ…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/git/git/archive/v2.9.0.zip</span><br><span class="line">unzip v2.9.0.zip</span><br><span class="line"><span class="built_in">cd</span> git-2.9.0</span><br></pre></td></tr></table></figure><p>3.ç¼–è¯‘å®‰è£…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">make prefix=/usr/<span class="built_in">local</span>/git all</span><br><span class="line">make prefix=/usr/<span class="built_in">local</span>/git install</span><br></pre></td></tr></table></figure><p>4.åŠ å…¥ç³»ç»Ÿå˜é‡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/profile  </span><br><span class="line"><span class="built_in">export</span> PATH=/usr/<span class="built_in">local</span>/git/bin:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure><p>5.é…ç½®git</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name <span class="string">'vultr'</span></span><br><span class="line">git config --global user.email <span class="string">'vultr@dy360.net'</span> <span class="string">'vultr@dy360.net'</span></span><br><span class="line">git config --global credential.helper store <span class="comment">#ä¿å­˜å¯†ç </span></span><br></pre></td></tr></table></figure><p>6.ç”Ÿæˆsshå¯†é’¥,æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œä¸€è·¯å›è½¦å³å¯ï¼Œå³å¯ç”¨å¯†é’¥å…‹éš†é¡¹ç›®ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C <span class="string">'vultr@dy360.net'</span></span><br></pre></td></tr></table></figure><p><em>END:gitå®‰è£…é…ç½®æˆåŠŸ</em></p><hr><p>æœ€åï¼Œç»ˆäºç¯å¢ƒæ­å»ºå¥½äº†ï¼è‡ªå·±æ­å»ºlnmpç¯å¢ƒå°‘è¯´ä¹Ÿæœ‰åå‡ æ¬¡äº†ï¼Œå¯æ˜¯æ¯æ¬¡éƒ½æœ‰æ–°æ„Ÿè§‰ï¼å› ä¸ºæ¯æ¬¡å‡ºç°çš„é—®é¢˜ï¼Œéƒ½ä¸å¤ªä¸€æ ·ï¼æœ€è¿‘ä¸¤æ¬¡éƒ½å‡ºç°äº†Nginxå®‰è£…åï¼Œé€šè¿‡ipä¸èƒ½è®¿é—®çš„é—®é¢˜ï¼Œç»“æœå‘ç°éƒ½æ˜¯é˜²ç«å¢™çš„é—®é¢˜ï¼Œæ²¡æœ‰å¼€å¯80ç«¯å£ã€‚å‘çš„è¦å‘½ï¼</p>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> php </tag>
            
            <tag> nginx </tag>
            
            <tag> mysql </tag>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>tar åˆ†å·å‹ç¼©å’Œè§£å‹</title>
      <link href="/post/4aac2ff2.html"/>
      <url>/post/4aac2ff2.html</url>
      
        <content type="html"><![CDATA[<p>tar æœ¬èº«ä¸ºä¸€ä¸ªæ‰“åŒ…å·¥å…·ï¼Œå¯ä»¥æŠŠç›®å½•æ‰“åŒ…æˆä¸€ä¸ªæ–‡ä»¶ï¼Œå®ƒçš„å¥½å¤„æ˜¯å®ƒæŠŠæ‰€æœ‰æ–‡ä»¶æ•´åˆæˆä¸€ä¸ªå¤§æ–‡ä»¶æ•´ä½“ï¼Œæ–¹ä¾¿æ‹·è´æˆ–è€…ç§»åŠ¨ã€‚</p><a id="more"></a><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">è¯­æ³•ï¼štar [-zjxcvfpP] filename,tarå‘½ä»¤æœ‰å¤šä¸ªé€‰é¡¹ï¼Œå…¶ä¸­ä¸å¸¸ç”¨çš„åšäº†æ ‡æ³¨ã€‚</span><br><span class="line"></span><br><span class="line">â€œ-zâ€ : åŒæ—¶ç”¨gzipå‹ç¼©</span><br><span class="line"></span><br><span class="line">â€œ-jâ€ : åŒæ—¶ç”¨bzip2å‹ç¼©</span><br><span class="line"></span><br><span class="line">â€œ-xâ€ : è§£åŒ…æˆ–è€…è§£å‹ç¼©</span><br><span class="line"></span><br><span class="line">â€œ-tâ€ : æŸ¥çœ‹taråŒ…é‡Œé¢çš„æ–‡ä»¶</span><br><span class="line"></span><br><span class="line">â€œ-câ€ : å»ºç«‹ä¸€ä¸ªtaråŒ…æˆ–è€…å‹ç¼©æ–‡ä»¶åŒ…</span><br><span class="line"></span><br><span class="line">â€œ-vâ€ : å¯è§†åŒ–</span><br><span class="line"></span><br><span class="line">â€œ-fâ€ : åé¢è·Ÿæ–‡ä»¶åï¼Œå‹ç¼©æ—¶è·Ÿ â€œ-f æ–‡ä»¶åâ€ï¼Œæ„æ€æ˜¯å‹ç¼©åçš„æ–‡ä»¶åä¸ºfilename, è§£å‹æ—¶è·Ÿ â€œ-f æ–‡ä»¶åâ€ï¼Œæ„æ€æ˜¯è§£å‹filename. è¯·æ³¨æ„ï¼Œå¦‚æœæ˜¯å¤šä¸ªå‚æ•°ç»„åˆçš„æƒ…å†µä¸‹å¸¦æœ‰ â€œ-fâ€ï¼Œè¯·æŠŠ â€œ-fâ€ å†™åˆ°æœ€åé¢ã€‚</span><br><span class="line"></span><br><span class="line">â€œ-pâ€ : ä½¿ç”¨åŸæ–‡ä»¶çš„å±æ€§ï¼Œå‹ç¼©å‰ä»€ä¹ˆå±æ€§å‹ç¼©åè¿˜ä»€ä¹ˆå±æ€§ã€‚ï¼ˆä¸å¸¸ç”¨ï¼‰</span><br><span class="line"></span><br><span class="line">â€œ-Pâ€ : å¯ä»¥ä½¿ç”¨ç»å¯¹è·¯å¾„ã€‚ï¼ˆä¸å¸¸ç”¨ï¼‰</span><br><span class="line"></span><br><span class="line">--exclude filename : åœ¨æ‰“åŒ…æˆ–è€…å‹ç¼©æ—¶ï¼Œä¸è¦å°†filenameæ–‡ä»¶åŒ…æ‹¬åœ¨å†…ã€‚ï¼ˆä¸å¸¸ç”¨ï¼‰</span><br></pre></td></tr></table></figure><p>é‚£å¦‚ä½•åˆ†å·è§£å‹ç¼©å‘¢ï¼Ÿ</p><p>å‡å¦‚è¦å°†ç›®å½•logsæ‰“åŒ…å‹ç¼©å¹¶åˆ†å‰²æˆå¤šä¸ª1Mçš„æ–‡ä»¶ï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">tar cjf - logs/ |split -b 1m - logs.tar.bz2</span><br><span class="line">å®Œæˆåä¼šäº§ç”Ÿä¸‹åˆ—æ–‡ä»¶ï¼š</span><br><span class="line">logs.tar.bz2.aa, logs.tar.bz2.ab, logs.tar.bz2.ac</span><br><span class="line">è¦è§£å‹çš„æ—¶å€™åªè¦æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤å°±å¯ä»¥äº†ï¼š</span><br><span class="line">cat logs.tar.bz2.a* | tar xj</span><br><span class="line"></span><br><span class="line">å†ä¸¾ä¾‹ï¼š</span><br><span class="line">è¦å°†æ–‡ä»¶test.pdfåˆ†åŒ…å‹ç¼©æˆ500 bytesçš„æ–‡ä»¶ï¼š</span><br><span class="line">tar czf - test.pdf | split -b 500 - test.tar.gz</span><br><span class="line">æœ€åè¦æé†’ä½†æ˜¯é‚£ä¸¤ä¸ª"-"ä¸è¦æ¼äº†ï¼Œé‚£æ˜¯tarçš„ouputå’Œsplitçš„inputçš„å‚æ•°ã€‚</span><br><span class="line"></span><br><span class="line">tar cjf - logs/ |split -b 1m - logs.tar.bz2.</span><br><span class="line">å®Œæˆåä¼šäº§ç”Ÿä¸‹åˆ—æ–‡ä»¶ï¼š</span><br><span class="line">logs.tar.bz2.aa, logs.tar.bz2.ab, logs.tar.bz2.ac</span><br><span class="line">è¦è§£å‹çš„æ—¶å€™åªè¦æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤å°±å¯ä»¥äº†ï¼š</span><br><span class="line">cat logs.tar.bz2.a* | tar xj</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•å¼ºåˆ¶å…¨ç«™httpsè®¿é—®</title>
      <link href="/post/773d918c.html"/>
      <url>/post/773d918c.html</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¤©åœ¨é˜¿é‡Œäº‘ä¸Šæäº†ä¸€ä¸ªå…è´¹çš„httpsè¯ä¹¦ï¼Œäºæ˜¯å°±åœ¨è‡ªå·±çš„æœåŠ¡å™¨ä¸Šå®‰è£…äº†ä¸€ä¸‹ï¼Œé…ç½®å¥½è¯ä¹¦ä¹‹åï¼Œå¦‚ä½•å¼ºåˆ¶å…¨ç«™httpsè®¿é—®å‘¢ï¼Ÿå…¶å®æ–¹æ³•æœ‰å¾ˆå¤šï¼Œè¿™é‡Œåªç»™å‡ºä¸¤ä¸ªæ¯”è¾ƒç®€å•çš„æ–¹æ³•ï¼š</p><a id="more"></a><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">åœ¨è‡ªå·±çš„è™šæ‹Ÿä¸»æœºé…ç½®serverèŠ‚ç‚¹ä¸­æ·»åŠ ä¸‹é¢çš„ä»£ç ï¼Œä½¿ç”¨å…¶ä¸€å³å¯ã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash">æ–¹æ³•ä¸€</span></span><br><span class="line">rewrite ^ https://$server_name$request_uri? permanent;</span><br><span class="line"><span class="meta">#</span><span class="bash">æ–¹æ³•äºŒ</span></span><br><span class="line">return 301 https://$server_name$request_uri;</span><br></pre></td></tr></table></figure><p>æˆ‘ç”¨çš„æ˜¯ç¬¬ä¸€ä¸ªæ–¹æ³•ï¼Œå¤§å®¶å¯ä»¥æ ¹æ®è‡ªå·±çš„å–œå¥½ï¼Œæ¥å†³å®šä½¿ç”¨å“ªä¸­æ–¹æ³•ã€‚ä¸‹é¢è´´å‡ºæˆ‘è‡ªå·±ç½‘ç«™çš„é…ç½®ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen     443;</span><br><span class="line">    listen     80;</span><br><span class="line">    </span><br><span class="line">    server_name  www.ydstudio.net;</span><br><span class="line">    set $my_server_name $scheme://$server_name;</span><br><span class="line">    </span><br><span class="line">    #é˜²æ­¢ipè®¿é—®ï¼Œå¦‚http://xxx.xxx.xxx.xxxæˆ–è€…https://xxx.xxx.xxx.xxx</span><br><span class="line">    if ( $host ~* "\d+\.\d+\.\d+\.\d+" ) &#123;</span><br><span class="line">        rewrite ^ https://$server_name;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    if ( $my_server_name != https://$server_name ) &#123;</span><br><span class="line">       rewrite ^ https://$server_name$request_uri? permanent;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    location / &#123;</span><br><span class="line">       root   /usr/share/nginx/html/typecho/;</span><br><span class="line">       try_files $uri $uri/ /index.php$is_args$args;</span><br><span class="line">       index index.php  index.html index.htm;</span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">    #error_page  404              /404.html;</span><br><span class="line">    # redirect server error pages to the static page /50x.html</span><br><span class="line">    error_page   500 502 503 504  /50x.html;</span><br><span class="line">    location = /50x.html &#123;</span><br><span class="line">        root   /usr/share/nginx/html;</span><br><span class="line">    &#125;</span><br><span class="line">    # proxy the PHP scripts to Apache listening on 127.0.0.1:80</span><br><span class="line">    #location ~ \.php$ &#123;</span><br><span class="line">    #    proxy_pass   http://127.0.0.1;</span><br><span class="line">    #&#125;</span><br><span class="line">    # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span><br><span class="line">    location ~ \.php$ &#123;</span><br><span class="line">       #root           html;</span><br><span class="line">       fastcgi_pass   127.0.0.1:9000;</span><br><span class="line">       fastcgi_index  index.php;</span><br><span class="line">       fastcgi_param  SCRIPT_FILENAME  /usr/share/nginx/html/typecho/$fastcgi_script_name;</span><br><span class="line">       include        fastcgi_params;</span><br><span class="line">    &#125;</span><br><span class="line">    # deny access to .htaccess files, if Apache's document root</span><br><span class="line">    # concurs with nginx's one</span><br><span class="line">    #location ~ /\.ht &#123;</span><br><span class="line">    #    deny  all;</span><br><span class="line">    #&#125;</span><br><span class="line">    ssl on;</span><br><span class="line">    ssl_certificate   /etc/nginx/cert/214353452860792.pem;</span><br><span class="line">    ssl_certificate_key  /etc/nginx/cert/214353452860792.key;</span><br><span class="line">    ssl_session_timeout 5m;</span><br><span class="line">    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;</span><br><span class="line">    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;</span><br><span class="line">    ssl_prefer_server_ciphers on;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxä¸‹chkconfigå‘½ä»¤è¯¦è§£</title>
      <link href="/post/a5b69b88.html"/>
      <url>/post/a5b69b88.html</url>
      
        <content type="html"><![CDATA[<h4 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h4><p>chkconfigå‘½ä»¤æ£€æŸ¥ã€è®¾ç½®ç³»ç»Ÿçš„å„ç§æœåŠ¡ã€‚è¿™æ˜¯Red Hatå…¬å¸éµå¾ªGPLè§„åˆ™æ‰€å¼€å‘çš„ç¨‹åºï¼Œå®ƒå¯æŸ¥è¯¢æ“ä½œç³»ç»Ÿåœ¨æ¯ä¸€ä¸ªæ‰§è¡Œç­‰çº§ä¸­ä¼šæ‰§è¡Œå“ªäº›ç³»ç»ŸæœåŠ¡ï¼Œå…¶ä¸­åŒ…æ‹¬å„ç±»å¸¸é©»æœåŠ¡ã€‚è°¨è®°chkconfigä¸æ˜¯ç«‹å³è‡ªåŠ¨ç¦æ­¢æˆ–æ¿€æ´»ä¸€ä¸ªæœåŠ¡ï¼Œå®ƒåªæ˜¯ç®€å•çš„æ”¹å˜äº†ç¬¦å·è¿æ¥ã€‚</p><a id="more"></a><h4 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@iZwz99xkrnh5xy0cqp8aofZ ~]# chkconfig --help</span><br><span class="line">chkconfig version 1.3.49.5 - Copyright (C) 1997-2000 Red Hat, Inc.</span><br><span class="line">This may be freely redistributed under the terms of the GNU Public License.</span><br><span class="line"></span><br><span class="line">usage:   chkconfig [--list] [--type &lt;type&gt;] [name]</span><br><span class="line">         chkconfig --add &lt;name&gt;</span><br><span class="line">         chkconfig --del &lt;name&gt;</span><br><span class="line">         chkconfig --override &lt;name&gt;</span><br><span class="line">         chkconfig [--level &lt;levels&gt;] [--type &lt;type&gt;] &lt;name&gt; &lt;on|off|reset|resetpriorities&gt;</span><br><span class="line">[root@iZwz99xkrnh5xy0cqp8aofZ ~]# </span><br><span class="line"></span><br><span class="line">--addï¼šå¢åŠ æ‰€æŒ‡å®šçš„ç³»ç»ŸæœåŠ¡ï¼Œè®©chkconfigæŒ‡ä»¤å¾—ä»¥ç®¡ç†å®ƒï¼Œå¹¶åŒæ—¶åœ¨ç³»ç»Ÿå¯åŠ¨çš„å™è¿°æ–‡ä»¶å†…å¢åŠ ç›¸å…³æ•°æ®ï¼› </span><br><span class="line">--delï¼šåˆ é™¤æ‰€æŒ‡å®šçš„ç³»ç»ŸæœåŠ¡ï¼Œä¸å†ç”±chkconfigæŒ‡ä»¤ç®¡ç†ï¼Œå¹¶åŒæ—¶åœ¨ç³»ç»Ÿå¯åŠ¨çš„å™è¿°æ–‡ä»¶å†…åˆ é™¤ç›¸å…³æ•°æ®ï¼› </span><br><span class="line">--level&lt;ç­‰çº§ä»£å·&gt;ï¼šæŒ‡å®šè¯»ç³»ç»ŸæœåŠ¡è¦åœ¨å“ªä¸€ä¸ªæ‰§è¡Œç­‰çº§ä¸­å¼€å¯æˆ–å…³æ¯•ã€‚</span><br></pre></td></tr></table></figure><p>levelç­‰çº§ä»£å·è§£é‡Šå¦‚ä¸‹ï¼š</p><ul><li>ç­‰çº§0è¡¨ç¤ºï¼šè¡¨ç¤ºå…³æœº </li><li>ç­‰çº§1è¡¨ç¤ºï¼šå•ç”¨æˆ·æ¨¡å¼ </li><li>ç­‰çº§2è¡¨ç¤ºï¼šæ— ç½‘ç»œè¿æ¥çš„å¤šç”¨æˆ·å‘½ä»¤è¡Œæ¨¡å¼ </li><li>ç­‰çº§3è¡¨ç¤ºï¼šæœ‰ç½‘ç»œè¿æ¥çš„å¤šç”¨æˆ·å‘½ä»¤è¡Œæ¨¡å¼ </li><li>ç­‰çº§4è¡¨ç¤ºï¼šä¸å¯ç”¨ </li><li>ç­‰çº§5è¡¨ç¤ºï¼šå¸¦å›¾å½¢ç•Œé¢çš„å¤šç”¨æˆ·æ¨¡å¼ </li><li>ç­‰çº§6è¡¨ç¤ºï¼šé‡æ–°å¯åŠ¨</li></ul><p>éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œlevelé€‰é¡¹å¯ä»¥æŒ‡å®šè¦æŸ¥çœ‹çš„è¿è¡Œçº§è€Œä¸ä¸€å®šæ˜¯å½“å‰è¿è¡Œçº§ã€‚å¯¹äºæ¯ä¸ªè¿è¡Œçº§ï¼Œåªèƒ½æœ‰ä¸€ä¸ªå¯åŠ¨è„šæœ¬æˆ–è€…åœæ­¢è„šæœ¬ã€‚å½“åˆ‡æ¢è¿è¡Œçº§æ—¶ï¼Œinitä¸ä¼šé‡æ–°å¯åŠ¨å·²ç»å¯åŠ¨çš„æœåŠ¡ï¼Œä¹Ÿä¸ä¼šå†æ¬¡å»åœæ­¢å·²ç»åœæ­¢çš„æœåŠ¡ã€‚</p><p>è¿è¡Œçº§æ–‡ä»¶ï¼š<br>æ¯ä¸ªè¢«chkconfigç®¡ç†çš„æœåŠ¡éœ€è¦åœ¨å¯¹åº”çš„init.dä¸‹çš„è„šæœ¬åŠ ä¸Šä¸¤è¡Œæˆ–è€…æ›´å¤šè¡Œçš„æ³¨é‡Šã€‚ç¬¬ä¸€è¡Œå‘Šè¯‰chkconfigç¼ºçœå¯åŠ¨çš„è¿è¡Œçº§ä»¥åŠå¯åŠ¨å’Œåœæ­¢çš„ä¼˜å…ˆçº§ã€‚å¦‚æœæŸæœåŠ¡ç¼ºçœä¸åœ¨ä»»ä½•è¿è¡Œçº§å¯åŠ¨ï¼Œé‚£ä¹ˆä½¿ç”¨-ä»£æ›¿è¿è¡Œçº§ã€‚ç¬¬äºŒè¡Œå¯¹æœåŠ¡è¿›è¡Œæè¿°ï¼Œå¯ä»¥ç”¨\è·¨è¡Œæ³¨é‡Šã€‚å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># chkconfig: 2345 20 80</span><br><span class="line"># description: Saves and restores system entropy pool for \</span><br><span class="line"># higher quality random number generation.</span><br></pre></td></tr></table></figure><p>å®ä¾‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">chkconfig --list #åˆ—å‡ºæ‰€æœ‰çš„ç³»ç»ŸæœåŠ¡ã€‚ </span><br><span class="line">chkconfig --add httpd #å¢åŠ httpdæœåŠ¡ã€‚ </span><br><span class="line">chkconfig --del httpd #åˆ é™¤httpdæœåŠ¡ã€‚ </span><br><span class="line">chkconfig --level httpd 2345 on #è®¾ç½®httpdåœ¨è¿è¡Œçº§åˆ«ä¸º2ã€3ã€4ã€5çš„æƒ…å†µä¸‹éƒ½æ˜¯onï¼ˆå¼€å¯ï¼‰çš„çŠ¶æ€ã€‚ </span><br><span class="line">chkconfig --list #åˆ—å‡ºç³»ç»Ÿæ‰€æœ‰çš„æœåŠ¡å¯åŠ¨æƒ…å†µã€‚ </span><br><span class="line">chkconfig --list mysqld #åˆ—å‡ºmysqldæœåŠ¡è®¾ç½®æƒ…å†µã€‚ </span><br><span class="line">chkconfig --level 35 mysqld on #è®¾å®šmysqldåœ¨ç­‰çº§3å’Œ5ä¸ºå¼€æœºè¿è¡ŒæœåŠ¡ï¼Œ--level 35è¡¨ç¤ºæ“ä½œåªåœ¨ç­‰çº§3å’Œ5æ‰§è¡Œï¼Œonè¡¨ç¤ºå¯åŠ¨ï¼Œoffè¡¨ç¤ºå…³é—­ã€‚ </span><br><span class="line">chkconfig mysqld on #è®¾å®šmysqldåœ¨å„ç­‰çº§ä¸ºonï¼Œâ€œå„ç­‰çº§â€åŒ…æ‹¬2ã€3ã€4ã€5ç­‰çº§ã€‚</span><br></pre></td></tr></table></figure><p>å¦‚ä½•å¢åŠ ä¸€ä¸ªæœåŠ¡ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æœåŠ¡è„šæœ¬å¿…é¡»å­˜æ”¾åœ¨/etc/ini.d/ç›®å½•ä¸‹ï¼›</span><br><span class="line">chkconfig --add servicenameåœ¨chkconfigå·¥å…·æœåŠ¡åˆ—è¡¨ä¸­å¢åŠ æ­¤æœåŠ¡ï¼Œæ­¤æ—¶æœåŠ¡ä¼šè¢«åœ¨/etc/rc.d/rcN.dä¸­èµ‹äºˆK/Så…¥å£äº†ï¼›</span><br><span class="line">chkconfig --level 35 mysqld onä¿®æ”¹æœåŠ¡çš„é»˜è®¤å¯åŠ¨ç­‰çº§ã€‚</span><br></pre></td></tr></table></figure><p><em>æ³¨æ„</em> æ­¤å‘½ä»¤åªèƒ½åœ¨Centos7ä»¥ä¸‹ä½¿ç”¨ï¼Œå› ä¸ºCentos7ä¸­å·²ç”±systemctlæ›¿ä»£chkconfigå‘½ä»¤</p>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mycat æ•°æ®åº“åˆ†åº“åˆ†è¡¨ä¸­çš„å®‰è£…ä¸ä½¿ç”¨</title>
      <link href="/post/56117af9.html"/>
      <url>/post/56117af9.html</url>
      
        <content type="html"><![CDATA[<p>Mycatéœ€è¦jdkçš„æ”¯æŒï¼Œè€Œæˆ‘çš„Macä¸­çš„jdkå·²ç»å®‰è£…å¥½äº†ï¼Œæ‰€ä»¥æ­¤æ­¥éª¤çœç•¥ï¼Œéœ€è¦å®‰è£…jdkçš„ç«¥é‹è¯·è‡ªè¡Œå®‰è£…jdkã€‚</p><a id="more"></a><h4 id="å®‰è£…Mycat"><a href="#å®‰è£…Mycat" class="headerlink" title="å®‰è£…Mycat:"></a>å®‰è£…Mycat:</h4><p>ç›´æ¥ä¸‹è½½è§£å‹åˆ°/usr/local/mycatç›®å½•å³å¯ï¼Œæˆ‘ä¸‹è½½çš„æ˜¯æœ€æ–°ç‰ˆ1.6ã€‚</p><h4 id="è¿è¡Œ"><a href="#è¿è¡Œ" class="headerlink" title="è¿è¡Œ"></a>è¿è¡Œ</h4><p>linuxï¼š</p><ul><li><p>./mycat start å¯åŠ¨</p></li><li><p>./mycat stop åœæ­¢</p></li><li><p>./mycat console å‰å°è¿è¡Œ</p></li><li><p>./mycat install æ·»åŠ åˆ°ç³»ç»Ÿè‡ªåŠ¨å¯åŠ¨ï¼ˆæš‚æœªå®ç°ï¼‰</p></li><li><p>./mycat remove å–æ¶ˆéšç³»ç»Ÿè‡ªåŠ¨å¯åŠ¨ï¼ˆæš‚æœªå®ç°ï¼‰</p></li><li><p>./mycat restart é‡å¯æœåŠ¡</p></li><li><p>./mycat pause æš‚åœ</p></li><li><p>./mycat status æŸ¥çœ‹å¯åŠ¨çŠ¶æ€</p></li></ul><p>winï¼š</p><ul><li>ç›´æ¥è¿è¡Œstartup_nowrap.batï¼Œå¦‚æœå‡ºç°é—ªé€€ï¼Œåœ¨cmd å‘½ä»¤è¡Œè¿è¡Œï¼ŒæŸ¥çœ‹å‡ºé”™åŸå› </li></ul><h4 id="å†…å­˜é…ç½®ï¼š"><a href="#å†…å­˜é…ç½®ï¼š" class="headerlink" title="å†…å­˜é…ç½®ï¼š"></a>å†…å­˜é…ç½®ï¼š</h4><p>å¯åŠ¨å‰ï¼Œä¸€èˆ¬éœ€è¦ä¿®æ”¹JVMé…ç½®å‚æ•°ï¼Œæ‰“å¼€conf/wrapper.confæ–‡ä»¶ï¼Œå¦‚ä¸‹è¡Œçš„å†…å®¹ä¸º2Gå’Œ2048ï¼Œå¯æ ¹æ®æœ¬æœºé…ç½®æƒ…å†µä¿®æ”¹ä¸º512Mæˆ–å…¶å®ƒå€¼ã€‚ ä»¥ä¸‹é…ç½®è·Ÿjvmå‚æ•°å®Œå…¨ä¸€è‡´ï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„jvmå‚æ•°è°ƒæ•´ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">Java Additional Parameters</span><br><span class="line"></span><br><span class="line">wrapper.java.additional.1=</span><br><span class="line"></span><br><span class="line">wrapper.java.additional.1=-DMYCAT_HOME=.</span><br><span class="line"></span><br><span class="line">wrapper.java.additional.2=-server</span><br><span class="line"></span><br><span class="line">wrapper.java.additional.3=-XX:MaxPermSize=64M</span><br><span class="line"></span><br><span class="line">wrapper.java.additional.4=-XX:+AggressiveOpts</span><br><span class="line"></span><br><span class="line">wrapper.java.additional.5=-XX:MaxDirectMemorySize=100m</span><br><span class="line"></span><br><span class="line">wrapper.java.additional.6=-Dcom.sun.management.jmxremote</span><br><span class="line"></span><br><span class="line">wrapper.java.additional.7=-Dcom.sun.management.jmxremote.port=1984</span><br><span class="line"></span><br><span class="line">wrapper.java.additional.8=-Dcom.sun.management.jmxremote.authenticate=false</span><br><span class="line"></span><br><span class="line">wrapper.java.additional.9=-Dcom.sun.management.jmxremote.ssl=false</span><br><span class="line"></span><br><span class="line">wrapper.java.additional.10=-Xmx100m</span><br><span class="line"></span><br><span class="line">wrapper.java.additional.11=-Xms100m</span><br><span class="line"></span><br><span class="line">wrapper.java.additional.12=-XX:+UseParNewGC</span><br><span class="line"></span><br><span class="line">wrapper.java.additional.13=-XX:+UseConcMarkSweepGC</span><br><span class="line"></span><br><span class="line">wrapper.java.additional.14=-XX:+UseCMSCompactAtFullCollection</span><br><span class="line"></span><br><span class="line">wrapper.java.additional.15=-XX:CMSFullGCsBeforeCompaction=0</span><br><span class="line"></span><br><span class="line">wrapper.java.additional.16=-XX:CMSInitiatingOccupancyFraction=70</span><br><span class="line"></span><br><span class="line">ä»¥ä¸‹é…ç½®ä½œåºŸï¼š</span><br><span class="line"></span><br><span class="line">wrapper.java.initmemory=3</span><br><span class="line"></span><br><span class="line">wrapper.java.maxmemory=64</span><br></pre></td></tr></table></figure><h4 id="Mycatè¿æ¥æµ‹è¯•ï¼š"><a href="#Mycatè¿æ¥æµ‹è¯•ï¼š" class="headerlink" title="Mycatè¿æ¥æµ‹è¯•ï¼š"></a>Mycatè¿æ¥æµ‹è¯•ï¼š</h4><p>æµ‹è¯•mycatä¸æµ‹è¯•mysqlå®Œå…¨ä¸€è‡´ï¼Œmysqlæ€ä¹ˆè¿æ¥ï¼Œmycatå°±æ€ä¹ˆè¿æ¥ã€‚</p><p>æ¨èå…ˆé‡‡ç”¨å‘½ä»¤è¡Œæµ‹è¯•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">sammac:local Sam$ mysql -uroot -p -P8066 </span><br><span class="line">Enter password: </span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is 339</span><br><span class="line">Server version: 5.5.48-log MySQL Community Server (GPL)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2016, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.</span><br><span class="line"></span><br><span class="line"><span class="meta">mysql&gt;</span></span><br></pre></td></tr></table></figure><p>å¦‚æœé‡‡ç”¨å·¥å…·è¿æ¥ï¼Œ1.4,1.3ç›®å‰éƒ¨åˆ†å·¥å…·æ— æ³•è¿æ¥ï¼Œä¼šæç¤ºdatabase not selectedï¼Œå»ºè®®é‡‡ç”¨é«˜ç‰ˆæœ¬ï¼Œnavicatæµ‹è¯•ã€‚1.5å·²ç»ä¿®å¤äº†éƒ¨åˆ†å·¥å…·è¿æ¥</p><p><em>æ³¨</em> æ–‡ç« éƒ¨åˆ†å†…å®¹è½¬è‡ªMycatå®˜ç½‘</p>]]></content>
      
      
      
        <tags>
            
            <tag> mycat </tag>
            
            <tag> database </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å®ç°MySQLä¸»ä»å¤åˆ¶</title>
      <link href="/post/34c3deb2.html"/>
      <url>/post/34c3deb2.html</url>
      
        <content type="html"><![CDATA[<h3 id="å®éªŒå‡†å¤‡ï¼š"><a href="#å®éªŒå‡†å¤‡ï¼š" class="headerlink" title="å®éªŒå‡†å¤‡ï¼š"></a>å®éªŒå‡†å¤‡ï¼š</h3><p>åœ¨Pcä¸Šå®‰è£…ä¸¤ä¸ªMySQLï¼Œåˆ†åˆ«ç›‘å¬3307å’Œ3308ç«¯å£ï¼Œåœ¨centos7ä¸Šä¹Ÿå®‰è£…ä¸€ä¸ªMySQLï¼Œè¿™æ ·æˆ‘ä»¬å°±æœ‰ä¸‰ä¸ªslaveï¼é¦–å…ˆæˆ‘ä»¬è¦ä¿è¯4ä¸ªMySQLä¸Šçš„æ•°æ®ä¸€è‡´ï¼Œå¹¶ä¸”é…ç½®å¥½å„ä¸ªçš„æ—¥å¿—ï¼Œè¿™æ ·å³ä½¿å‡ºé”™äº†ï¼Œä¹Ÿå®¹æ˜“æ‰¾å‡ºé”™è¯¯ã€‚</p><a id="more"></a><ul><li>Slave1ï¼šMySQL3307</li><li>Slave2ï¼šMySQL3308</li><li>Slave3ï¼šCentos7ä¸Šçš„MySQL</li><li>Master: è¿è¡Œåœ¨3306ç«¯å£çš„MySQL</li></ul><h3 id="ä¿®æ”¹Masterçš„é…ç½®"><a href="#ä¿®æ”¹Masterçš„é…ç½®" class="headerlink" title="ä¿®æ”¹Masterçš„é…ç½®"></a>ä¿®æ”¹Masterçš„é…ç½®</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">server-id=1      //[å¿…é¡»]æœåŠ¡å™¨å”¯ä¸€IDï¼Œé»˜è®¤æ˜¯1ï¼Œå¯ä»¥éšä¾¿é…ç½®ï¼Œåªè¦ä¸é‡å¤å³å¯</span><br><span class="line">binlog-do-db = xxx // åŒæ­¥çš„æ•°æ®åº“åï¼Œå¦‚æœ‰å¤šä¸ªå†™å¤šè¡Œ</span><br><span class="line">binlog-ignore-db =mysql // ä¸éœ€è¦å¤‡ä»½çš„æ•°æ®åº“ï¼Œå¦‚æœ‰å¤šä¸ªå†™å¤šè¡Œ</span><br><span class="line">read-only =0  // ä¸»æœºï¼Œè¯»å†™éƒ½å¯ä»¥</span><br><span class="line">log-bin=mysql-bin   //[å¿…é¡»]å¯ç”¨äºŒè¿›åˆ¶æ—¥å¿— </span><br><span class="line">binlog-format =mixed // binçš„æ ¼å¼</span><br><span class="line">relay-log=mysql-relay // ä¸­ç»§æ—¥å¿—æ–‡ä»¶å</span><br><span class="line">expire-logs-days=20 // æ—¥å¿—æœ€é•¿ä¿å­˜æ—¶é—´</span><br><span class="line">max_binlog_size = 100M // æ—¥å¿—æœ€å¤§å®¹é‡</span><br><span class="line">slave-skip-errors=all // è·³è¿‡æ‰€æœ‰é”™è¯¯</span><br></pre></td></tr></table></figure><h3 id="ä¿®æ”¹Slaveçš„é…ç½®"><a href="#ä¿®æ”¹Slaveçš„é…ç½®" class="headerlink" title="ä¿®æ”¹Slaveçš„é…ç½®"></a>ä¿®æ”¹Slaveçš„é…ç½®</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">MySQL3307</span></span><br><span class="line"> [mysqld]</span><br><span class="line"> log-bin=mysql-bin   //[ä¸æ˜¯å¿…é¡»]å¯ç”¨äºŒè¿›åˆ¶æ—¥å¿—</span><br><span class="line"> server-id=3307      //[å¿…é¡»]æœåŠ¡å™¨å”¯ä¸€IDï¼Œé»˜è®¤æ˜¯1ï¼Œå¯ä»¥éšä¾¿é…ç½®ï¼Œåªè¦ä¸é‡å¤å³å¯</span><br><span class="line"> replicate-do-db =test // å¤åˆ¶æŸä¸ªåº“,å¦‚æœ‰å¤šä¸ªå†™å¤šè¡Œ</span><br><span class="line"> replicate-ignore-db=mysql // ä¸å¤åˆ¶æŸä¸ªåº“,å¦‚æœ‰å¤šä¸ªå†™å¤šè¡Œ</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">MySQL3308</span></span><br><span class="line">[mysqld]</span><br><span class="line"> log-bin=mysql-bin   //[ä¸æ˜¯å¿…é¡»]å¯ç”¨äºŒè¿›åˆ¶æ—¥å¿—</span><br><span class="line"> server-id=3308      //[å¿…é¡»]æœåŠ¡å™¨å”¯ä¸€IDï¼Œé»˜è®¤æ˜¯1ï¼Œå¯ä»¥éšä¾¿é…ç½®ï¼Œåªè¦ä¸é‡å¤å³å¯</span><br><span class="line"> replicate-do-db =test // å¤åˆ¶æŸä¸ªåº“,å¦‚æœ‰å¤šä¸ªå†™å¤šè¡Œ</span><br><span class="line"> replicate-ignore-db=mysql // ä¸å¤åˆ¶æŸä¸ªåº“,å¦‚æœ‰å¤šä¸ªå†™å¤šè¡Œ</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">Centos7</span></span><br><span class="line">[mysqld]</span><br><span class="line"> log-bin=mysql-bin   //[ä¸æ˜¯å¿…é¡»]å¯ç”¨äºŒè¿›åˆ¶æ—¥å¿—</span><br><span class="line"> server-id=3      //[å¿…é¡»]æœåŠ¡å™¨å”¯ä¸€IDï¼Œé»˜è®¤æ˜¯1ï¼Œå¯ä»¥éšä¾¿é…ç½®ï¼Œåªè¦ä¸é‡å¤å³å¯</span><br><span class="line"> replicate-do-db =test // å¤åˆ¶æŸä¸ªåº“,å¦‚æœ‰å¤šä¸ªå†™å¤šè¡Œ</span><br><span class="line"> replicate-ignore-db=mysql // ä¸å¤åˆ¶æŸä¸ªåº“,å¦‚æœ‰å¤šä¸ªå†™å¤šè¡Œ</span><br></pre></td></tr></table></figure><h3 id="ä¿å­˜ä¿®æ”¹åé‡å¯4ä¸ªMySQLæœåŠ¡"><a href="#ä¿å­˜ä¿®æ”¹åé‡å¯4ä¸ªMySQLæœåŠ¡" class="headerlink" title="ä¿å­˜ä¿®æ”¹åé‡å¯4ä¸ªMySQLæœåŠ¡"></a>ä¿å­˜ä¿®æ”¹åé‡å¯4ä¸ªMySQLæœåŠ¡</h3><h3 id="åœ¨Masteråˆ›å»º3ä¸ªMySQLç”¨æˆ·"><a href="#åœ¨Masteråˆ›å»º3ä¸ªMySQLç”¨æˆ·" class="headerlink" title="åœ¨Masteråˆ›å»º3ä¸ªMySQLç”¨æˆ·"></a>åœ¨Masteråˆ›å»º3ä¸ªMySQLç”¨æˆ·</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">grant replication client,replication slave on *.* to slave3307@'%' identified by 'slave3307';</span><br><span class="line"></span><br><span class="line">grant replication client,replication slave on *.* to slave3308@'%' identified by 'slave3308';</span><br><span class="line"></span><br><span class="line">grant replication client,replication slave on *.* to centos7@'%' identified by 'centos7'; </span><br><span class="line"></span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure><h3 id="ç™»å½•Masteræ‰§è¡Œå‘½ä»¤æŸ¥çœ‹log-poså’Œlog-file"><a href="#ç™»å½•Masteræ‰§è¡Œå‘½ä»¤æŸ¥çœ‹log-poså’Œlog-file" class="headerlink" title="ç™»å½•Masteræ‰§è¡Œå‘½ä»¤æŸ¥çœ‹log_poså’Œlog_file"></a>ç™»å½•Masteræ‰§è¡Œå‘½ä»¤æŸ¥çœ‹log_poså’Œlog_file</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">show master status;</span><br><span class="line">   +------------------+----------+--------------+------------------+</span><br><span class="line">   | File             | Position | Binlog_Do_DB | Binlog_Ignore_DB |</span><br><span class="line">   +------------------+----------+--------------+------------------+</span><br><span class="line">   | mysql-bin.000062 |      8233|              |                  |</span><br><span class="line">   +------------------+----------+--------------+------------------+</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong> æ‰§è¡Œå®Œæ­¤æ­¥éª¤åä¸è¦å†æ“ä½œä¸»æœåŠ¡å™¨MYSQLï¼Œé˜²æ­¢ä¸»æœåŠ¡å™¨çŠ¶æ€å€¼å˜åŒ–</p><h3 id="é…ç½®ä»æœåŠ¡å™¨Slaveï¼Œä¸‹é¢çš„å‘½ä»¤åˆ†åˆ«åœ¨3ä¸ªMySQLä¸Šæ‰§è¡Œï¼š"><a href="#é…ç½®ä»æœåŠ¡å™¨Slaveï¼Œä¸‹é¢çš„å‘½ä»¤åˆ†åˆ«åœ¨3ä¸ªMySQLä¸Šæ‰§è¡Œï¼š" class="headerlink" title="é…ç½®ä»æœåŠ¡å™¨Slaveï¼Œä¸‹é¢çš„å‘½ä»¤åˆ†åˆ«åœ¨3ä¸ªMySQLä¸Šæ‰§è¡Œï¼š"></a>é…ç½®ä»æœåŠ¡å™¨Slaveï¼Œä¸‹é¢çš„å‘½ä»¤åˆ†åˆ«åœ¨3ä¸ªMySQLä¸Šæ‰§è¡Œï¼š</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">change master to master_host=&apos;192.168.19.254&apos;,master_port=3306,master_user=&apos;slave3307&apos;,</span><br><span class="line">master_password=&apos;slave3307&apos;,master_log_file=&apos;mysql-bin.000062&apos;,master_log_pos=8233;</span><br><span class="line"></span><br><span class="line">start slave #å¯åŠ¨ä»æœåŠ¡å™¨å¤åˆ¶åŠŸèƒ½</span><br><span class="line"></span><br><span class="line">change master to master_host=&apos;192.168.19.254&apos;,master_port=3306,master_user=&apos;slave3308&apos;,</span><br><span class="line">master_password=&apos;slave3308&apos;,master_log_file=&apos;mysql-bin.000062&apos;,master_log_pos=8233;</span><br><span class="line"></span><br><span class="line">start slave #å¯åŠ¨ä»æœåŠ¡å™¨å¤åˆ¶åŠŸèƒ½</span><br><span class="line"></span><br><span class="line">change master to master_host=&apos;192.168.19.254&apos;,master_port=3306,master_user=&apos;centos7&apos;,</span><br><span class="line">master_password=&apos;centos7&apos;,master_log_file=&apos;mysql-bin.000087&apos;,master_log_pos=8233;</span><br><span class="line"></span><br><span class="line">start slave #å¯åŠ¨ä»æœåŠ¡å™¨å¤åˆ¶åŠŸèƒ½</span><br></pre></td></tr></table></figure><h3 id="æ£€æŸ¥Slaveå¤åˆ¶åŠŸèƒ½çš„çŠ¶æ€"><a href="#æ£€æŸ¥Slaveå¤åˆ¶åŠŸèƒ½çš„çŠ¶æ€" class="headerlink" title="æ£€æŸ¥Slaveå¤åˆ¶åŠŸèƒ½çš„çŠ¶æ€"></a>æ£€æŸ¥Slaveå¤åˆ¶åŠŸèƒ½çš„çŠ¶æ€</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show slave status\G</span><br></pre></td></tr></table></figure><p><em>æ³¨æ„</em> Slave_IOåŠSlave_SQLè¿›ç¨‹å¿…é¡»æ­£å¸¸è¿è¡Œï¼Œå³YESçŠ¶æ€ï¼Œå¦åˆ™éƒ½æ˜¯é”™è¯¯çš„çŠ¶æ€(å¦‚ï¼šå…¶ä¸­ä¸€ä¸ªNOæˆ–è€…å‡ºç°Connection)ã€‚æœ‰æ—¶å€™æ˜¯server-idé…ç½®é”™è¯¯ã€é˜²ç«å¢™æ‹¦æˆªæˆ–è´¦æˆ·æ²¡æœ‰æƒé™ï¼Œä»”ç»†æ£€æŸ¥å„ä¸ªçš„é”™è¯¯æ—¥å¿—ï¼Œå°±èƒ½å¾ˆå¿«æ‰¾åˆ°é—®é¢˜æ‰€åœ¨ã€‚</p><h3 id="END-ä»¥ä¸Šæ“ä½œè¿‡ç¨‹ï¼Œä¸»ä»æœåŠ¡å™¨é…ç½®å®Œæˆ"><a href="#END-ä»¥ä¸Šæ“ä½œè¿‡ç¨‹ï¼Œä¸»ä»æœåŠ¡å™¨é…ç½®å®Œæˆ" class="headerlink" title="END ä»¥ä¸Šæ“ä½œè¿‡ç¨‹ï¼Œä¸»ä»æœåŠ¡å™¨é…ç½®å®Œæˆ"></a>END ä»¥ä¸Šæ“ä½œè¿‡ç¨‹ï¼Œä¸»ä»æœåŠ¡å™¨é…ç½®å®Œæˆ</h3><h5 id="é™„"><a href="#é™„" class="headerlink" title="é™„"></a>é™„</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">åœ¨Windowsä¸Šæ³¨å†ŒMySQLæ·»åŠ æœåŠ¡</span></span><br><span class="line"></span><br><span class="line">C:\phpStudy\MySQL3307\bin\mysqld install mysql3307 --defaults-file="C:\phpStudy\MySQL3307\my.ini"</span><br><span class="line">C:\phpStudy\MySQL3308\bin\mysqld install mysql3308 --defaults-file="C:\phpStudy\MySQL3308\my.ini"</span><br></pre></td></tr></table></figure><p><em>MySQLä¸»ä»å¤åˆ¶è·³è¿‡é”™è¯¯ä¸¤ç§æ–¹å¼ï¼š</em></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">1.è·³è¿‡æŒ‡å®šæ•°é‡çš„äº‹åŠ¡ï¼š</span><br><span class="line"></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash">stop slave ;</span></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash">SET GLOBAL SQL_SLAVE_SKIP_COUNTER = 1;  <span class="comment">#è·³è¿‡ä¸€ä¸ªäº‹åŠ¡</span></span></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash">start slave;</span></span><br><span class="line"></span><br><span class="line">2.ä¿®æ”¹mysqlçš„é…ç½®æ–‡ä»¶ï¼Œé€šè¿‡slave_skip_errorså‚æ•°æ¥è·³æ‰€æœ‰é”™è¯¯æˆ–æŒ‡å®šç±»å‹çš„é”™è¯¯</span><br><span class="line">vi /etc/my.cnf</span><br><span class="line">[mysqld]</span><br><span class="line">slave-skip-errors=1062,1053,1146 #è·³è¿‡æŒ‡å®šerror noç±»å‹çš„é”™è¯¯</span><br><span class="line">slave-skip-errors=all #è·³è¿‡æ‰€æœ‰é”™è¯¯</span><br></pre></td></tr></table></figure><p>2018å¹´10æœˆ3å·æ›´æ–°ï¼š<br><strong>æ³¨æ„ï¼š</strong><br>å¦‚æœä½ æ˜¯ç›´æ¥å¤åˆ¶MySQLçš„å®‰è£…ç›®å½•ï¼Œè€Œä½ çš„MySQLçš„ç‰ˆæœ¬åˆæ˜¯5.6åŠä»¥åçš„ç‰ˆæœ¬ï¼Œé‚£ä½ æœ‰å¯èƒ½å‡ºç°ä¸‹é¢çš„é—®é¢˜ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Fatal error: The slave I/O thread stops because master and slave have equal MySQL server UUIDs; these UUIDs must be different for replication to work.</span><br></pre></td></tr></table></figure><p>mysql 5.6çš„å¤åˆ¶å¼•å…¥äº†uuidçš„æ¦‚å¿µï¼Œå„ä¸ªå¤åˆ¶ç»“æ„ä¸­çš„server_uuidå¾—ä¿è¯ä¸ä¸€æ ·ï¼Œä½†æ˜¯æŸ¥çœ‹åˆ°ç›´æ¥å¤åˆ¶dataæ–‡ä»¶å¤¹åserver_uuidæ˜¯ç›¸åŒçš„</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show variables like &apos;%server_uuid%&apos;;</span><br></pre></td></tr></table></figure><p>è§£å†³æ–¹æ³•ï¼š<br>æ‰¾åˆ°dataæ–‡ä»¶å¤¹ä¸‹çš„auto.cnfæ–‡ä»¶ï¼Œä¿®æ”¹é‡Œé¢çš„uuidå€¼ï¼Œä¿è¯å„ä¸ªdbçš„uuidä¸ä¸€æ ·ï¼Œé‡å¯dbå³å¯</p><p>é™„ä¸€ä¸ªæ­£ç¡®slave statusçš„ä¿¡æ¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">mysql&gt; show slave status\G</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">               Slave_IO_State: Waiting for master to send event</span><br><span class="line">                  Master_Host: 127.0.0.1</span><br><span class="line">                  Master_User: slave3307</span><br><span class="line">                  Master_Port: 3306</span><br><span class="line">                Connect_Retry: 60</span><br><span class="line">              Master_Log_File: mysql-bin.000007</span><br><span class="line">          Read_Master_Log_Pos: 602</span><br><span class="line">               Relay_Log_File: mysql-relay.000005</span><br><span class="line">                Relay_Log_Pos: 765</span><br><span class="line">        Relay_Master_Log_File: mysql-bin.000007</span><br><span class="line">             Slave_IO_Running: Yes</span><br><span class="line">            Slave_SQL_Running: Yes</span><br><span class="line">              Replicate_Do_DB:</span><br><span class="line">          Replicate_Ignore_DB:</span><br><span class="line">           Replicate_Do_Table:</span><br><span class="line">       Replicate_Ignore_Table:</span><br><span class="line">      Replicate_Wild_Do_Table:</span><br><span class="line">  Replicate_Wild_Ignore_Table:</span><br><span class="line">                   Last_Errno: 0</span><br><span class="line">                   Last_Error:</span><br><span class="line">                 Skip_Counter: 0</span><br><span class="line">          Exec_Master_Log_Pos: 602</span><br><span class="line">              Relay_Log_Space: 1384</span><br><span class="line">              Until_Condition: None</span><br><span class="line">               Until_Log_File:</span><br><span class="line">                Until_Log_Pos: 0</span><br><span class="line">           Master_SSL_Allowed: No</span><br><span class="line">           Master_SSL_CA_File:</span><br><span class="line">           Master_SSL_CA_Path:</span><br><span class="line">              Master_SSL_Cert:</span><br><span class="line">            Master_SSL_Cipher:</span><br><span class="line">               Master_SSL_Key:</span><br><span class="line">        Seconds_Behind_Master: 0</span><br><span class="line">Master_SSL_Verify_Server_Cert: No</span><br><span class="line">                Last_IO_Errno: 0</span><br><span class="line">                Last_IO_Error:</span><br><span class="line">               Last_SQL_Errno: 0</span><br><span class="line">               Last_SQL_Error:</span><br><span class="line">  Replicate_Ignore_Server_Ids:</span><br><span class="line">             Master_Server_Id: 1</span><br><span class="line">                  Master_UUID: fe1b230d-6ee9-11e8-b0c6-9c5c8e103115</span><br><span class="line">             Master_Info_File: C:\phpStudy\MySQL3307\data\master.info</span><br><span class="line">                    SQL_Delay: 0</span><br><span class="line">          SQL_Remaining_Delay: NULL</span><br><span class="line">      Slave_SQL_Running_State: Slave has read all relay log; waiting for the slave I/O thread to update it</span><br><span class="line">           Master_Retry_Count: 86400</span><br><span class="line">                  Master_Bind:</span><br><span class="line">      Last_IO_Error_Timestamp:</span><br><span class="line">     Last_SQL_Error_Timestamp:</span><br><span class="line">               Master_SSL_Crl:</span><br><span class="line">           Master_SSL_Crlpath:</span><br><span class="line">           Retrieved_Gtid_Set:</span><br><span class="line">            Executed_Gtid_Set:</span><br><span class="line">                Auto_Position: 0</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure><p><strong>2020å¹´03æœˆ15å·æ›´æ–°:</strong></p><p>binlog_do_dbæ˜¯æŒ‡å®šbinlogæ—¥å¿—è®°å½•é‚£äº›åº“çš„äºŒè¿›åˆ¶æ—¥å¿—ã€‚replicate_do_dbåˆ™åœ¨slaveåº“ä¸­æŒ‡å®šåŒæ­¥é‚£äº›åº“çš„binlogæ—¥å¿—ã€‚<br>åœ¨ä¸»ä»äº’å¤‡ç¯å¢ƒä¸­ï¼Œæœ‰æ²¡æœ‰å¿…è¦æ¯ä¸ªæœåŠ¡å™¨éƒ½åŒæ—¶é…ç½®binlog_do_dbå’Œreplicate_do_db?ç†ç”±æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>binlog-do-dbï¼šæŒ‡å®šmysqlçš„binlogæ—¥å¿—è®°å½•å“ªä¸ªdb<br>replicate_do_dbï¼šå‚æ•°æ˜¯åœ¨slaveä¸Šé…ç½®ï¼ŒæŒ‡å®šslaveè¦å¤åˆ¶å“ªä¸ªåº“</p><p>åœ¨masterä¸Šè®¾ç½®binlog_do_å¼Šç«¯ï¼š<br>1ã€è¿‡æ»¤æ“ä½œå¸¦æ¥çš„è´Ÿè½½éƒ½åœ¨masterä¸Š<br>2ã€æ— æ³•åšåŸºäºæ—¶é—´ç‚¹çš„å¤åˆ¶ï¼ˆåˆ©ç”¨binlogï¼‰</p><p>å¦‚ä½•åˆ é™¤æ—¥å¿—?<br>åˆ©ç”¨ RESET MASTER æˆ–è€… purge</p><p>reset master ï¼šåˆ é™¤æ‰€æœ‰çš„binglogæ—¥å¿—æ–‡ä»¶ï¼Œå¹¶å°†æ—¥å¿—ç´¢å¼•æ–‡ä»¶æ¸…ç©ºï¼Œé‡æ–°å¼€å§‹æ‰€æœ‰æ–°çš„æ—¥å¿—æ–‡ä»¶ã€‚ç”¨äºç¬¬ä¸€æ¬¡è¿›è¡Œæ­å»ºä¸»ä»åº“æ—¶ï¼Œè¿›è¡Œä¸»åº“binlogåˆå§‹åŒ–å·¥ä½œ</p><p>æ³¨æ„reset master ä¸åŒäº purge binary logçš„ä¸¤å¤„åœ°æ–¹</p><ol><li>reset master å°†åˆ é™¤æ—¥å¿—ç´¢å¼•æ–‡ä»¶ä¸­è®°å½•çš„æ‰€æœ‰binlogæ–‡ä»¶ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥å¿—æ–‡ä»¶èµ·å§‹å€¼ä»000001 å¼€å§‹ï¼Œç„¶è€Œpurge binary log å‘½ä»¤å¹¶ä¸ä¼šä¿®æ”¹è®°å½•binlogçš„é¡ºåºçš„æ•°å€¼</li><li>reset master ä¸èƒ½ç”¨äºæœ‰ä»»ä½•slave æ­£åœ¨è¿è¡Œçš„ä¸»ä»å…³ç³»çš„ä¸»åº“ã€‚å› ä¸ºåœ¨slave è¿è¡Œæ—¶åˆ» reset master å‘½ä»¤ä¸è¢«æ”¯æŒï¼Œreset master å°†master çš„binlogä»000001 å¼€å§‹è®°å½•,slave è®°å½•çš„master log åˆ™æ˜¯reset master æ—¶ä¸»åº“çš„æœ€æ–°çš„binlog,ä»åº“ä¼šæŠ¥é”™æ— æ³•æ‰¾çš„æŒ‡å®šçš„binlogæ–‡ä»¶</li></ol><p>purgeä½¿ç”¨äº‹ä¾‹</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ¸…é™¤mysql-bin.010æ—¥å¿—</span></span><br><span class="line"><span class="keyword">purge</span> <span class="keyword">master</span> <span class="keyword">logs</span> <span class="keyword">to</span> <span class="string">'mysql-bin.010â€™; </span></span><br><span class="line"><span class="string"># æ¸…é™¤2016-02-28 13:00:00å‰çš„æ—¥å¿—</span></span><br><span class="line"><span class="string">purge master logs before '</span><span class="number">2016</span><span class="number">-02</span><span class="number">-28</span> <span class="number">13</span>:<span class="number">00</span>:<span class="number">00</span><span class="string">'; </span></span><br><span class="line"><span class="string"># æ¸…é™¤3å¤©å‰çš„binæ—¥å¿—</span></span><br><span class="line"><span class="string">purge master logs before date_sub(now(), interval 3 day);</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux Crontab å®‰è£…ä½¿ç”¨è¯¦ç»†è¯´æ˜</title>
      <link href="/post/6933ee4e.html"/>
      <url>/post/6933ee4e.html</url>
      
        <content type="html"><![CDATA[<p>crontabå‘½ä»¤å¸¸è§äºUnixå’ŒLinuxçš„æ“ä½œç³»ç»Ÿä¹‹ä¸­ï¼Œç”¨äºè®¾ç½®å‘¨æœŸæ€§è¢«æ‰§è¡Œçš„æŒ‡ä»¤ã€‚è¯¥å‘½ä»¤ä»æ ‡å‡†è¾“å…¥è®¾å¤‡è¯»å–æŒ‡ä»¤ï¼Œå¹¶å°†å…¶å­˜æ”¾äºâ€œcrontabâ€æ–‡ä»¶ä¸­ï¼Œä»¥ä¾›ä¹‹åè¯»å–å’Œæ‰§è¡Œã€‚é€šå¸¸ï¼Œcrontabå‚¨å­˜çš„æŒ‡ä»¤è¢«å®ˆæŠ¤è¿›ç¨‹æ¿€æ´»ã€‚crond å¸¸å¸¸åœ¨åå°è¿è¡Œï¼Œæ¯ä¸€åˆ†é’Ÿæ£€æŸ¥æ˜¯å¦æœ‰é¢„å®šçš„ä½œä¸šéœ€è¦æ‰§è¡Œã€‚è¿™ç±»ä½œä¸šä¸€èˆ¬ç§°ä¸ºcron jobsã€‚</p><a id="more"></a><ol><li>å®‰è£…<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum -y install vixie-cron</span><br><span class="line">yum -y install crontabs</span><br></pre></td></tr></table></figure>è¯´æ˜ï¼š<br>vixie-cron è½¯ä»¶åŒ…æ˜¯ cron çš„ä¸»ç¨‹åºï¼›<br>crontabs è½¯ä»¶åŒ…æ˜¯ç”¨æ¥å®‰è£…ã€å¸è£…ã€æˆ–åˆ—ä¸¾ç”¨æ¥é©±åŠ¨ cron å®ˆæŠ¤è¿›ç¨‹çš„è¡¨æ ¼çš„ç¨‹åºã€‚</li><li>é…ç½®<br>cronæ˜¯linuxçš„å†…ç½®æœåŠ¡ï¼Œä½†å®ƒä¸è‡ªåŠ¨èµ·æ¥ï¼Œå¯ä»¥ç”¨ä»¥ä¸‹çš„æ–¹æ³•å¯åŠ¨ã€å…³é—­è¿™ä¸ªæœåŠ¡ï¼š<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">service crond start     //å¯åŠ¨æœåŠ¡</span><br><span class="line">service crond stop      //å…³é—­æœåŠ¡</span><br><span class="line">service crond restart   //é‡å¯æœåŠ¡</span><br><span class="line">service crond reload    //é‡æ–°è½½å…¥é…ç½®</span><br><span class="line">service crond status    //æŸ¥çœ‹crontabæœåŠ¡çŠ¶æ€</span><br></pre></td></tr></table></figure></li><li>åœ¨CentOSç³»ç»Ÿä¸­åŠ å…¥å¼€æœºè‡ªåŠ¨å¯åŠ¨:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chkconfig --level 345 crond on</span><br></pre></td></tr></table></figure></li><li>crontab å‘½ä»¤</li></ol><p>åŠŸèƒ½ï¼šè®¾ç½®è®¡æ—¶å™¨ã€‚</p><p>è¯­æ³•ï¼šcrontab[-u &lt;ç”¨æˆ·åç§°&gt;][é…ç½®æ–‡ä»¶] æˆ– crontab [-u &lt;ç”¨æˆ·åç§°&gt;][-elr]<br>è§£é‡Šï¼šcron æ˜¯ä¸€ä¸ªå¸¸é©»æœåŠ¡ï¼Œå®ƒæä¾›è®¡æ—¶å™¨çš„åŠŸèƒ½ï¼Œè®©ç”¨æˆ·åœ¨ç‰¹å®šçš„æ—¶é—´å¾—ä»¥æ‰§è¡Œé¢„è®¾çš„æŒ‡ä»¤æˆ–ç¨‹åºã€‚åªè¦ç”¨æˆ·ä¼šç¼–è¾‘è®¡æ—¶å™¨çš„é…ç½®æ–‡ä»¶ï¼Œå°±å¯ä»¥ä½¿ ç”¨è®¡æ—¶å™¨çš„åŠŸèƒ½ã€‚å…¶é…ç½®æ–‡ä»¶æ ¼å¼å¦‚ä¸‹ï¼šMinute Hour Day Month DayOFWeek Command</p><p>å‚æ•°ï¼š<br>-eã€€ç¼–è¾‘è¯¥ç”¨æˆ·çš„è®¡æ—¶å™¨è®¾ç½®ã€‚<br>-lã€€åˆ—å‡ºè¯¥ç”¨æˆ·çš„è®¡æ—¶å™¨è®¾ç½®ã€‚<br>-rã€€åˆ é™¤è¯¥ç”¨æˆ·çš„è®¡æ—¶å™¨è®¾ç½®ã€‚<br>-u&lt;ç”¨æˆ·åç§°&gt; ã€€æŒ‡å®šè¦è®¾å®šè®¡æ—¶å™¨çš„ç”¨æˆ·åç§°ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">æ ¼å¼:</span><br><span class="line">*   *ã€€ *ã€€ *ã€€ *ã€€ã€€<span class="built_in">command</span></span><br><span class="line">åˆ†ã€€æ—¶ã€€æ—¥ã€€æœˆã€€å‘¨ã€€ å‘½ä»¤</span><br><span class="line"></span><br><span class="line">ç¬¬1åˆ—è¡¨ç¤ºåˆ†é’Ÿ1ï½59 æ¯åˆ†é’Ÿç”¨*æˆ–è€… */1è¡¨ç¤º</span><br><span class="line">ç¬¬2åˆ—è¡¨ç¤ºå°æ—¶1ï½23ï¼ˆ0è¡¨ç¤º0ç‚¹ï¼‰</span><br><span class="line">ç¬¬3åˆ—è¡¨ç¤ºæ—¥æœŸ1ï½31</span><br><span class="line">ç¬¬4åˆ—è¡¨ç¤ºæœˆä»½1ï½12</span><br><span class="line">ç¬¬5åˆ—æ ‡è¯†å·æ˜ŸæœŸ0ï½6ï¼ˆ0è¡¨ç¤ºæ˜ŸæœŸå¤©ï¼‰</span><br><span class="line">ç¬¬6åˆ—è¦è¿è¡Œçš„å‘½ä»¤</span><br><span class="line"></span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">ä¾‹å­ï¼š</span><br><span class="line">```bash</span><br><span class="line">*/5 * * * * root ab -n 2000 http://60.217.229.252/250k.jpg</span><br><span class="line"></span><br><span class="line">ä¸Šé¢ä¾‹å­è¡¨ç¤ºæ¯5åˆ†é’Ÿæ¨¡æ‹Ÿç”¨æˆ·è®¿é—®http://60.217.229.252/250k.jpg 2000æ¬¡</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">30 21 * * * /usr/<span class="built_in">local</span>/etc/rc.d/lighttpd restart</span><br><span class="line">ä¸Šé¢çš„ä¾‹å­è¡¨ç¤ºæ¯æ™šçš„21:30é‡å¯apacheã€‚</span><br><span class="line"></span><br><span class="line">45 4 1,10,22 * * /usr/<span class="built_in">local</span>/etc/rc.d/lighttpd restart</span><br><span class="line">ä¸Šé¢çš„ä¾‹å­è¡¨ç¤ºæ¯æœˆ1ã€10ã€22æ—¥çš„4 : 45é‡å¯apacheã€‚</span><br><span class="line"></span><br><span class="line">10 1 * * 6,0 /usr/<span class="built_in">local</span>/etc/rc.d/lighttpd restart</span><br><span class="line">ä¸Šé¢çš„ä¾‹å­è¡¨ç¤ºæ¯å‘¨å…­ã€å‘¨æ—¥çš„1 : 10é‡å¯apacheã€‚</span><br><span class="line"></span><br><span class="line">0,30 18-23 * * * /usr/<span class="built_in">local</span>/etc/rc.d/lighttpd restart</span><br><span class="line">ä¸Šé¢çš„ä¾‹å­è¡¨ç¤ºåœ¨æ¯å¤©18 : 00è‡³23 : 00ä¹‹é—´æ¯éš”30åˆ†é’Ÿé‡å¯apacheã€‚</span><br><span class="line"></span><br><span class="line">0 23 * * 6 /usr/<span class="built_in">local</span>/etc/rc.d/lighttpd restart</span><br><span class="line">ä¸Šé¢çš„ä¾‹å­è¡¨ç¤ºæ¯æ˜ŸæœŸå…­çš„11 : 00 pmé‡å¯apacheã€‚</span><br><span class="line"></span><br><span class="line">* */1 * * * /usr/<span class="built_in">local</span>/etc/rc.d/lighttpd restart</span><br><span class="line">æ¯ä¸€å°æ—¶é‡å¯apache</span><br><span class="line"></span><br><span class="line">* 23-7/1 * * * /usr/<span class="built_in">local</span>/etc/rc.d/lighttpd restart</span><br><span class="line">æ™šä¸Š11ç‚¹åˆ°æ—©ä¸Š7ç‚¹ä¹‹é—´ï¼Œæ¯éš”ä¸€å°æ—¶é‡å¯apache</span><br><span class="line"></span><br><span class="line">0 11 4 * mon-wed /usr/<span class="built_in">local</span>/etc/rc.d/lighttpd restart</span><br><span class="line">æ¯æœˆçš„4å·ä¸æ¯å‘¨ä¸€åˆ°å‘¨ä¸‰çš„11ç‚¹é‡å¯apache</span><br><span class="line"></span><br><span class="line">0 4 1 jan * /usr/<span class="built_in">local</span>/etc/rc.d/lighttpd restart</span><br><span class="line">ä¸€æœˆä¸€å·çš„4ç‚¹é‡å¯apache</span><br><span class="line"></span><br><span class="line">*/30 * * * * /usr/sbin/ntpdate 210.72.145.44</span><br><span class="line">æ¯åŠå°æ—¶åŒæ­¥ä¸€ä¸‹æ—¶é—´</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> crontab </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHPç›®å‰æ¯”è¾ƒå¸¸è§çš„äº”å¤§è¿è¡Œæ¨¡å¼</title>
      <link href="/post/fa0692b8.html"/>
      <url>/post/fa0692b8.html</url>
      
        <content type="html"><![CDATA[<p>å…³äºPHPç›®å‰æ¯”è¾ƒå¸¸è§çš„äº”å¤§è¿è¡Œæ¨¡å¼ï¼š</p><ol><li>CGIï¼ˆé€šç”¨ç½‘å…³æ¥å£ / Common Gateway Interfaceï¼‰</li><li>FastCGIï¼ˆå¸¸é©»å‹CGI / Long-Live CGIï¼‰</li><li>CLIï¼ˆå‘½ä»¤è¡Œè¿è¡Œ / Command Line Interfaceï¼‰</li><li>Webæ¨¡å—æ¨¡å¼ï¼ˆApacheç­‰WebæœåŠ¡å™¨è¿è¡Œçš„æ¨¡å¼ï¼‰</li><li>ISAPIï¼ˆInternet Server Application Program Interfaceï¼‰<a id="more"></a></li></ol><p><em>å¤‡æ³¨</em>ï¼šåœ¨PHP5.3ä»¥åï¼ŒPHPä¸å†æœ‰ISAPIæ¨¡å¼ï¼Œå®‰è£…åä¹Ÿä¸å†æœ‰php5isapi.dllè¿™ä¸ªæ–‡ä»¶ã€‚è¦åœ¨IIS6ä¸Šä½¿ç”¨é«˜ç‰ˆæœ¬PHPï¼Œå¿…é¡»å®‰è£…FastCGI æ‰©å±•ï¼Œç„¶åä½¿IIS6æ”¯æŒFastCGIã€‚</p><h4 id="CGIæ¨¡å¼"><a href="#CGIæ¨¡å¼" class="headerlink" title="CGIæ¨¡å¼"></a>CGIæ¨¡å¼</h4><p>ã€€ã€€CGIå³é€šç”¨ç½‘å…³æ¥å£ï¼ˆCommon Gateway Interfaceï¼‰ï¼Œå®ƒæ˜¯ä¸€æ®µç¨‹åºï¼Œé€šä¿—çš„è®²CGIå°±è±¡æ˜¯ä¸€åº§æ¡¥ï¼ŒæŠŠç½‘é¡µå’ŒWebæœåŠ¡å™¨ä¸­çš„æ‰§è¡Œç¨‹åºè¿æ¥èµ·æ¥ï¼Œå®ƒæŠŠHTMLæ¥æ”¶çš„æŒ‡ä»¤ä¼ é€’ç»™æœåŠ¡å™¨çš„æ‰§è¡Œç¨‹åºï¼Œå†æŠŠæœåŠ¡å™¨æ‰§è¡Œç¨‹åºçš„ç»“æœè¿”è¿˜ç»™HTMLé¡µã€‚CGI çš„è·¨å¹³å°æ€§èƒ½æä½³ï¼Œå‡ ä¹å¯ä»¥åœ¨ä»»ä½•æ“ä½œç³»ç»Ÿä¸Šå®ç°ã€‚ CGIå·²ç»æ˜¯æ¯”è¾ƒè€çš„æ¨¡å¼äº†ï¼Œè¿™å‡ å¹´éƒ½å¾ˆå°‘ç”¨äº†ã€‚<br>ã€€ã€€æ¯æœ‰ä¸€ä¸ªç”¨æˆ·è¯·æ±‚ï¼Œéƒ½ä¼šå…ˆè¦åˆ›å»ºCGIçš„å­è¿›ç¨‹ï¼Œç„¶åå¤„ç†è¯·æ±‚ï¼Œå¤„ç†å®Œåç»“æŸè¿™ä¸ªå­è¿›ç¨‹ï¼Œè¿™å°±æ˜¯Fork-And-Executeæ¨¡å¼ã€‚ å½“ç”¨æˆ·è¯·æ±‚æ•°é‡éå¸¸å¤šæ—¶ï¼Œä¼šå¤§é‡æŒ¤å ç³»ç»Ÿçš„èµ„æºå¦‚å†…å­˜ï¼ŒCPUæ—¶é—´ç­‰ï¼Œé€ æˆæ•ˆèƒ½ä½ä¸‹ã€‚æ‰€ä»¥ç”¨CGIæ–¹å¼çš„æœåŠ¡å™¨æœ‰å¤šå°‘è¿æ¥è¯·æ±‚å°±ä¼šæœ‰å¤šå°‘CGIå­è¿›ç¨‹ï¼Œå­è¿›ç¨‹åå¤åŠ è½½æ˜¯CGIæ€§èƒ½ä½ä¸‹çš„ä¸»è¦åŸå› ã€‚<br>ã€€ã€€å¦‚æœä¸æƒ³æŠŠ PHP åµŒå…¥åˆ°æœåŠ¡å™¨ç«¯è½¯ä»¶ï¼ˆå¦‚ Apacheï¼‰ä½œä¸ºä¸€ä¸ªæ¨¡å—å®‰è£…çš„è¯ï¼Œå¯ä»¥é€‰æ‹©ä»¥ CGI çš„æ¨¡å¼å®‰è£…ã€‚æˆ–è€…æŠŠ PHP ç”¨äºä¸åŒçš„ CGI å°è£…ä»¥ä¾¿ä¸ºä»£ç åˆ›å»ºå®‰å…¨çš„ chroot å’Œ setuid ç¯å¢ƒã€‚è¿™æ ·æ¯ä¸ªå®¢æˆ·æœºè¯·æ±‚ä¸€ä¸ªPHPæ–‡ä»¶ï¼ŒWebæœåŠ¡å™¨å°±è°ƒç”¨php.exeï¼ˆwinä¸‹æ˜¯php.exe,linuxæ˜¯phpï¼‰å»è§£é‡Šè¿™ä¸ªæ–‡ä»¶ï¼Œç„¶åå†æŠŠè§£é‡Šçš„ç»“æœä»¥ç½‘é¡µçš„å½¢å¼è¿”å›ç»™å®¢æˆ·æœºã€‚ è¿™ç§å®‰è£…æ–¹å¼é€šå¸¸ä¼šæŠŠ PHP çš„å¯æ‰§è¡Œæ–‡ä»¶å®‰è£…åˆ° web æœåŠ¡å™¨çš„ cgi-bin ç›®å½•ã€‚CERT å»ºè®®ä¹¦ CA-96.11 å»ºè®®ä¸è¦æŠŠä»»ä½•çš„è§£é‡Šå™¨æ”¾åˆ° cgi-bin ç›®å½•ã€‚<br>ã€€ã€€è¿™ç§æ–¹å¼çš„å¥½å¤„æ˜¯æŠŠWeb Serverå’Œå…·ä½“çš„ç¨‹åºå¤„ç†ç‹¬ç«‹å¼€æ¥ï¼Œç»“æ„æ¸…æ™°ï¼Œå¯æ§æ€§å¼ºï¼ŒåŒæ—¶ç¼ºç‚¹å°±æ˜¯å¦‚æœåœ¨é«˜è®¿é—®éœ€æ±‚çš„æƒ…å†µä¸‹ï¼ŒCGIçš„è¿›ç¨‹Forkå°±ä¼šæˆä¸ºå¾ˆå¤§çš„æœåŠ¡å™¨è´Ÿæ‹…ï¼Œæƒ³ è±¡ä¸€ä¸‹æ•°ç™¾ä¸ªå¹¶å‘è¯·æ±‚å¯¼è‡´æœåŠ¡å™¨Forkå‡ºæ•°ç™¾ä¸ªè¿›ç¨‹å°±æ˜ç™½äº†ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆCGIä¸€ç›´èƒŒè´Ÿæ€§èƒ½ä½ä¸‹ï¼Œé«˜èµ„æºæ¶ˆè€—çš„æ¶åçš„åŸå› ã€‚</p><h4 id="FastCGIæ¨¡å¼"><a href="#FastCGIæ¨¡å¼" class="headerlink" title="FastCGIæ¨¡å¼"></a>FastCGIæ¨¡å¼</h4><p>ã€€ã€€FastCGIæ˜¯CGIçš„å‡çº§ç‰ˆæœ¬ï¼ŒFastCGIåƒæ˜¯ä¸€ä¸ªå¸¸é©» (long-live)å‹çš„ CGIï¼Œå®ƒå¯ä»¥ä¸€ç›´æ‰§è¡Œç€ï¼Œåªè¦æ¿€æ´»åï¼Œä¸ä¼šæ¯æ¬¡éƒ½è¦èŠ±è´¹æ—¶é—´å» Fork ä¸€æ¬¡ ï¼ˆè¿™æ˜¯ CGI æœ€ä¸ºäººè¯Ÿç—…çš„ fork-and-execute æ¨¡å¼ï¼‰ã€‚<br>ã€€ã€€FastCGIæ˜¯ä¸€ä¸ªå¯ä¼¸ç¼©åœ°ã€é«˜é€Ÿåœ°åœ¨HTTP serverå’ŒåŠ¨æ€è„šæœ¬è¯­è¨€é—´é€šä¿¡çš„æ¥å£ã€‚å¤šæ•°æµè¡Œçš„HTTP serveréƒ½æ”¯æŒFastCGIï¼ŒåŒ…æ‹¬Apacheã€Nginxå’Œlighttpdç­‰ï¼ŒåŒæ—¶ï¼ŒFastCGIä¹Ÿè¢«è®¸å¤šè„šæœ¬è¯­è¨€æ‰€æ”¯æŒï¼Œå…¶ä¸­å°±æœ‰PHPã€‚<br>ã€€ã€€FastCGIæ¥å£æ–¹å¼é‡‡ç”¨C/Sç»“æ„ï¼Œå¯ä»¥å°†HTTPæœåŠ¡å™¨å’Œè„šæœ¬è§£ææœåŠ¡å™¨åˆ†å¼€ï¼ŒåŒæ—¶åœ¨è„šæœ¬è§£ææœåŠ¡å™¨ä¸Šå¯åŠ¨ä¸€ä¸ªæˆ–è€…å¤šä¸ªè„šæœ¬è§£æå®ˆæŠ¤è¿›ç¨‹ã€‚å½“HTTPæœåŠ¡å™¨æ¯æ¬¡é‡åˆ°åŠ¨æ€ç¨‹åºæ—¶ï¼Œå¯ä»¥å°†å…¶ç›´æ¥äº¤ä»˜ç»™FastCGIè¿›ç¨‹æ¥æ‰§è¡Œï¼Œç„¶åå°†å¾—åˆ°çš„ç»“æœè¿”å›ç»™æµè§ˆå™¨ã€‚è¿™ç§æ–¹å¼å¯ä»¥è®©HTTPæœåŠ¡å™¨ä¸“ä¸€åœ°å¤„ç†é™æ€è¯·æ±‚æˆ–è€…å°†åŠ¨æ€è„šæœ¬æœåŠ¡å™¨çš„ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ï¼Œè¿™åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šæé«˜äº†æ•´ä¸ªåº”ç”¨ç³»ç»Ÿçš„æ€§èƒ½ã€‚</p><p><em>åŸç†</em></p><ol><li>Web Serverå¯åŠ¨æ—¶è½½å…¥FastCGIè¿›ç¨‹ç®¡ç†å™¨ï¼ˆIIS ISAPIæˆ–Apache Module)ï¼›</li><li>FastCGIè¿›ç¨‹ç®¡ç†å™¨è‡ªèº«åˆå§‹åŒ–ï¼Œå¯åŠ¨å¤šä¸ªCGIè§£é‡Šå™¨è¿›ç¨‹ (å¯è§å¤šä¸ªphp-cgi.exeæˆ–php-cig)å¹¶ç­‰å¾…æ¥è‡ªWeb Serverçš„è¿æ¥ï¼›</li><li>å½“å®¢æˆ·ç«¯è¯·æ±‚åˆ°è¾¾Web Serveræ—¶ï¼ŒFastCGIè¿›ç¨‹ç®¡ç†å™¨é€‰æ‹©å¹¶è¿æ¥åˆ°ä¸€ä¸ªCGIè§£é‡Šå™¨ã€‚Web serverå°†CGIç¯å¢ƒå˜é‡å’Œæ ‡å‡†è¾“å…¥å‘é€åˆ°FastCGIå­è¿›ç¨‹php-cgiï¼›</li><li>FastCGIå­è¿›ç¨‹å®Œæˆå¤„ç†åå°†æ ‡å‡†è¾“å‡ºå’Œé”™è¯¯ä¿¡æ¯ä»åŒä¸€è¿æ¥è¿”å›WebServerã€‚å½“FastCGIå­è¿›ç¨‹å…³é—­è¿æ¥æ—¶ï¼Œè¯·æ±‚ä¾¿å‘Šå¤„ç†å®Œæˆã€‚FastCGIå­è¿›ç¨‹æ¥ç€ç­‰å¾…å¹¶å¤„ç†æ¥è‡ªFastCGIè¿›ç¨‹ç®¡ç†å™¨ï¼ˆè¿è¡Œåœ¨WebServerä¸­ï¼‰çš„ä¸‹ä¸€ä¸ªè¿æ¥ã€‚åœ¨æ­£å¸¸çš„CGIæ¨¡å¼ä¸­ï¼Œphp-cgi.exeåœ¨æ­¤ä¾¿é€€å‡ºäº†ã€‚åœ¨CGIæ¨¡å¼ä¸­ï¼Œä½ å¯ä»¥æƒ³è±¡CGIé€šå¸¸æœ‰å¤šæ…¢ã€‚æ¯ä¸€ä¸ªWebè¯·æ±‚PHPéƒ½å¿…é¡»é‡æ–°è§£æphp.iniã€é‡æ–°è½½å…¥å…¨éƒ¨dllæ‰©å±•å¹¶é‡åˆå§‹åŒ–å…¨éƒ¨æ•°æ®ç»“æ„ã€‚ä½¿ç”¨FastCGIï¼Œæ‰€æœ‰è¿™äº›éƒ½åªåœ¨è¿›ç¨‹å¯åŠ¨æ—¶å‘ç”Ÿä¸€æ¬¡ã€‚ä¸€ä¸ªé¢å¤–çš„å¥½å¤„æ˜¯ï¼ŒæŒç»­æ•°æ®åº“è¿æ¥ï¼ˆPersistent database connectionï¼‰å¯ä»¥å·¥ä½œã€‚</li></ol><p><em>å¤‡æ³¨</em>ï¼šPHPçš„FastCGIè¿›ç¨‹ç®¡ç†å™¨æ˜¯PHP-FPMï¼ˆPHP-FastCGI Process Managerï¼‰</p><p><em>ä¼˜ç‚¹</em></p><ol><li>ä»ç¨³å®šæ€§ä¸Šçœ‹ï¼ŒFastCGIæ˜¯ä»¥ç‹¬ç«‹çš„è¿›ç¨‹æ± æ¥è¿è¡ŒCGIï¼Œå•ç‹¬ä¸€ä¸ªè¿›ç¨‹æ­»æ‰ï¼Œç³»ç»Ÿå¯ä»¥å¾ˆè½»æ˜“çš„ä¸¢å¼ƒï¼Œç„¶åé‡æ–°åˆ†é…æ–°çš„è¿›ç¨‹æ¥è¿è¡Œé€»è¾‘ï¼›</li><li>ä»å®‰å…¨æ€§ä¸Šçœ‹ï¼ŒFastCGIæ”¯æŒåˆ†å¸ƒå¼è¿ç®—ã€‚FastCGIå’Œå®¿ä¸»çš„Serverå®Œå…¨ç‹¬ç«‹ï¼ŒFastCGIæ€ä¹ˆdownä¹Ÿä¸ä¼šæŠŠServeræå®ï¼›</li><li>ä»æ€§èƒ½ä¸Šçœ‹ï¼ŒFastCGIæŠŠåŠ¨æ€é€»è¾‘çš„å¤„ç†ä»Serverä¸­åˆ†ç¦»å‡ºæ¥ï¼Œå¤§è´Ÿè·çš„IOå¤„ç†è¿˜æ˜¯ç•™ç»™å®¿ä¸»Serverï¼Œè¿™æ ·å®¿ä¸»Serverå¯ä»¥ä¸€<br>å¿ƒä¸€æ„ä½œIOï¼Œå¯¹äºä¸€ä¸ªæ™®é€šçš„åŠ¨æ€ç½‘é¡µæ¥è¯´, é€»è¾‘å¤„ç†å¯èƒ½åªæœ‰ä¸€å°éƒ¨åˆ†ï¼Œå¤§é‡çš„æ˜¯å›¾ç‰‡ç­‰é™æ€ã€‚</li></ol><p><em>ç¼ºç‚¹</em><br>ã€€ã€€è¯´å®Œäº†å¥½å¤„ï¼Œä¹Ÿæ¥è¯´è¯´ç¼ºç‚¹ã€‚ä»æˆ‘çš„å®é™…ä½¿ç”¨æ¥çœ‹ï¼Œç”¨FastCGIæ¨¡å¼æ›´é€‚åˆç”Ÿäº§ç¯å¢ƒçš„æœåŠ¡å™¨ã€‚ä½†å¯¹äºå¼€å‘ç”¨æœºå™¨æ¥è¯´å°±ä¸å¤ªåˆé€‚ã€‚å› ä¸ºå½“ä½¿ç”¨ZendStudioè°ƒè¯•ç¨‹åºæ—¶ï¼Œç”±äºFastCGIä¼šè®¤ä¸ºPHPè¿›ç¨‹è¶…æ—¶ï¼Œä»è€Œåœ¨é¡µé¢è¿”å›500é”™è¯¯ã€‚è¿™ä¸€ç‚¹è®©äººéå¸¸æ¼ç«ï¼Œæ‰€ä»¥æˆ‘åœ¨å¼€å‘æœºå™¨ä¸Šè¿˜æ˜¯æ¢å›äº†ISAPIæ¨¡å¼ã€‚å¯¹æŸäº›æœåŠ¡å™¨çš„æ–°ç‰ˆæœ¬æ”¯æŒä¸å¥½ï¼Œå¯¹åˆ†å¸ƒå¼è´Ÿè½½å‡è¡¡æ²¡è¦æ±‚çš„æ¨¡å—åŒ–å®‰è£…æ˜¯å¦æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚ç›®å‰çš„FastCGIå’ŒServeræ²Ÿé€šè¿˜ä¸å¤Ÿæ™ºèƒ½ï¼Œä¸€ä¸ªFastCGIè¿›ç¨‹å¦‚æœæ‰§è¡Œæ—¶é—´è¿‡é•¿ä¼šè¢«å½“æˆæ˜¯æ­»è¿›ç¨‹æ€æ‰é‡èµ·ï¼Œè¿™æ ·åœ¨å¤„ç†é•¿æ—¶é—´ä»»åŠ¡çš„æ—¶å€™å¾ˆéº»çƒ¦ï¼Œè¿™æ ·åšä¹Ÿä½¿å¾—FastCGIæ— æ³•å…è®¸è”æœºè°ƒè¯•ã€‚å› ä¸ºæ˜¯å¤šè¿›ç¨‹ï¼Œæ‰€ä»¥æ¯”CGIå¤šçº¿ç¨‹æ¶ˆè€—æ›´å¤šçš„æœåŠ¡å™¨å†…å­˜ï¼ŒPHP-CGIè§£é‡Šå™¨æ¯è¿›ç¨‹æ¶ˆè€—7è‡³25å…†å†…å­˜ï¼Œå°†è¿™ä¸ªæ•°å­—ä¹˜ä»¥50æˆ–100å°±æ˜¯å¾ˆå¤§çš„å†…å­˜æ•°ã€‚</p><h4 id="CLIæ¨¡å¼"><a href="#CLIæ¨¡å¼" class="headerlink" title="CLIæ¨¡å¼"></a>CLIæ¨¡å¼</h4><p>ã€€ã€€PHP-CLIæ˜¯PHP Command Line Interfaceçš„ç®€ç§°ï¼Œå¦‚åŒå®ƒåå­—çš„æ„æ€ï¼Œå°±æ˜¯PHPåœ¨å‘½ä»¤è¡Œè¿è¡Œçš„æ¥å£ï¼ŒåŒºåˆ«äºåœ¨WebæœåŠ¡å™¨ä¸Šè¿è¡Œçš„PHPç¯å¢ƒï¼ˆPHP-CGIï¼ŒISAPIç­‰ï¼‰ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼ŒPHPä¸å•å¯ä»¥å†™å‰å°ç½‘é¡µï¼Œå®ƒè¿˜å¯ä»¥ç”¨æ¥å†™åå°çš„ç¨‹åºã€‚PHPçš„CLIShellè„šæœ¬é€‚ç”¨äºæ‰€æœ‰çš„PHPä¼˜åŠ¿ï¼Œä½¿åˆ›å»ºè¦ä¹ˆæ”¯æŒè„šæœ¬æˆ–ç³»ç»Ÿç”šè‡³ä¸GUIåº”ç”¨ç¨‹åºçš„æœåŠ¡ç«¯ï¼Œåœ¨Windowså’ŒLinuxä¸‹éƒ½æ˜¯æ”¯æŒPHP-CLIæ¨¡å¼çš„ã€‚</p><p><em>ä¼˜ç‚¹</em></p><ol><li>ä½¿ç”¨å¤šè¿›ç¨‹ï¼Œå­è¿›ç¨‹ç»“æŸä»¥åï¼Œå†…æ ¸ä¼šè´Ÿè´£å›æ”¶èµ„æºï¼›</li><li>ä½¿ç”¨å¤šè¿›ç¨‹ï¼Œå­è¿›ç¨‹å¼‚å¸¸é€€å‡ºä¸ä¼šå¯¼è‡´æ•´ä¸ªè¿›ç¨‹Threadé€€å‡ºï¼Œçˆ¶è¿›ç¨‹è¿˜æœ‰æœºä¼šé‡å»ºæµç¨‹ï¼›</li><li>ä¸€ä¸ªå¸¸é©»ä¸»è¿›ç¨‹ï¼Œåªè´Ÿè´£ä»»åŠ¡åˆ†å‘ï¼Œé€»è¾‘æ›´æ¸…æ¥šã€‚æˆ‘ä»¬åœ¨Linuxä¸‹ç»å¸¸ä½¿ç”¨â€phpâ€“mâ€æŸ¥æ‰¾PHPå®‰è£…äº†é‚£äº›æ‰©å±•å°±æ˜¯PHPå‘½ä»¤è¡Œè¿è¡Œæ¨¡å¼ï¼›æœ‰å…´è¶£çš„åŒå­¦å¯ä»¥è¾“å…¥â€php â€“hâ€å»æ·±å…¥ç ”ç©¶è¯¥è¿è¡Œæ¨¡å¼ã€‚</li></ol><h4 id="æ¨¡å—æ¨¡å¼"><a href="#æ¨¡å—æ¨¡å¼" class="headerlink" title="æ¨¡å—æ¨¡å¼"></a>æ¨¡å—æ¨¡å¼</h4><p>ã€€æ¨¡å—æ¨¡å¼æ˜¯ä»¥mod_php5æ¨¡å—çš„å½¢å¼é›†æˆï¼Œæ­¤æ—¶mod_php5æ¨¡å—çš„ä½œç”¨æ˜¯æ¥æ”¶Apacheä¼ é€’è¿‡æ¥çš„PHPæ–‡ä»¶è¯·æ±‚ï¼Œå¹¶å¤„ç†è¿™äº›è¯·æ±‚ï¼Œç„¶åå°†å¤„ç†åçš„ç»“æœè¿”å›ç»™Apacheã€‚å¦‚æœæˆ‘ä»¬åœ¨Apacheå¯åŠ¨å‰åœ¨å…¶é…ç½®æ–‡ä»¶ä¸­é…ç½®å¥½äº†PHPæ¨¡å—ï¼ˆmod_php5ï¼‰ï¼Œ PHPæ¨¡å—é€šè¿‡æ³¨å†Œapache2çš„ap_hook_post_configæŒ‚é’©ï¼Œåœ¨Apacheå¯åŠ¨çš„æ—¶å€™å¯åŠ¨æ­¤æ¨¡å—ä»¥æ¥å—PHPæ–‡ä»¶çš„è¯·æ±‚ã€‚<br>ã€€é™¤äº†è¿™ç§å¯åŠ¨æ—¶çš„åŠ è½½æ–¹å¼ï¼ŒApacheçš„æ¨¡å—å¯ä»¥åœ¨è¿è¡Œçš„æ—¶å€™åŠ¨æ€è£…è½½ï¼Œè¿™æ„å‘³ç€å¯¹æœåŠ¡å™¨å¯ä»¥è¿›è¡ŒåŠŸèƒ½æ‰©å±•è€Œä¸éœ€è¦é‡æ–°å¯¹æºä»£ç è¿›è¡Œç¼–è¯‘ï¼Œç”šè‡³æ ¹æœ¬ä¸éœ€è¦åœæ­¢æœåŠ¡å™¨ã€‚æˆ‘ä»¬æ‰€éœ€è¦åšçš„ä»…ä»…æ˜¯ç»™æœåŠ¡å™¨å‘é€ä¿¡å·HUPæˆ–è€…AP_SIG_GRACEFULé€šçŸ¥æœåŠ¡å™¨é‡æ–°è½½å…¥æ¨¡å—ã€‚ä½†æ˜¯åœ¨åŠ¨æ€åŠ è½½ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å°†æ¨¡å—ç¼–è¯‘æˆä¸ºåŠ¨æ€é“¾æ¥åº“ã€‚æ­¤æ—¶çš„åŠ¨æ€åŠ è½½å°±æ˜¯åŠ è½½åŠ¨æ€é“¾æ¥åº“ã€‚ Apacheä¸­å¯¹åŠ¨æ€é“¾æ¥åº“çš„å¤„ç†æ˜¯é€šè¿‡æ¨¡å—mod_soæ¥å®Œæˆçš„ï¼Œå› æ­¤mod_soæ¨¡å—ä¸èƒ½è¢«åŠ¨æ€åŠ è½½ï¼Œå®ƒåªèƒ½è¢«é™æ€ç¼–è¯‘è¿›Apacheçš„æ ¸å¿ƒã€‚è¿™æ„å‘³ç€å®ƒæ˜¯éšç€Apacheä¸€èµ·å¯åŠ¨çš„ã€‚<br>ã€€Apacheæ˜¯å¦‚ä½•åŠ è½½æ¨¡å—çš„å‘¢ï¼Ÿæˆ‘ä»¬ä»¥å‰é¢æåˆ°çš„mod_php5æ¨¡å—ä¸ºä¾‹ã€‚é¦–å…ˆæˆ‘ä»¬éœ€è¦åœ¨Apacheçš„é…ç½®æ–‡ä»¶httpd.confä¸­æ·»åŠ ä¸€è¡Œï¼š<br>LoadModule php5_module modules/mod_php5.so<br>ã€€è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº†LoadModuleå‘½ä»¤ï¼Œè¯¥å‘½ä»¤çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ¨¡å—çš„åç§°ï¼Œåç§°å¯ä»¥åœ¨æ¨¡å—å®ç°çš„æºç ä¸­æ‰¾åˆ°ã€‚ç¬¬äºŒä¸ªé€‰é¡¹æ˜¯è¯¥æ¨¡å—æ‰€å¤„çš„è·¯å¾„ã€‚å¦‚æœéœ€è¦åœ¨æœåŠ¡å™¨è¿è¡Œæ—¶åŠ è½½æ¨¡å—ï¼Œå¯ä»¥é€šè¿‡å‘é€ä¿¡å·HUPæˆ–è€…AP_SIG_GRACEFULç»™æœåŠ¡å™¨ï¼Œä¸€æ—¦æ¥å—åˆ°è¯¥ä¿¡å·ï¼ŒApacheå°†é‡æ–°è£…è½½æ¨¡å—ï¼Œè€Œä¸éœ€è¦é‡æ–°å¯åŠ¨æœåŠ¡å™¨ã€‚<br>ã€€è¯¥è¿è¡Œæ¨¡å¼æ˜¯æˆ‘ä»¬ä»¥å‰åœ¨windowsç¯å¢ƒä¸‹ä½¿ç”¨apacheæœåŠ¡å™¨ç»å¸¸ä½¿ç”¨çš„ï¼Œè€Œåœ¨æ¨¡å—åŒ–ï¼ˆDLLï¼‰ä¸­ï¼ŒPHPæ˜¯ä¸WebæœåŠ¡å™¨ä¸€èµ·å¯åŠ¨å¹¶è¿è¡Œçš„ã€‚ï¼ˆå®ƒæ˜¯apacheåœ¨CGIçš„åŸºç¡€ä¸Šè¿›è¡Œçš„ä¸€ç§æ‰©å±•ï¼ŒåŠ å¿«PHPçš„è¿è¡Œæ•ˆç‡ï¼‰ã€‚</p><h4 id="ISAPIæ¨¡å¼"><a href="#ISAPIæ¨¡å¼" class="headerlink" title="ISAPIæ¨¡å¼"></a>ISAPIæ¨¡å¼</h4><p>ã€€ISAPIï¼ˆInternet Server Application Program Interfaceï¼‰æ˜¯å¾®è½¯æä¾›çš„ä¸€å¥—é¢å‘InternetæœåŠ¡çš„APIæ¥å£ï¼Œä¸€ä¸ªISAPIçš„DLLï¼Œå¯ä»¥åœ¨è¢«ç”¨æˆ·è¯·æ±‚æ¿€æ´»åé•¿é©»å†…å­˜ï¼Œç­‰å¾…ç”¨æˆ·çš„å¦ä¸€ä¸ªè¯·æ±‚ï¼Œè¿˜å¯ä»¥åœ¨ä¸€ä¸ªDLLé‡Œè®¾ç½®å¤šä¸ªç”¨æˆ·è¯·æ±‚å¤„ç†å‡½æ•°ï¼Œæ­¤å¤–ï¼ŒISAPIçš„DLLåº”ç”¨ç¨‹åºå’ŒWWWæœåŠ¡å™¨å¤„äºåŒä¸€ä¸ªè¿›ç¨‹ä¸­ï¼Œæ•ˆç‡è¦æ˜¾è‘—é«˜äºCGIã€‚ï¼ˆç”±äºå¾®è½¯çš„æ’ä»–æ€§ï¼Œåªèƒ½è¿è¡Œäºwindowsç¯å¢ƒï¼‰PHPä½œä¸ºApacheæ¨¡å—ï¼ŒApacheæœåŠ¡å™¨åœ¨ç³»ç»Ÿå¯åŠ¨åï¼Œé¢„å…ˆç”Ÿæˆå¤šä¸ªè¿›ç¨‹å‰¯æœ¬é©»ç•™åœ¨å†…å­˜ä¸­ï¼Œä¸€æ—¦æœ‰è¯·æ±‚å‡ºç°ï¼Œå°±ç«‹å³ä½¿ç”¨è¿™äº›ç©ºä½™çš„å­è¿›ç¨‹è¿›è¡Œå¤„ç†ï¼Œè¿™æ ·å°±ä¸å­˜åœ¨ç”Ÿæˆå­è¿›ç¨‹é€ æˆçš„å»¶è¿Ÿäº†ã€‚è¿™äº›æœåŠ¡å™¨å‰¯æœ¬åœ¨å¤„ç†å®Œä¸€æ¬¡HTTPè¯·æ±‚ä¹‹åå¹¶ä¸ç«‹å³é€€å‡ºï¼Œè€Œæ˜¯åœç•™åœ¨è®¡ç®—æœºä¸­ç­‰å¾…ä¸‹æ¬¡è¯·æ±‚ã€‚å¯¹äºå®¢æˆ·æµè§ˆå™¨çš„è¯·æ±‚ååº”æ›´å¿«ï¼Œæ€§èƒ½è¾ƒé«˜ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è§£å†³gité»˜è®¤ä¸åŒºåˆ†æ–‡ä»¶åå¤§å°å†™çš„é—®é¢˜</title>
      <link href="/post/8598d574.html"/>
      <url>/post/8598d574.html</url>
      
        <content type="html"><![CDATA[<p>å½“ä½ åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å,å« readme.md å†™å…¥å†…å®¹å æäº¤åˆ°çº¿ä¸Šä»£ç ä»“åº“.<br>ç„¶åä½ åœ¨æœ¬åœ°ä¿®æ”¹æ–‡ä»¶åä¸º Readme.md æ¥ç€ä½ å»æäº¤,å‘ç°ä»£ç æ²¡æœ‰å˜åŒ–.</p><a id="more"></a><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git status</span><br></pre></td></tr></table></figure><p>ä½ ä¼šæ— ä»»ä½•æç¤ºä¿¡æ¯,å…¶å® git é»˜è®¤å¯¹äºæ–‡ä»¶åå¤§å°å†™æ˜¯ä¸æ•æ„Ÿçš„,æ‰€ä»¥ä¸Šé¢ä½ ä¿®æ”¹äº†é¦–å­—æ¯å¤§å†™,ä½†æ˜¯git å¹¶æ²¡æœ‰å‘ç°ä»£ç ä»»ä½•æ”¹åŠ¨.é‚£ä¹ˆå¦‚ä½•æ‰èƒ½è®© git è¯†åˆ«æ–‡ä»¶åå¤§å°å†™å˜åŒ–.</p><p>ä¸€  é…ç½®git ä½¿å…¶å¯¹æ–‡ä»¶åå¤§å°å†™æ•æ„Ÿ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config core.ignorecase false</span><br></pre></td></tr></table></figure><p>äºŒ ä»git æœ¬åœ°ä»“åº“åˆ é™¤æ­¤æ–‡ä»¶,ç„¶åæ·»åŠ å†æäº¤<br>(1) åˆ é™¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git rm readme.md</span><br></pre></td></tr></table></figure><p>(2) é‡æ–°æ·»åŠ </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git add Readme.md</span><br></pre></td></tr></table></figure><p>(3)æäº¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit -m 'Readme.md'</span><br></pre></td></tr></table></figure><p>è¿™æ ·gitä¸åŒºåˆ†æ–‡ä»¶åå¤§å°å†™çš„é—®é¢˜å°±è§£å†³äº†ï¼</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>éšè—Nginxæˆ–Apacheä»¥åŠPHPçš„ç‰ˆæœ¬å·</title>
      <link href="/post/adb014f8.html"/>
      <url>/post/adb014f8.html</url>
      
        <content type="html"><![CDATA[<p>  å½“ä½ é…ç½®å®Œä¸€å°æœåŠ¡å™¨åï¼Œå¹¶ä¸æ˜¯å°±å¯ä»¥é«˜æ•æ— å¿§äº†ï¼Œç”±äºè½¯ä»¶éš¾å…ä¼šæœ‰æ¼æ´ï¼Œé˜²æ­¢å› ä¸ºæ¼æ´å¯¼è‡´ä¸€äº›æŸå¤±ï¼Œæ‰€ä»¥è¯´ç»å¸¸å…³æ³¨å®‰å…¨å…¬å‘Šå¹¶åŠæ—¶å‡çº§æœåŠ¡å™¨ä¹Ÿæ˜¯å¿…è¦çš„ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œé»‘å®¢æ”»å‡»æœåŠ¡å™¨çš„é¦–è¦æ­¥éª¤å°±æ˜¯æ”¶é›†ä¿¡æ¯ï¼Œæ¯”å¦‚è¯´ä½ çš„è½¯ä»¶ç‰ˆæœ¬ï¼Œè¿™äº›å°†æˆä¸ºä¸‹ä¸€æ­¥æœ‰é’ˆå¯¹æ€§æ”»å‡»çš„ä¾æ®ã€‚æ‰€ä»¥è¯´ä¸€å®šç¨‹åº¦çš„éšè—è¿™äº›ä¿¡æ¯å°±æ˜¾å¾—éå¸¸æœ‰å¿…è¦äº†ï¼Œæœ¬æ–‡å°†ç®€å•ä»‹ç»å¦‚ä½•åœ¨ç½‘ç»œä¸Šéšè—Nginxç‰ˆæœ¬å·ä»¥åŠPHPçš„ç‰ˆæœ¬å·ã€‚</p><a id="more"></a><p>æˆ‘ä»¬ç”¨å‘½ä»¤æµ‹è¯•ä¸€ä¸‹ï¼Œæ˜¾ç¤ºæœåŠ¡å™¨ä¸Šç‰ˆæœ¬ä¿¡æ¯ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -I http://127.0.0.1/phpinfo.php</span><br></pre></td></tr></table></figure><p>ç»“æœæ˜¾ç¤ºäº†å¦‚ä¸‹å†…å®¹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Server: nginx/1.5.0</span><br><span class="line">Date: Thu, 18 Jun 2015 02:39:32 GMT</span><br><span class="line">Content-Type: text/html</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Vary: Accept-Encoding</span><br><span class="line">X-Powered-By: PHP/5.3.1</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„æœåŠ¡å™¨nginxå’Œphpç‰ˆæœ¬éƒ½æš´éœ²äº†ã€‚é‚£è¯¥å¦‚ä½•éšè—ç‰ˆæœ¬å·å‘¢ï¼Ÿ<br>  1.å…ˆè¯´éšè—Nginxç‰ˆæœ¬å·ï¼ŒNginxçš„ç‰ˆæœ¬å·ä¸»è¦åœ¨ä¸¤ä¸ªåœ°æ–¹ä¼šæœ‰ï¼Œä¸€ä¸ªæ˜¯HTTP headerï¼Œæœ‰ä¸ªServer:nginx/1.x.xç±»ä¼¼ä¼šæš´éœ²WebæœåŠ¡å™¨æ‰€ç”¨è½¯ä»¶åç§°ä»¥åŠç‰ˆæœ¬å·ï¼Œè¿™ä¸ªä¹Ÿæ˜¯å¤§å¤šæ•°WebæœåŠ¡å™¨æœ€å®¹æ˜“æš´éœ²ç‰ˆæœ¬å·çš„åœ°æ–¹ï¼Œç¬¬äºŒä¸ªåœ°æ–¹æ˜¯Nginxå‡ºé”™é¡µé¢ï¼Œæ¯”å¦‚404é¡µé¢æ²¡æœ‰æ‰¾åˆ°ç­‰ï¼Œè¿™æ˜¯å¦‚æœç”¨æˆ·æ²¡æœ‰æŒ‡å®šé¡µé¢çš„è¯ï¼Œé‚£ä¹ˆNginxè‡ªå·±çš„é¡µé¢ä¼šæœ‰ç‰ˆæœ¬æˆ³è®°ã€‚<br>  åœ¨nginxé…ç½®æ–‡ä»¶ä¸­httpèŠ‚çš„é…ç½®,åŠ å…¥ä»¥ä¸‹ä»£ç ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http &#123;</span><br><span class="line">    # ...çœç•¥ä¸€äº›é…ç½®</span><br><span class="line">    server_tokens off;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>æœ€ååˆ«å¿˜äº†ä½¿ç”¨å‘½ä»¤nginx -s reloadåˆ·æ–°å½“å‰é…ç½®ã€‚å®Œæˆåä½ å¯ä»¥æŸ¥çœ‹æ‰€æœ‰é¡µé¢çš„å“åº”å¤´æˆ–è€…é”™è¯¯é¡µï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯åªçœ‹åˆ°nginxå­—æ ·è€Œçœ‹ä¸åˆ°ç‰ˆæœ¬å·ï¼Ÿä»€ä¹ˆï¼Ÿä½ æƒ³è¿nginxä¹Ÿæ”¹æ‰ï¼Ÿå‘µå‘µï¼Œè¿™ä¸ªææ€•å°±éº»çƒ¦äº†ï¼Œéœ€è¦æ”¹åŠ¨Nginxæºä»£ç ç„¶åé‡æ–°ç¼–è¯‘ï¼Œæ„Ÿå…´è¶£çš„ç«¥é‹å¯ä»¥ç ”ç©¶ä¸‹ï¼<br>åœ¨apacheé…ç½®æ–‡ä»¶httpd.confä¸­,åŠ å…¥ä»¥ä¸‹ä»£ç ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ServerTokens Prod</span><br><span class="line">ServerSignature Off</span><br></pre></td></tr></table></figure><p>è®°å¾—ä¿å­˜åé‡å¯ä¸€ä¸‹apache!</p><p>2.éšè—PHPçš„ç‰ˆæœ¬å·ï¼ŒPHPå®¹æ˜“æš´éœ²çš„ç‰ˆæœ¬å·åœ¨ä»€ä¹ˆåœ°æ–¹å‘¢ï¼Ÿå…¶å®ä¹Ÿæ˜¯åœ¨HTTPå¤´ï¼Œä»¥ç±»ä¼¼X-Powered-By: PHP/5.2.11è¿™ç§å½¢å¼å­˜åœ¨ã€‚<br>  å…¶å®è¿™ä¸ªæ˜¯åœ¨PHPçš„é…ç½®æ–‡ä»¶php.inié‡Œæ”¹åŠ¨ï¼Œæ‰“å¼€php.iniï¼Œæ‰¾åˆ°ä¸‹é¢å™è¿°ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">; Decides whether PHP may expose the fact that it is installed on the server</span><br><span class="line">; (e.g. by adding its signature to the Web server header).  It is no security</span><br><span class="line">; threat in any way, but it makes it possible to determine whether you use PHP</span><br><span class="line">; on your server or not.</span><br><span class="line">; http://php.net/expose-php</span><br><span class="line">expose_php = On</span><br></pre></td></tr></table></figure><p>  expose_php = Onæ”¹ä¸ºexpose_php = Offå°±æå®šäº†ï¼Œå½“ç„¶ï¼Œå¯¹äºapacheæœåŠ¡å™¨è¿˜æœ‰å¦å¤–ä¸€ä¸ªæ–¹æ³•å¯ä»¥ç›´æ¥å°è¯•åœ¨.htaccessæ–‡ä»¶ä¸­Header unset X-Powered-Byï¼Œåˆ é™¤X-Powered-ByèŠ‚ï¼Œä¸è¿‡æˆ‘è¿˜æ˜¯å»ºè®®æ”¹åŠ¨php.iniçš„expose_phpã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•æ­£ç¡®çš„ä¿®æ”¹Pythonçš„pipè‡ªå¸¦çš„æº</title>
      <link href="/post/cf179e51.html"/>
      <url>/post/cf179e51.html</url>
      
        <content type="html"><![CDATA[<p>  Pythonä¸­çš„pipå®‰è£…ä¾èµ–åŒ…æ—¶é»˜è®¤è®¿é—®<a href="https://pypi.python.org/simple/ï¼Œä½†æ˜¯ç»å¸¸å‡ºç°ä¸ç¨³å®šä»¥åŠè®¿é—®é€Ÿåº¦éå¸¸æ…¢çš„æƒ…å†µï¼Œå›½å†…å‚å•†æä¾›çš„pipyé•œåƒç›®å‰å¯ç”¨çš„æœ‰ï¼š" target="_blank" rel="noopener">https://pypi.python.org/simple/ï¼Œä½†æ˜¯ç»å¸¸å‡ºç°ä¸ç¨³å®šä»¥åŠè®¿é—®é€Ÿåº¦éå¸¸æ…¢çš„æƒ…å†µï¼Œå›½å†…å‚å•†æä¾›çš„pipyé•œåƒç›®å‰å¯ç”¨çš„æœ‰ï¼š</a></p><h4 id="1-http-pypi-douban-com-è±†ç“£"><a href="#1-http-pypi-douban-com-è±†ç“£" class="headerlink" title="1.http://pypi.douban.com/ è±†ç“£"></a>1.<a href="http://pypi.douban.com/" target="_blank" rel="noopener">http://pypi.douban.com/</a> è±†ç“£</h4><h4 id="2-http-pypi-mirrors-ustc-edu-cn-simple-ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦"><a href="#2-http-pypi-mirrors-ustc-edu-cn-simple-ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦" class="headerlink" title="2.http://pypi.mirrors.ustc.edu.cn/simple/ ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦"></a>2.<a href="http://pypi.mirrors.ustc.edu.cn/simple/" target="_blank" rel="noopener">http://pypi.mirrors.ustc.edu.cn/simple/</a> ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦</h4><a id="more"></a><p>æœ‰ä¸¤ç§æ–¹å¼ä½¿ç”¨æˆ‘ä»¬è‡ªå·±æŒ‡å®šçš„é•œåƒæºï¼Œç¬¬ä¸€ç§æ˜¯æ‰‹åŠ¨æŒ‡å®šï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip -i http://pypi.douban.com/simple install Flask -- trusted-host pypi.douban.com</span><br></pre></td></tr></table></figure><p>ä¸è¿‡è¿™ç§æ–¹å¼åœ¨æ¯æ¬¡å®‰è£…æ—¶éƒ½è¦æ‰‹åŠ¨æŒ‡å®šï¼Œæ‰€ä»¥ç¬¬äºŒç§æ–¹æ³•æ›´åŠ æ–¹ä¾¿ï¼Œåœ¨å½“å‰ç”¨æˆ·ç›®å½•ä¸‹åˆ›å»º.pipæ–‡ä»¶å¤¹ä¸­ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">ini=<span class="string">"""[global]</span></span><br><span class="line"><span class="string">index-url = https://pypi.doubanio.com/simple/</span></span><br><span class="line"><span class="string">[install]</span></span><br><span class="line"><span class="string">trusted-host=pypi.doubanio.com</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line">pippath=os.environ[<span class="string">"USERPROFILE"</span>]+<span class="string">"\\pip\\"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(pippath):</span><br><span class="line">    os.mkdir(pippath)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(pippath+<span class="string">"pip.ini"</span>,<span class="string">"w+"</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(ini)</span><br></pre></td></tr></table></figure><p>  ä¸ªäººè§‰å¾—ç¬¬äºŒç§æ–¹æ³•æœ€ä½³ï¼Œä¸€æ¬¡æ‰§è¡Œç»ˆèº«æ— å¿§ï¼</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Linuxæ–‡ä»¶æ—¶é—´è¯¦è§£ ctimeã€mtimeå’Œatime</title>
      <link href="/post/6652f017.html"/>
      <url>/post/6652f017.html</url>
      
        <content type="html"><![CDATA[<p>Linuxç³»ç»Ÿæ–‡ä»¶æœ‰ä¸‰ä¸ªä¸»è¦çš„æ—¶é—´å±æ€§ï¼Œåˆ†åˆ«æ˜¯ ctime(change time), atime(access time), mtime(modify time)ã€‚è¿™ä¸‰ä¸ªæ—¶é—´å¾ˆå®¹æ˜“æ··æ·†ï¼Œå‡†å¤‡æ·±å…¥äº†è§£Linuxçš„ç«¥é‹è¯·åŒºåˆ†è¿™ä¸‰è€…çš„åŒºåˆ«ã€‚</p><a id="more"></a><p>atimeï¼šAccess timeï¼Œæ˜¯åœ¨è¯»å–æ–‡ä»¶æˆ–è€…æ‰§è¡Œæ–‡ä»¶æ—¶æ›´æ”¹ï¼Œå³æ–‡ä»¶æœ€åä¸€æ¬¡è¢«è¯»å–çš„æ—¶é—´ã€‚<br>è¯´æ˜ï¼š st_atime</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Time when file data was last accessed. Changed by  the following  functions:  creat(),  mknod(),</span><br><span class="line">  pipe(), utime(2), and read(2).</span><br></pre></td></tr></table></figure><p>mtimeï¼šModified timeï¼Œæ˜¯åœ¨å†™å…¥æ–‡ä»¶æ—¶éšæ–‡ä»¶å†…å®¹çš„æ›´æ”¹è€Œæ›´æ”¹ï¼Œæ˜¯æŒ‡æ–‡ä»¶å†…å®¹æœ€åä¸€æ¬¡è¢«ä¿®æ”¹çš„æ—¶é—´ã€‚<br>è¯´æ˜ï¼š st_mtime</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Time when data was last modified. Changed by the  following  functions:</span><br><span class="line">  creat(), mknod(), pipe(), utime(), and write(2).</span><br></pre></td></tr></table></figure><p>ctimeï¼šChange timeï¼Œæ˜¯åœ¨å†™å…¥æ–‡ä»¶ã€æ›´æ”¹æ‰€æœ‰è€…ã€æƒé™æˆ–é“¾æ¥è®¾ç½®æ—¶éš Inode çš„å†…å®¹æ›´æ”¹è€Œæ›´æ”¹ï¼Œå³æ–‡ä»¶çŠ¶æ€æœ€åä¸€æ¬¡è¢«æ”¹å˜çš„æ—¶é—´ã€‚<br>è¯´æ˜ï¼š st_ctime</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Time when file status was last changed. Changed by the following  functions: </span><br><span class="line"> chmod(),  chown(),  creat(), link(2),  mknod(),  pipe(),  unlink(2),  utime(),  and write().</span><br></pre></td></tr></table></figure><p>å¾ˆå¤šäººæŠŠå®ƒç†è§£æˆcreate timeï¼ŒåŒ…æ‹¬å¾ˆå¤šè¯¯å¯¼äººçš„ä¹¦ç±ä¹Ÿæ˜¯è¿™ä¹ˆå†™ã€‚å®é™…ä¸Šctimeæ˜¯æŒ‡change timeã€‚<br>æ³¨æ„ï¼š<br>1ã€ä¿®æ”¹æ˜¯æ–‡æœ¬æœ¬èº«çš„å†…å®¹å‘ç”Ÿäº†å˜åŒ–ï¼ˆmtimeï¼‰<br>æ”¹å˜æ˜¯æ–‡ä»¶çš„ç´¢å¼•èŠ‚ç‚¹å‘ç”Ÿäº†æ”¹å˜ï¼ˆctimeï¼‰<br>2ã€å¦‚æœä¿®æ”¹äº†æ–‡ä»¶å†…å®¹ï¼Œåˆ™åŒæ—¶æ›´æ–°ctimeå’Œmtime<br>3ã€å¦‚æœåªæ”¹å˜äº†æ–‡ä»¶ç´¢å¼•èŠ‚ç‚¹ï¼Œæ¯”å¦‚ä¿®æ”¹æƒé™ï¼Œåˆ™åªæ˜¯æ”¹å˜äº†ctime<br>4ã€å¦‚æœä½¿ç”¨ext3æ–‡ä»¶ç³»ç»Ÿçš„æ—¶å€™ï¼Œåœ¨mountçš„æ—¶å€™ä½¿ç”¨äº†noatimeå‚æ•°åˆ™ä¸ä¼šæ›´æ–°atimeçš„ä¿¡æ¯ï¼Œå³è®¿é—®æ–‡ä»¶ä¹‹åatimeä¸ä¼šè¢«ä¿®æ”¹ï¼Œè€Œè¿™ä¸ªä¸ä»£è¡¨çœŸå®æƒ…å†µ<br>å°çŸ¥è¯†ï¼šè¿™ä¸‰ä¸ª time stamp éƒ½æ”¾åœ¨ inode ä¸­ã€‚è‹¥mtime,atimeä¿®æ”¹, inode å°±ä¸€å®šä¼šæ”¹,ç›¸åº”çš„inodeæ”¹äº†,é‚£ctime ä¹Ÿå°±è·Ÿç€è¦æ”¹äº†ï¼Œä¹‹æ‰€ä»¥åœ¨mount optionä¸­ä½¿ç”¨ noatime, å°±æ˜¯ä¸æƒ³ file system åšå¤ªå¤šçš„ä¿®æ”¹, ä»è€Œæ”¹å–„è¯»å–æ€§èƒ½.<br>æŸ¥çœ‹æ–‡ä»¶çš„ atimeã€ctime å’Œ mtimeã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> ls -lc filename        åˆ—å‡ºæ–‡ä»¶çš„ ctime</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ls -lu filename        åˆ—å‡ºæ–‡ä»¶çš„ atime</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ls -l  filename          åˆ—å‡ºæ–‡ä»¶çš„ mtime</span></span><br><span class="line"><span class="meta">#</span><span class="bash">ä¾‹å­</span></span><br><span class="line">1ï¼š # echo "Hello World" &gt;&gt; myfile    atimeä¸å˜,åŒæ—¶æ”¹å˜äº†ctimeå’Œmtime</span><br><span class="line">2ï¼š # cat myfile            ctimeå’Œmtimeä¸å˜ï¼Œåªæ”¹å˜atime</span><br><span class="line"><span class="meta">#</span><span class="bash"> ls myfile</span></span><br><span class="line">ctimeå’Œmtimeä»¥åŠatimeéƒ½ä¸æ”¹å˜</span><br><span class="line">3ï¼š # chmod u+x myfile            mtimeå’Œatimeä¸å˜ï¼Œåªæ”¹å˜ctime</span><br><span class="line">4ï¼š # mv myfile ../ mtimeå’Œatimeä¸å˜ï¼Œåªæ”¹å˜ctime</span><br></pre></td></tr></table></figure><p>å…¶ä»–æ‰©å±•ï¼š<br>relatimeå±æ€§<br>ä»kernel2.6.29å¼€å§‹ï¼Œé»˜è®¤é›†æˆäº†ä¸€ä¸ª relatimeçš„å±æ€§ã€‚ä½¿ç”¨è¿™ä¸ªç‰¹æ€§æ¥æŒ‚è£…æ–‡ä»¶ç³»ç»Ÿåï¼Œåªæœ‰å½“mtimeæ¯”atimeæ›´æ–°çš„æ—¶å€™ï¼Œæ‰ä¼šæ›´æ–°atimeã€‚<br>ä½¿ç”¨åœºæ™¯ï¼š<br>åœ¨æ–‡ä»¶è¯»æ“ä½œå¾ˆé¢‘ç¹çš„ç³»ç»Ÿä¸­ï¼Œatimeæ›´æ–°æ‰€å¸¦æ¥çš„å¼€é”€å¾ˆå¤§ï¼Œæ‰€ä»¥åœ¨æŒ‚è£…æ–‡ä»¶ç³»ç»Ÿçš„æ—¶å€™ä½¿ç”¨noatimeå±æ€§æ¥åœæ­¢æ›´æ–°atimeã€‚ä½†æ˜¯æœ‰äº›ç¨‹åºéœ€è¦æ ¹æ®atimeè¿›è¡Œä¸€äº›åˆ¤æ–­å’Œæ“ä½œï¼Œè¿™ä¸ªæ—¶å€™relatimeç‰¹æ€§å°±æ´¾ä¸Šç”¨åœºäº†ã€‚å…¶å®åœ¨äº‹å®ä¸Šï¼Œè¿™ä¸ªæ—¶å€™atimeå’Œmtimeå·²ç»æ˜¯åŒä¸€ä¸ªtimeï¼Œæ‰€ä»¥å¯ä»¥ç†è§£è¿™ä¸ªé€‰é¡¹å°±æ˜¯ä¸ºäº†å®ç°å¯¹atimeçš„å…¼å®¹æ‰æ¨å‡ºçš„ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªæ–°çš„æ—¶é—´å±æ€§ã€‚<br>ä½¿ç”¨æ–¹æ³•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> mount -o relatime /dir<span class="comment">##æŒ‚è½½ç›®å½•çš„æ—¶å€™åŠ relatimeå‚æ•°</span></span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>apacheå‡ºç°no input file specified.çš„å®Œç¾è§£å†³æ–¹æ¡ˆ</title>
      <link href="/post/ff626742.html"/>
      <url>/post/ff626742.html</url>
      
        <content type="html"><![CDATA[<p>å¯ç”¨rewriteçš„ä¼ªé™æ€åŠŸèƒ½çš„æ—¶å€™ï¼Œé¦–é¡µå¯ä»¥è®¿é—®ï¼Œè€Œè®¿é—®å†…é¡µçš„æ—¶å€™ï¼Œå°±æç¤ºï¼šâ€œNo input file specified.â€<br>åŸå› åœ¨äºä½¿ç”¨çš„PHPæ˜¯fast_cgiæ¨¡å¼ï¼Œè€Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä¸èƒ½æ­£ç¡®è¯†åˆ«path_infoæ‰€é€ æˆçš„é”™è¯¯ï¼ŒWordpressçš„ä¼ªé™æ€ä¹Ÿæœ‰ä¸€æ ·çš„é—®é¢˜ã€‚</p><a id="more"></a><p>Wordpressç¨‹åºé»˜è®¤çš„.htaccessé‡Œé¢çš„è§„åˆ™ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">RewriteEngine On</span><br><span class="line">RewriteBase /</span><br><span class="line">RewriteCond %&#123;REQUEST_FILENAME&#125; !-f</span><br><span class="line">RewriteCond %&#123;REQUEST_FILENAME&#125; !-d</span><br><span class="line">RewriteRule ^(.*)$ /index.php/$1 [L]</span><br></pre></td></tr></table></figure><p>å…¶å®â€œNo input file specified.â€ï¼Œæ˜¯æ²¡æœ‰å¾—åˆ°æœ‰æ•ˆçš„æ–‡ä»¶è·¯å¾„é€ æˆçš„ã€‚ä¿®æ”¹ä¼ªé™æ€è§„åˆ™ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">RewriteEngine On</span><br><span class="line">RewriteBase /</span><br><span class="line">RewriteCond %&#123;REQUEST_FILENAME&#125; !-f</span><br><span class="line">RewriteCond %&#123;REQUEST_FILENAME&#125; !-d</span><br><span class="line">RewriteRule ^(.*)$ /index.php?/$1 [L]</span><br></pre></td></tr></table></figure><p>æœ‰æ²¡æœ‰å‘ç°ä¸åŒï¼Ÿ<br>å…¶å®å°±æ˜¯åœ¨æ­£åˆ™ç»“æœâ€œ/$1â€å‰é¢å¤šåŠ äº†ä¸€ä¸ªâ€œ?â€å·ï¼Œé—®é¢˜ä¹Ÿå°±éšä¹‹è§£å†³äº†ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>git pullæ“ä½œå¤±è´¥çš„é—®é¢˜</title>
      <link href="/post/a774f745.html"/>
      <url>/post/a774f745.html</url>
      
        <content type="html"><![CDATA[<p>ä½¿ç”¨gitç‰ˆæœ¬æ§åˆ¶ï¼Œæäº¤ä»£ç åˆ°æµ‹è¯•ç¯å¢ƒï¼Œå‘ç°ä»£ç æ²¡æœ‰æ›´æ–°ï¼Œç›´æ¥åœ¨æœåŠ¡å™¨ä¸Šç”¨å‘½ä»¤è¡Œæ“ä½œçš„æ—¶å€™å‡ºç°ä¸‹é¢çš„é”™è¯¯ï¼š</p><a id="more"></a><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">www@iZ23oqentptZ:~/develop.dameiweb.com/webroot$ git pull</span><br><span class="line">error: Cannot update the ref 'refs/remotes/origin/develop': </span><br><span class="line">unable to append to .git/logs/refs/remotes/origin/develop: </span><br><span class="line">Permission denied</span><br><span class="line">From git.dameiweb.com:dm/www.dameiweb.com</span><br><span class="line"> ! 3fa3fb3..297aa33 develop -&gt; origin/develop  </span><br><span class="line">(unable to update local ref)</span><br><span class="line">error: Cannot update the ref 'refs/remotes/origin/master': </span><br><span class="line">unable to append to .git/logs/refs/remotes/origin/master:</span><br><span class="line"> Permission denied</span><br><span class="line"> ! 0eadc3f..d8ad757  master -&gt; origin/master  </span><br><span class="line">(unable to update local ref)</span><br></pre></td></tr></table></figure><!--more--><p>é€šè¿‡æŸ¥çœ‹æ–‡ä»¶çš„æƒé™ï¼Œå‘ç°.gitæ–‡ä»¶å¤¹ä¸‹æ–‡ä»¶çš„æƒé™ä¸å¯¹ï¼Œæœ‰çš„æ–‡ä»¶ä¸å±äºgitè´¦å·ï¼ˆgitçš„ç”¨æˆ·æ˜¯wwwï¼‰ï¼Œå‡ºç°è¿™ä¸ªæƒ…å†µå¯èƒ½æ˜¯ç”¨ä¸åŒçš„è´¦å·å»æ‰§è¡Œgitå‘½ä»¤ï¼Œè­¬å¦‚æˆ‘ä»¬è¿™å°±æ˜¯ä½¿ç”¨rootè´¦å·æ“ä½œè¿‡ã€‚<br>  è§£å†³åŠæ³•å°±æ˜¯ç”¨rootè´¦æˆ·ä¿®æ”¹.gitæ–‡ä»¶çš„æƒé™,.gitæ–‡ä»¶çš„æ‰€æœ‰è€…å’Œæ‰€å±ç»„éƒ½æ˜¯www,äºæ˜¯æ‰§è¡Œå‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">æ–‡ä»¶çš„æ‰€æœ‰è€…å’Œæ‰€å±ç»„ä¿®æ”¹æˆwww</span></span><br><span class="line">chown -R www:www .git</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå®Œå‘½ä»¤ä¹‹åï¼ŒæŸ¥çœ‹æ–‡ä»¶çš„æƒé™ä¿®æ”¹æˆåŠŸåï¼Œå†åˆ‡æ¢æˆwwwç”¨æˆ·ï¼Œæ‰§è¡Œgit pullï¼Œæ›´æ–°æˆåŠŸï¼<br>  å¤§å®¶åˆ‡è®°ï¼Œlinuxä¸‹æƒé™å¾ˆé‡è¦ï¼Œä¸ç”¨ä¹±ç”¨ä¸ç”¨çš„ç”¨æˆ·ï¼Œè¿™æ ·ä¼šå¯¼è‡´æ–‡ä»¶çš„æ‰€æœ‰è€…å’Œæ‰€å±ç»„å‘ç”Ÿæ”¹å˜ï¼</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>gitçš„.gitignoreè§„åˆ™ä¸ç”Ÿæ•ˆçš„è§£å†³åŠæ³•</title>
      <link href="/post/8b084705.html"/>
      <url>/post/8b084705.html</url>
      
        <content type="html"><![CDATA[<p>åœ¨gitä¸­å¦‚æœæƒ³å¿½ç•¥æ‰æŸä¸ªæ–‡ä»¶ï¼Œä¸è®©è¿™ä¸ªæ–‡ä»¶æäº¤åˆ°ç‰ˆæœ¬åº“ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ä¿®æ”¹æ ¹ç›®å½•ä¸­ .gitignore æ–‡ä»¶çš„æ–¹æ³•ï¼ˆå¦‚æ— ï¼Œåˆ™éœ€è‡ªå·±æ‰‹å·¥å»ºç«‹æ­¤æ–‡ä»¶ï¼‰ã€‚è¿™ä¸ªæ–‡ä»¶æ¯ä¸€è¡Œä¿å­˜äº†ä¸€ä¸ªåŒ¹é…çš„è§„åˆ™ä¾‹å¦‚ï¼š</p><a id="more"></a><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æ­¤ä¸ºæ³¨é‡Š â€“ å°†è¢« Git å¿½ç•¥</span></span><br><span class="line">*.aÂ Â Â Â Â Â  # å¿½ç•¥æ‰€æœ‰ .a ç»“å°¾çš„æ–‡ä»¶</span><br><span class="line">!lib.aÂ Â Â  # ä½† lib.a é™¤å¤–</span><br><span class="line">/TODOÂ Â Â Â  # ä»…ä»…å¿½ç•¥é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ TODO æ–‡ä»¶ï¼Œä¸åŒ…æ‹¬ subdir/TODO</span><br><span class="line">build/Â Â Â  # å¿½ç•¥ build/ ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶</span><br><span class="line">doc/*.txt # ä¼šå¿½ç•¥ doc/notes.txt ä½†ä¸åŒ…æ‹¬ doc/server/arch.txt</span><br></pre></td></tr></table></figure><p>è§„åˆ™å¾ˆç®€å•ï¼Œä¸åšè¿‡å¤šè§£é‡Šï¼Œä½†æ˜¯æœ‰æ—¶å€™åœ¨é¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­ï¼Œçªç„¶å¿ƒè¡€æ¥æ½®æƒ³æŠŠæŸäº›ç›®å½•æˆ–æ–‡ä»¶åŠ å…¥å¿½ç•¥è§„åˆ™ï¼ŒæŒ‰ç…§ä¸Šè¿°æ–¹æ³•å®šä¹‰åå‘ç°å¹¶æœªç”Ÿæ•ˆï¼ŒåŸå› æ˜¯.gitignoreåªèƒ½å¿½ç•¥é‚£äº›åŸæ¥æ²¡æœ‰è¢«trackçš„æ–‡ä»¶ï¼Œå¦‚æœæŸäº›æ–‡ä»¶å·²ç»è¢«çº³å…¥äº†ç‰ˆæœ¬ç®¡ç†ä¸­ï¼Œåˆ™ä¿®æ”¹.gitignoreæ˜¯æ— æ•ˆçš„ã€‚é‚£ä¹ˆè§£å†³æ–¹æ³•å°±æ˜¯å…ˆæŠŠæœ¬åœ°ç¼“å­˜åˆ é™¤ï¼ˆæ”¹å˜æˆæœªtrackçŠ¶æ€ï¼‰ï¼Œç„¶åå†æäº¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gitÂ rmÂ -rÂ --cachedÂ .</span><br><span class="line">gitÂ addÂ .</span><br><span class="line">gitÂ commitÂ -mÂ 'updateÂ .gitignore'</span><br></pre></td></tr></table></figure><p>è¿™æ ·gitçš„å¿½ç•¥è§„åˆ™ä¸ç”Ÿæ•ˆçš„é—®é¢˜å°±è§£å†³äº†ï¼</p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
