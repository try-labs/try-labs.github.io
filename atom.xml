<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="https://www.w3.org/2005/Atom">
  <title>Samçš„ä¸ªäººåšå®¢</title>
  
  <subtitle>ä¸€ä¸ªç¨‹åºå‘˜çš„æˆé•¿è®°å½•</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://ydstudios.gitee.io/"/>
  <updated>2021-01-30T08:57:31.000Z</updated>
  <id>https://ydstudios.gitee.io/</id>
  
  <author>
    <name>Sam</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>èˆ¹æ–°ç‰ˆæœ¬çš„ç­–ç•¥æ¨¡å¼ï¼Œä½ ä¸€å®šæ²¡æœ‰è§è¿‡</title>
    <link href="https://ydstudios.gitee.io/post/cd1b2f51.html"/>
    <id>https://ydstudios.gitee.io/post/cd1b2f51.html</id>
    <published>2021-01-30T15:06:49.000Z</published>
    <updated>2021-01-30T08:57:31.000Z</updated>
    
    <content type="html"><![CDATA[<p>æˆ‘åœ¨ä¹‹å‰çš„æ–‡ç« <a href="https://ydstudios.gitee.io/post/170b3d6a.html">è®¾è®¡æ¨¡å¼å­¦ä¹ ä¹‹ç­–ç•¥æ¨¡å¼</a> ä¸€æ–‡ä¸­ä»‹ç»äº†ç­–ç•¥æ¨¡å¼çš„ä¼˜ç‚¹ã€ç¼ºç‚¹ã€å®ç°æ–¹æ³•å’Œå…·ä½“çš„ä½¿ç”¨åœºæ™¯ã€‚ç­–ç•¥ç±»æœ‰<code>ç­–ç•¥ç±»ä¼šå¢å¤š,é€ æˆç±»è†¨èƒ€</code>çš„ç¼ºç‚¹ï¼Œè¿™ä¸ªç¼ºç‚¹æˆ‘è¿˜æ˜¯æ¯”è¾ƒåœ¨æ„çš„ã€‚å› ä¸ºåœ¨å®é™…å¼€å‘ä¸­å‘ç°ï¼Œæœ‰æ—¶ç­–ç•¥çš„å®ç°æ²¡æœ‰å¤šå°‘ä»£ç ï¼Œè¿™æ ·çš„å®šä¹‰æˆä¸€ä¸ªç­–ç•¥ç±»åè€ŒçœŸçš„æœ‰ç‚¹æµªè´¹ï¼Œç¡®å®é€ æˆäº†ç±»è†¨èƒ€ã€‚è‡ªä»å‘ç°äº†è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä¸€ç›´åœ¨æ€è€ƒå¦‚ä½•è§£å†³è¿™ç§é—®é¢˜ï¼Œç»è¿‡æ€è€ƒè§£å†³é—®é¢˜çš„æ–¹æ³•å·²ç»æƒ³å‡ºæ¥äº†ï¼Œä½†æ˜¯ä¸€ç›´æ²¡æœ‰å»å°è¯•åšå‡ºæ¥çœ‹çœ‹æ˜¯å¦çœŸçš„èƒ½è§£å†³ç­–ç•¥æ¨¡å¼ <code>ç±»è†¨èƒ€çš„é—®é¢˜</code>,ç»ˆäºåœ¨è¿™å‘¨æˆ‘å¿™é‡Œå·é—²ç”¨ä»£ç å®ç°äº†æˆ‘çš„æƒ³æ³•ï¼Œæˆ‘è‡ªè®¤ä¸ºåˆ©ç”¨ <code>Lambdaè¡¨è¾¾å¼ + åå°„ + æ³¨è§£</code> ç»„åˆè§£å†³äº†<code>ç±»è†¨èƒ€çš„é—®é¢˜</code>ï¼Œè¿™ç§èˆ¹æ–°ç‰ˆæœ¬å®ç°æ–¹æ¡ˆï¼Œå®¹æˆ‘ç»†ç»†é“æ¥ï¼</p><a id="more"></a><blockquote><p>å¤§æ‰å¥½ï¼Œæˆ‘ç³»æ¸£æ¸£è¾‰ï¼Œæ¢æŒ½æ‡’æœˆï¼Œä»‹å››é‡Œæ²¡æœ‰æŒ½è¿‡çš„èˆ¹æ–°ç‰ˆæœ¬ï¼ŒæŒ¤éœ€ä½“éªŒä¸‰ç•ªé’Ÿï¼Œé‡Œé€ ä¼šå¹²æˆ‘ä¸€æ ·ï¼Œçˆ±è±¡èŠ‚æ¬¾æ¸¸æˆã€‚ â€”å¼€å¿ƒä¸€å“ˆ ğŸ˜„ğŸ˜„</p></blockquote><h5 id="ä»£ç ç»“æ„å›¾"><a href="#ä»£ç ç»“æ„å›¾" class="headerlink" title="ä»£ç ç»“æ„å›¾"></a>ä»£ç ç»“æ„å›¾</h5><p>è¿™ç§å®ç°æ–¹æ³•ï¼ŒUMLå›¾æ²¡æ³•å±•ç°å…¶ä¸­å…³ç³»ï¼Œæ‰€ä»¥å°±ä¸è´´UMLå›¾äº†ï¼Œç›´æ¥ä¸Šä»£ç çš„ç»“æ„å›¾ã€‚</p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210130154828.png" alt="èˆ¹æ–°ç‰ˆæœ¬ç­–ç•¥æ¨¡å¼" style="zoom:50%;" /><h5 id="ä¸»è¦æ€æƒ³"><a href="#ä¸»è¦æ€æƒ³" class="headerlink" title="ä¸»è¦æ€æƒ³"></a>ä¸»è¦æ€æƒ³</h5><ul><li>ä¸ºä½•ä¼šå‡ºç°ç±»è†¨èƒ€</li></ul><p>ç­–ç•¥æ¨¡å¼ç±»è†¨èƒ€çš„ç¼ºç‚¹ï¼Œå°±æ˜¯ç­–ç•¥ç±»å¤ªå¤šçš„ç¼˜æ•…ã€‚å¦‚æœç­–ç•¥ç±»çš„å®ç°ä»£ç ä¸æ˜¯å¾ˆå¤šï¼Œæ˜¯å¦å¯ä»¥å°†ç­–ç•¥ä¸åœ¨ç±»çš„çº§åˆ«ä¸Šå®ç°ï¼Ÿäºæ˜¯æƒ³åˆ°äº†åˆ©ç”¨Lambdaè¡¨è¾¾å¼çš„åŒ¿åç±»æ¥å®ç°ç­–ç•¥æ¥å£ï¼Œè¿™æ ·ä¸å°±æŠŠå®ç°ä»ç±»é™çº§åˆ°äº†æ–¹æ³•çº§åˆ«äº†ä¹ˆï¼Œå“ˆå“ˆğŸ˜„ğŸ˜„ï¼ï¼</p><ul><li>å¦‚ä½•å°†è¿™äº›ç­–ç•¥æ–¹æ³•ç»Ÿä¸€èµ·æ¥ï¼Œæ–¹ä¾¿å¤–éƒ¨è°ƒç”¨<br>ç­–ç•¥æ–¹æ³•éƒ½åœ¨ä¸€ä¸ªç±»ä¸­ï¼Œè¿™æ ·é¦–å…ˆè¦æ ‡æ³¨ä¸€ä¸‹æ–¹æ³•ï¼Œå“ªä¸ªæ˜¯ç­–ç•¥æ–¹æ³•ï¼Œå“ªä¸ªæ˜¯æ™®é€šæ–¹æ³•ã€‚è¿™ä¸ªé—®é¢˜æˆ‘ä»¬ç”¨æ³¨è§£æ¥å®ç°ï¼Œå› ä¸ºåœ¨Java è¯­è¨€ä¸­çš„ç±»ã€æ–¹æ³•ã€å˜é‡ã€å‚æ•°å’ŒåŒ…ç­‰éƒ½å¯ä»¥ç”¨æ³¨è§£æ¥æ ‡æ³¨ã€‚</li></ul><p>æˆ‘æƒ³æŠŠç­–ç•¥æ–¹æ³•å­˜æ”¾åœ¨Mapä¸­ï¼Œç”¨ç­–ç•¥çš„åå­—ä½œä¸ºMapçš„keyï¼Œç­–ç•¥æ–¹æ³•ä½œä¸ºMapçš„valueã€‚æˆ‘ä»¬åœ¨è¿™é‡Œç”¨åå°„æ¥å°†Lambdaå®ç°çš„åŒ¿åç±»å­˜æ”¾åˆ°Mapä¸­ã€‚</p><h5 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h5><ol><li><p>å®šä¹‰ä¸€ä¸ªç­–ç•¥æ³¨è§£ Strategyï¼Œç”¨æ¥æ ‡æ³¨ç­–ç•¥æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Strategy æ³¨è§£</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/1/26</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.7.7</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Inherited</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Target</span>(&#123;ElementType.METHOD,ElementType.TYPE&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Strategy &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ‡è¯†ä¸åŒçš„æ¨¡å— productã€orderæ¨¡å—</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">String <span class="title">module</span><span class="params">()</span> <span class="keyword">default</span> ""</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å…·ä½“çš„ç­–ç•¥ç±»å‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">String <span class="title">value</span><span class="params">()</span> <span class="keyword">default</span> ""</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ç­–ç•¥æ¥å£,è¿™é‡Œçš„ç­–ç•¥æ¥å£å¦‚æœä¸æ˜¯å¾ˆå¤æ‚çš„è¯å¯ä»¥ç”¨jdkè‡ªå¸¦çš„<code>java.util.function.Function&lt;T, R&gt;</code>æ›¿ä»£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &lt;T&gt; ç­–ç•¥çš„å…¥å‚ç±»å‹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &lt;R&gt; ç­–ç•¥çš„è¿”å›å€¼ç±»å‹</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/1/26</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.7.7</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IStrategyHandler</span>&lt;<span class="title">T</span>, <span class="title">R</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç­–ç•¥</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> param å‚æ•°</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">R <span class="title">apply</span><span class="params">(T param)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>AbstractStrategyå®ç°ä½¿ç”¨Springæä¾›çš„æ‰©å±•ç‚¹ApplicationContextAwareï¼Œåœ¨ç³»ç»Ÿå¯åŠ¨çš„æ—¶å€™å°†å¯¹åº”ç­–ç•¥æ–¹æ³•çš„å­˜æ”¾åœ¨Mapä¸­ï¼ŒåŒæ—¶å¯¹å¤–æä¾›æ‰§è¡Œå…¥å£ execute</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractStrategy</span>&lt;<span class="title">T</span>, <span class="title">R</span>&gt; <span class="keyword">implements</span> <span class="title">ApplicationContextAware</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, IStrategyHandler&lt;T, R&gt;&gt; implMap = <span class="keyword">new</span> ConcurrentHashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String DELIMITER = <span class="string">"####"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å¾—bean çš„class</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &lt;K&gt; ç±»å‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">abstract</span> &lt;K&gt; <span class="function">Class&lt;K&gt; <span class="title">getClazz</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿”å›springä¸­çš„beanName</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> String <span class="title">getBeanName</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‰§è¡Œå‡½æ•°</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> strategy ç­–ç•¥ç±»å‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> module   æ¨¡å—</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> param    å‚æ•°</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> R <span class="title">execute</span><span class="params">(String strategy, String <span class="keyword">module</span>, T param)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        String key = StringUtils.join(<span class="keyword">module</span>, DELIMITER, strategy);</span><br><span class="line">        IStrategyHandler&lt;T, R&gt; handler = implMap.get(key);</span><br><span class="line">        log.debug(<span class="string">"ç­–ç•¥å®ç°é›†åˆ&#123;&#125;"</span>, implMap);</span><br><span class="line">        <span class="keyword">if</span> (handler == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"æ²¡æœ‰ç›¸åº”çš„ç­–ç•¥å®ç°"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        R apply = handler.apply(param);</span><br><span class="line">        <span class="keyword">return</span> apply;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setApplicationContext</span><span class="params">(ApplicationContext applicationContext)</span> <span class="keyword">throws</span> BeansException </span>&#123;</span><br><span class="line">        log.error(<span class="string">"AbstractStrategy æ‰§è¡Œ"</span>);</span><br><span class="line"></span><br><span class="line">        Class&lt;Object&gt; clazz = getClazz();</span><br><span class="line">        Object bean = applicationContext.getBean(getBeanName(), clazz);</span><br><span class="line">        <span class="keyword">if</span> (bean == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        Strategy strategyAnnotation = bean.getClass().getAnnotation(Strategy<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        <span class="keyword">if</span> (strategyAnnotation == <span class="keyword">null</span>) &#123;</span><br><span class="line">            log.error(<span class="string">"ç±»[&#123;&#125;]æ²¡æœ‰æ·»åŠ Strategyæ³¨è§£"</span>, clazz);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ¨¡å—çš„åç§°</span></span><br><span class="line">        String <span class="keyword">module</span> = strategyAnnotation.<span class="keyword">module</span>();</span><br><span class="line">        Method[] declaredMethods = clazz.getDeclaredMethods();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (ArrayUtils.isEmpty(declaredMethods)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(clazz + <span class="string">"æ²¡æœ‰ç›¸å…³ç­–ç•¥æ–¹æ³•"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (Method declaredMethod : declaredMethods) &#123;</span><br><span class="line">            Strategy annotation = declaredMethod.getAnnotation(Strategy<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">            <span class="keyword">if</span> (annotation == <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">// ç”¨moduleå’Œ å››ä¸ª #### åŠ ä¸Š value ç»„æˆmapçš„key</span></span><br><span class="line">                String key = StringUtils.join(<span class="keyword">module</span>, DELIMITER, annotation.value());</span><br><span class="line">                IStrategyHandler&lt;T, R&gt; handler = (IStrategyHandler&lt;T, R&gt;) declaredMethod.invoke(bean);</span><br><span class="line">                implMap.put(key, handler);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IllegalAccessException | InvocationTargetException e) &#123;</span><br><span class="line">                log.error(<span class="string">"æ¨¡å—[&#123;&#125;]ç­–ç•¥å¤„ç†å‘ç”Ÿäº†é”™è¯¯"</span>, <span class="keyword">module</span>, e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>è®¢å•ã€äº§å“æ¨¡å—æœ‰è¿™ç§ç­–ç•¥æ¨¡å¼åœºæ™¯</p></li></ol><p>è®¢å•æ¨¡å—çš„ç­–ç•¥æ¨¡å¼åœºæ™¯,IStrategyHandlerçš„ç­–ç•¥æ–¹æ³•éƒ½åœ¨OrderStrategyImplä¸­å®ç°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Strategy</span>(<span class="keyword">module</span> = <span class="string">"Order"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderStrategyImpl</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> BizLocalMessageService bizLocalMessageService;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Strategy</span>(value = <span class="string">"strategy1"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> IStrategyHandler&lt;BInDto, BOutDto&gt; <span class="title">strategy1</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> bInDto -&gt; &#123;</span><br><span class="line">            log.error(<span class="string">"è®¢å•æ¨¡å—ç›¸å…³ç­–ç•¥ strategy1 executeStart"</span>);</span><br><span class="line">            String join = StringUtils.join(<span class="string">"strategy1:"</span>, bInDto.getParam1(), bInDto.getParam2());</span><br><span class="line">            BOutDto bOutDto = <span class="keyword">new</span> BOutDto();</span><br><span class="line">            bOutDto.setOrderNo(join);</span><br><span class="line">            bOutDto.setPrice(<span class="number">111</span>);</span><br><span class="line"></span><br><span class="line">            SaveBizLocalMessageDto dto = <span class="keyword">new</span> SaveBizLocalMessageDto();</span><br><span class="line">            dto.setBizModule((<span class="keyword">byte</span>)<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">            ThreadLocalRandom localRandom = ThreadLocalRandom.current();</span><br><span class="line">            dto.setBizNo(localRandom.nextInt(<span class="number">16000</span>,<span class="number">115000</span>)+<span class="string">""</span>);</span><br><span class="line">            dto.setBizType((<span class="keyword">byte</span>)<span class="number">0</span>);</span><br><span class="line">            dto.setMsg(<span class="string">""</span>);</span><br><span class="line">            dto.setMsgDesc(<span class="string">""</span>);</span><br><span class="line">            dto.setHandledCount((<span class="keyword">byte</span>)<span class="number">0</span>);</span><br><span class="line">            dto.setMaxHandleCount((<span class="keyword">byte</span>)<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">            bizLocalMessageService.saveBizLocalMessage(dto);</span><br><span class="line">            log.error(<span class="string">"è®¢å•æ¨¡å—ç›¸å…³ç­–ç•¥ strategy1 executeEnd"</span>);</span><br><span class="line">            <span class="keyword">return</span> bOutDto;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Strategy</span>(value = <span class="string">"strategy2"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> IStrategyHandler&lt;BInDto, BOutDto&gt; <span class="title">strategy2</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> param -&gt; &#123;</span><br><span class="line"></span><br><span class="line">            log.error(<span class="string">"è®¢å•æ¨¡å—ç›¸å…³ç­–ç•¥ strategy2 executeStart"</span>);</span><br><span class="line"></span><br><span class="line">            String join = StringUtils.join(<span class="string">"strategy2:"</span>, param.getParam1(), param.getParam2());</span><br><span class="line">            BOutDto bOutDto = <span class="keyword">new</span> BOutDto();</span><br><span class="line">            bOutDto.setOrderNo(join);</span><br><span class="line">            bOutDto.setPrice(<span class="number">11121</span>);</span><br><span class="line"></span><br><span class="line">            SaveBizLocalMessageDto dto = <span class="keyword">new</span> SaveBizLocalMessageDto();</span><br><span class="line">            dto.setBizModule((<span class="keyword">byte</span>)<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">            ThreadLocalRandom localRandom = ThreadLocalRandom.current();</span><br><span class="line">            dto.setBizNo(localRandom.nextInt(<span class="number">6000</span>,<span class="number">15000</span>)+<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line">            dto.setBizType((<span class="keyword">byte</span>)<span class="number">0</span>);</span><br><span class="line">            dto.setMsg(<span class="string">""</span>);</span><br><span class="line">            dto.setMsgDesc(<span class="string">""</span>);</span><br><span class="line">            dto.setHandledCount((<span class="keyword">byte</span>)<span class="number">0</span>);</span><br><span class="line">            dto.setMaxHandleCount((<span class="keyword">byte</span>)<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">            bizLocalMessageService.saveBizLocalMessage(dto);</span><br><span class="line">            log.error(<span class="string">"è®¢å•æ¨¡å—ç›¸å…³ç­–ç•¥ strategy2 executeEnd"</span>);</span><br><span class="line">            <span class="keyword">return</span> bOutDto;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>äº§å“æ¨¡å—çš„ç­–ç•¥æ¨¡å¼åœºæ™¯ï¼ŒIStrategyHandlerçš„ç­–ç•¥æ–¹æ³•éƒ½åœ¨ProductStrategyImplä¸­å®ç°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Strategy</span>(<span class="keyword">module</span> = <span class="string">"Product"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductStrategyImpl</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> BizLocalMessageService bizLocalMessageService;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Strategy</span>(value = <span class="string">"strategyA"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> IStrategyHandler&lt;BInDto, BOutDto&gt; <span class="title">strategy1</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> bInDto -&gt; &#123;</span><br><span class="line"></span><br><span class="line">            log.error(<span class="string">"äº§å“æ¨¡å—ç›¸å…³ç­–ç•¥ strategy1 executeStart"</span>);</span><br><span class="line"></span><br><span class="line">            String join = StringUtils.join(<span class="string">"strategyA:"</span>, bInDto.getParam1(), bInDto.getParam2());</span><br><span class="line">            BOutDto bOutDto = <span class="keyword">new</span> BOutDto();</span><br><span class="line">            bOutDto.setOrderNo(join);</span><br><span class="line">            bOutDto.setPrice(<span class="number">111</span>);</span><br><span class="line"></span><br><span class="line">            SaveBizLocalMessageDto dto = <span class="keyword">new</span> SaveBizLocalMessageDto();</span><br><span class="line">            dto.setBizModule((<span class="keyword">byte</span>)<span class="number">0</span>);</span><br><span class="line">            ThreadLocalRandom localRandom = ThreadLocalRandom.current();</span><br><span class="line">            dto.setBizNo(localRandom.nextInt(<span class="number">1000</span>,<span class="number">5000</span>)+<span class="string">""</span>);</span><br><span class="line">            dto.setBizType((<span class="keyword">byte</span>)<span class="number">0</span>);</span><br><span class="line">            dto.setMsg(<span class="string">""</span>);</span><br><span class="line">            dto.setMsgDesc(<span class="string">""</span>);</span><br><span class="line">            dto.setHandledCount((<span class="keyword">byte</span>)<span class="number">0</span>);</span><br><span class="line">            dto.setMaxHandleCount((<span class="keyword">byte</span>)<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">            bizLocalMessageService.saveBizLocalMessage(dto);</span><br><span class="line"></span><br><span class="line">            log.error(<span class="string">"äº§å“æ¨¡å—ç›¸å…³ç­–ç•¥ strategy1 executeEnd"</span>);</span><br><span class="line">            <span class="keyword">return</span> bOutDto;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Strategy</span>(value = <span class="string">"strategyB"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> IStrategyHandler&lt;BInDto, BOutDto&gt; <span class="title">strategy2</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> param -&gt; &#123;</span><br><span class="line"></span><br><span class="line">            log.error(<span class="string">"äº§å“æ¨¡å—ç›¸å…³ç­–ç•¥ strategy2 executeStart"</span>);</span><br><span class="line"></span><br><span class="line">            String join = StringUtils.join(<span class="string">"strategyB:"</span>, param.getParam1(), param.getParam2());</span><br><span class="line">            BOutDto bOutDto = <span class="keyword">new</span> BOutDto();</span><br><span class="line">            bOutDto.setOrderNo(join);</span><br><span class="line">            bOutDto.setPrice(<span class="number">11121</span>);</span><br><span class="line"></span><br><span class="line">            SaveBizLocalMessageDto dto = <span class="keyword">new</span> SaveBizLocalMessageDto();</span><br><span class="line">            dto.setBizModule((<span class="keyword">byte</span>)<span class="number">0</span>);</span><br><span class="line">            ThreadLocalRandom localRandom = ThreadLocalRandom.current();</span><br><span class="line">            dto.setBizNo(localRandom.nextInt(<span class="number">5000</span>,<span class="number">8000</span>)+<span class="string">""</span>);</span><br><span class="line">            dto.setBizType((<span class="keyword">byte</span>)<span class="number">0</span>);</span><br><span class="line">            dto.setMsg(<span class="string">""</span>);</span><br><span class="line">            dto.setMsgDesc(<span class="string">""</span>);</span><br><span class="line">            dto.setHandledCount((<span class="keyword">byte</span>)<span class="number">0</span>);</span><br><span class="line">            dto.setMaxHandleCount((<span class="keyword">byte</span>)<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">            bizLocalMessageService.saveBizLocalMessage(dto);</span><br><span class="line"></span><br><span class="line">            log.error(<span class="string">"äº§å“æ¨¡å—ç›¸å…³ç­–ç•¥ strategy2  executeEnd"</span>);</span><br><span class="line">            <span class="keyword">return</span> bOutDto;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="5"><li>å°†å­˜æ”¾ç­–ç•¥æ–¹æ³•çš„ç±»å’Œç­–ç•¥ä¸Šä¸‹æ–‡å…³è”èµ·æ¥</li></ol><p>è®¢å•æ¨¡å—ç›¸å…³</p>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderStrategyContext</span> <span class="keyword">extends</span> <span class="title">AbstractStrategy</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function">Class&lt;OrderStrategyImpl&gt; <span class="title">getClazz</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> OrderStrategyImpl<span class="class">.<span class="keyword">class</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function">String <span class="title">getBeanName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"orderStrategyImpl"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>äº§å“æ¨¡å—ç›¸å…³</p>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductStrategyContext</span> <span class="keyword">extends</span> <span class="title">AbstractStrategy</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function">Class&lt;ProductStrategyImpl&gt; <span class="title">getClazz</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ProductStrategyImpl<span class="class">.<span class="keyword">class</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function">String <span class="title">getBeanName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"productStrategyImpl"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="6"><li>ä»£ç å®ç°å®Œæ¯•ï¼Œæˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ContextConfiguration</span>(locations = &#123;<span class="string">"classpath:spring/spring-dao.xml"</span>,<span class="string">"classpath:spring/spring-service.xml"</span>&#125;)</span><br><span class="line"><span class="meta">@RunWith</span>(value = SpringJUnit4ClassRunner<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">StrategyTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> AbstractStrategy&lt;BInDto, BOutDto&gt; orderStrategyContext;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> AbstractStrategy&lt;BInDto, BOutDto&gt; productStrategyContext;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">productTest</span><span class="params">()</span></span>&#123;</span><br><span class="line">        BInDto bInDto = <span class="keyword">new</span> BInDto();</span><br><span class="line">        bInDto.setParam1(<span class="string">"äº§å“é‡‘é¢"</span>);</span><br><span class="line">        bInDto.setParam2(<span class="number">222</span>);</span><br><span class="line"></span><br><span class="line">        productStrategyContext.execute(<span class="string">"strategyA"</span>, <span class="string">"Product"</span>, bInDto);</span><br><span class="line">        productStrategyContext.execute(<span class="string">"strategyB"</span>, <span class="string">"Product"</span>, bInDto);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">orderTest</span><span class="params">()</span></span>&#123;</span><br><span class="line">        BInDto bInDto = <span class="keyword">new</span> BInDto();</span><br><span class="line">        bInDto.setParam1(<span class="string">"ä¼˜æƒ åˆ¸é‡‘é¢"</span>);</span><br><span class="line">        bInDto.setParam2(<span class="number">180</span>);</span><br><span class="line"></span><br><span class="line">        orderStrategyContext.execute(<span class="string">"strategy1"</span>, <span class="string">"Order"</span>, bInDto);</span><br><span class="line">        orderStrategyContext.execute(<span class="string">"strategy2"</span>, <span class="string">"Order"</span>, bInDto);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>äº§å“æ¨¡å—çš„æµ‹è¯•<br><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210130164441.png" alt="äº§å“æ¨¡å—çš„æµ‹è¯•" style="zoom:50%;" /></p><p>è®¢å•æ¨¡å—çš„æµ‹è¯•</p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210130164512.png" alt="è®¢å•æ¨¡å—çš„æµ‹è¯•" style="zoom:50%;" /><h5 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h5><p>ç­–ç•¥æ¥å£ä¸æ˜¯å¾ˆå¤æ‚çš„æƒ…å†µä¸‹ IStrategyHandler æ¥å£å¯ä»¥å¤ç”¨ï¼Œè‡ªå·±å®ç° StrategyContext æŠ½è±¡ç±»ï¼Œç„¶åå†å®ç°è‡ªå·±çš„ç­–ç•¥æ–¹æ³•å°±å¯ä»¥äº†ï¼Œä¸çŸ¥å¤§å®¶å¯¹äºè¿™ç§èˆ¹æ–°ç‰ˆæœ¬æœ‰ä»€ä¹ˆçœ‹æ³•ï¼</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æˆ‘åœ¨ä¹‹å‰çš„æ–‡ç« &lt;a href=&quot;https://ydstudios.gitee.io/post/170b3d6a.html&quot;&gt;è®¾è®¡æ¨¡å¼å­¦ä¹ ä¹‹ç­–ç•¥æ¨¡å¼&lt;/a&gt; ä¸€æ–‡ä¸­ä»‹ç»äº†ç­–ç•¥æ¨¡å¼çš„ä¼˜ç‚¹ã€ç¼ºç‚¹ã€å®ç°æ–¹æ³•å’Œå…·ä½“çš„ä½¿ç”¨åœºæ™¯ã€‚ç­–ç•¥ç±»æœ‰&lt;code&gt;ç­–ç•¥ç±»ä¼šå¢å¤š,é€ æˆç±»è†¨èƒ€&lt;/code&gt;çš„ç¼ºç‚¹ï¼Œè¿™ä¸ªç¼ºç‚¹æˆ‘è¿˜æ˜¯æ¯”è¾ƒåœ¨æ„çš„ã€‚å› ä¸ºåœ¨å®é™…å¼€å‘ä¸­å‘ç°ï¼Œæœ‰æ—¶ç­–ç•¥çš„å®ç°æ²¡æœ‰å¤šå°‘ä»£ç ï¼Œè¿™æ ·çš„å®šä¹‰æˆä¸€ä¸ªç­–ç•¥ç±»åè€ŒçœŸçš„æœ‰ç‚¹æµªè´¹ï¼Œç¡®å®é€ æˆäº†ç±»è†¨èƒ€ã€‚è‡ªä»å‘ç°äº†è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä¸€ç›´åœ¨æ€è€ƒå¦‚ä½•è§£å†³è¿™ç§é—®é¢˜ï¼Œç»è¿‡æ€è€ƒè§£å†³é—®é¢˜çš„æ–¹æ³•å·²ç»æƒ³å‡ºæ¥äº†ï¼Œä½†æ˜¯ä¸€ç›´æ²¡æœ‰å»å°è¯•åšå‡ºæ¥çœ‹çœ‹æ˜¯å¦çœŸçš„èƒ½è§£å†³ç­–ç•¥æ¨¡å¼ &lt;code&gt;ç±»è†¨èƒ€çš„é—®é¢˜&lt;/code&gt;,ç»ˆäºåœ¨è¿™å‘¨æˆ‘å¿™é‡Œå·é—²ç”¨ä»£ç å®ç°äº†æˆ‘çš„æƒ³æ³•ï¼Œæˆ‘è‡ªè®¤ä¸ºåˆ©ç”¨ &lt;code&gt;Lambdaè¡¨è¾¾å¼ + åå°„ + æ³¨è§£&lt;/code&gt; ç»„åˆè§£å†³äº†&lt;code&gt;ç±»è†¨èƒ€çš„é—®é¢˜&lt;/code&gt;ï¼Œè¿™ç§èˆ¹æ–°ç‰ˆæœ¬å®ç°æ–¹æ¡ˆï¼Œå®¹æˆ‘ç»†ç»†é“æ¥ï¼&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="https://ydstudios.gitee.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
      <category term="ç­–ç•¥æ¨¡å¼" scheme="https://ydstudios.gitee.io/tags/%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/"/>
    
      <category term="åå°„" scheme="https://ydstudios.gitee.io/tags/%E5%8F%8D%E5%B0%84/"/>
    
      <category term="lambdaè¡¨è¾¾å¼" scheme="https://ydstudios.gitee.io/tags/lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
    
      <category term="æ³¨è§£" scheme="https://ydstudios.gitee.io/tags/%E6%B3%A8%E8%A7%A3/"/>
    
  </entry>
  
  <entry>
    <title>UMLç±»å›¾</title>
    <link href="https://ydstudios.gitee.io/post/122fc4b2.html"/>
    <id>https://ydstudios.gitee.io/post/122fc4b2.html</id>
    <published>2021-01-23T14:17:36.000Z</published>
    <updated>2021-01-23T07:26:07.000Z</updated>
    
    <content type="html"><![CDATA[<h5 id="UML"><a href="#UML" class="headerlink" title="UML"></a>UML</h5><p>UML(Unified Modeling Languageï¼Œç»Ÿä¸€å»ºæ¨¡è¯­è¨€)æ˜¯ä¸€ç§ä¸ºé¢å‘å¯¹è±¡ç³»ç»Ÿçš„äº§å“è¿›è¡Œè¯´æ˜ã€å¯è§†åŒ–å’Œç¼–åˆ¶æ–‡æ¡£çš„ä¸€ç§æ ‡å‡†è¯­è¨€ï¼Œæ˜¯éä¸“åˆ©çš„ç¬¬ä¸‰ä»£å»ºæ¨¡å’Œè§„çº¦è¯­è¨€ã€‚UMLæ˜¯é¢å‘å¯¹è±¡è®¾è®¡çš„å»ºæ¨¡å·¥å…·ï¼Œç‹¬ç«‹äºä»»ä½•å…·ä½“ç¨‹åºè®¾è®¡è¯­è¨€ã€‚</p><a id="more"></a><h5 id="UMLå’Œè®¾è®¡æ¨¡å¼"><a href="#UMLå’Œè®¾è®¡æ¨¡å¼" class="headerlink" title="UMLå’Œè®¾è®¡æ¨¡å¼"></a>UMLå’Œè®¾è®¡æ¨¡å¼</h5><p>è®¾è®¡æ¨¡å¼ï¼ˆDesign patternï¼‰æ˜¯ä¸€å¥—è¢«åå¤ä½¿ç”¨ã€å¤šæ•°äººçŸ¥æ™“çš„ã€ç»è¿‡åˆ†ç±»ç¼–ç›®çš„ã€ä»£ç è®¾è®¡ç»éªŒçš„æ€»ç»“ã€‚<strong>ä¸ªäººè§‰å¾—è®¾è®¡æ¨¡å¼æ˜¯å‰äººå¤§ä½¬æ€»ç»“çš„ä¸€ç§æ€æƒ³ï¼Œæ˜¯ä¸€ç§è„±ç¦»è¯­è¨€å¹¶ä¸”èƒ½å¤ŸæŒ‡å¯¼ç¨‹åºå‘˜æ›´å®¹æ˜“å†™å‡ºå¥½çš„ä»£ç çš„ç¼–ç¨‹ä¹ æƒ¯ã€‚</strong>å¯¹äºä¸€ä¸ªæ²¡æœ‰å¤ªå¤šç»éªŒçš„ç¨‹åºå‘˜ï¼Œå¦‚ä½•å†™å‡º <strong>ç®€æ´ä¼˜é›…ï¼Œå¯å¤ç”¨æ€§é«˜ï¼Œå¯æ‰©å±•æ€§å¼ºï¼Œé«˜å†…èšä½è€¦åˆ</strong> çš„ä»£ç è‡³å…³é‡è¦ã€‚å­¦ä¹ åˆ«äººçš„è®¾è®¡æ¨¡å¼å°±æ˜¯ä¸ºäº†åœ¨æ²¡æœ‰ç»éªŒçš„æƒ…å†µä¸‹å†™å‡ºä¸€æ‰‹ä¸é”™çš„ä»£ç ï¼Œåªçœ‹ä¸å†™å¹¶ä¸èƒ½æ·±åˆ»ä½“éªŒåˆ°è®¾è®¡æ¨¡å¼çš„å·§å¦™ä¹‹å¤„ï¼Œè€Œå­¦ä¼šä½¿ç”¨UMLè¿›è¡Œéœ€æ±‚åˆ†æï¼Œæ˜¯ä½¿ç”¨è®¾è®¡æ¨¡å¼å†™å¥½ä»£ç çš„å‰æã€‚</p><h5 id="UMLå›¾åˆ†ç±»"><a href="#UMLå›¾åˆ†ç±»" class="headerlink" title="UMLå›¾åˆ†ç±»"></a>UMLå›¾åˆ†ç±»</h5><ul><li>ç”¨ä¾‹å›¾(Use Case Diagram)ï¼Œæè¿°ç³»ç»ŸåŠŸèƒ½ï¼›</li><li>ç±»å›¾(Class Diagram)ï¼Œæè¿°ç³»ç»Ÿçš„é™æ€ç»“æ„ï¼›</li><li>å¯¹è±¡å›¾(Object Diagram)ï¼Œæè¿°ç³»ç»Ÿåœ¨æŸä¸ªæ—¶åˆ»çš„é™æ€ç»“æ„ï¼›</li><li>ç»„ä»¶å›¾(Component Diagram)ï¼Œæè¿°äº†å®ç°ç³»ç»Ÿçš„å…ƒç´ çš„ç»„ç»‡ï¼›</li><li>é…ç½®å›¾(Deployment Diagram)ï¼Œæè¿°äº†ç¯å¢ƒå…ƒç´ çš„é…ç½®ï¼Œå¹¶æŠŠå®ç°ç³»ç»Ÿçš„å…ƒç´ æ˜ å°„åˆ°é…ç½®ä¸Šï¼›</li><li>çŠ¶æ€å›¾(State Diagram)ï¼Œæè¿°äº†ç³»ç»Ÿå…ƒç´ çš„çŠ¶æ€æ¡ä»¶å’Œå“åº”ï¼›</li><li>æ—¶åºå›¾(Sequence Diagram)ï¼ŒæŒ‰æ—¶é—´é¡ºåºæè¿°ç³»ç»Ÿå…ƒç´ é—´çš„äº¤äº’ï¼›</li><li>åä½œå›¾(Collaboration Diagram)ï¼ŒæŒ‰ç…§æ—¶é—´å’Œç©ºé—´é¡ºåºæè¿°ç³»ç»Ÿå…ƒç´ é—´çš„äº¤äº’å’Œå®ƒä»¬ä¹‹é—´çš„å…³ç³»ï¼›</li><li>æ´»åŠ¨å›¾(Activity Diagram)ï¼Œæè¿°äº†ç³»ç»Ÿå…ƒç´ çš„æ´»åŠ¨ï¼›</li></ul><blockquote><p>å…¶ä¸­ç±»å›¾æ˜¯æè¿°ç±»ä¸ç±»ä¹‹é—´çš„å…³ç³»çš„ï¼Œæ˜¯UMLå›¾ä¸­æœ€æ ¸å¿ƒçš„ã€‚</p></blockquote><h5 id="UMLä½œç”¨"><a href="#UMLä½œç”¨" class="headerlink" title="UMLä½œç”¨"></a>UMLä½œç”¨</h5><ul><li><p>ä¸ºè½¯ä»¶ç³»ç»Ÿå»ºç«‹å¯è§†åŒ–æ¨¡å‹ï¼›</p></li><li><p>èƒ½å¤Ÿäº†è§£ç³»ç»Ÿçš„ç»“æ„å’Œèƒ½åŠ›ï¼›</p></li><li><p>ä¸ºè½¯ä»¶ç³»ç»Ÿå»ºç«‹æ„ä»¶ï¼›</p></li><li><p>ä¸ºè½¯ä»¶ç³»ç»Ÿå»ºç«‹æ–‡æ¡£ï¼›</p></li></ul><blockquote><p>ä»€ä¹ˆæ˜¯æ¨¡å‹ï¼Ÿæ¨¡å‹æ˜¯å¯¹ç°å®ä¸–ç•Œçš„å½¢çŠ¶æˆ–çŠ¶æ€çš„æŠ½è±¡æ¨¡æ‹Ÿå’Œç®€åŒ–ã€‚<br>ä¸ºä»€ä¹ˆè¦å»ºæ¨¡ï¼Ÿæœ€ç®€å•çš„ç†ç”±ï¼šä¸ºäº†èƒ½å¤Ÿæ›´å¥½åœ°ç†è§£æ­£åœ¨å¼€å‘çš„ç³»ç»Ÿã€‚</p></blockquote><h5 id="UML-ç±»å›¾"><a href="#UML-ç±»å›¾" class="headerlink" title="UML ç±»å›¾"></a>UML ç±»å›¾</h5><p>å­¦ä¹ è®¾è®¡æ¨¡å¼å¿…å®šéœ€è¦å…ˆè¯»æ‡‚ UML ç±»å›¾ï¼Œä¸‹é¢å°±è°ˆè°ˆå…·ä½“ UML ç±»å›¾ä¸­çš„æ¦‚å¿µã€‚ç±»å›¾æ˜¯ç”¨äºæè¿°ä¸€ç»„ç±»ã€æ¥å£ã€åä½œä»¥åŠå®ƒä»¬ä¹‹é—´çš„é™æ€å…³ç³»ã€‚åœ¨é¢å‘å¯¹è±¡ç³»ç»Ÿçš„å»ºæ¨¡ä¸­ï¼Œç±»å›¾æ˜¯æœ€ä¸ºå¸¸ç”¨çš„å›¾ï¼Œå®ƒç”¨æ¥é˜æ˜ç³»ç»Ÿçš„é™æ€ç»“æ„ã€‚äº‹å®ä¸Šç±»æ˜¯å¯¹ä¸€ç»„å…·æœ‰ç›¸åŒå±æ€§ã€æ“ä½œã€å…³ç³»å’Œè¯­ä¹‰çš„å¯¹è±¡çš„æè¿°ï¼Œå…¶ä¸­å¯¹ç±»çš„å±æ€§å’Œæ“ä½œè¿›è¡Œæè¿°æ—¶çš„ä¸€ä¸ªæœ€é‡è¦çš„ç»†èŠ‚å°±æ˜¯å®ƒçš„å¯è§æ€§ã€‚</p><h6 id="ç±»å›¾çš„åŸºæœ¬ç¬¦å·ä¸å«ä¹‰"><a href="#ç±»å›¾çš„åŸºæœ¬ç¬¦å·ä¸å«ä¹‰" class="headerlink" title="ç±»å›¾çš„åŸºæœ¬ç¬¦å·ä¸å«ä¹‰"></a>ç±»å›¾çš„åŸºæœ¬ç¬¦å·ä¸å«ä¹‰</h6><p>1ã€ <strong>ç±»(Class)</strong>ï¼šä¸€èˆ¬æ˜¯ç”¨ä¸‰å±‚çŸ©å½¢æ¡†è¡¨ç¤ºï¼Œç¬¬ä¸€å±‚è¡¨ç¤ºç±»çš„åç§°ï¼Œç¬¬äºŒå±‚è¡¨ç¤ºçš„æ˜¯å­—æ®µå’Œå±æ€§ï¼Œç¬¬ä¸‰å±‚åˆ™æ˜¯ç±»çš„æ–¹æ³•ã€‚ç¬¬ä¸€å±‚ä¸­ï¼Œå¦‚æœæ˜¯æŠ½è±¡ç±»ï¼Œéœ€ç”¨æ–œä½“æ˜¾ç¤ºã€‚</p><ul><li><p><strong>ç±»çš„å±æ€§</strong>è¡¨è¾¾æ–¹å¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æƒé™ å±æ€§åï¼šç±»å‹ [ = é»˜è®¤å€¼ ]</span><br></pre></td></tr></table></figure></li><li><p><strong>ç±»çš„æ–¹æ³•</strong>è¡¨è¾¾æ–¹å¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æƒé™  æ–¹æ³•åç§°(å‚æ•°åˆ—è¡¨) [ : è¿”å›ç±»å‹]</span><br></pre></td></tr></table></figure><blockquote><p>  æ³¨æ„ï¼špublic ç”¨    <code>+</code>  è¡¨ç¤º ï¼Œprotected ç”¨   <code>#</code>  è¡¨ç¤º ï¼Œprivate ç”¨   <code>-</code>  è¡¨ç¤º ï¼Œdefault ç”¨   <code>~</code>  è¡¨ç¤º</p></blockquote></li></ul><p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210123143148.png" alt="ç±»å›¾ç¤º"></p><p>2ã€<strong>æ¥å£(interface)</strong>ï¼šæ¥å£ä¸ç±»å›¾ç±»ä¼¼ï¼Œä¸ç±»å›¾çš„ä¸»è¦åŒºåˆ«å°±æ˜¯é¡¶ç«¯æœ‰<code>&lt;&lt;interface&gt;&gt;</code>æ˜¾ç¤ºã€‚</p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210123143316.png" style="zoom:50%;"  alt="æ¥å£ç¤ºä¾‹å›¾"/><p>3ã€ç±»ä¹‹é—´çš„å…³ç³»<br>ç±»ä¸ç±»ä¸€å…±æœ‰å¦‚ä¸‹6ç§å…³ç³»ï¼šæ³›åŒ–ï¼ˆGeneralizationï¼‰ã€å®ç°ï¼ˆRealizationï¼‰ã€ç»„åˆï¼ˆCompositionï¼‰ã€èšåˆï¼ˆAggregationï¼‰ã€å…³è”ï¼ˆAssociationï¼‰ã€ä¾èµ– ï¼ˆDependenceï¼‰ã€‚ä¸Šè¿°6ç§å…³ç³»çš„å¼ºå¼±å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ³›åŒ– = å®ç° &gt; ç»„åˆ &gt; èšåˆ &gt; å…³è” &gt; ä¾èµ–</span><br></pre></td></tr></table></figure><p><strong>ç±»å…³ç³»å›¾ç¤º</strong></p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210123142628.png" alt="ç±»å…³ç³»å›¾ç¤º" style="zoom:50%;" /><ul><li><p>æ³›åŒ–ï¼ˆGeneralizationï¼‰ï¼šè¡¨ç¤ºçš„æ˜¯ç±»ä¹‹é—´çš„ç»§æ‰¿å…³ç³»ï¼Œæ³¨æ„æ˜¯å­ç±»æŒ‡å‘çˆ¶ç±»ã€‚UMLä¸­ç”¨å¸¦ç©ºå¿ƒä¸‰è§’ç®­å¤´çš„å®çº¿è¡¨ç¤ºæ³›åŒ–å…³ç³»ï¼Œç®­å¤´æŒ‡å‘çš„æ˜¯çˆ¶ç±»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">People</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword">extends</span> <span class="title">People</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Double grade;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">study</span><span class="params">(String course)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"å­¦ä¹ "</span> + course);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Long <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Long id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Double <span class="title">getGrade</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> grade;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setGrade</span><span class="params">(Double grade)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.grade = grade;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>å®ç°(Realization)ï¼šå®ç°å…³ç³»ç”¨ä¸€æ¡å¸¦ç©ºå¿ƒç®­å¤´çš„è™šçº¿è¡¨ç¤ºã€‚UMLä¸­ç”¨å¸¦ç©ºå¿ƒä¸‰è§’ç®­å¤´çš„è™šçº¿è¡¨ç¤ºå®ç°å…³ç³»ï¼Œç®­å¤´æŒ‡å‘çš„æ˜¯æ¥å£ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IWork</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">doWork</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">People</span> <span class="keyword">implements</span> <span class="title">IWork</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doWork</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"å·¥ä½œ"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ç»„åˆ(Composition)ï¼šæ˜¯èšåˆçš„ä¸€ç§ç‰¹æ®Šå½¢å¼ï¼Œè¡¨ç¤ºçš„æ˜¯ç±»ä¹‹é—´æ›´å¼ºçš„ç»„åˆå…³ç³»ã€‚ä»–ä½“ç°çš„æ˜¯ä¸€ç§contains-açš„å…³ç³»ï¼Œè¿™ç§å…³ç³»æ¯”èšåˆæ›´å¼ºï¼Œä¹Ÿç§°ä¸ºå¼ºèšåˆï¼›ä»–åŒæ ·ä½“ç°æ•´ä½“ä¸éƒ¨åˆ†é—´çš„å…³ç³»ï¼Œä½†æ­¤æ—¶æ•´ä½“ä¸éƒ¨åˆ†æ˜¯ä¸å¯åˆ†çš„ï¼Œæ•´ä½“çš„ç”Ÿå‘½å‘¨æœŸç»“æŸä¹Ÿå°±æ„å‘³ç€éƒ¨åˆ†çš„ç”Ÿå‘½å‘¨æœŸç»“æŸã€‚UMLä¸­ç”¨å®å¿ƒè±å½¢å¤´çš„å®çº¿æ¥è¡¨ç¤ºç»„åˆï¼Œè±å½¢å¤´æŒ‡å‘æ•´ä½“ã€‚</p></li></ul><blockquote><p>ä¾‹å¦‚å…¬å¸ç”±å¤šä¸ªéƒ¨é—¨ç»„æˆï¼›å…¬å¸ä¸å­˜åœ¨äº†ï¼Œéƒ¨é—¨ä¹Ÿå°†ä¸å­˜åœ¨äº†ã€‚</p></blockquote><ul><li>èšåˆï¼ˆAggregationï¼‰ï¼šç”¨äºè¡¨ç¤ºå®ä½“å¯¹è±¡ä¹‹é—´çš„å…³ç³»ï¼Œè¡¨ç¤ºæ•´ä½“ç”±éƒ¨åˆ†æ„æˆçš„è¯­ä¹‰ã€‚ä¸ç»„åˆå…³ç³»ä¸åŒçš„æ˜¯ï¼Œæ•´ä½“å’Œéƒ¨åˆ†ä¸æ˜¯å¼ºä¾èµ–çš„ï¼Œå³ä½¿æ•´ä½“ä¸å­˜åœ¨äº†ï¼Œéƒ¨åˆ†ä»ç„¶å­˜åœ¨ï¼›èšåˆå…³ç³»æ˜¯å…³è”å…³ç³»çš„ä¸€ç§ï¼Œè€¦åˆåº¦å¼ºäºå…³è”ï¼Œä»–ä»¬çš„ä»£ç è¡¨ç°æ˜¯ç›¸åŒçš„ï¼Œä»…ä»…æ˜¯åœ¨è¯­ä¹‰ä¸Šæœ‰æ‰€åŒºåˆ«ï¼šå…³è”å…³ç³»çš„å¯¹è±¡é—´æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œè€Œèšåˆå…³ç³»çš„å¯¹è±¡ä¹‹é—´å­˜åœ¨ç€åŒ…å®¹å…³ç³»ï¼Œä»–ä»¬ä¹‹é—´æ˜¯â€œæ•´ä½“-ä¸ªä½“â€çš„ç›¸äº’å…³ç³»ã€‚UMLä¸­ç”¨ç©ºå¿ƒè±å½¢å¤´çš„å®çº¿è¡¨ç¤ºèšåˆå…³ç³»ï¼Œè±å½¢å¤´æŒ‡å‘æ•´ä½“ã€‚</li></ul><blockquote><p>ä¾‹å¦‚ä¸€ä¸ªéƒ¨é—¨ç”±å¤šä¸ªå‘˜å·¥ç»„æˆï¼Œéƒ¨é—¨æ’¤é”€äº†ï¼Œäººå‘˜ä¸ä¼šæ¶ˆå¤±ï¼Œä»–ä»¬ä¾ç„¶å­˜åœ¨ã€‚</p></blockquote><ul><li>å…³è”(Association)ï¼šè¡¨ç¤ºçš„æ˜¯ç±»ä¸ç±»ä¹‹é—´å­˜åœ¨æŸç§ç‰¹å®šçš„å¯¹åº”å…³ç³»ã€‚å®ƒæ˜¯ä¸€ç§é™æ€å…³ç³»ï¼Œé€šå¸¸ä¸è¿è¡ŒçŠ¶æ€æ— å…³ï¼Œä¸€èˆ¬ç”±å¸¸è¯†ç­‰å› ç´ å†³å®šçš„ï¼›å…³è”å…³ç³»é»˜è®¤ä¸å¼ºè°ƒæ–¹å‘ï¼Œè¡¨ç¤ºå¯¹è±¡é—´ç›¸äº’çŸ¥é“ã€‚UMLä¸­ç”¨åŒå‘ã€å•å‘å¸¦ç®­å¤´çš„è™šçº¿è¡¨ç¤ºå…³è”å…³ç³»ï¼Œç®­å¤´ä¸¤ç«¯ä¸ºç›¸äº’å…³è”çš„ä¸¤ä¸ªç±»ã€‚</li></ul><p><strong>æ³¨</strong>ï¼šåœ¨æœ€ç»ˆä»£ç ä¸­ï¼Œå…³è”å¯¹è±¡é€šå¸¸æ˜¯ä»¥æˆå‘˜å˜é‡çš„å½¢å¼å®ç°çš„;</p><blockquote><p>ä¾‹å¦‚ä¹˜è½¦äººå’Œè½¦ç¥¨ä¹‹é—´å°±æ˜¯ä¸€ç§å…³è”å…³ç³»ã€‚</p></blockquote><ul><li>ä¾èµ–(Dependency)ï¼šè¡¨ç¤ºçš„æ˜¯ç±»ä¹‹é—´çš„è°ƒç”¨å…³ç³»ã€‚ä¸å…³è”å…³ç³»ä¸åŒçš„æ˜¯ï¼Œå®ƒæ˜¯ä¸€ç§ä¸´æ—¶æ€§çš„å…³ç³»ï¼Œé€šå¸¸åœ¨è¿è¡ŒæœŸé—´äº§ç”Ÿï¼Œå¹¶ä¸”éšç€è¿è¡Œæ—¶çš„å˜åŒ–ï¼›ä¾èµ–å…³ç³»ä¹Ÿå¯èƒ½å‘ç”Ÿå˜åŒ–ï¼›æ˜¾ç„¶ï¼Œä¾èµ–ä¹Ÿæœ‰æ–¹å‘ï¼ŒåŒå‘ä¾èµ–æ˜¯ä¸€ç§éå¸¸ç³Ÿç³•çš„ç»“æ„ï¼Œæˆ‘ä»¬æ€»æ˜¯åº”è¯¥ä¿æŒå•å‘ä¾èµ–ï¼Œæœç»åŒå‘ä¾èµ–çš„äº§ç”Ÿã€‚UMLä¸­ç”¨å¸¦ç®­å¤´çš„è™šçº¿è¡¨ç¤ºä¾èµ–å…³ç³»ï¼Œè€Œç®­å¤´æ‰€æŒ‡çš„åˆ™æ˜¯è¢«ä¾èµ–çš„ç±»ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Book</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String author;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Date publishDate;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> BigDecimal price;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getAuthor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> author;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAuthor</span><span class="params">(String author)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.author = author;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Date <span class="title">getPublishDate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> publishDate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPublishDate</span><span class="params">(Date publishDate)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.publishDate = publishDate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> BigDecimal <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrice</span><span class="params">(BigDecimal price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword">extends</span> <span class="title">People</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Double grade;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">study</span><span class="params">(String course)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"å­¦ä¹ "</span> + course);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * Studentçš„ç±»ä¾èµ–Bookç±»</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(Book book)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"é˜…è¯»"</span> + book.getName());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Long <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Long id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Double <span class="title">getGrade</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> grade;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setGrade</span><span class="params">(Double grade)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.grade = grade;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ³¨</strong>ï¼šåœ¨æœ€ç»ˆä»£ç ä¸­ï¼Œä¾èµ–å…³ç³»ä½“ç°ä¸º<strong>ç±»æ„é€ æ–¹æ³•</strong>åŠ<strong>ç±»æ–¹æ³•çš„ä¼ å…¥å‚æ•°</strong>ï¼Œç®­å¤´çš„æŒ‡å‘ä¸ºè°ƒç”¨å…³ç³»ï¼›ä¾èµ–å…³ç³»é™¤äº†ä¸´æ—¶çŸ¥é“å¯¹æ–¹å¤–ï¼Œè¿˜æ˜¯â€œä½¿ç”¨â€å¯¹æ–¹çš„æ–¹æ³•å’Œå±æ€§ï¼›</p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210123144416.png" alt="ç±»ç»§æ‰¿å®ç°ç¤ºä¾‹å›¾" style="zoom:50%;" /><p><strong>å…³è”ã€èšåˆã€ç»„åˆä¸‰ç§å…³ç³»ç”¨ä»£ç è¡¨ç¤ºçš„è¯ï¼Œå¤§å¤šéƒ½æ˜¯ä¸€ä¸ªç±»æ˜¯å¦ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡ã€‚çœŸæ­£çš„å…³ç³»åªèƒ½é…åˆè¯­ä¹‰ï¼Œç»“åˆä¸Šä¸‹æ–‡æ‰èƒ½å¤Ÿåˆ¤æ–­å‡ºæ¥ï¼Œè€Œåªç»™å‡ºä¸€æ®µä»£ç è®©æˆ‘ä»¬åˆ¤æ–­æ˜¯å…³è”ã€èšåˆè¿˜æ˜¯ç»„åˆå…³ç³»ï¼Œåˆ™æ˜¯æ— æ³•åˆ¤æ–­çš„ã€‚</strong></p><p>[1]<a href="https://zhuanlan.zhihu.com/p/24576502" target="_blank" rel="noopener">å‚è€ƒèµ„æ–™https://zhuanlan.zhihu.com/p/24576502</a><br>[2]<a href="https://design-patterns.readthedocs.io/zh_CN/latest/read_uml.html" target="_blank" rel="noopener">å‚è€ƒèµ„æ–™https://design-patterns.readthedocs.io/zh_CN/latest/read_uml.html</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h5 id=&quot;UML&quot;&gt;&lt;a href=&quot;#UML&quot; class=&quot;headerlink&quot; title=&quot;UML&quot;&gt;&lt;/a&gt;UML&lt;/h5&gt;&lt;p&gt;UML(Unified Modeling Languageï¼Œç»Ÿä¸€å»ºæ¨¡è¯­è¨€)æ˜¯ä¸€ç§ä¸ºé¢å‘å¯¹è±¡ç³»ç»Ÿçš„äº§å“è¿›è¡Œè¯´æ˜ã€å¯è§†åŒ–å’Œç¼–åˆ¶æ–‡æ¡£çš„ä¸€ç§æ ‡å‡†è¯­è¨€ï¼Œæ˜¯éä¸“åˆ©çš„ç¬¬ä¸‰ä»£å»ºæ¨¡å’Œè§„çº¦è¯­è¨€ã€‚UMLæ˜¯é¢å‘å¯¹è±¡è®¾è®¡çš„å»ºæ¨¡å·¥å…·ï¼Œç‹¬ç«‹äºä»»ä½•å…·ä½“ç¨‹åºè®¾è®¡è¯­è¨€ã€‚&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="UML" scheme="https://ydstudios.gitee.io/tags/UML/"/>
    
      <category term="ç±»å›¾" scheme="https://ydstudios.gitee.io/tags/%E7%B1%BB%E5%9B%BE/"/>
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="https://ydstudios.gitee.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>RocketMQçš„æ¶ˆè´¹æ¨¡å¼</title>
    <link href="https://ydstudios.gitee.io/post/122ee231.html"/>
    <id>https://ydstudios.gitee.io/post/122ee231.html</id>
    <published>2021-01-18T23:32:39.000Z</published>
    <updated>2021-01-18T15:41:25.000Z</updated>
    
    <content type="html"><![CDATA[<p>RocketMQ æ˜¯åŸºäºå‘å¸ƒè®¢é˜…æ¨¡å‹çš„æ¶ˆæ¯ä¸­é—´ä»¶ã€‚æ‰€è°“çš„å‘å¸ƒè®¢é˜…å°±æ˜¯è¯´ï¼Œconsumer è®¢é˜…äº† broker ä¸Šçš„æŸä¸ª topicï¼Œå½“ producer å‘å¸ƒæ¶ˆæ¯åˆ° broker ä¸Šçš„è¯¥ topic æ—¶ï¼Œconsumer å°±èƒ½æ”¶åˆ°è¯¥æ¡æ¶ˆæ¯ã€‚RocketMQé»˜è®¤æ”¯æŒä¸¤ç§æ¶ˆè´¹æ¨¡å¼ï¼Œåˆ†åˆ«æ˜¯é›†ç¾¤æ¶ˆè´¹æ¨¡å¼å’Œå¹¿æ’­æ¶ˆè´¹æ¨¡å¼ï¼Œé»˜è®¤é›†ç¾¤æ¶ˆè´¹æ¨¡å¼ã€‚</p><a id="more"></a><h5 id="é›†ç¾¤"><a href="#é›†ç¾¤" class="headerlink" title="é›†ç¾¤"></a>é›†ç¾¤</h5><p>MQ çº¦å®šä½¿ç”¨ç›¸åŒ Consumer ID çš„è®¢é˜…è€…å±äºåŒä¸€ä¸ªé›†ç¾¤ï¼ŒåŒä¸€ä¸ªé›†ç¾¤ä¸‹çš„è®¢é˜…è€…æ¶ˆè´¹é€»è¾‘å¿…é¡»å®Œå…¨ä¸€è‡´ï¼ˆåŒ…æ‹¬ Tag çš„ä½¿ç”¨ï¼‰ï¼Œè¿™äº›è®¢é˜…è€…åœ¨é€»è¾‘ä¸Šå¯ä»¥è®¤ä¸ºæ˜¯ä¸€ä¸ªæ¶ˆè´¹èŠ‚ç‚¹ã€‚</p><blockquote><p>æ¶ˆè´¹åŒä¸€ç±»æ¶ˆæ¯çš„å¤šä¸ª consumer å®ä¾‹ç»„æˆä¸€ä¸ªæ¶ˆè´¹è€…ç»„ï¼Œä¹Ÿå¯ä»¥ç§°ä¸ºä¸€ä¸ª consumer é›†ç¾¤ï¼Œè¿™äº› consumer å®ä¾‹ä½¿ç”¨åŒä¸€ä¸ª group nameã€‚éœ€è¦æ³¨æ„ä¸€ç‚¹ï¼Œé™¤äº†ä½¿ç”¨åŒä¸€ä¸ª group nameï¼Œè®¢é˜…çš„ tag ä¹Ÿå¿…é¡»æ˜¯ä¸€æ ·çš„ï¼Œåªæœ‰ç¬¦åˆè¿™ä¸¤ä¸ªæ¡ä»¶çš„ consumer å®ä¾‹æ‰èƒ½ç»„æˆ consumer é›†ç¾¤ã€‚</p></blockquote><h5 id="é›†ç¾¤æ¶ˆè´¹æ¨¡å¼"><a href="#é›†ç¾¤æ¶ˆè´¹æ¨¡å¼" class="headerlink" title="é›†ç¾¤æ¶ˆè´¹æ¨¡å¼"></a>é›†ç¾¤æ¶ˆè´¹æ¨¡å¼</h5><p>å½“ä½¿ç”¨é›†ç¾¤æ¶ˆè´¹æ¨¡å¼æ—¶ï¼ŒMQ è®¤ä¸ºä»»æ„ä¸€æ¡æ¶ˆæ¯åªéœ€è¦è¢«é›†ç¾¤å†…çš„ä»»æ„ä¸€ä¸ªæ¶ˆè´¹è€…å¤„ç†å³å¯ã€‚</p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210118233803.png" style="zoom:50%;" alt="é›†ç¾¤æ¶ˆè´¹æ¨¡å¼" /><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">DefaultMQPushConsumer consumer = <span class="keyword">new</span> DefaultMQPushConsumer(<span class="string">"consumer1"</span>);  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// åŒæ ·ä¹Ÿè¦è®¾ç½®NameServeråœ°å€  </span></span><br><span class="line">consumer.setNamesrvAddr(<span class="string">"127.0.0.1:9876;127.0.0.1:9876"</span>);  </span><br><span class="line"><span class="comment">// é»˜è®¤å°±æ˜¯é›†ç¾¤æ¶ˆè´¹æ¨¡å¼</span></span><br><span class="line">consumer.setMessageModel(MessageModel.CLUSTERING); </span><br><span class="line">consumer.setConsumeFromWhere(ConsumeFromWhere.CONSUME_FROM_FIRST_OFFSET);  </span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®consumeræ‰€è®¢é˜…çš„Topicå’ŒTagï¼Œ*ä»£è¡¨å…¨éƒ¨çš„Tag  </span></span><br><span class="line">consumer.subscribe(<span class="string">"TopicTest"</span>, <span class="string">"*"</span>);</span><br></pre></td></tr></table></figure><h6 id="é€‚ç”¨åœºæ™¯-amp-æ³¨æ„äº‹é¡¹"><a href="#é€‚ç”¨åœºæ™¯-amp-æ³¨æ„äº‹é¡¹" class="headerlink" title="é€‚ç”¨åœºæ™¯&amp;æ³¨æ„äº‹é¡¹"></a>é€‚ç”¨åœºæ™¯&amp;æ³¨æ„äº‹é¡¹</h6><ul><li>æ¶ˆè´¹ç«¯é›†ç¾¤åŒ–éƒ¨ç½²ï¼Œæ¯æ¡æ¶ˆæ¯åªéœ€è¦è¢«å¤„ç†ä¸€æ¬¡ã€‚</li><li>ç”±äºæ¶ˆè´¹è¿›åº¦åœ¨æœåŠ¡ç«¯ç»´æŠ¤ï¼Œå¯é æ€§æ›´é«˜ã€‚</li><li>é›†ç¾¤æ¶ˆè´¹æ¨¡å¼ä¸‹ï¼Œæ¯ä¸€æ¡æ¶ˆæ¯éƒ½åªä¼šè¢«åˆ†å‘åˆ°consumeré›†ç¾¤å†…ä»»æ„ä¸€ä¸ªçš„consumerå®ä¾‹æ¶ˆè´¹å¤„ç†ï¼Œå¦‚æœéœ€è¦è¢«é›†ç¾¤ä¸‹æ‰€æœ‰çš„consumerå®ä¾‹æ¶ˆè´¹å¤„ç†ï¼Œè¯·ä½¿ç”¨å¹¿æ’­æ¨¡å¼ã€‚</li><li>é›†ç¾¤æ¶ˆè´¹æ¨¡å¼ä¸‹ï¼Œä¸ä¿è¯æ¶ˆæ¯çš„æ¯ä¸€æ¬¡å¤±è´¥é‡æŠ•ç­‰é€»è¾‘éƒ½èƒ½è·¯ç”±åˆ°åŒä¸€ä¸ªconsumerå®ä¾‹ä¸Šï¼Œå› æ­¤å¤„ç†æ¶ˆæ¯æ—¶ä¸åº”è¯¥åšä»»ä½•ç¡®å®šæ€§å‡è®¾ã€‚</li></ul><h5 id="å¹¿æ’­æ¶ˆè´¹æ¨¡å¼"><a href="#å¹¿æ’­æ¶ˆè´¹æ¨¡å¼" class="headerlink" title="å¹¿æ’­æ¶ˆè´¹æ¨¡å¼"></a>å¹¿æ’­æ¶ˆè´¹æ¨¡å¼</h5><p>å½“ä½¿ç”¨å¹¿æ’­æ¶ˆè´¹æ¨¡å¼æ—¶ï¼ŒMQ ä¼šå°†æ¯æ¡æ¶ˆæ¯æ¨é€ç»™é›†ç¾¤å†…æ‰€æœ‰æ¶ˆè´¹è€…ï¼Œä¿è¯æ¶ˆæ¯è‡³å°‘è¢«æ¯ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹ä¸€æ¬¡ã€‚</p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210118233944.png" alt="å¹¿æ’­æ¶ˆè´¹æ¨¡å¼" style="zoom:50%;" /><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">DefaultMQPushConsumer consumer = <span class="keyword">new</span> DefaultMQPushConsumer(<span class="string">"consumer1"</span>);  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// åŒæ ·ä¹Ÿè¦è®¾ç½®NameServeråœ°å€  </span></span><br><span class="line">consumer.setNamesrvAddr(<span class="string">"127.0.0.1:9876;127.0.0.1:9876"</span>);  </span><br><span class="line"><span class="comment">// è®¾ç½®ä¸ºå¹¿æ’­æ¶ˆè´¹æ¨¡å¼</span></span><br><span class="line">consumer.setMessageModel(MessageModel.BROADCASTING); </span><br><span class="line">consumer.setConsumeFromWhere(ConsumeFromWhere.CONSUME_FROM_FIRST_OFFSET);  </span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®consumeræ‰€è®¢é˜…çš„Topicå’ŒTagï¼Œ*ä»£è¡¨å…¨éƒ¨çš„Tag  </span></span><br><span class="line">consumer.subscribe(<span class="string">"TopicTest"</span>, <span class="string">"*"</span>);</span><br></pre></td></tr></table></figure><h6 id="é€‚ç”¨åœºæ™¯-amp-æ³¨æ„äº‹é¡¹-1"><a href="#é€‚ç”¨åœºæ™¯-amp-æ³¨æ„äº‹é¡¹-1" class="headerlink" title="é€‚ç”¨åœºæ™¯&amp;æ³¨æ„äº‹é¡¹"></a>é€‚ç”¨åœºæ™¯&amp;æ³¨æ„äº‹é¡¹</h6><ul><li>æ¯æ¡æ¶ˆæ¯éƒ½éœ€è¦è¢«consumeré›†ç¾¤å†…æ‰€æœ‰çš„consumer å®ä¾‹æ¶ˆè´¹ä¸€æ¬¡ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯æ¡æ¶ˆæ¯è‡³å°‘è¢«æ¯ä¸€ä¸ªconsumer å®ä¾‹æ¶ˆè´¹ä¸€æ¬¡ã€‚</li><li>æ¶ˆè´¹è¿›åº¦åœ¨å®¢æˆ·ç«¯ç»´æŠ¤ï¼Œå‡ºç°é‡å¤çš„æ¦‚ç‡ç¨å¤§äºé›†ç¾¤æ¨¡å¼ã€‚</li><li>å¹¿æ’­æ¨¡å¼ä¸‹ï¼ŒMQ ä¿è¯æ¯æ¡æ¶ˆæ¯è‡³å°‘è¢«æ¯å°å®¢æˆ·ç«¯æ¶ˆè´¹ä¸€æ¬¡ï¼Œä½†æ˜¯å¹¶ä¸ä¼šå¯¹æ¶ˆè´¹å¤±è´¥çš„æ¶ˆæ¯è¿›è¡Œå¤±è´¥é‡æŠ•ï¼Œå› æ­¤ä¸šåŠ¡æ–¹éœ€è¦å…³æ³¨æ¶ˆè´¹å¤±è´¥çš„æƒ…å†µã€‚</li><li>å¹¿æ’­æ¨¡å¼ä¸‹ï¼Œç¬¬ä¸€æ¬¡å¯åŠ¨æ—¶é»˜è®¤ä»æœ€æ–°æ¶ˆæ¯æ¶ˆè´¹ï¼Œå®¢æˆ·ç«¯çš„æ¶ˆè´¹è¿›åº¦æ˜¯è¢«æŒä¹…åŒ–åœ¨å®¢æˆ·ç«¯æœ¬åœ°çš„éšè—æ–‡ä»¶ä¸­ï¼Œå› æ­¤ä¸å»ºè®®åˆ é™¤è¯¥éšè—æ–‡ä»¶ï¼Œå¦åˆ™ä¼šä¸¢å¤±éƒ¨åˆ†æ¶ˆæ¯ã€‚</li><li>å¹¿æ’­æ¨¡å¼ä¸‹ï¼Œæ¯æ¡æ¶ˆæ¯éƒ½ä¼šè¢«å¤§é‡çš„å®¢æˆ·ç«¯é‡å¤å¤„ç†ï¼Œå› æ­¤æ¨èå°½å¯èƒ½ä½¿ç”¨é›†ç¾¤æ¨¡å¼ã€‚</li><li>å¹¿æ’­æ¨¡å¼ä¸‹æœåŠ¡ç«¯ä¸ç»´æŠ¤æ¶ˆè´¹è¿›åº¦ï¼Œæ‰€ä»¥æœåŠ¡ç«¯ä¸æä¾›å †ç§¯æŸ¥è¯¢å’ŒæŠ¥è­¦åŠŸèƒ½ã€‚</li></ul><blockquote><p>ç›®å‰ä»… Java å®¢æˆ·ç«¯æ”¯æŒå¹¿æ’­æ¨¡å¼ã€‚</p></blockquote><p>è™½ç„¶å¹¿æ’­æ¶ˆè´¹èƒ½ä¿è¯é›†ç¾¤å†…æ¯ä¸ªconsumerå®ä¾‹éƒ½èƒ½æ¶ˆè´¹æ¶ˆæ¯ï¼Œä½†æ˜¯æ¶ˆè´¹è¿›åº¦çš„ç»´æŠ¤ã€ä¸å…·å¤‡æ¶ˆæ¯é‡æŠ•çš„æœºåˆ¶å¤§å¤§å½±å“äº†å®é™…çš„ä½¿ç”¨ã€‚å› æ­¤ï¼Œåœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œæ›´æ¨èä½¿ç”¨é›†ç¾¤æ¶ˆè´¹ï¼Œå› ä¸ºé›†ç¾¤æ¶ˆè´¹ä¸ä»…æ‹¥æœ‰æ¶ˆè´¹è¿›åº¦å­˜å‚¨çš„å¯é æ€§ï¼Œè¿˜å…·æœ‰æ¶ˆæ¯é‡æŠ•çš„æœºåˆ¶ã€‚è€Œä¸”ï¼Œæˆ‘ä»¬é€šè¿‡é›†ç¾¤æ¶ˆè´¹ä¹Ÿå¯ä»¥è¾¾åˆ°å¹¿æ’­æ¶ˆè´¹çš„æ•ˆæœã€‚</p><h5 id="ä½¿ç”¨é›†ç¾¤æ¨¡å¼æ¨¡æ‹Ÿå¹¿æ’­æ¨¡å¼"><a href="#ä½¿ç”¨é›†ç¾¤æ¨¡å¼æ¨¡æ‹Ÿå¹¿æ’­æ¨¡å¼" class="headerlink" title="ä½¿ç”¨é›†ç¾¤æ¨¡å¼æ¨¡æ‹Ÿå¹¿æ’­æ¨¡å¼"></a>ä½¿ç”¨é›†ç¾¤æ¨¡å¼æ¨¡æ‹Ÿå¹¿æ’­æ¨¡å¼</h5><p>æœ‰äº›åœºæ™¯å¸Œæœ›ä¸€ä¸ªæ¶ˆæ¯éœ€è¦å¤šä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹ï¼Œå¹¶ä¸”ä¹Ÿå¸Œæœ›æ¶ˆè´¹è€…æ¶ˆè´¹å¤±è´¥ï¼Œæ¶ˆæ¯èƒ½å¤Ÿé‡æ–°æŠ•é€’ã€‚</p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210118234035.png" alt="é›†ç¾¤æ¨¡å¼æ¨¡æ‹Ÿå¹¿æ’­æ¶ˆè´¹" style="zoom:50%;" /><blockquote><p>è®¢å•æ”¯ä»˜å®Œæˆé€šçŸ¥ä¸‹æ¸¸ç³»ç»Ÿï¼Œç§¯åˆ†æœåŠ¡æ‰£å‡è®¢å•ä½¿ç”¨çš„ç§¯åˆ†ã€ä¼˜æƒ åˆ¸æœåŠ¡å°†ä¼˜æƒ åˆ¸çŠ¶æ€æ›´æ–°ä¸ºå·²ä½¿ç”¨ã€åº“å­˜æœåŠ¡æ‰£å‡å•†å“åº“å­˜ã€ä»“åº“å‡†å¤‡å‘è´§ç­‰ç­‰</p></blockquote><h6 id="é€‚ç”¨åœºæ™¯-amp-æ³¨æ„äº‹é¡¹-2"><a href="#é€‚ç”¨åœºæ™¯-amp-æ³¨æ„äº‹é¡¹-2" class="headerlink" title="é€‚ç”¨åœºæ™¯&amp;æ³¨æ„äº‹é¡¹"></a>é€‚ç”¨åœºæ™¯&amp;æ³¨æ„äº‹é¡¹</h6><ul><li>æ¯æ¡æ¶ˆæ¯éƒ½éœ€è¦è¢«å¤šä¸ªæ¶ˆè´¹è€…å¤„ç†ï¼Œæ¯ä¸ªæ¶ˆè´¹è€…çš„é€»è¾‘å¯ä»¥ç›¸åŒä¹Ÿå¯ä»¥ä¸ä¸€æ ·ã€‚</li><li>æ¶ˆè´¹è¿›åº¦åœ¨æœåŠ¡ç«¯ç»´æŠ¤ï¼Œå¯é æ€§é«˜äºå¹¿æ’­æ¨¡å¼ã€‚</li></ul><p>å¦‚æœä¸šåŠ¡ä¸Šç¡®å®éœ€è¦ä½¿ç”¨å¹¿æ’­æ¶ˆè´¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ›å»ºå¤šä¸ª consumer å®ä¾‹ï¼Œæ¯ä¸ª consumer å®ä¾‹å±äºä¸åŒçš„ consumer groupï¼Œä½†æ˜¯å®ƒä»¬éƒ½è®¢é˜…åŒä¸€ä¸ª topicã€‚</p><blockquote><p>ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬åˆ›å»º 4 ä¸ª consumer å®ä¾‹ï¼Œconsumer1ï¼ˆå±äºconsumerGroup1ï¼‰ã€consumer2ï¼ˆå±äºconsumerGroup 2ï¼‰ã€consumer 3ï¼ˆå±äºconsumerGroup3ï¼‰å’Œ consumer4ï¼ˆå±äºconsumerGroup4ï¼‰ï¼Œå®ƒä»¬éƒ½è®¢é˜…äº† topicA ï¼Œé‚£ä¹ˆå½“ producer å‘é€ä¸€æ¡æ¶ˆæ¯åˆ° topic A ä¸Šæ—¶ï¼Œç”±äº3ä¸ªconsumer å±äºä¸åŒçš„ consumer groupï¼Œæ‰€ä»¥ 3 ä¸ªconsumeréƒ½èƒ½æ”¶åˆ°æ¶ˆæ¯ï¼Œä¹Ÿå°±è¾¾åˆ°äº†å¹¿æ’­æ¶ˆè´¹çš„æ•ˆæœäº†ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¾ç½®ä¸åŒçš„æ¶ˆè´¹ç»„åï¼Œå®ç°é›†ç¾¤æ¨¡å¼æ¨¡æ‹Ÿå¹¿æ’­æ¶ˆè´¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> consumerGroup æ¶ˆè´¹ç»„å</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">consumerMessage</span><span class="params">(String consumerGroup)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isBlank(consumerGroup))&#123;</span><br><span class="line">            consumerGroup = <span class="string">"unique_group_name"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Instantiate with specified consumer group name.</span></span><br><span class="line">        DefaultMQPushConsumer consumer = <span class="keyword">new</span> DefaultMQPushConsumer(consumerGroup);</span><br><span class="line">        <span class="comment">// Specify name server addresses.</span></span><br><span class="line">        consumer.setNamesrvAddr(<span class="string">"127.0.0.1:9876;127.0.0.1:9870"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é‡è¦ï¼šè®¾ç½®æ¶ˆè´¹è€…æ¶ˆæ¯æœ€å¤§é‡è¯•æ¬¡æ•°</span></span><br><span class="line">        <span class="comment">//consumer.setMaxReconsumeTimes(5);</span></span><br><span class="line">        <span class="comment">// Subscribe one more more topics to consume.</span></span><br><span class="line">        consumer.subscribe(<span class="string">"TopicTest"</span>, <span class="string">"*"</span>);</span><br><span class="line">        consumer.setConsumeFromWhere(ConsumeFromWhere.CONSUME_FROM_FIRST_OFFSET);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Register callback to execute on arrival of messages fetched from brokers.</span></span><br><span class="line">        consumer.registerMessageListener((MessageListenerConcurrently) (messages, context) -&gt; &#123;</span><br><span class="line">            <span class="keyword">for</span> (MessageExt message : messages) &#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">int</span> reconsumeTimes = message.getReconsumeTimes();</span><br><span class="line">                String msgId = message.getMsgId();</span><br><span class="line"></span><br><span class="line">                SimpleDateFormat simpleDateFormat = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd HH:mm:ss"</span>);</span><br><span class="line">                String format = simpleDateFormat.format(<span class="keyword">new</span> Date());</span><br><span class="line">                String messageContext = <span class="keyword">new</span> String(message.getBody(), StandardCharsets.UTF_8);</span><br><span class="line">                System.out.println(<span class="string">"æ¶ˆè´¹æ—¶é—´ï¼š"</span> + format + <span class="string">" ,æ¶ˆæ¯æ¶ˆè´¹æ¬¡æ•°="</span> + reconsumeTimes + <span class="string">", msgId="</span> + msgId + <span class="string">", æ¶ˆæ¯å†…å®¹:"</span> + messageContext);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ConsumeConcurrentlyStatus.CONSUME_SUCCESS;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Launch the consumer instance.</span></span><br><span class="line">        consumer.start();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>é™¤æ­¤ä¹‹å¤–ï¼Œæ¯ä¸ª consumer å®ä¾‹çš„æ¶ˆè´¹é€»è¾‘å¯ä»¥ä¸€æ ·ä¹Ÿå¯ä»¥ä¸ä¸€æ ·ï¼Œæ¯ä¸ªconsumer groupè¿˜å¯ä»¥æ ¹æ®éœ€è¦å¢åŠ  consumer å®ä¾‹ï¼Œæ¯”èµ·å¹¿æ’­æ¶ˆè´¹æ¥è¯´æ›´åŠ çµæ´»ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;RocketMQ æ˜¯åŸºäºå‘å¸ƒè®¢é˜…æ¨¡å‹çš„æ¶ˆæ¯ä¸­é—´ä»¶ã€‚æ‰€è°“çš„å‘å¸ƒè®¢é˜…å°±æ˜¯è¯´ï¼Œconsumer è®¢é˜…äº† broker ä¸Šçš„æŸä¸ª topicï¼Œå½“ producer å‘å¸ƒæ¶ˆæ¯åˆ° broker ä¸Šçš„è¯¥ topic æ—¶ï¼Œconsumer å°±èƒ½æ”¶åˆ°è¯¥æ¡æ¶ˆæ¯ã€‚RocketMQé»˜è®¤æ”¯æŒä¸¤ç§æ¶ˆè´¹æ¨¡å¼ï¼Œåˆ†åˆ«æ˜¯é›†ç¾¤æ¶ˆè´¹æ¨¡å¼å’Œå¹¿æ’­æ¶ˆè´¹æ¨¡å¼ï¼Œé»˜è®¤é›†ç¾¤æ¶ˆè´¹æ¨¡å¼ã€‚&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="rocketmq" scheme="https://ydstudios.gitee.io/tags/rocketmq/"/>
    
      <category term="æ¶ˆè´¹æ¨¡å¼" scheme="https://ydstudios.gitee.io/tags/%E6%B6%88%E8%B4%B9%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>ç³»ç»Ÿçš„æ•°æ®ä¸€è‡´æ€§åˆ°åº•æ˜¯åœ¨è¯´ä»€ä¹ˆ</title>
    <link href="https://ydstudios.gitee.io/post/e544327e.html"/>
    <id>https://ydstudios.gitee.io/post/e544327e.html</id>
    <published>2021-01-17T11:58:02.000Z</published>
    <updated>2021-01-24T04:41:46.000Z</updated>
    
    <content type="html"><![CDATA[<p>ä½œä¸ºä¸€åç¨‹åºå‘˜ï¼Œä½ æ˜¯ä¸æ˜¯ç»å¸¸åœ¨å¾ˆå¤šåœºæ™¯ï¼Œä¾‹å¦‚çœ‹åšå®¢ã€èŠå¤©å¹æ°´ç­‰ç­‰æ—¶å€™å¬åˆ°è¿™æ ·ä¸€ä¸ªè¯â€ç³»ç»Ÿæ•°æ®ä¸€è‡´æ€§â€ï¼Œæ˜¯ä¸æ˜¯æœ‰æ—¶å€™æ„Ÿè§‰åˆ°äº†è¿·ç³Šï¼Œä¸çŸ¥é“è¿™ä¸ªâ€ç³»ç»Ÿæ•°æ®ä¸€è‡´æ€§â€åˆ°åº•æ˜¯åœ¨è¯´ä»€ä¹ˆï¼Ÿå…¶å®ï¼Œä½ å¯èƒ½åªæ˜¯ä¸æ˜ç™½è¿™ä¸ªè¯ï¼Œä½†æ˜¯ä½ è‚¯å®šåœ¨å®é™…å·¥ä½œä¸­å‘ç°ã€è§£å†³è¿‡è¿™æ ·çš„é—®é¢˜ã€‚</p><a id="more"></a><h6 id="å•ä½“æ¶æ„ä¸‹ç³»ç»Ÿæ•°æ®ä¸€è‡´æ€§é—®é¢˜"><a href="#å•ä½“æ¶æ„ä¸‹ç³»ç»Ÿæ•°æ®ä¸€è‡´æ€§é—®é¢˜" class="headerlink" title="å•ä½“æ¶æ„ä¸‹ç³»ç»Ÿæ•°æ®ä¸€è‡´æ€§é—®é¢˜"></a>å•ä½“æ¶æ„ä¸‹ç³»ç»Ÿæ•°æ®ä¸€è‡´æ€§é—®é¢˜</h6><p>åœ¨ä¼ ç»Ÿçš„ç³»ç»Ÿåº”ç”¨ä¸­ï¼Œä¸€èˆ¬éƒ½æ˜¯ä½¿ç”¨å•ä½“æ¶æ„æ¥æ„å»ºç³»ç»Ÿçš„ã€‚å³æ‰€æœ‰çš„åŠŸèƒ½æ¨¡å—éƒ½æ”¾åœ¨ä¸€èµ·å®ç°ï¼Œæ‰“æˆä¸€ä¸ªWARåŒ…éƒ¨ç½²åœ¨Tomcatä¸­ï¼Œæ•°æ®ä¸€èˆ¬å­˜æ”¾åœ¨å…³ç³»å‹æ•°æ®åº“ä¸­ï¼Œå¦‚MySQLæ•°æ®åº“ã€‚</p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210117223211.png" style="zoom:50%;" alt="å•ä½“æ¶æ„å›¾" /><p>å‰é¢æˆ‘è¯´è¿‡å³ä½¿è¿™ç§å•ä½“æ¶æ„çš„ç³»ç»Ÿä¹Ÿæ˜¯æ•°æ®ä¸€è‡´æ€§çš„é—®é¢˜çš„ï¼Œä¸¾ä¸€ä¸ªç”µå•†ä¸‹å•çš„ä¾‹å­ï¼Œç”¨æˆ·æäº¤å®Œè®¢å•ï¼Œç³»ç»Ÿï¼Œç³»ç»Ÿåœ¨è®¢å•è¡¨orderè¡¨ä¸­å†™å…¥è®¢å•é‡‘é¢ã€ç”¨æˆ·ç­‰ç›¸å…³æ•°æ®ï¼Œåœ¨è®¢å•æ˜ç»†order_itemè¡¨ä¸­å†™å…¥å•†å“ä»·æ ¼ã€è´­ä¹°çš„æ•°é‡ç­‰æ•°æ®ï¼Œæœ€åæ›´æ–°å•†å“çš„åº“å­˜skuä¿¡æ¯ã€‚ç”¨æˆ·ä¸‹å•æˆåŠŸä¹‹åï¼Œç³»ç»Ÿæ“ä½œäº†orderã€order_itemã€skuè¿™ä¸‰ä¸ªæ•°æ®è¡¨ï¼Œå¯¹äºè¿™ä¸‰ä¸ªè¡¨çš„æ“ä½œæ— è®ºæˆåŠŸä¸å¤±è´¥ï¼Œéƒ½åº”è¯¥æ˜¯åŸå­çš„ï¼Œæ“ä½œæˆåŠŸåˆ™éƒ½è¦æˆåŠŸï¼Œå¤±è´¥åˆ™éƒ½è¦ä¸€èµ·å¤±è´¥ã€‚ä¸ç„¶å°±ä¼šå‡ºç°è„æ•°æ®ï¼Œæ•°æ®ä¸€è‡´æ€§è¢«ç ´åã€‚</p><p>1ã€ å¦‚æœæ“ä½œorderå’Œorder_itemè¡¨æˆåŠŸï¼Œæ“ä½œskuè¡¨å¤±è´¥ï¼Œåˆ™ä¼šå¯¼è‡´æœ¬åº”è¯¥æ‰£å‡çš„åº“å­˜æ²¡æœ‰æ‰£å‡ï¼Œåˆ™å•†å“æœ‰å¯èƒ½å‡ºç°è¶…å–ã€‚</p><p>2ã€å¦‚æœæ“ä½œorderå’Œorder_itemè¡¨å¤±è´¥ï¼Œæ“ä½œskuè¡¨æˆåŠŸï¼Œåˆ™ä¼šå¯¼è‡´æœ¬ä¸åº”è¯¥æ‰£å‡çš„åº“å­˜æ‰£å‡äº†ï¼Œåˆ™å•†å“æœ‰å¯èƒ½å‡ºç°å°‘å–ã€‚</p><p>3ã€å¦‚æœæ“ä½œorderå’Œskuè¡¨æˆåŠŸï¼Œorder_itemæ“ä½œå¤±è´¥ï¼Œåˆ™è¿™ä¸ªè®¢å•æ•°æ®ä¸¢å¤±ï¼Œè®¢å•åç»­çš„æ“ä½œè‚¯å®šä¹Ÿæ˜¯æ“ä½œä¸äº†äº†ã€‚</p><p>ä¸Šé¢åªæ˜¯ç®€å•çš„ä¸¾äº†ä¸‰ç§å¯èƒ½å‡ºç°çš„æƒ…å†µï¼Œä¹Ÿå¯èƒ½ä¼šæœ‰å…¶ä»–çš„æƒ…å†µå‘ç”Ÿã€‚é‚£æˆ‘ä»¬æ€ä¹ˆé¿å…è¿™äº›æƒ…å†µçš„å‘ç”Ÿå‘¢ï¼Ÿå…¶å®è¿™ç§é—®é¢˜ç¨å¾®æœ‰çš„å¼€å‘ç»éªŒçš„åŒå­¦éƒ½ä¼šæƒ³åˆ°è§£å†³æ–¹æ¡ˆï¼Œé‚£å°±æ˜¯ä½¿ç”¨æ•°æ®åº“çš„äº‹åŠ¡ï¼Œäº‹åŠ¡çš„åŸå­æ€§ä¿è¯ä¸Šè¿°çš„æ­¥éª¤æˆåŠŸåˆ™ä¸€èµ·æˆåŠŸï¼Œå¤±è´¥åˆ™ä¸€èµ·å¤±è´¥ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">BEGIN</span>;</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">order</span>;</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> order_item;</span><br><span class="line"><span class="keyword">UPDATE</span> sku;</span><br><span class="line"><span class="keyword">COMMIT</span>; <span class="comment"># ROLLBACK</span></span><br></pre></td></tr></table></figure><p><strong>åœ¨å•ä½“æ¶æ„çš„ç³»ç»Ÿä¸‹è§£å†³å†…éƒ¨æ¨¡å—çš„æ•°æ®ä¸€è‡´æ€§çš„é—®é¢˜ï¼Œç”¨æ•°æ®åº“çš„ACIDç‰¹æ€§å°±èƒ½ä¿è¯ã€‚</strong></p><p>å•ä½“æ¶æ„çš„ä¼˜ç‚¹å°±æ˜¯ç›¸å¯¹åˆ†å¸ƒå¼æ¥è¯´å¼€å‘ç®€å•ï¼ŒåŠŸèƒ½å¯ä»¥é›†ä¸­ç®¡ç†ï¼Œæ¨¡å—ä¹‹é—´é€šä¿¡æ²¡æœ‰æŸè€—ã€‚ä½†éšç€ä¸šåŠ¡è¶Šæ¥è¶Šå¤æ‚ã€éœ€æ±‚è¶Šæ¥è¶Šåºå¤§ï¼Œäººä»¬å¯¹ç³»ç»Ÿå“åº”æ—¶é—´ã€ååé‡å’Œå‡ºç°æ•…éšœçš„æ—¶å€™çš„ç³»ç»Ÿå¯ç”¨æ€§çš„è¦æ±‚ä¹Ÿè¶Šæ¥è¶Šé«˜ï¼ä¼ ç»Ÿçš„å•ä½“æ¶æ„ç³»ç»Ÿåœ¨è¿™ç§æƒ…å†µä¸‹æš´éœ²çš„ç¼ºç‚¹ä¹Ÿè¶Šæ¥è¶Šå¤šï¼Œäººä»¬å¼€å§‹å¯»æ±‚è½¬å˜ã€‚æ—¢ç„¶éƒ¨ç½²åœ¨ä¸€ä¸ªæœåŠ¡å™¨ä¸Šçš„å•ä½“æ¶æ„ç³»ç»Ÿæä¸å®šï¼Œé‚£å°±å¤šéƒ¨ç½²å‡ å°ï¼Œå³ç”¨å¤šå°å•æœºèŠ‚ç‚¹ç»„æˆé›†ç¾¤ï¼Œå†ç”¨è´Ÿè½½å‡è¡¡å‘å¤–æä¾›æœåŠ¡ã€‚</p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210123224514.png" alt="è´Ÿè½½å‡è¡¡" style="zoom:50%;" /><p>ä½†æ˜¯è¿™æ ·åšè¿˜æ˜¯è§£å†³ä¸äº†å•ä½“æ¶æ„å­˜åœ¨çš„ä¸€äº›é—®é¢˜ï¼š</p><ul><li>åªèƒ½ä½¿ç”¨åŒç§è¯­è¨€å¼€å‘ï¼Œä¸èƒ½é’ˆå¯¹ä¸åŒä¸šåŠ¡åœºæ™¯åˆ©ç”¨ä¸åŒè¯­è¨€çš„ä¼˜åŠ¿å¼€å‘å¯¹åº”çš„æ¨¡å—ã€‚</li><li>ç³»ç»Ÿæ¨¡å—è€¦åˆæ€§å¤ªå¼ºï¼Œç³»ç»Ÿä¸­æŸä¸€ä¸ªæ¨¡å—å‡ºç°é—®é¢˜ï¼Œä¾‹å¦‚é«˜å¹¶å‘ã€å¤§æ•°æ®åœºæ™¯æˆ–è€…å‡ºç°bugï¼Œæ•´ä¸ªç³»ç»Ÿéƒ½ä¼šå—åˆ°ç‰µè¿ã€‚</li><li>æŸä¸ªæ¨¡å—å‘å¸ƒï¼Œæ•´ä¸ªç³»ç»Ÿéƒ½è¦åœæœºå‘å¸ƒï¼Œç³»ç»Ÿæ‰€æœ‰æ¨¡å—éƒ½ä¸èƒ½å¯¹å¤–æä¾›æœåŠ¡ï¼Œè¿™æ ·æ— æ³•å¿«é€Ÿå“åº”å¸‚åœºéœ€æ±‚ã€‚</li><li>é›†ç¾¤è´Ÿæ‹…å¤§ï¼Œå¦‚æœæƒ³è¦é›†ç¾¤ï¼Œåªèƒ½å¯¹æ•´ä¸ªç³»ç»Ÿè¿›è¡Œé›†ç¾¤ï¼Œå³ä½¿åªæœ‰ä¸€ä¸ªæ¨¡å—æœ‰å‹åŠ›ã€‚</li></ul><h6 id="å¾®æœåŠ¡æ¶æ„"><a href="#å¾®æœåŠ¡æ¶æ„" class="headerlink" title="å¾®æœåŠ¡æ¶æ„"></a>å¾®æœåŠ¡æ¶æ„</h6>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä½œä¸ºä¸€åç¨‹åºå‘˜ï¼Œä½ æ˜¯ä¸æ˜¯ç»å¸¸åœ¨å¾ˆå¤šåœºæ™¯ï¼Œä¾‹å¦‚çœ‹åšå®¢ã€èŠå¤©å¹æ°´ç­‰ç­‰æ—¶å€™å¬åˆ°è¿™æ ·ä¸€ä¸ªè¯â€ç³»ç»Ÿæ•°æ®ä¸€è‡´æ€§â€ï¼Œæ˜¯ä¸æ˜¯æœ‰æ—¶å€™æ„Ÿè§‰åˆ°äº†è¿·ç³Šï¼Œä¸çŸ¥é“è¿™ä¸ªâ€ç³»ç»Ÿæ•°æ®ä¸€è‡´æ€§â€åˆ°åº•æ˜¯åœ¨è¯´ä»€ä¹ˆï¼Ÿå…¶å®ï¼Œä½ å¯èƒ½åªæ˜¯ä¸æ˜ç™½è¿™ä¸ªè¯ï¼Œä½†æ˜¯ä½ è‚¯å®šåœ¨å®é™…å·¥ä½œä¸­å‘ç°ã€è§£å†³è¿‡è¿™æ ·çš„é—®é¢˜ã€‚&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="åˆ†å¸ƒå¼" scheme="https://ydstudios.gitee.io/tags/%E5%88%86%E5%B8%83%E5%BC%8F/"/>
    
      <category term="ä¸€è‡´æ€§" scheme="https://ydstudios.gitee.io/tags/%E4%B8%80%E8%87%B4%E6%80%A7/"/>
    
  </entry>
  
  <entry>
    <title>2020å¹´çš„å¹´ç»ˆå°ç»“</title>
    <link href="https://ydstudios.gitee.io/post/b4e52eb3.html"/>
    <id>https://ydstudios.gitee.io/post/b4e52eb3.html</id>
    <published>2021-01-11T20:06:57.000Z</published>
    <updated>2021-01-17T03:48:14.000Z</updated>
    
    <content type="html"><![CDATA[<p>2020å¹´çœŸçš„æ˜¯ä¸€ä¸ªç¥å¥‡å¹´åº¦ï¼Œè¿™ä¸€å¹´ä½œä¸ºåƒç“œç¾¤ä¼—çš„æˆ‘ï¼Œè§åˆ°äº†å¤ªå¤šç‰›é¬¼è›‡ç¥ã€‚</p><a id="more"></a><h5 id="å‘¨è¾¹ç¯å¢ƒçš„ä¸å¹³å‡¡"><a href="#å‘¨è¾¹ç¯å¢ƒçš„ä¸å¹³å‡¡" class="headerlink" title="å‘¨è¾¹ç¯å¢ƒçš„ä¸å¹³å‡¡"></a>å‘¨è¾¹ç¯å¢ƒçš„ä¸å¹³å‡¡</h5><p>æ–°å† ç–«æƒ…å¸­å·å…¨çƒï¼Œä¸­å›½æ”¿åºœçš„å°é—­ç®¡ç†æ•ˆæœæ˜¾è‘—ï¼Œç”Ÿäº§æ´»åŠ¨å¾—åˆ°äº†æœ‰åºæ¢å¤ã€‚6æœˆ16æ—¥åœ¨åŠ å‹’ä¸‡æ²³è°·åœ°åŒºä¸­å°å‘ç”Ÿæ‘©æ“¦äº‹ä»¶ï¼Œå°å†›è¢«å¨æ­¦çš„è§£æ”¾å†›æš´æåæ­»äº¡20äººã€‚è€ç¾çš„ç»æµæ³¢åŠ¨ï¼Œè‚¡å¸‚ç ´çºªå½•çš„å››æ¬¡ç†”æ–­ï¼Œå·å»ºå›½çš„ç¾å›½æ€»ç»Ÿä¹‹æ—…åœ¨11æœˆç»“æŸã€‚åŒ—äº¬æ—¶é—´12æœˆ17æ—¥1æ—¶59åˆ†ï¼Œå«¦å¨¥äº”å·è¿”å›å™¨åœ¨å†…è’™å¤å››å­ç‹æ——æˆåŠŸç€é™†ï¼Œæ ‡å¿—ç€æˆ‘å›½é¦–æ¬¡åœ°å¤–å¤©ä½“é‡‡æ ·è¿”å›ä»»åŠ¡åœ†æ»¡å®Œæˆã€‚</p><p><strong>å›½å†…ç–«æƒ…æ¦‚è§ˆ</strong><br><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210111215555.png" alt="å›½å†…ç–«æƒ…æ¦‚è§ˆ" style="zoom:50%;" /></p><p><strong>å›½å¤–ç–«æƒ…æ¦‚è§ˆ</strong></p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210111215635.png" alt="å›½å¤–ç–«æƒ…æ¦‚è§ˆ" style="zoom:50%;" /><h5 id="ä¸ªäººç”Ÿæ´»"><a href="#ä¸ªäººç”Ÿæ´»" class="headerlink" title="ä¸ªäººç”Ÿæ´»"></a>ä¸ªäººç”Ÿæ´»</h5><p>è¶ç€å›½åº†æ”¾å‡åˆå»äº†ä¸€è¶Ÿåˆè‚¥ï¼Œè¿™ä¸€æ¬¡åƒä¸Šäº†ä¸ˆæ¯å¨˜äº²æ‰‹åšçš„çº¢çƒ§é±¿é±¼ï¼Œå‘³é“çœŸæ˜¯ä¸é”™ï¼å›½åº†çš„ç¬¬å››å¤©å’Œå¥³æœ‹å‹å»äº†é»„å±±å¸‚æ—…æ¸¸ï¼Œçˆ¬äº†è²èŠ±å³°ã€å»äº†å¤§å³¡è°·è¿˜åƒäº†è‡­é³œé±¼ã€‚é»„å±±çš„é£æ™¯çœŸæ˜¯ä¸é”™ï¼Œå±±å³°é™¡å³­ã€æ™¯è‰²ç§€ä¸½ã€‚å› ä¸ºæƒ³çœ‹çœ‹é»„å±±çš„æ—¥å‡ºï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨å±±ä¸Šä½äº†ä¸€æ™šã€‚ç¬¬äºŒå¤©æ—©ä¸Šæˆ‘ä»¬æ€¥æ€¥å¿™å¿™çš„èµ·åºŠï¼Œç©¿ä¸Šé…’åº—é‡Œé¢åšåšå¤§å¤§æ£‰è¡£ï¼Œå¤–é¢ä¸‹ç€å°é›¨ã€åˆ®ç€å†·é£è¿˜æœ‰å¤§é›¾ï¼Œè‡ªç„¶ä¹Ÿå°±æ²¡æœ‰çœ‹åˆ°æ—¥å‡ºã€‚å¬å®¾é¦†çš„æœåŠ¡äººå‘˜è¯´å±±ä¸Š365å¤©æœ‰360å¤©éƒ½åœ¨ä¸‹é›¨ï¼Œä½ è¦æ˜¯èƒ½çœ‹åˆ°æ—¥å‡ºï¼Œè¯æ˜ä½ çš„è¿æ°”çœŸæ˜¯çˆ†æ£šï¼<br><strong>è²èŠ±å³°æ‹ç…§ç•™å¿µ</strong><br><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210113221351.png" alt="è²èŠ±å³°æ‹ç…§ç•™å¿µ" style="zoom:50%;" /></p><h5 id="å·¥ä½œ"><a href="#å·¥ä½œ" class="headerlink" title="å·¥ä½œ"></a>å·¥ä½œ</h5><p>åœ¨2020å¹´çš„æœ€åå‡ å¤©æœ‰å¹¸å’Œå‡ ä½å¤§ä½¬èŠäº†èŠï¼Œå‘ç°å¤§ä½¬å°±æ˜¯å¤§ä½¬ï¼Œä¸ç®¡æ˜¯åœ¨æŠ€æœ¯ä¸Šè¿˜æ˜¯åœ¨æ€æƒ³ä¸Šéƒ½è¿œè¿œè¶…è¿‡æˆ‘ã€‚å¤§ä½¬æœ‰å¥è¯å…³äºç³»ç»Ÿè®¾è®¡çš„è¯ï¼Œæˆ‘ç”šæ˜¯èµåŒï¼Œè¯çš„å†…å®¹å¤§è‡´å¦‚ä¸‹ï¼š</p><blockquote><p> ä¸šåŠ¡çš„è¯‰æ±‚è½¬åŒ–æˆäº§å“çš„éœ€æ±‚ï¼Œäº§å“çš„éœ€æ±‚è½¬åŒ–æˆæŠ€æœ¯çš„è¦æ±‚ï¼Œæœ€ç»ˆè½¬æ¢æˆç³»ç»Ÿçš„èƒ½åŠ›ã€‚</p></blockquote><p>ä¸€å¥è¯å°±è¯´å‡ºäº†ç³»ç»Ÿè®¾è®¡çš„è¿‡ç¨‹å’Œç›®çš„ï¼Œè¨€ç®€æ„èµ…å‘€ï¼è°ˆè¯ä¸­å¤§ä½¬è¿˜æŒ‡å‡ºäº†æˆ‘çš„ä¸€äº›é—®é¢˜ï¼Œè®©æˆ‘ä»¥åå¤šå¤šå…³æ³¨ä¸€ä¸‹ç³»ç»Ÿè®¾è®¡ï¼Œè¦æƒ³æ³•å­å»æé«˜è‡ªå·±çš„æ ¸å¿ƒç«äº‰åŠ›ã€‚æˆ‘äº‹åä¹Ÿæƒ³äº†æƒ³ï¼Œæˆ‘åœ¨çŸ¥è¯†æ€»ç»“ã€ç³»ç»Ÿè®¾è®¡å’Œè¯­è¨€ç»„ç»‡èƒ½åŠ›ä¸Šéƒ½æœ‰ä¸è¶³ï¼Œæ–°çš„ä¸€å¹´è¦æ³¨æ„è¿™å‡ ä¸ªæ–¹é¢çš„é”»ç‚¼ã€‚çŸ¥è¯†æ€»ç»“è¿™æ–¹é¢ï¼Œæˆ‘å†³å®šåé¢å¤šå¤šæ€»ç»“ï¼ŒæŠŠçŸ¥è¯†ä¸²è”èµ·æ¥ï¼Œå¤šè¾“å‡ºä¸€äº›åšå®¢ã€‚è¯­è¨€ç»„ç»‡èƒ½åŠ›æˆ‘æƒ³æˆ‘å¹³æ—¶å¤šæ³¨æ„ä¸€ä¸‹ï¼Œç„¶åé€‚å½“çš„é”»ç‚¼é”»ç‚¼åé¢åº”è¯¥ä¼šæ¸æ¸å˜å¥½ã€‚ç³»ç»Ÿè®¾è®¡èƒ½åŠ›è¿™æ–¹é¢çš„è¯ï¼Œåªèƒ½çœ‹çœ‹å·¥ä½œä¸Šæœ‰æ²¡æœ‰ç±»ä¼¼çš„æœºä¼šäº†ï¼Œè¿™ä¸ªå…‰é æƒ³åº”è¯¥ä¸è¡Œï¼Œè¿˜æ˜¯å¾—å®è·µè§çœŸçŸ¥ï¼</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;2020å¹´çœŸçš„æ˜¯ä¸€ä¸ªç¥å¥‡å¹´åº¦ï¼Œè¿™ä¸€å¹´ä½œä¸ºåƒç“œç¾¤ä¼—çš„æˆ‘ï¼Œè§åˆ°äº†å¤ªå¤šç‰›é¬¼è›‡ç¥ã€‚&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="å¹´ç»ˆ" scheme="https://ydstudios.gitee.io/tags/%E5%B9%B4%E7%BB%88/"/>
    
      <category term="æ„Ÿæ‚Ÿ" scheme="https://ydstudios.gitee.io/tags/%E6%84%9F%E6%82%9F/"/>
    
  </entry>
  
  <entry>
    <title>å·§ç”¨äºŒè¿›åˆ¶è¡¨ç¤ºä¸åŒçš„çŠ¶æ€</title>
    <link href="https://ydstudios.gitee.io/post/b7145215.html"/>
    <id>https://ydstudios.gitee.io/post/b7145215.html</id>
    <published>2021-01-06T21:28:00.000Z</published>
    <updated>2021-01-07T15:21:55.000Z</updated>
    
    <content type="html"><![CDATA[<p>æˆ‘ä»¬åœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­ä¼šé‡åˆ°è¿™ç§åœºæ™¯ï¼Œåœ¨ç³»ç»Ÿçš„æƒé™ã€é€‰é¡¹è®¾ç½®ï¼Œåªæœ‰ä¸¤ç§çŠ¶æ€å¼€å¯æˆ–è€…å…³é—­ã€‚</p><a id="more"></a><p>å…·ä½“æˆ‘ä»¬ä»¥å“”å“©å“”å“©çš„éšç§è®¾ç½®ä¸ºä¾‹ï¼š<br><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210106221129.png" alt="éšç§è®¾ç½®" style="zoom:50%;" /></p><p>è¿™ä¹ˆå‡ ç§å¼€å…³ä½ ä¼šæ€ä¹ˆè®¾è®¡æ•°æ®è¡¨ï¼ŸæŒ‰ç…§æ­£å¸¸çš„æ“ä½œé’ˆå¯¹ä¸€ä¸ªå¼€å…³æ·»åŠ å­—æ®µè¿›è¡Œè¡¨ç¤ºã€‚å¯æ˜¯åç»­å°±ä¼šæœ‰ä¸‹é¢çš„è¿™æ ·çš„æƒ…å†µï¼š</p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20210106223014.png"  alt="éšç§è®¾ç½®"  style="zoom:50%;" /><p>å“ˆå“ˆï¼Œäº§å“éœ€æ±‚è¿­ä»£å¢åŠ äº†åç»­å‡ ç§å¼€å…³ï¼Œä½ å‡†å¤‡æ€ä¹ˆåšï¼Ÿè¿˜æ˜¯ç»§ç»­å¢åŠ å­—æ®µè¿›è¡Œä¿å­˜ä¹ˆï¼Ÿå¢åŠ å­—æ®µè¿›è¡Œä¿å­˜ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯æ„Ÿè§‰ä¸Šä¼šæœ‰é‚£ä¹ˆä¸€ç‚¹ç‚¹lowï¼æ–°çš„å¼€å…³å‡ºç°å¢åŠ å­—æ®µè¿›è¡Œä¿å­˜ï¼Œæ—¢è¦ä¿®æ”¹è¡¨ç»“æ„ï¼Œåˆè¦æ”¹å®ä½“å±æ€§ï¼Œè¿˜æ˜¯æ¯”è¾ƒéº»çƒ¦çš„ï¼æ‰€ä»¥ï¼Œå¯¹äºè¿™ç§ç±»ä¼¼çš„éœ€æ±‚ï¼Œæˆ‘ä»¬è¦æœ‰ä¸€ä¸ªè‰¯å¥½çš„è®¾è®¡æ¥åº”å¯¹ï¼Œé‚£æˆ‘ä»¬å¦‚ä½•è§£å†³å‘¢ï¼Ÿ</p><p>ç”¨è¿‡linuxç³»ç»Ÿçš„åŒå­¦ä¼šçŸ¥é“è¿™æ ·ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chomd 777 something</span><br><span class="line"><span class="meta">#</span><span class="bash"> å¯è¯»r=4ï¼Œå¯å†™w=2ï¼Œå¯æ‰§è¡Œx=1ï¼Œå³ äºŒè¿›åˆ¶çš„001ä»£è¡¨å¯æ‰§è¡Œï¼Œ010ä»£è¡¨å¯å†™ï¼Œ100ä»£è¡¨å¯è¯»</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„linuxå‘½ä»¤ä»£è¡¨æŠŠsomethingçš„æƒé™ä¿®æ”¹æˆæ‰€æœ‰è€…ã€ç”¨æˆ·ç»„ã€å…¶ä»–ç”¨æˆ·éƒ½å¯ä»¥è¿›è¡Œå¯è¯»ã€å¯å†™ã€å¯æ‰§è¡Œã€‚</p><table><thead><tr><th>æ•°å­—</th><th>æƒé™</th><th>rwx</th><th>äºŒè¿›åˆ¶</th></tr></thead><tbody><tr><td>7</td><td>è¯» + å†™ + æ‰§è¡Œ</td><td>rwx</td><td>111</td></tr><tr><td>6</td><td>è¯» + å†™</td><td>rw-</td><td>110</td></tr><tr><td>5</td><td>è¯» + æ‰§è¡Œ</td><td>r-x</td><td>101</td></tr><tr><td>4</td><td>åªè¯»</td><td>râ€“</td><td>100</td></tr><tr><td>3</td><td>å†™ + æ‰§è¡Œ</td><td>-wx</td><td>011</td></tr><tr><td>2</td><td>åªå†™</td><td>-w-</td><td>010</td></tr><tr><td>1</td><td>åªæ‰§è¡Œ</td><td>â€“x</td><td>001</td></tr><tr><td>0</td><td>æ— </td><td>â€”</td><td>000</td></tr></tbody></table><p>ç”¨çš„æ˜¯äºŒè¿›åˆ¶çš„001ä»£è¡¨å¯æ‰§è¡Œï¼Œ010ä»£è¡¨å¯å†™ï¼Œ100ä»£è¡¨å¯è¯»ï¼Œé‚£ä¹ˆåªéœ€è¦3ä½äºŒè¿›åˆ¶æ•°å³å¯è¡¨ç¤ºè¿™ä¸‰ç§çŠ¶æ€çš„æ··åˆæ­é…ã€‚å€Ÿç”¨è¿™ç§æ€æƒ³ï¼Œæˆ‘ä»¬æ¥è§£å†³ä¸Šè¿°çš„é—®é¢˜ï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªintç±»å‹å­—æ®µå°±å¯ä»¥è¡¨ç¤ºä¸Šè¿°æ‰€æœ‰çš„çŠ¶æ€å¼€å…³ã€‚<strong>ä½¿ç”¨2çš„æ¬¡å¹‚å€¼ä»£è¡¨ä¸€ç§çŠ¶æ€</strong>ï¼Œæ¯”å¦‚æˆ‘ä»¬ç”¨</p><ul><li><p>2çš„é›¶æ¬¡æ–¹ $2^{0}$ = 1 è¡¨ç¤ºæ‰“å¼€æˆ‘çš„æ”¶è—</p></li><li><p>2çš„ä¸€æ¬¡æ–¹ $2^{1}$ = 2 è¡¨ç¤ºæ‰“å¼€è¿½ç•ªè¿½å‰§</p></li><li><p>2çš„äºŒæ¬¡æ–¹ $2^{2}$ = 4 è¡¨ç¤ºæ‰“å¼€è®¢é˜…æ ‡ç­¾</p></li><li><p>2çš„ä¸‰æ¬¡æ–¹ $2^{3}$ = 8 è¡¨ç¤ºæ‰“å¼€æœ€è¿‘æŠ•å¸çš„è§†é¢‘</p></li><li><p>2çš„å››æ¬¡æ–¹ $2^{4}$ = 16 è¡¨ç¤ºæ‰“å¼€ä¸ªäººèµ„æ–™</p></li><li><p>2çš„äº”æ¬¡æ–¹ $2^{5}$ = 32 è¡¨ç¤ºæ‰“å¼€æœ€è¿‘ç©è¿‡çš„æ¸¸æˆ</p><blockquote><p>åšå®¢ä½¿ç”¨hexoæ­å»ºï¼Œé‡‡ç”¨é»˜è®¤çš„landscapeä¸»é¢˜ä¸æ”¯æŒLaTeX å…¬å¼ï¼Œæ‰€ä»¥ä¸Šé¢çš„æ¬¡æ–¹å…¬å¼æ˜¾ç¤ºçš„æœ‰é—®é¢˜ã€‚ </p></blockquote></li></ul><table><thead><tr><th>äºŒè¿›åˆ¶</th><th>æ•°å­—ï¼ˆåè¿›åˆ¶ï¼‰</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>000 000</td><td>0</td><td>å…¨éƒ¨å…³é—­</td></tr><tr><td>000 001</td><td>1</td><td>å¼€å¯æˆ‘çš„æ”¶è—</td></tr><tr><td>000 011</td><td>3</td><td>å¼€å¯æˆ‘çš„æ”¶è—ã€è¿½ç•ªè¿½å‰§</td></tr><tr><td>000 111</td><td>7</td><td>å¼€å¯æˆ‘çš„æ”¶è—ã€è¿½ç•ªè¿½å‰§ã€è®¢é˜…æ ‡ç­¾</td></tr><tr><td>111 111</td><td>63</td><td>å…¨éƒ¨å¼€å¯</td></tr></tbody></table><p><strong>å…¶å®å°±æ˜¯ç”¨bitä½è¡¨ç¤ºå¼€å¯æˆ–è€…å…³é—­ï¼Œå¦‚æœæ˜¯1è¡¨ç¤ºå¼€å¯ï¼Œ0è¡¨ç¤ºå…³é—­ã€‚</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æˆ–è¿ç®—ï¼šbitä½ä¸Šæœ‰1ä¸º1ã€‚ä¾‹å¦‚ï¼š2 | 1 == 0000 0010 | 0000 0001 == 3</span><br><span class="line">ä¸è¿ç®—ï¼šbitä½éƒ½ä¸º1æ‰ä¸º1ã€‚ ä¾‹å¦‚ 5 &amp; 2 == 0000 0101 &amp; 0000 0010 == 0</span><br><span class="line">å¼‚æˆ–è¿ç®—ï¼š0^0=0ï¼›  0^1=1ï¼›  1^0=1ï¼›   1^1=0ï¼›å³ï¼šå‚åŠ è¿ç®—çš„ä¸¤ä¸ªå¯¹è±¡ï¼Œå¦‚æœä¸¤ä¸ªç›¸åº”ä½ä¸ºâ€œå¼‚â€ï¼ˆå€¼ä¸åŒï¼‰ï¼Œåˆ™è¯¥ä½ç»“æœä¸º1ï¼Œå¦åˆ™ä¸º0ã€‚</span><br></pre></td></tr></table></figure><h6 id="é‚£æˆ‘ä»¬å°±æ¥ç¼–ç å®ç°ä¸Šè¿°åŠŸèƒ½ï¼š"><a href="#é‚£æˆ‘ä»¬å°±æ¥ç¼–ç å®ç°ä¸Šè¿°åŠŸèƒ½ï¼š" class="headerlink" title="é‚£æˆ‘ä»¬å°±æ¥ç¼–ç å®ç°ä¸Šè¿°åŠŸèƒ½ï¼š"></a>é‚£æˆ‘ä»¬å°±æ¥ç¼–ç å®ç°ä¸Šè¿°åŠŸèƒ½ï¼š</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ydstudio.flashsale.<span class="keyword">module</span>.business.bit;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Getter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> åˆ˜æ´‹ Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/1/7</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> MemberOption &#123;</span><br><span class="line"></span><br><span class="line">    FAVORITE(<span class="number">1</span>, <span class="string">"æˆ‘çš„æ”¶è—"</span>, <span class="number">1</span>),</span><br><span class="line">    FOLLOW(<span class="number">2</span>, <span class="string">"è¿½ç•ªè¿½å‰§"</span>, <span class="number">2</span>),</span><br><span class="line">    SUBSCRIBE(<span class="number">3</span>, <span class="string">"è®¢é˜…æ ‡ç­¾"</span>, <span class="number">4</span>),</span><br><span class="line">    VIDEO(<span class="number">4</span>, <span class="string">"æœ€è¿‘æŠ•å¸è§†é¢‘"</span>, <span class="number">8</span>),</span><br><span class="line">    PROFILE(<span class="number">5</span>, <span class="string">"ä¸ªäººèµ„æ–™"</span>, <span class="number">16</span>),</span><br><span class="line">    GAME(<span class="number">6</span>, <span class="string">"æœ€è¿‘ç©çš„æ¸¸æˆ"</span>, <span class="number">32</span>),;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æšä¸¾</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer code;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æè¿°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String desc;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * çŠ¶æ€ä½</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer tag;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¯å¦æœ‰æŸä¸ªtag</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> tags æ‹¥æœ‰çš„tagé›†åˆ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasTag</span><span class="params">(<span class="keyword">int</span> tags)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (tags &amp; <span class="keyword">this</span>.tag) == <span class="keyword">this</span>.tag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> tags = <span class="number">37</span>;</span><br><span class="line">        <span class="comment">// true</span></span><br><span class="line">        System.out.println(MemberOption.FAVORITE.hasTag(tags));</span><br><span class="line">        <span class="comment">// true</span></span><br><span class="line">        System.out.println(MemberOption.SUBSCRIBE.hasTag(tags));</span><br><span class="line">        <span class="comment">// false</span></span><br><span class="line">        System.out.println(MemberOption.VIDEO.hasTag(tags));</span><br><span class="line">        <span class="comment">// true</span></span><br><span class="line">        System.out.println(MemberOption.GAME.hasTag(tags));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h6 id="å¼€å¯æˆ‘çš„æ”¶è—å’Œæœ€è¿‘ç©çš„æ¸¸æˆï¼Œå…¶ä»–é€‰é¡¹éƒ½å…³é—­ï¼Œåˆ™è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š"><a href="#å¼€å¯æˆ‘çš„æ”¶è—å’Œæœ€è¿‘ç©çš„æ¸¸æˆï¼Œå…¶ä»–é€‰é¡¹éƒ½å…³é—­ï¼Œåˆ™è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š" class="headerlink" title="å¼€å¯æˆ‘çš„æ”¶è—å’Œæœ€è¿‘ç©çš„æ¸¸æˆï¼Œå…¶ä»–é€‰é¡¹éƒ½å…³é—­ï¼Œåˆ™è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š"></a>å¼€å¯æˆ‘çš„æ”¶è—å’Œæœ€è¿‘ç©çš„æ¸¸æˆï¼Œå…¶ä»–é€‰é¡¹éƒ½å…³é—­ï¼Œåˆ™è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># æˆ‘çš„æ”¶è— tag = 1 æœ€è¿‘ç©çš„æ¸¸æˆ tag = 32</span><br><span class="line">tags = <span class="number">1</span> + <span class="number">32</span> = <span class="number">33</span> </span><br><span class="line">æˆ–è€…é‡‡ç”¨ä½æˆ–è¿ç®— tags = <span class="number">1</span> | <span class="number">32</span> = <span class="number">33</span></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">  * è®¡ç®—çŠ¶æ€ä½</span></span><br><span class="line"><span class="comment">  * tags: å·²æœ‰çŠ¶æ€ä½</span></span><br><span class="line"><span class="comment">  * values: éœ€è¦æ·»åŠ çš„çŠ¶æ€å€¼</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">addTag</span><span class="params">(<span class="keyword">int</span> tags, <span class="keyword">int</span>... values)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> value : values) &#123;</span><br><span class="line">    tags |= value;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> tags;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h6 id="å…³é—­æœ€è¿‘ç©çš„æ¸¸æˆï¼Œåˆ™è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š"><a href="#å…³é—­æœ€è¿‘ç©çš„æ¸¸æˆï¼Œåˆ™è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š" class="headerlink" title="å…³é—­æœ€è¿‘ç©çš„æ¸¸æˆï¼Œåˆ™è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š"></a>å…³é—­æœ€è¿‘ç©çš„æ¸¸æˆï¼Œåˆ™è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">ä¸Šé¢è®¡ç®—çš„tags = <span class="number">33</span> ï¼Œæœ€è¿‘ç©çš„æ¸¸æˆ tag = <span class="number">32</span></span><br><span class="line">å…³é—­æœ€è¿‘ç©çš„æ¸¸æˆï¼Œ</span><br><span class="line">tags = <span class="number">33</span> ^ <span class="number">32</span> = <span class="number">0010</span> <span class="number">0001</span> ^ <span class="number">0010</span> <span class="number">0000</span> = <span class="number">0000</span> <span class="number">0001</span> = <span class="number">1</span></span><br><span class="line">  </span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * ç§»é™¤çŠ¶æ€ä½</span></span><br><span class="line"><span class="comment">   * tags: å·²æœ‰çŠ¶æ€ä½</span></span><br><span class="line"><span class="comment">   * tag: éœ€è¦ç§»é™¤çš„çŠ¶æ€å€¼</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">delTag</span><span class="params">(<span class="keyword">int</span> tags, <span class="keyword">int</span> tag)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// tagså’Œvalueä¸è¿ç®—ä¸ç­‰äºtagï¼Œè¯´æ˜æ²¡æœ‰å¼€å¯tagå¯¹åº”çš„é€‰é¡¹ï¼Œåˆ™ç›´æ¥è¿”å›tags</span></span><br><span class="line">  <span class="keyword">if</span> ((tags &amp; tag) != tag) <span class="keyword">return</span> tags;</span><br><span class="line">  <span class="keyword">return</span> tags ^ tag;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h6 id="åˆ¤æ–­æ˜¯å¦å¼€å¯æœ€è¿‘ç©çš„æ¸¸æˆï¼Œåˆ™è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š"><a href="#åˆ¤æ–­æ˜¯å¦å¼€å¯æœ€è¿‘ç©çš„æ¸¸æˆï¼Œåˆ™è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š" class="headerlink" title="åˆ¤æ–­æ˜¯å¦å¼€å¯æœ€è¿‘ç©çš„æ¸¸æˆï¼Œåˆ™è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š"></a>åˆ¤æ–­æ˜¯å¦å¼€å¯æœ€è¿‘ç©çš„æ¸¸æˆï¼Œåˆ™è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ä¸Šé¢è®¡ç®—çš„tags = <span class="number">33</span> ï¼Œæœ€è¿‘ç©çš„æ¸¸æˆ tag = <span class="number">32</span></span><br><span class="line"> <span class="number">33</span> &amp; <span class="number">32</span> = <span class="number">0010</span> <span class="number">0001</span> &amp; <span class="number">0010</span> <span class="number">0000</span> = <span class="number">0010</span> <span class="number">0000</span> = <span class="number">32</span> (<span class="number">0010</span> <span class="number">0000</span>)</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¯å¦æœ‰æŸä¸ªtag</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> tags æ‹¥æœ‰çš„tagé›†åˆ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> tag å¾…åˆ¤æ–­çš„tag</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasTag</span><span class="params">(<span class="keyword">int</span> tags, <span class="keyword">int</span> tag)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (tags &amp; tag) == tag;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h6 id="å¦‚ä½•ç”¨SQLæŸ¥è¯¢å¼€å¯æœ€è¿‘ç©çš„æ¸¸æˆé€‰é¡¹çš„ç”¨æˆ·"><a href="#å¦‚ä½•ç”¨SQLæŸ¥è¯¢å¼€å¯æœ€è¿‘ç©çš„æ¸¸æˆé€‰é¡¹çš„ç”¨æˆ·" class="headerlink" title="å¦‚ä½•ç”¨SQLæŸ¥è¯¢å¼€å¯æœ€è¿‘ç©çš„æ¸¸æˆé€‰é¡¹çš„ç”¨æˆ·"></a>å¦‚ä½•ç”¨SQLæŸ¥è¯¢å¼€å¯æœ€è¿‘ç©çš„æ¸¸æˆé€‰é¡¹çš„ç”¨æˆ·</h6><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># MySQLä¹Ÿæ˜¯æ”¯æŒä½è¿ç®—çš„ï¼Œå…¶ä»–çš„æ•°æ®åº“åº”è¯¥ä¹Ÿæ˜¯æ”¯æŒçš„</span></span><br><span class="line"><span class="keyword">select</span> member_id <span class="keyword">from</span> table_name <span class="keyword">where</span> member_option &amp; <span class="comment">#&#123;option&#125; = #&#123;option&#125;</span></span><br></pre></td></tr></table></figure><p>å°±è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç”¨ä¸€ä¸ªintå‹å­—æ®µä¿å­˜4*8 = 32ä¸ªçŠ¶æ€ä½ï¼ˆæ— ç¬¦å·çš„æƒ…å†µä¸‹ï¼‰,çœ‹èµ·æ¥è¿˜æ˜¯å¾ˆä¸é”™ï¼Œè¿ç®—çš„æ•ˆç‡é«˜ï¼Œåªç”¨ä¸€ä¸ªå­—æ®µå¯ä»¥ä¿å­˜è¾ƒå¤šçš„çŠ¶æ€ã€‚ç¼ºç‚¹å˜›ä¹Ÿæ˜¯æœ‰çš„ï¼Œå°±æ˜¯å¯è¯»æ€§å·®ï¼Œä¸èƒ½å¾ˆç›´è§‚çš„çœ‹å‡ºåˆ°åº•æœ‰å“ªäº›çŠ¶æ€ã€‚å…¶å®è¿™ç§æ–¹æ³•å¯ä»¥ç”¨ä¸€ä¸ªå­—æ®µè¡¨ç¤ºå¤šç§çŠ¶æ€ï¼Œä¾‹å¦‚ è®¢å•ä¸€èˆ¬æœ‰æ”¯ä»˜çŠ¶æ€ï¼šå¾…æ”¯ä»˜ 1 ã€æ”¯ä»˜ä¸­ 2 ã€æ”¯ä»˜æˆåŠŸ4 ã€æ”¯ä»˜å¤±è´¥8å’Œå‘è´§çŠ¶æ€ï¼šå¾…å‘è´§16ã€å·²å‘è´§32ã€åœ¨é€”64ã€å·²æ”¶è´§128ï¼Œè¿™æ ·çš„è¯ç”¨ä¸€ä¸ªorderStatusæ¥è¡¨ç¤ºè¿™ä¸¤ç§çŠ¶æ€ï¼šæ”¯ä»˜æˆåŠŸ4 + å¾…å‘è´§16 = 4 | 16 = 20ï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ä½†æ˜¯å¦‚ä¸Šé¢æ‰€è¯´ï¼Œä¼˜ç¼ºç‚¹éƒ½æœ‰ï¼Œçœ‹ä½ çš„å®é™…æƒ…å†µè¿›è¡Œé€‰æ‹©äº†ï¼</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æˆ‘ä»¬åœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­ä¼šé‡åˆ°è¿™ç§åœºæ™¯ï¼Œåœ¨ç³»ç»Ÿçš„æƒé™ã€é€‰é¡¹è®¾ç½®ï¼Œåªæœ‰ä¸¤ç§çŠ¶æ€å¼€å¯æˆ–è€…å…³é—­ã€‚&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="äºŒè¿›åˆ¶" scheme="https://ydstudios.gitee.io/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6/"/>
    
      <category term="ä½è¿ç®—" scheme="https://ydstudios.gitee.io/tags/%E4%BD%8D%E8%BF%90%E7%AE%97/"/>
    
  </entry>
  
  <entry>
    <title>Luaè„šæœ¬åœ¨ç§’æ€åœºæ™¯ä¸‹çš„ä½¿ç”¨</title>
    <link href="https://ydstudios.gitee.io/post/d958d490.html"/>
    <id>https://ydstudios.gitee.io/post/d958d490.html</id>
    <published>2020-12-24T22:40:10.000Z</published>
    <updated>2021-01-06T13:07:07.000Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨ç§’æ€è¿™ç§é«˜å¹¶å‘ã€å¤§æµé‡çš„åœºæ™¯ä¸‹ï¼Œåˆ©ç”¨æ•°æ®åº“è¿›è¡Œåº“å­˜æ‰£å‡ã€æ•°æ®æŸ¥è¯¢è¿™ç§æƒ³æ³•å°±ä¸è¦è€ƒè™‘äº†ã€‚ä½ è¦æ˜¯æœ‰è¿™ç§æƒ³æ³•ï¼ŒåŠä½ æ—©ç‚¹æ”¾å¼ƒï¼ŒP0äº‹æ•…ä¸€å®šåœ¨ç­‰ç€ä½ ã€‚ä¹‹å‰ç”¨Luaè„šæœ¬å®ç°ç§’æ€åœºæ™¯ä¸‹çš„åº“å­˜æ‰£å‡æ„Ÿè§‰å¾ˆä¸é”™ï¼Œé…åˆRedisç§’æ€æ•ˆæœæ æ çš„ï¼Redis 2.6 ç‰ˆæœ¬é€šè¿‡å†…åµŒæ”¯æŒ Lua ç¯å¢ƒï¼Œä¼šå•çº¿ç¨‹åŸå­æ€§æ‰§è¡Œ Lua è„šæœ¬ï¼Œä¿è¯ Lua è„šæœ¬åœ¨å¤„ç†çš„è¿‡ç¨‹ä¸­ä¸ä¼šè¢«ä»»æ„å…¶å®ƒè¯·æ±‚æ‰“æ–­ã€‚</p><a id="more"></a><p>å…ˆè¯´ä¸€ä¸‹å¤§æ¦‚çš„æƒ…å†µï¼Œåœ¨ä¸Šç§’æ€çš„å•†å“çš„æ—¶å€™ï¼Œå°±ç›´æ¥å°†äº§å“çš„åº“å­˜ã€ç”¨æˆ·æ¯äººçš„é™è´­çš„æ•°é‡ç­‰ä¿¡æ¯ç›´æ¥ç”¨Hashæ•°æ®ç±»å‹ä¿å­˜åœ¨Redisçš„é”®goods_å•†å“IDä¸­ï¼Œä¸è®¾ç½®ç¼“å­˜æœ‰æ•ˆæ—¶é—´ã€‚ç”¨æˆ·çš„è´­ä¹°è®°å½•ç”¨zsetä¿å­˜purchase_goods_å•†å“idä¸­ï¼Œç”¨å•†å“çš„IDä½œä¸ºkeyï¼Œç”¨æˆ·å”¯ä¸€æ ‡è¯†ä¸ºmember,è´­ä¹°çš„æ•°é‡ä¸ºscoreã€‚ç›¸å…³çš„å‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> åˆå§‹åŒ–ä¸€äº›ç§’æ€äº§å“</span></span><br><span class="line">hmset seckill:goods:1000 goodsId 1000 name æˆ´æ£®å¸å°˜å™¨V10Motorheadå…¥é—¨æ¬¾,æ€§ä»·æ¯”ä¹‹é€‰ stock 10 purchaseLimit 1   price 999.99 startSaleTime 1614137304000 endSaleTime 1614140904000  coverImage https://dss2.bdstatic.com/8_V1bjqh_Q23odCf/pacific/1955446237.png</span><br><span class="line"></span><br><span class="line">hmset seckill:goods:2000 goodsId 2000 name æˆ´æ£®æ— å¶é£æ‰‡ stock 15 purchaseLimit 1  price 1999.99 startSaleTime 1640406504000 endSaleTime 1614140904000  coverImage https://dss2.bdstatic.com/8_V1bjqh_Q23odCf/pacific/1957729018.png</span><br><span class="line"></span><br><span class="line">hmset seckill:goods:3000 goodsId 3000 name æˆ´æ£®æ™ºèƒ½ç…§æ˜ç¯ stock 32 purchaseLimit 1 price 299.99 startSaleTime 1640406504000 endSaleTime 1614140904000  coverImage https://dss2.bdstatic.com/8_V1bjqh_Q23odCf/pacific/1947896752.jpg</span><br><span class="line"></span><br><span class="line">hmset seckill:goods:4000 goodsId 4000 name æˆ´æ£®AM10é™¤èŒåŠ æ¹¿å™¨ stock 15  purchaseLimit 1   price 1299.99 startSaleTime 1640752104000 endSaleTime 1610166504000 coverImage https://dss2.bdstatic.com/8_V1bjqh_Q23odCf/pacific/1947896752.jpg</span><br><span class="line"></span><br><span class="line">hmset seckill:goods:5000 goodsId 5000 name è‹¹æœAirPodsMax  stock 13 purchaseLimit 1   price 2099.99 startSaleTime 1640752104000 endSaleTime 1610166504000 coverImage  https://dss2.bdstatic.com/8_V1bjqh_Q23odCf/pacific/1983533493.jpg</span><br></pre></td></tr></table></figure><p>å…·ä½“çš„Luaè„šæœ¬ç¼–å†™è¿‡ç¨‹æ¯”è¾ƒç®€å•ï¼Œç¨å¾®ç†Ÿæ‚‰ä¸€ä¸‹å°±èƒ½çœ‹æ‡‚äº†ï¼Œå…·ä½“å†…å®¹å¦‚ä¸‹ï¼ˆä¸´æ—¶é‡å†™çš„æ²¡æœ‰ä¼˜åŒ–ï¼Œå‡‘åˆç€çœ‹å§ï¼‰ï¼š</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--KEYS[1] å¯¹åº”å•†å“çš„è´­ä¹°è®°å½•:purchase_goods_1000</span></span><br><span class="line"><span class="comment">--KEYS[2] å•†å“çš„key:goods_1000</span></span><br><span class="line"><span class="comment">--ARGV[1] è´­ä¹°äººå”¯ä¸€æ ‡è¯†memberId:2000</span></span><br><span class="line"><span class="comment">--ARGV[2] è´­ä¹°æ•°é‡number: 2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> goodsExists=redis.call(<span class="string">'EXISTS'</span>, KEYS[<span class="number">2</span>])</span><br><span class="line"><span class="keyword">if</span> goodsExists == <span class="number">0</span></span><br><span class="line"><span class="keyword">then</span> </span><br><span class="line"> <span class="comment">-- äº§å“ä¸å­˜åœ¨</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">local</span> goodsStockExists=redis.call(<span class="string">'hexists'</span>, KEYS[<span class="number">2</span>], <span class="string">'stock'</span>)</span><br><span class="line"><span class="keyword">if</span> goodsStockExists == <span class="number">0</span> </span><br><span class="line"><span class="keyword">then</span> </span><br><span class="line">   <span class="comment">-- ä»£è¡¨äº§å“åº“å­˜ä¸å­˜åœ¨</span></span><br><span class="line"> <span class="keyword">return</span> <span class="number">-2</span></span><br><span class="line"><span class="keyword">end</span> </span><br><span class="line"><span class="comment">--ç”¨æˆ·é™è´­æ•°é‡</span></span><br><span class="line"><span class="keyword">local</span> purchaseLimitExists=redis.call(<span class="string">'hexists'</span>, KEYS[<span class="number">2</span>], <span class="string">'purchaseLimit'</span>)</span><br><span class="line"><span class="keyword">if</span> purchaseLimitExists == <span class="number">0</span></span><br><span class="line"><span class="keyword">then</span> </span><br><span class="line"><span class="comment">-- å•†å“é™è´­æ•°é‡ä¸å­˜åœ¨</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">-3</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">--ç”¨æˆ·é™è´­æ•°é‡</span></span><br><span class="line"><span class="keyword">local</span> purchaseLimit=<span class="built_in">tonumber</span>(redis.call(<span class="string">'hget'</span>, KEYS[<span class="number">2</span>], <span class="string">'purchaseLimit'</span>))</span><br><span class="line"><span class="comment">--ç”¨æˆ·å·²ç»è´­ä¹°çš„æ•°é‡</span></span><br><span class="line"><span class="keyword">local</span> purchasedNumber=redis.call(<span class="string">'ZSCORE'</span>, KEYS[<span class="number">1</span>], ARGV[<span class="number">1</span>])</span><br><span class="line"><span class="comment">--è´­ä¹°æ•°é‡ä¸å­˜åœ¨åˆ™é»˜è®¤ä¸º0</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> purchasedNumber</span><br><span class="line"><span class="keyword">then</span> </span><br><span class="line">   purchasedNumber = <span class="number">0</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">-- ç”¨æˆ·ç°åœ¨è¦è´­ä¹°çš„æ•°é‡</span></span><br><span class="line"><span class="keyword">local</span> nowPurchasedNumber = <span class="built_in">tonumber</span>(ARGV[<span class="number">2</span>])</span><br><span class="line"><span class="comment">-- ç”¨æˆ·å°†è¦è´­ä¹°çš„æ€»æ•°é‡</span></span><br><span class="line"><span class="keyword">local</span> totalPurchaseNumber = nowPurchasedNumber+purchasedNumber</span><br><span class="line"><span class="keyword">if</span> purchaseLimit &lt; totalPurchaseNumber</span><br><span class="line"><span class="keyword">then</span> </span><br><span class="line"><span class="comment">-- ç”¨æˆ·è´­ä¹°æ•°é‡è¶…è¿‡äº†é™è´­æ•°é‡</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">-4</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">local</span> stock=<span class="built_in">tonumber</span>(redis.call(<span class="string">'hget'</span>, KEYS[<span class="number">2</span>], <span class="string">'stock'</span>))</span><br><span class="line"><span class="keyword">if</span> stock &lt;= <span class="number">0</span></span><br><span class="line"><span class="keyword">then</span> </span><br><span class="line">  <span class="comment">-- åº“å­˜ä¸º0</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">if</span> stock &lt; nowPurchasedNumber</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line"> <span class="comment">-- åº“å­˜ä¸è¶³</span></span><br><span class="line"> <span class="keyword">return</span> <span class="number">2</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--æ‰£å‡å•†å“åº“å­˜</span></span><br><span class="line">redis.call(<span class="string">'hincrby'</span>, KEYS[<span class="number">2</span>], <span class="string">'stock'</span>, -nowPurchasedNumber)</span><br><span class="line"><span class="comment">-- æ›´æ–°ç”¨æˆ·çš„æ€»è´­ä¹°æ•°é‡</span></span><br><span class="line">redis.call(<span class="string">'zadd'</span>,KEYS[<span class="number">1</span>], totalPurchaseNumber, ARGV[<span class="number">1</span>])</span><br><span class="line"><span class="comment">-- ç”¨æˆ·è´­ä¹°æˆåŠŸ</span></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span></span><br></pre></td></tr></table></figure><blockquote><ol><li>å°½ç®¡Luaä¼šæä¾›å­—ç¬¦ä¸²å’Œæ•°å­—çš„è‡ªåŠ¨è½¬æ¢ï¼Œä½†æ˜¯æ›´å¥½è¿˜æ˜¯è½¬æ¢ä¸€ä¸‹ã€‚tonumberå°±æ˜¯æŠŠå­—ç¬¦ä¸²æ•°å­—è½¬æ¢æˆæ•°å­—çš„å‡½æ•°ã€‚</li><li>redis.callæ˜¯ç”¨æ¥æ‰§è¡Œrediså‡½æ•°çš„æ–¹æ³•ã€‚</li><li>ä¸Šè¿°çš„è„šæœ¬å¯ä»¥é€šè¿‡EVALã€EVALSHAæˆ–è€…redis-cli å‚æ•°çš„å½¢å¼æ‰§è¡Œã€‚ä½†æ˜¯ä¸Šé¢çš„è„šæœ¬å·²ç»æ ¼å¼åŒ–äº†ï¼Œæœ€å¥½è¿˜æ˜¯ä»¥åé¢çš„æ–¹å¼è¿è¡Œã€‚</li><li>Luaçš„æ³¨é‡Šæ˜¯ä»¥ â€“ å¼€å¤´ä½œä¸ºå•è¡Œæ³¨é‡Š</li></ol></blockquote><p>å…·ä½“æ‰§è¡Œæ¼”ç¤ºå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Sam-Mac:Downloads Sam$ rediscli --eval  /Users/sam/Downloads/seckill.lua  purchase_goods_3000 seckill:goods:1000 , 202 1</span><br><span class="line">(integer) 0</span><br><span class="line">Sam-Mac:Downloads Sam$</span><br></pre></td></tr></table></figure><ul><li><p>â€“evalå‚æ•°æ˜¯å‘Šè¯‰rediscli(è¿™ä¸ªæ˜¯è‡ªå®šä¹‰redis-cliå‘½ä»¤çš„åœ°å€)è¯»å–å¹¶è¿è¡Œåé¢çš„Luaè„šæœ¬ã€‚</p></li><li><p>/Users/sam/Downloads/seckill.lua æ˜¯è„šæœ¬çš„ä½ç½®ï¼Œåé¢è·Ÿç€æ˜¯ä¼ ç»™Luaè„šæœ¬çš„å‚æ•°ã€‚</p></li><li><p>é€—å·â€,â€å‰çš„purchase_goods_3000 seckill:goods:1000 æ˜¯è¦æ“ä½œçš„é”®ï¼Œå¯ä»¥åœ¨è„šæœ¬ä¸­ç”¨KEYS[1]ã€KEYS[2]è·å–ï¼Œé€—å·â€,â€åé¢çš„202å’Œ1æ˜¯å‚æ•°ï¼Œåœ¨è„šæœ¬ä¸­èƒ½å¤Ÿä½¿ç”¨ARGV[1]å’ŒARGV[2]è·å¾—ã€‚</p></li></ul><blockquote><p>æ³¨æ„â€,â€é€—å·ä¸¤è¾¹çš„ç©ºæ ¼ä¸èƒ½çœç•¥ï¼Œå¦åˆ™ä¼šå‡ºé”™</p></blockquote><p>åœ¨Redisä¸­è°ƒç”¨Luaè„šæœ¬ï¼Œä¹Ÿæ˜¯å¯ä»¥è°ƒè¯•çš„ã€‚Redis ä» v3.2.0 å¼€å§‹æ”¯æŒ Lua debuggerï¼Œå¯ä»¥åŠ æ–­ç‚¹ã€print å˜é‡ä¿¡æ¯ã€å±•ç¤ºæ­£åœ¨æ‰§è¡Œçš„ä»£ç ã€‚å¯ä»¥åœ¨å‘½ä»¤ä¸­æ·»åŠ â€“ldbè¿›è¡Œè°ƒè¯•ï¼Œè¿™ä¸ªå‚æ•°æ˜¯å¼€å¯ Lua dubegger çš„æ„æ€ï¼Œè¿™ä¸ªæ¨¡å¼ä¸‹Redisä¼š fork ä¸€ä¸ªè¿›ç¨‹è¿›å…¥éš”ç¦»ç¯å¢ƒï¼Œä¸ä¼šå½±å“Redisæ­£å¸¸æä¾›æœåŠ¡ï¼Œä½†è°ƒè¯•æœŸé—´ï¼ŒåŸå§‹ redis æ‰§è¡Œå‘½ä»¤ã€è„šæœ¬çš„ç»“æœä¹Ÿä¸ä¼šä½“ç°åˆ° fork ä¹‹åçš„éš”ç¦»ç¯å¢ƒä¹‹ä¸­ã€‚å› æ­¤å‘¢ï¼Œè¿˜æœ‰å¦å¤–ä¸€ç§è°ƒè¯•æ¨¡å¼ â€“ldb-sync-modeï¼Œä¹Ÿå°±æ˜¯å‰é¢æåˆ°çš„åŒæ­¥æ¨¡å¼ï¼Œè¿™ä¸ªæ¨¡å¼ä¸‹ï¼Œä¼šé˜»å¡ redis ä¸Šæ‰€æœ‰çš„å‘½ä»¤ã€è„šæœ¬ï¼Œç›´åˆ°è„šæœ¬é€€å‡ºï¼Œå®Œå…¨æ¨¡æ‹Ÿäº†æ­£å¼ç¯å¢ƒä½¿ç”¨æ—¶å€™çš„æƒ…å†µï¼Œä½¿ç”¨çš„æ—¶å€™åŠ¡å¿…æ³¨æ„è¿™ç‚¹ã€‚</p><p>æ·»åŠ å’Œåˆ é™¤æ–­ç‚¹å¾ˆç®€å•ï¼Œåªéœ€ä½¿ç”¨<code>b 1 2 3 4</code>åœ¨ç¬¬1,2,3,4è¡Œæ·»åŠ <code>b 0</code>æ–­ç‚¹ã€‚è¯¥å‘½ä»¤å°†åˆ é™¤æ‰€æœ‰æ–­ç‚¹ã€‚å¯ä»¥ä½¿ç”¨aså‚æ•°åˆ é™¤é€‰å®šçš„æ–­ç‚¹ï¼Œå³æˆ‘ä»¬è¦åˆ é™¤çš„æ–­ç‚¹æ‰€åœ¨çš„è¡Œï¼Œä½†å‰ç¼€ä¸ºå‡å·ã€‚ä¾‹å¦‚<code>b -3</code>ï¼Œä»ç¬¬3è¡Œä¸­åˆ é™¤æ–­ç‚¹ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Sam-Mac:Downloads Sam$ rediscli --ldb --eval  /Users/sam/Downloads/seckill.lua  purchase_goods_3000 seckill:goods:1000 , 202 1</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20201224234757.png" alt="è°ƒè¯•Luaè„šæœ¬"></p><p>ä¸Šé¢å°±æ˜¯ä»Šæ—¥æ–‡ç« çš„æ‰€ä»¥å†…å®¹ï¼Œè¿™æ ·çœ‹èµ·æ¥æ˜¯ä¸æ˜¯è§‰å¾—Luaè„šæœ¬ä¹Ÿæ˜¯æŒºå®¹æ˜“çš„å§ï¼</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨ç§’æ€è¿™ç§é«˜å¹¶å‘ã€å¤§æµé‡çš„åœºæ™¯ä¸‹ï¼Œåˆ©ç”¨æ•°æ®åº“è¿›è¡Œåº“å­˜æ‰£å‡ã€æ•°æ®æŸ¥è¯¢è¿™ç§æƒ³æ³•å°±ä¸è¦è€ƒè™‘äº†ã€‚ä½ è¦æ˜¯æœ‰è¿™ç§æƒ³æ³•ï¼ŒåŠä½ æ—©ç‚¹æ”¾å¼ƒï¼ŒP0äº‹æ•…ä¸€å®šåœ¨ç­‰ç€ä½ ã€‚ä¹‹å‰ç”¨Luaè„šæœ¬å®ç°ç§’æ€åœºæ™¯ä¸‹çš„åº“å­˜æ‰£å‡æ„Ÿè§‰å¾ˆä¸é”™ï¼Œé…åˆRedisç§’æ€æ•ˆæœæ æ çš„ï¼Redis 2.6 ç‰ˆæœ¬é€šè¿‡å†…åµŒæ”¯æŒ Lua ç¯å¢ƒï¼Œä¼šå•çº¿ç¨‹åŸå­æ€§æ‰§è¡Œ Lua è„šæœ¬ï¼Œä¿è¯ Lua è„šæœ¬åœ¨å¤„ç†çš„è¿‡ç¨‹ä¸­ä¸ä¼šè¢«ä»»æ„å…¶å®ƒè¯·æ±‚æ‰“æ–­ã€‚&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="redis" scheme="https://ydstudios.gitee.io/tags/redis/"/>
    
      <category term="lua" scheme="https://ydstudios.gitee.io/tags/lua/"/>
    
      <category term="ç§’æ€" scheme="https://ydstudios.gitee.io/tags/%E7%A7%92%E6%9D%80/"/>
    
  </entry>
  
  <entry>
    <title>MySQLçš„IGNOREå…³é”®å­—åœ¨é¿å…é‡å¤æ’å…¥è®°å½•æ—¶å­˜åœ¨çš„é—®é¢˜åŠæœ€ä½³å®è·µ</title>
    <link href="https://ydstudios.gitee.io/post/cef7abb0.html"/>
    <id>https://ydstudios.gitee.io/post/cef7abb0.html</id>
    <published>2020-12-16T21:57:39.000Z</published>
    <updated>2021-01-23T08:01:44.000Z</updated>
    
    <content type="html"><![CDATA[<p>æˆ‘ä»¬åœ¨å®é™…å¼€å‘ä¸­æ€»æœ‰è¿™æ ·çš„éœ€æ±‚ï¼Œè¡¨é‡Œçš„æ•°æ®è¦ä¿æŒå”¯ä¸€ï¼Œæ‰€ä»¥æˆ‘ä»¬å¼€å‘ä¸­ç»å¸¸éƒ½æ˜¯å…ˆæŸ¥è¯¢è¿™æ ·çš„æ•°æ®æœ‰æ²¡æœ‰ï¼Œæœ‰çš„è¯è·³è¿‡ï¼Œæ²¡æœ‰çš„è¯å†æ’å…¥ï¼Œç„¶ååœ¨èƒ½è¡¨ç¤ºæ•°æ®è®°å½•å”¯ä¸€çš„åˆ—ä¸ŠåŠ ä¸Šå”¯ä¸€ç´¢å¼•è¿›è¡Œå…œåº•ã€‚è™½ç„¶æœ‰çš„åŒå­¦åŸºæœ¬ä¸Šä¹Ÿæ˜¯è¿™ä¹ˆåšçš„ï¼Œä½†æ˜¯åˆç¨å¾®çš„åšäº†ä¸€ç‚¹å…¶ä»–çš„éªšæ“ä½œğŸ˜„ğŸ˜„ğŸ˜„ã€‚</p><a id="more"></a><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ğŸ˜„ğŸ˜„ğŸ˜„ éªšæ“ä½œ, å½“æœ‰é‡å¤è®°å½•å°±ä¼šå¿½ç•¥é”™è¯¯è¿”å›å½±å“è¡Œæ•°0</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">IGNORE</span> <span class="keyword">INTO</span> tableName <span class="keyword">VALUES</span> ()</span><br></pre></td></tr></table></figure><p>æœ‰çš„åŒå­¦æ˜¯è¿™ä¹ˆæƒ³çš„ï¼Œåœ¨é«˜å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œå…ˆæŸ¥è¯¢å†æ’å…¥çš„è¯æ˜¯æœ‰å¹¶å‘çš„é—®é¢˜çš„ï¼Œæˆ‘ç›´æ¥åœ¨é‡å¤æ’å…¥çš„æ—¶å€™å±è”½é”™è¯¯ï¼Œä¸ç”¨æ•è·æˆ–è€…æŠ›å‡ºå¼‚å¸¸ï¼Œç›´æ¥ç”¨ insert çš„è¿”å›å½±å“è¡Œæ•°æ¥åˆ¤æ–­æ’å…¥æ˜¯å¦æˆåŠŸã€‚è¿™æ ·çš„åšæ³•çœ‹ä¸Šå»æ„Ÿè§‰æ²¡å•¥é—®é¢˜ï¼Œå…¶å®è¿˜æ˜¯æœ‰å¾ˆå¤§çš„é—®é¢˜çš„ã€‚</p><h6 id="è¯­ä¹‰ä¸Šçš„ä¸æ­£ç¡®"><a href="#è¯­ä¹‰ä¸Šçš„ä¸æ­£ç¡®" class="headerlink" title="è¯­ä¹‰ä¸Šçš„ä¸æ­£ç¡®"></a>è¯­ä¹‰ä¸Šçš„ä¸æ­£ç¡®</h6><p>ä½ åœ¨è¡¨ä¸­å®šä¹‰äº†å”¯ä¸€ç´¢å¼•ï¼Œæ’å…¥é‡å¤çš„è®°å½•ç›´æ¥å±è”½äº†é”™è¯¯ï¼Œè¿™å°±é€ æˆå¼‚å¸¸è¢«åæ‰äº†ï¼Œå¯¼è‡´åŠŸèƒ½æœ‰æ•°æ®é‡å¤çš„bugå°±æ— æ³•é€šè¿‡å¼‚å¸¸æ—¥å¿—æ¥å®šä½ã€‚</p><h6 id="ç ´åMySQLä¸»ä»çš„æ•°æ®ä¸€è‡´æ€§"><a href="#ç ´åMySQLä¸»ä»çš„æ•°æ®ä¸€è‡´æ€§" class="headerlink" title="ç ´åMySQLä¸»ä»çš„æ•°æ®ä¸€è‡´æ€§"></a>ç ´åMySQLä¸»ä»çš„æ•°æ®ä¸€è‡´æ€§</h6><p>åœ¨è¯´è¿™ä¸ªIGNOREæ˜¯å¦‚ä½•é€ æˆ MySQL ä¸»ä»æ•°æ®ä¸ä¸€è‡´çš„åŸå› ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆè¯´è¯´ MySQL ä¸­çš„ä¸€ä¸ªä½œä¸ºå¼€å‘å¾ˆå°‘å¬è¯´çš„ä¸€ä¸ªè¡¨çº§é”ï¼š<strong>AUTO-INCé”</strong>ï¼ˆå³è‡ªå¢é”ï¼‰ã€‚</p><p>åœ¨ä½¿ç”¨ MySQL çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºè¡¨çš„æŸä¸€åˆ—æ·»åŠ  AUTO_INCREMENTå±æ€§ï¼Œåœ¨æ’å…¥è®°å½•æ—¶è¯¥åˆ—å¯ä»¥ä¸æŒ‡å®šï¼ŒMySQL ä¼šè‡ªåŠ¨ä¸ºè¯¥åˆ—èµ‹äºˆä¸€ä¸ªé€’å¢çš„å€¼ã€‚MySQL è‡ªåŠ¨ç»™AUTO_INCREMENTä¿®é¥°çš„åˆ—è¿›è¡Œé€’å¢èµ‹å€¼çš„å®ç°æ–¹å¼ä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ä¸ªï¼š</p><ul><li><p>é‡‡ç”¨ AUTO_INCé”ï¼Œåœ¨æ‰§è¡Œæ’å…¥è¯­å¥æ—¶å°±åŠ ä¸€ä¸ªè¡¨çº§åˆ«çš„AUTO_INCé”ï¼Œç„¶åä¸ºæ¯æ¡å¾…æ’å…¥çš„è®°å½•åˆ†é…é€’å¢å€¼ã€‚åœ¨è¯­å¥æ‰§è¡Œç»“æŸåï¼Œå†æŠŠAUTO_INCé”é‡Šæ”¾ã€‚æ‰€ä»¥åœ¨ä¸€ä¸ªäº‹åŠ¡æŒæœ‰AUTO_INCé”çš„è¿‡ç¨‹ä¸­ï¼Œå…¶ä»–æ’å…¥è¯­å¥éƒ½è¦é˜»å¡ï¼Œä»è€Œä¿è¯ä¸€ä¸ªè¯­å¥åˆ†é…çš„é€’å¢å€¼æ˜¯è¿ç»­çš„ã€‚</p></li><li><p>é‡‡ç”¨ä¸€ä¸ªè½»é‡çº§çš„é”ï¼Œåœ¨ä¸ºINSERTè¯­å¥ç”Ÿæˆé€’å¢å€¼æ—¶è·å–è¿™ä¸ªè½»é‡çº§çš„é”ï¼Œç„¶ååœ¨ç”Ÿæˆæœ¬æ¬¡æ’å…¥è¯­å¥éœ€è¦ç”¨åˆ°çš„é€’å¢å€¼åå°±æŠŠè½»é‡çº§é”é‡Šæ”¾æ‰ï¼Œä¸éœ€è¦ç­‰åˆ°æ•´ä¸ªæ’å…¥è¯­å¥æ‰§è¡Œå®Œæ‰é‡Šæ”¾é”ã€‚</p></li></ul><p>å¦‚æœæˆ‘ä»¬çš„æ’å…¥è¯­å¥åœ¨æ‰§è¡Œå‰å°±å¯ä»¥ç¡®å®šå…·ä½“è¦æ’å…¥å¤šå°‘æ¡è®°å½•ï¼Œæ¯”å¦‚ </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">test</span>(a) <span class="keyword">VALUES</span> (<span class="string">'1'</span>),(<span class="string">'b'</span>);</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶æˆ‘ä»¬å¯ä»¥åœ¨æ‰§è¡Œå‰å°±ç¡®å®šè¦æ’å…¥2æ¡è®°å½•ï¼Œé‚£ä¹ˆä¸€èˆ¬é‡‡ç”¨è½»é‡çº§é”çš„æ–¹å¼å¯¹ AUTO_INCREMENTä¿®é¥°çš„åˆ—è¿›è¡Œèµ‹å€¼ï¼Œç”¨è¿™ç§æ–¹å¼å¯ä»¥é¿å…é”å®šè¡¨ï¼Œå¯ä»¥æé«˜æ’å…¥æ€§èƒ½ã€‚</p><blockquote><p>Mysql æä¾›äº†ä¸€ä¸ªåä¸º innodb_atuoinc_lock_mode çš„ç³»ç»Ÿå˜é‡ï¼Œæ¥æ§åˆ¶ MySQLä½¿ç”¨ä¸Šè¿°çš„ä¸¤ç§æ–¹å¼ä¸­çš„å“ªä¸€ä¸­æ¥ä¸º AUTO_INCREMENTä¿®é¥°çš„åˆ—è¿›è¡Œèµ‹å€¼ã€‚</p></blockquote><ul><li>å½“ innodb_atuoinc_lock_mode çš„å€¼ä¸º0æ—¶ï¼Œä¸€å¾‹é‡‡ç”¨AUTO_INCé”ï¼›</li><li>å½“ innodb_atuoinc_lock_mode çš„å€¼ä¸º1æ—¶ï¼Œä¸¤ç§æ–¹å¼æ··åˆä½¿ç”¨ï¼Œæ’å…¥è®°å½•ç¡®å®šæ—¶é‡‡ç”¨è½»é‡çº§é”ï¼Œä¸ç¡®å®šæ—¶ä½¿ç”¨AUTO_INCé”ã€‚</li><li>å½“ innodb_atuoinc_lock_mode çš„å€¼ä¸º2æ—¶ï¼Œä¸€å¾‹é‡‡ç”¨è½»é‡çº§é”ï¼›<blockquote><p>å½“innodb_autoinc_lock_mode=0æ—¶ï¼Œåªæœ‰æ’å…¥æˆåŠŸä¹‹åï¼ŒAUTO_INCREMENT å€¼æ‰ä¼šé€’å¢ï¼Œæ’å…¥å¤±è´¥ä¸ä¼šé€’å¢ã€‚<br>å½“innodb_autoinc_lock_mode=1æ—¶ï¼Œæ— è®ºæ’å…¥æ˜¯å¦æˆåŠŸï¼ŒAUTO_INCREMENTçš„å€¼éƒ½ä¼šé€’å¢ã€‚<br>å½“innodb_atuoinc_lock_modeä¸º2æ—¶ï¼Œå¯èƒ½ä¼šé€ æˆä¸åŒäº‹ç‰©ä¸­çš„æ’å…¥è¯­å¥ä¸ºAUTO_INCREMENTä¿®é¥°çš„åˆ—ç”Ÿçš„å€¼æ˜¯äº¤å‰çš„ï¼Œè¿™åœ¨ä¸»ä»å¤åˆ¶çš„åœºæ™¯æ˜¯ä¸å®‰å…¨çš„ã€‚<sup>[1]</sup></p></blockquote></li></ul><p>æˆ‘æŸ¥çœ‹è¿‡æˆ‘ç›®å‰è´Ÿè´£çš„ç³»ç»Ÿï¼ŒMySQL é‡‡ç”¨çš„æ˜¯ä¸»ä»æ¨¡å¼ï¼Œéš”ç¦»çº§åˆ«è®¾ç½®çš„æ˜¯è¯»å·²æäº¤(Read Committed)ï¼Œbinlogçš„æ ¼å¼è®¾ç½®ä¸º ROWï¼Œ innodb_atuoinc_lock_modeè®¾ç½®çš„æ˜¯1ï¼Œä¹Ÿå°±æ˜¯è¯´æ— è®ºæ’å…¥æˆåŠŸä¸å¦ AUTO_INCREMENT çš„å€¼éƒ½ä¼šé€’å¢ã€‚åœ¨æœ¬åœ°æ­å»ºçš„ä¸»ä»æ¨¡å¼çš„ mysqlï¼ˆå®‰è£…æœ¬äººåšå®¢ä¸­ä¹‹å‰çš„æ–‡ç« æ­å»ºçš„ MySQLä¸»ä»ï¼‰ ä¸­çš„masteråº“ æ–°å»ºä¸€ä¸ªå¦‚ä¸‹çš„è¡¨ï¼š</p><p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20201218232257.png" alt="è¡¨ç»“æ„å’Œå¯¹åº”çš„è‡ªå¢å€¼"></p><p>æŸ¥çœ‹ä¸€ä¸‹ slave3307æ•°æ®åº“ä¸­å¯¹åº”çš„è¡¨ç»“æ„å’Œè‡ªå¢å€¼ï¼šç¡®å®šå’Œ master ä¸€è‡´</p><p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20201218232602.png" alt="slave3307æ•°æ®åº“ä¸­å¯¹åº”çš„è¡¨ç»“æ„å’Œè‡ªå¢å€¼"></p><p>åœ¨ masteråº“ä¸Šæ‰§è¡Œ show master status æŸ¥çœ‹ master çš„binglog ä¿¡æ¯ï¼š</p><p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20201218232902.png" alt="master çš„binglog ä¿¡æ¯"></p><p>åœ¨ master åº“ä¸Šè¿ç»­æ‰§è¡Œä¸‹å›¾çš„ä¸‰ä¸ª SQLï¼Œè§‚å¯Ÿ  master ä¸ salve çš„æƒ…å†µã€‚</p><p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20201218233357.png" alt="ä¸‰ä¸ª SQL"></p><p>master çš„è¡¨çš„AUTO_INCREMENTå€¼å·²ç»å‘ç”Ÿäº†å˜åŒ–ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20201218233623.png" alt="è¡¨çš„è‡ªå¢å€¼å‘ç”Ÿäº†å˜åŒ–"></p><p>master çš„ binglog å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20201218233929.png" alt="master çš„ binglog"></p><p>æˆ‘ä»¬ä»ä¸Šé¢ä¸¤ä¸ªå›¾å¯ä»¥å‘ç°ï¼Œä½¿ç”¨ignoreå…³é”®å­—ï¼Œå°½ç®¡å¾…æ’å…¥çš„è®°å½•å› ä¸ºå”¯ä¸€é”®å†²çªè€Œæ²¡æœ‰æ’å…¥æˆåŠŸï¼Œä½†AUTO_INCREMENTå€¼å´é€’å¢äº†ï¼Œè€Œä¸” binlog ä¸­ä¹Ÿæ²¡æœ‰ INSERT IGNORE è¯­å¥æ—¥å¿—ï¼Œè¿™å¾ˆæ˜æ˜¾å¯¼è‡´æ•°æ®åº“ slave ä¸ä¼šæ‰§è¡Œè¯¥è¯­å¥ï¼Œå¯¼è‡´æ•°æ®åº“ slaveæ•°æ®åº“ä¸­çš„è¡¨çš„ä¸»é”®å’Œ master æ•°æ®åº“ä¸­çš„è¡¨ä¸»é”®ä¸ä¸€è‡´ï¼</p><p>æˆ‘ä»¬ç”±æ­¤å¯ä»¥å¤§èƒ†çš„çŒœæµ‹ä¸€ä¸‹ IGNORE çš„å®ç°æœºåˆ¶ï¼š</p><p>1ã€å°è¯•æŠŠæ–°è¡Œæ’å…¥åˆ°è¡¨ä¸­ ï¼›</p><p>2ã€å¦‚æœæ’å…¥æˆåŠŸåˆ™è¿”å›æ­£å¸¸çš„å½±å“è¡Œæ•°ï¼›å¦‚æœå”¯ä¸€é”®å†²çªï¼ˆé”™è¯¯ï¼‰åˆ™å¿½ç•¥è¯¥é”™è¯¯ï¼Œè¿”å›å½±å“è¡Œæ•°ä¸º0 ï¼›</p><p>åœ¨å®é™…ç”Ÿäº§ç¯å¢ƒä¸­ä¸šåŠ¡ä¸Šæ˜¯éœ€è¦å½“å‡ºç°å”¯ä¸€é”®å†²çªæ—¶å‘ç”Ÿé‡å¤è¦æŠ›å‡ºå¼‚å¸¸è€Œä¸æ˜¯åæ‰å¼‚å¸¸ï¼Œè¿™ä¸ªå‰é¢ä¹Ÿæœ‰è¯´åˆ°ã€‚æ­¤å¤–ï¼Œç”±ä¸Šé¢çš„æ‰§è¡Œè¿‡ç¨‹å¯çŸ¥ï¼Œæˆ‘ä»¬æœŸæœ›æ’å…¥çš„è®°å½•å› ä¸ºå”¯ä¸€é”®å†²çªè€Œæ²¡æœ‰æ’å…¥æˆåŠŸï¼Œä½†AUTO_INCREMENTå­—æ®µå€¼å´é€’å¢äº†ã€‚å› ä¸ºæ’å…¥è¯­å¥å¹¶æœªæ‰§è¡ŒæˆåŠŸï¼Œåœ¨binlogä¸­å¹¶ä¸ä¼šæœ‰æ‰§è¡Œè®°å½•ï¼Œè¿™æ„å‘³ç€ä»åº“çš„AUTO_INCREMENTå­—æ®µå€¼ä¸ä¼šé€’å¢ï¼Œå³ä¸»åº“å’Œä»åº“çš„AUTO_INCREMENTå€¼å‡ºç°äº†ä¸ä¸€è‡´ã€‚è¿™å¸¦æ¥çš„é—®é¢˜æ˜¯ï¼Œåç»­å¦‚æœå› ä¸ºä¸»åº“å‘ç”Ÿæ•…éšœè€Œå‘ç”Ÿä¸»ä»åˆ‡æ¢ï¼Œä»åº“çš„AUTO_INCREMENTå€¼è½åäºä¸»åº“ï¼Œå°±ä¼šå¯¼è‡´ä¸€æ®µæ—¶é—´å†…åœ¨åŸä»åº“ç°ä¸»åº“æ’å…¥çš„æ•°æ®åœ¨åŸä¸»åº“ç°ä»åº“ä¸Šå› ä¸ºAUTO_INCREMENTä¸»é”®å†²çªè€Œå¯¼è‡´æ’å…¥å¤±è´¥ï¼Œè¿™ä¸ªè‚¯å®šæ˜¯ç”¨<code>INSERT IGNORE</code>ä¹‹å‰æ²¡æœ‰æƒ³åˆ°çš„ï¼Œæ‰€ä»¥å»ºè®®åœ¨å®é™…å¼€å‘ä¸­ä¸è¦ä½¿ç”¨æ­¤ç§éªšæ“ä½œğŸ˜„ğŸ˜„ğŸ˜„</p><blockquote><p>InnoDBè¡¨insertè¯­å¥ä¸»è¦åˆ†ä¸ºä¸‰ç§ç±»å‹ï¼š</p><ul><li><p>Simple insert(ç®€å•æ’å…¥)<br>å¯ä»¥é€šè¿‡è¯­å¥é¢„å…ˆåˆ¤æ–­æ’å…¥çš„è¡Œæ•°ã€‚åŒ…æ‹¬ä¸åŒ…å«å­æŸ¥è¯¢çš„å•è¡Œã€å¤šè¡Œ <code>INSERT</code> å’Œ <code>REPLACE</code> è¯­å¥ï¼Œè¿˜æœ‰è¯­å¥<code>INSERT ... ON DUPLICATE KEY UPDATE</code>ã€‚</p></li><li><p>Bulk inserts(å¤§é‡æ’å…¥)<br>æ— æ³•é€šè¿‡è¯­å¥é¢„å…ˆåˆ¤æ–­æ’å…¥çš„è¡Œæ•°ã€‚åŒ…æ‹¬<code>INSERT ... SELECT</code>ã€<code>REPLACE ... SELECT &gt;</code>å’Œ<code>LOAD DATA</code>è¯­å¥ã€‚InnoDBæ¯å¤„ç†ä¸€è¡Œæ‰ä¼šä¸º AUTO_INCREMENT åˆ—åˆ†é…ä¸€ä¸ªå€¼ã€‚</p></li><li><p>Mixed-mode inserts(æ··åˆæ¨¡å¼æ’å…¥)<br>åœ¨ç®€å•æ’å…¥è¯­å¥å½“ä¸­ï¼Œæœ‰çš„è¡Œæœ‰ä¸ºè‡ªå¢åˆ—æŒ‡å®šå€¼ï¼Œè€Œæœ‰çš„è¡Œæ²¡æœ‰ä¸ºè‡ªå¢åˆ—æŒ‡å®šå€¼ã€‚</p></li></ul></blockquote><p><strong>ä¾‹å¦‚:æ··åˆæ¨¡å¼æ’å…¥</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># idåˆ—ä½œä¸ºè‡ªå¢åˆ—</span></span><br><span class="line"> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> t1 (<span class="keyword">id</span>,c1,c2) <span class="keyword">VALUES</span> (<span class="number">1</span>,<span class="number">1</span>,<span class="string">'a'</span>), (<span class="literal">NULL</span>,<span class="literal">NULL</span>,<span class="string">'b'</span>), (<span class="number">10</span>,<span class="number">5</span>,<span class="string">'c'</span>), (<span class="literal">NULL</span>,<span class="literal">NULL</span>,<span class="string">'d'</span>) ;</span><br></pre></td></tr></table></figure><ul><li>[1] <a href="https://ydstudios.gitee.io/post/cef7abb0.html">å‚è€ƒã€ŠMySQLæ˜¯æ€æ ·è¿è¡Œçš„ã€‹411é¡µ</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æˆ‘ä»¬åœ¨å®é™…å¼€å‘ä¸­æ€»æœ‰è¿™æ ·çš„éœ€æ±‚ï¼Œè¡¨é‡Œçš„æ•°æ®è¦ä¿æŒå”¯ä¸€ï¼Œæ‰€ä»¥æˆ‘ä»¬å¼€å‘ä¸­ç»å¸¸éƒ½æ˜¯å…ˆæŸ¥è¯¢è¿™æ ·çš„æ•°æ®æœ‰æ²¡æœ‰ï¼Œæœ‰çš„è¯è·³è¿‡ï¼Œæ²¡æœ‰çš„è¯å†æ’å…¥ï¼Œç„¶ååœ¨èƒ½è¡¨ç¤ºæ•°æ®è®°å½•å”¯ä¸€çš„åˆ—ä¸ŠåŠ ä¸Šå”¯ä¸€ç´¢å¼•è¿›è¡Œå…œåº•ã€‚è™½ç„¶æœ‰çš„åŒå­¦åŸºæœ¬ä¸Šä¹Ÿæ˜¯è¿™ä¹ˆåšçš„ï¼Œä½†æ˜¯åˆç¨å¾®çš„åšäº†ä¸€ç‚¹å…¶ä»–çš„éªšæ“ä½œğŸ˜„ğŸ˜„ğŸ˜„ã€‚&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="mysql" scheme="https://ydstudios.gitee.io/tags/mysql/"/>
    
      <category term="ignore" scheme="https://ydstudios.gitee.io/tags/ignore/"/>
    
  </entry>
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼å­¦ä¹ ä¹‹æ¨¡æ¿å’Œç­–ç•¥æ¨¡å¼å®æˆ˜</title>
    <link href="https://ydstudios.gitee.io/post/c14af19a.html"/>
    <id>https://ydstudios.gitee.io/post/c14af19a.html</id>
    <published>2020-12-04T21:41:34.000Z</published>
    <updated>2020-12-07T14:02:17.000Z</updated>
    
    <content type="html"><![CDATA[<p>å‰é¢æ–‡ç« ç”±æŠ½å¥–æ´»åŠ¨èµ é€ä¸åŒçš„å¥–åŠ±ä»è€Œå¼•å‡ºäº†ç­–ç•¥æ¨¡å¼ï¼Œå®šä¹‰ä¸€ä¸ªç­–ç•¥æ¥å£ï¼Œä¸åŒçš„å¥–åŠ±å‘æ”¾å®ç°ä¸åŒçš„ç­–ç•¥ã€‚å³ä½¿åç»­æ–°å¢åŠ å¥–åŠ±ç§ç±»ï¼Œåªè¦é‡æ–°å®ç°ä¸€ä¸ªç­–ç•¥å³å¯ï¼Œç¬¦åˆäº†è®¾è®¡æ¨¡å¼ä¸­çš„<em>å¼€é—­åŸåˆ™-å¯¹æ‰©å±•å¼€æ”¾å¯¹ä¿®æ”¹å…³é—­</em>ã€‚æˆ‘åœ¨ä¸€æ¬¡è®¢å•æ´»åŠ¨åŠŸèƒ½å¼€å‘ä¸­ä½¿ç”¨åˆ°äº†ç­–ç•¥æ¨¡å¼ï¼Œåœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­å‘ç°ï¼Œè®¢å•ç¬¦åˆæ´»åŠ¨æ¡ä»¶çš„åˆ¤æ–­ã€å‘æ”¾å¥–åŠ±ç»™ç”¨æˆ·ï¼Œå¯ä»¥æå‡åˆ°çˆ¶ç±»å®ç°ï¼Œå…·ä½“çš„æ¡ä»¶åˆ¤æ–­é€»è¾‘å¯ä»¥å»¶è¿Ÿåˆ°å­ç±»å»å®ç°ï¼Œä»è€Œå¼•å‡ºæœ¬ç¯‡æ–‡ç« çš„ä¸»é¢˜ï¼šæ¨¡æ¿æ¨¡å¼ã€‚</p><a id="more"></a><h6 id="æ¨¡æ¿æ¨¡å¼"><a href="#æ¨¡æ¿æ¨¡å¼" class="headerlink" title="æ¨¡æ¿æ¨¡å¼"></a>æ¨¡æ¿æ¨¡å¼</h6><p>åœ¨æ¨¡æ¿æ¨¡å¼ï¼ˆTemplate Patternï¼‰ä¸­ï¼Œä¸€ä¸ªæŠ½è±¡ç±»å…¬å¼€å®šä¹‰äº†æ‰§è¡Œå®ƒçš„æ–¹æ³•çš„æ–¹å¼/æ¨¡æ¿ã€‚å®ƒçš„å­ç±»å¯ä»¥æŒ‰éœ€è¦é‡å†™æ–¹æ³•å®ç°ï¼Œä½†è°ƒç”¨å°†ä»¥æŠ½è±¡ç±»ä¸­å®šä¹‰çš„æ–¹å¼è¿›è¡Œï¼Œè¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºè¡Œä¸ºå‹æ¨¡å¼ã€‚æ¨¡æ¿æ¨¡å¼ä¸­æ¶‰åŠåˆ°åœ¨çˆ¶ç±»å®ç°ç®—æ³•éª¨æ¶ï¼Œå…·ä½“æ­¥éª¤åœ¨å­ç±»å®ç°ï¼Œæ‰€ä»¥å¿…é¡»è¦æœ‰æŠ½è±¡ç±»ï¼ˆJava8ä¸­çš„æ¥å£çš„ default æ–¹æ³•è²Œä¼¼ä¹Ÿå¯ä»¥å®ç°ï¼‰ã€‚</p><h6 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h6><ul><li>æ„å›¾ï¼šå®šä¹‰ä¸€ä¸ªæ“ä½œä¸­çš„ç®—æ³•çš„éª¨æ¶ï¼Œè€Œå°†ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­ã€‚æ¨¡æ¿æ–¹æ³•ä½¿å¾—å­ç±»å¯ä»¥ä¸æ”¹å˜ä¸€ä¸ªç®—æ³•çš„ç»“æ„å³å¯é‡å®šä¹‰è¯¥ç®—æ³•çš„æŸäº›ç‰¹å®šæ­¥éª¤ã€‚</li><li>ä¸»è¦è§£å†³ï¼šä¸€äº›æ–¹æ³•é€šç”¨ï¼Œå´åœ¨æ¯ä¸€ä¸ªå­ç±»éƒ½é‡æ–°å†™äº†è¿™ä¸€æ–¹æ³•ã€‚</li><li>ä½•æ—¶ä½¿ç”¨ï¼šæœ‰ä¸€äº›é€šç”¨çš„æ–¹æ³•ã€‚</li><li>å¦‚ä½•è§£å†³ï¼šå°†è¿™äº›é€šç”¨ç®—æ³•æŠ½è±¡å‡ºæ¥ã€‚</li><li>å…³é”®ä»£ç ï¼šåœ¨æŠ½è±¡ç±»å®ç°ï¼Œå…¶ä»–æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»å®ç°ã€‚</li></ul><h6 id="åº”ç”¨å®ä¾‹ï¼š"><a href="#åº”ç”¨å®ä¾‹ï¼š" class="headerlink" title="åº”ç”¨å®ä¾‹ï¼š"></a>åº”ç”¨å®ä¾‹ï¼š</h6><ul><li>JDKä¸­ ReentrantLockä¸­å…¬å¹³é”å’Œéå…¬å¹³é”çš„å®ç° </li><li>Spring ä¸­å¯¹ Hibernate çš„æ”¯æŒï¼Œå°†ä¸€äº›å·²ç»å®šå¥½çš„æ–¹æ³•å°è£…èµ·æ¥ï¼Œæ¯”å¦‚å¼€å¯äº‹åŠ¡ã€è·å– Sessionã€å…³é—­ Session  ç­‰ï¼Œç¨‹åºå‘˜ä¸é‡å¤å†™é‚£äº›å·²ç»è§„èŒƒå¥½çš„ä»£ç ï¼Œç›´æ¥ä¸¢ä¸€ä¸ªå®ä½“å°±å¯ä»¥ä¿å­˜ã€‚</li></ul><h6 id="ä¼˜ç‚¹ï¼š"><a href="#ä¼˜ç‚¹ï¼š" class="headerlink" title="ä¼˜ç‚¹ï¼š"></a>ä¼˜ç‚¹ï¼š</h6><ul><li>å°è£…ä¸å˜éƒ¨åˆ†ï¼Œæ‰©å±•å¯å˜éƒ¨åˆ†ã€‚ </li><li>æå–å…¬å…±ä»£ç ï¼Œä¾¿äºç»´æŠ¤ã€‚ </li><li>è¡Œä¸ºç”±çˆ¶ç±»æ§åˆ¶ï¼Œå­ç±»å®ç°ã€‚</li></ul><h6 id="ç¼ºç‚¹ï¼š"><a href="#ç¼ºç‚¹ï¼š" class="headerlink" title="ç¼ºç‚¹ï¼š"></a>ç¼ºç‚¹ï¼š</h6><ul><li>æ¯ä¸€ä¸ªä¸åŒçš„å®ç°éƒ½éœ€è¦ä¸€ä¸ªå­ç±»æ¥å®ç°ï¼Œå¯¼è‡´ç±»çš„ä¸ªæ•°å¢åŠ ï¼Œä½¿å¾—ç³»ç»Ÿæ›´åŠ åºå¤§ã€‚</li></ul><h6 id="ä½¿ç”¨åœºæ™¯ï¼š"><a href="#ä½¿ç”¨åœºæ™¯ï¼š" class="headerlink" title="ä½¿ç”¨åœºæ™¯ï¼š"></a>ä½¿ç”¨åœºæ™¯ï¼š</h6><ul><li>æœ‰å¤šä¸ªå­ç±»å…±æœ‰çš„æ–¹æ³•ï¼Œä¸”é€»è¾‘ç›¸åŒã€‚ </li><li>é‡è¦çš„ã€å¤æ‚çš„æ–¹æ³•ï¼Œå¯ä»¥è€ƒè™‘ä½œä¸ºæ¨¡æ¿æ–¹æ³•ã€‚</li></ul><h6 id="æ³¨æ„äº‹é¡¹ï¼š"><a href="#æ³¨æ„äº‹é¡¹ï¼š" class="headerlink" title="æ³¨æ„äº‹é¡¹ï¼š"></a>æ³¨æ„äº‹é¡¹ï¼š</h6><blockquote><p> ä¸ºé˜²æ­¢æ¶æ„æ“ä½œï¼Œä¸€èˆ¬æ¨¡æ¿æ–¹æ³•éƒ½åŠ ä¸Š final å…³é”®è¯ã€‚</p></blockquote><h6 id="æœ¬æ–‡ç¤ºä¾‹UMLå›¾"><a href="#æœ¬æ–‡ç¤ºä¾‹UMLå›¾" class="headerlink" title="æœ¬æ–‡ç¤ºä¾‹UMLå›¾"></a>æœ¬æ–‡ç¤ºä¾‹UMLå›¾</h6><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20201204224522.png" alt="æ¨¡æ¿ã€ç­–ç•¥æ¨¡å¼ UML å›¾" style="zoom:40%;" /><h6 id="ä»£ç ç»“æ„å›¾"><a href="#ä»£ç ç»“æ„å›¾" class="headerlink" title="ä»£ç ç»“æ„å›¾"></a>ä»£ç ç»“æ„å›¾</h6><p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20201207220104.png" alt="ä»£ç ç»“æ„å›¾"></p><h6 id="ç¤ºä¾‹ä»£ç "><a href="#ç¤ºä¾‹ä»£ç " class="headerlink" title="ç¤ºä¾‹ä»£ç "></a>ç¤ºä¾‹ä»£ç </h6><p>1ã€ç­–ç•¥æ¥å£ï¼Œå®šä¹‰äº†ä¸€ä¸ªæ´»åŠ¨ç­–ç•¥éœ€è¦å®ç°çš„æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.ydstudio.flashsale.<span class="keyword">module</span>.pattern.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ydstudio.flashsale.common.Result;</span><br><span class="line"><span class="keyword">import</span> com.ydstudio.flashsale.<span class="keyword">module</span>.pattern.dto.ActiveOrderDto;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * æ´»åŠ¨æ¥å£</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/11/26</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.7.3</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IActiveHandle</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿”å›æ´»åŠ¨çš„ç±»å‹</span></span><br><span class="line"><span class="comment">     * ActiveCategoryEnum æšä¸¾</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">String <span class="title">getCategory</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿”å›æ´»åŠ¨çš„è¯¦ç»†ç±»å‹</span></span><br><span class="line"><span class="comment">     * ActiveCategoryDetailEnum æšä¸¾</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">String <span class="title">getCategoryDetail</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¢å•æ£€æŸ¥</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> temporaryOrderDto ä¸´æ—¶è®¢å•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> Result</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">Result <span class="title">checkOrder</span><span class="params">(ActiveOrderDto temporaryOrderDto)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2ã€æ´»åŠ¨æŠ½è±¡ç±»åŒ…å«è®¢å•è§„åˆ™æ˜¯å¦ç¬¦åˆçš„åˆ¤æ–­ä»¥åŠç¬¦åˆè§„åˆ™ä¹‹åå‘é€å¥–åŠ±çš„ç®—æ³•éª¨æ¶ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ydstudio.flashsale.<span class="keyword">module</span>.pattern.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ydstudio.flashsale.common.Result;</span><br><span class="line"><span class="keyword">import</span> com.ydstudio.flashsale.<span class="keyword">module</span>.pattern.dto.ActiveOrderDto;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ´»åŠ¨æŠ½è±¡ç±»,æŠ½å–å…¬å…±æ–¹æ³•,</span></span><br><span class="line"><span class="comment"> * æŠŠè®¢å•æ˜¯å¦ç¬¦åˆå¥–åŠ±çš„åˆ¤æ–­ä¹‹åå‘é€å¥–åŠ±çš„å…¬å…±é€»è¾‘åœ¨æ­¤å¤„å®ç°,</span></span><br><span class="line"><span class="comment"> * è®¢å•å…·ä½“æ¡ä»¶çš„åˆ¤æ–­å»¶è¿Ÿç”±å­ç±»å»å®ç°.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * ç­–ç•¥å’Œæ¨¡æ¿æ¨¡å¼ç»„åˆä½¿ç”¨</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/11/26</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.7.3</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractActiveHandle</span> <span class="keyword">implements</span> <span class="title">IActiveHandle</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å…¶ä»–æŠ½è±¡æ–¹æ³•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">otherMethod</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">otherMethod1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"å…¶ä»–å…¬ç”¨æ–¹æ³•"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¤–éƒ¨çœŸæ­£è¦è°ƒç”¨çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> temporaryOrderDto è®¢å•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> String <span class="title">handle</span><span class="params">(ActiveOrderDto temporaryOrderDto)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è°ƒç”¨æ¥å£ä¸­éœ€è¦å­ç±»å®ç°çš„æ–¹æ³•</span></span><br><span class="line">        Result result = checkOrder(temporaryOrderDto);</span><br><span class="line">        <span class="keyword">if</span> (!result.isSuccess()) &#123;</span><br><span class="line">            System.out.println(<span class="string">"ä¸ç¬¦åˆå¥–åŠ±å‘æ”¾æ¡ä»¶"</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"ä¸ç¬¦åˆå¥–åŠ±å‘æ”¾æ¡ä»¶"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sendReward(temporaryOrderDto, temporaryOrderDto.getMemberId(), <span class="string">"ç§¯åˆ†"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç»Ÿä¸€çš„å‘é€å¥–åŠ±çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> temporaryOrderDto è®¢å•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> memberId ç”¨æˆ·ID</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> reward å¥–åŠ±</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">sendReward</span><span class="params">(ActiveOrderDto temporaryOrderDto, <span class="keyword">long</span> memberId, String reward)</span> </span>&#123;</span><br><span class="line">        String s = <span class="string">"ç»™ç”¨æˆ·"</span> + memberId + <span class="string">"çš„è®¢å•"</span> + temporaryOrderDto + <span class="string">"å‘é€å¥–åŠ±"</span> + reward;</span><br><span class="line">        System.out.println(s);</span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3ã€ æ´»åŠ¨ç­–ç•¥çš„å®ç°ç±»</p><ul><li><p>ä¼šç±è®¢å•ç­–ç•¥å®ç°ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ydstudio.flashsale.<span class="keyword">module</span>.pattern.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ydstudio.flashsale.common.Result;</span><br><span class="line"><span class="keyword">import</span> com.ydstudio.flashsale.<span class="keyword">module</span>.pattern.dto.ActiveOrderDto;</span><br><span class="line"><span class="keyword">import</span> com.ydstudio.flashsale.<span class="keyword">module</span>.pattern.service.AbstractActiveHandle;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * ä¼šç±è®¢å•çš„å¤„ç†</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/11/26</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.7.3</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LevelOrderActiveHandle</span> <span class="keyword">extends</span> <span class="title">AbstractActiveHandle</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">otherMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"ä¼šç±è®¢å•çš„å®ç°"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getCategory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"2"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getCategoryDetail</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"2"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">checkOrder</span><span class="params">(ActiveOrderDto temporaryOrderDto)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Random random = <span class="keyword">new</span> Random();</span><br><span class="line">        <span class="keyword">int</span> i = random.nextInt(<span class="number">4</span>);</span><br><span class="line">        <span class="keyword">if</span> (i &gt;=<span class="number">2</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> Result();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Result(<span class="string">"ä¸ç¬¦åˆä¼šç±è®¢å•æ´»åŠ¨æ¡ä»¶"</span>,<span class="string">"ä¸ç¬¦åˆä¼šç±è®¢å•æ´»åŠ¨æ¡ä»¶"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>é…’åº—è®¢å•æ´»åŠ¨ç­–ç•¥å®ç°ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ydstudio.flashsale.<span class="keyword">module</span>.pattern.service.impl;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ydstudio.flashsale.common.Result;</span><br><span class="line"><span class="keyword">import</span> com.ydstudio.flashsale.<span class="keyword">module</span>.pattern.dto.ActiveOrderDto;</span><br><span class="line"><span class="keyword">import</span> com.ydstudio.flashsale.<span class="keyword">module</span>.pattern.service.AbstractActiveHandle;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * é…’åº—è®¢å•å¤„ç†</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/11/26</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.7.3</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderActiveHandle</span> <span class="keyword">extends</span> <span class="title">AbstractActiveHandle</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">otherMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"é…’åº—è®¢å•çš„å®ç°"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getCategory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"1"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getCategoryDetail</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"1"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">checkOrder</span><span class="params">(ActiveOrderDto temporaryOrderDto)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Random random = <span class="keyword">new</span> Random();</span><br><span class="line">        <span class="keyword">int</span> i = random.nextInt(<span class="number">4</span>);</span><br><span class="line">        <span class="keyword">if</span> (i&lt;=<span class="number">2</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> Result();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Result(<span class="string">"ä¸ç¬¦åˆé…’åº—è®¢å•æ´»åŠ¨æ¡ä»¶"</span>,<span class="string">"ä¸ç¬¦åˆé…’åº—è®¢å•æ´»åŠ¨æ¡ä»¶"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p>4 ã€ç»Ÿä¸€å…¥å£æä¾›ä¸€ä¸ªContext ç»™å¤–éƒ¨ä½¿ç”¨</p><p>è°ƒç”¨æ–¹ç›´æ¥ä½¿ç”¨@Autowired æ³¨å…¥ActiveHandleContextå³å¯ä½¿ç”¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ydstudio.flashsale.<span class="keyword">module</span>.pattern.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è´Ÿè´£æ‰€æœ‰æ´»åŠ¨å¤„ç†çš„å…¥å£,æ ¹æ® getImpl(String categoryDetail)ç±»å‹æ¥åˆ¤æ–­è°ƒç”¨å…·ä½“çš„æ´»åŠ¨ç­–ç•¥</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/7/13</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.6.8</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ActiveHandleContext</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;AbstractActiveHandle&gt; activeHandleList;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¯¹å¤–çš„ç»Ÿä¸€å…¥å£</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> categoryDetail ç±»å‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> AbstractActiveHandle <span class="title">getImpl</span><span class="params">(String categoryDetail)</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">"å‚æ•° categoryDetail =[&#123;&#125;] è·å–å®ç° "</span>, categoryDetail);</span><br><span class="line">        <span class="keyword">for</span> (AbstractActiveHandle activeHandle : activeHandleList) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (activeHandle.getCategoryDetail().equals(categoryDetail)) &#123;</span><br><span class="line">                <span class="keyword">return</span> activeHandle;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException(<span class="string">"æ²¡æœ‰è¯¥å®ç°"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çˆ¶ç±»AbstractActiveHandleå®ç°æ´»åŠ¨è§„åˆ™åˆ¤æ–­ã€å‘æ”¾å¥–åŠ±çš„ç®—æ³•éª¨æ¶ï¼Œå­ç±»å®ç°å…·ä½“çš„è§„åˆ™åˆ¤æ–­ï¼Œè¿™æ ·å°±å®ç°äº†ä»£ç çš„ä¼˜åŒ–å’Œå…¬ç”¨ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å‰é¢æ–‡ç« ç”±æŠ½å¥–æ´»åŠ¨èµ é€ä¸åŒçš„å¥–åŠ±ä»è€Œå¼•å‡ºäº†ç­–ç•¥æ¨¡å¼ï¼Œå®šä¹‰ä¸€ä¸ªç­–ç•¥æ¥å£ï¼Œä¸åŒçš„å¥–åŠ±å‘æ”¾å®ç°ä¸åŒçš„ç­–ç•¥ã€‚å³ä½¿åç»­æ–°å¢åŠ å¥–åŠ±ç§ç±»ï¼Œåªè¦é‡æ–°å®ç°ä¸€ä¸ªç­–ç•¥å³å¯ï¼Œç¬¦åˆäº†è®¾è®¡æ¨¡å¼ä¸­çš„&lt;em&gt;å¼€é—­åŸåˆ™-å¯¹æ‰©å±•å¼€æ”¾å¯¹ä¿®æ”¹å…³é—­&lt;/em&gt;ã€‚æˆ‘åœ¨ä¸€æ¬¡è®¢å•æ´»åŠ¨åŠŸèƒ½å¼€å‘ä¸­ä½¿ç”¨åˆ°äº†ç­–ç•¥æ¨¡å¼ï¼Œåœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­å‘ç°ï¼Œè®¢å•ç¬¦åˆæ´»åŠ¨æ¡ä»¶çš„åˆ¤æ–­ã€å‘æ”¾å¥–åŠ±ç»™ç”¨æˆ·ï¼Œå¯ä»¥æå‡åˆ°çˆ¶ç±»å®ç°ï¼Œå…·ä½“çš„æ¡ä»¶åˆ¤æ–­é€»è¾‘å¯ä»¥å»¶è¿Ÿåˆ°å­ç±»å»å®ç°ï¼Œä»è€Œå¼•å‡ºæœ¬ç¯‡æ–‡ç« çš„ä¸»é¢˜ï¼šæ¨¡æ¿æ¨¡å¼ã€‚&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="java" scheme="https://ydstudios.gitee.io/tags/java/"/>
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="https://ydstudios.gitee.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
      <category term="ç­–ç•¥æ¨¡å¼" scheme="https://ydstudios.gitee.io/tags/%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/"/>
    
      <category term="æ¨¡æ¿æ¨¡å¼" scheme="https://ydstudios.gitee.io/tags/%E6%A8%A1%E6%9D%BF%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>IDEA éšè—.ideaä¸.imlæ–‡ä»¶</title>
    <link href="https://ydstudios.gitee.io/post/c41bdbee.html"/>
    <id>https://ydstudios.gitee.io/post/c41bdbee.html</id>
    <published>2020-12-04T20:56:58.000Z</published>
    <updated>2020-12-04T13:15:09.000Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨ IDEA ä¸­ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬åˆ›å»º.idea å’Œ.iml æ–‡ä»¶ï¼Œå…¶å®è¿™ä¸¤ä¸ªæ–‡ä»¶å¯¹æˆ‘ä»¬æ²¡å•¥ç”¨çš„ï¼Œä½†æ˜¯ä¹Ÿä¸èƒ½åˆ æ‰(é¡¹ç›®éœ€è¦è€Œä¸”åˆ äº†åªå¥½è¿˜ä¼šè‡ªåŠ¨åˆ›å»º)ï¼Œé‚£æˆ‘ä»¬åªå¥½æƒ³æ³•å­ç»™ä»–éšè—æ‰ã€‚</p><a id="more"></a><p>Windows ç³»ç»Ÿåˆ™ä¾æ¬¡ç‚¹å‡» File â€”- Setting â€”- Editor â€”- File Types</p><p>Macç³»ç»Ÿä¾æ¬¡ç‚¹å‡»Preferencesâ€”- Editor â€”- File Types</p><p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20201204210639.png" alt="Macç³»ç»Ÿè®¾ç½®"></p><p>åœ¨å›¾ä¸­çº¢æ¡†å¤„æ·»åŠ  .idea å’Œ *imlï¼Œç„¶åä¿å­˜å³å¯ï¼å¿½ç•¥å…¶ä»–ç»“å°¾çš„æ–‡ä»¶ä¹Ÿå¯ä»¥è¿™ä¹ˆæ“ä½œçš„ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨ IDEA ä¸­ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬åˆ›å»º.idea å’Œ.iml æ–‡ä»¶ï¼Œå…¶å®è¿™ä¸¤ä¸ªæ–‡ä»¶å¯¹æˆ‘ä»¬æ²¡å•¥ç”¨çš„ï¼Œä½†æ˜¯ä¹Ÿä¸èƒ½åˆ æ‰(é¡¹ç›®éœ€è¦è€Œä¸”åˆ äº†åªå¥½è¿˜ä¼šè‡ªåŠ¨åˆ›å»º)ï¼Œé‚£æˆ‘ä»¬åªå¥½æƒ³æ³•å­ç»™ä»–éšè—æ‰ã€‚&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="idea" scheme="https://ydstudios.gitee.io/tags/idea/"/>
    
      <category term="å¼€å‘å·¥å…·" scheme="https://ydstudios.gitee.io/tags/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼å­¦ä¹ ä¹‹ç­–ç•¥æ¨¡å¼</title>
    <link href="https://ydstudios.gitee.io/post/170b3d6a.html"/>
    <id>https://ydstudios.gitee.io/post/170b3d6a.html</id>
    <published>2020-10-24T11:58:02.000Z</published>
    <updated>2020-12-06T14:04:33.000Z</updated>
    
    <content type="html"><![CDATA[<p>ç­–ç•¥æ¨¡å¼ï¼ˆStrategy Patternï¼‰æˆ‘è§‰å¾—åœ¨23ä¸­å¸¸è§çš„è®¾è®¡æ¨¡å¼é‡Œé¢æ˜¯ä¸€ç§æ¯”è¾ƒç®€å•çš„ï¼Œä½¿ç”¨åœºæ™¯ä¹Ÿå¾ˆå¤šã€‚åœ¨ç­–ç•¥æ¨¡å¼ä¸­ï¼Œä¸€ä¸ªç±»çš„è¡Œä¸ºæˆ–å…¶ç®—æ³•å¯ä»¥åœ¨è¿è¡Œæ—¶æ›´æ”¹ã€‚è¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºè¡Œä¸ºå‹æ¨¡å¼ã€‚åœ¨ç­–ç•¥æ¨¡å¼ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºè¡¨ç¤ºå„ç§ç­–ç•¥çš„å¯¹è±¡å’Œä¸€ä¸ªè¡Œä¸ºéšç€ç­–ç•¥å¯¹è±¡æ”¹å˜è€Œæ”¹å˜çš„ context å¯¹è±¡,ç­–ç•¥å¯¹è±¡æ”¹å˜ context å¯¹è±¡çš„æ‰§è¡Œç®—æ³•ã€‚</p><a id="more"></a><h4 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h4><h6 id="æ„å›¾"><a href="#æ„å›¾" class="headerlink" title="æ„å›¾:"></a>æ„å›¾:</h6><p>å®šä¹‰ä¸€ç³»åˆ—çš„ç®—æ³•,æŠŠå®ƒä»¬ä¸€ä¸ªä¸ªå°è£…èµ·æ¥, å¹¶ä¸”ä½¿å®ƒä»¬å¯ç›¸äº’æ›¿æ¢ã€‚</p><h6 id="ä¸»è¦è§£å†³ï¼š"><a href="#ä¸»è¦è§£å†³ï¼š" class="headerlink" title="ä¸»è¦è§£å†³ï¼š"></a>ä¸»è¦è§£å†³ï¼š</h6><p>åœ¨æœ‰å¤šç§ç®—æ³•ç›¸ä¼¼çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨ ifâ€¦else æ‰€å¸¦æ¥çš„å¤æ‚å’Œéš¾ä»¥ç»´æŠ¤ã€‚</p><h6 id="ä½•æ—¶ä½¿ç”¨ï¼š"><a href="#ä½•æ—¶ä½¿ç”¨ï¼š" class="headerlink" title="ä½•æ—¶ä½¿ç”¨ï¼š"></a>ä½•æ—¶ä½¿ç”¨ï¼š</h6><p>ä¸€ä¸ªç³»ç»Ÿæœ‰è®¸å¤šè®¸å¤šç±»ï¼Œè€ŒåŒºåˆ†å®ƒä»¬çš„åªæ˜¯ä»–ä»¬ç›´æ¥çš„è¡Œä¸ºã€‚</p><h6 id="å¦‚ä½•è§£å†³ï¼š"><a href="#å¦‚ä½•è§£å†³ï¼š" class="headerlink" title="å¦‚ä½•è§£å†³ï¼š"></a>å¦‚ä½•è§£å†³ï¼š</h6><p>å°†è¿™äº›ç®—æ³•å°è£…æˆä¸€ä¸ªä¸€ä¸ªçš„ç±»ï¼Œä»»æ„åœ°æ›¿æ¢ã€‚</p><h6 id="å…³é”®ä»£ç ï¼š"><a href="#å…³é”®ä»£ç ï¼š" class="headerlink" title="å…³é”®ä»£ç ï¼š"></a>å…³é”®ä»£ç ï¼š</h6><p>éœ€è¦å®ç°åŒä¸€ä¸ªæ¥å£ã€‚</p><h6 id="åº”ç”¨å®ä¾‹ï¼š"><a href="#åº”ç”¨å®ä¾‹ï¼š" class="headerlink" title="åº”ç”¨å®ä¾‹ï¼š"></a>åº”ç”¨å®ä¾‹ï¼š</h6><ul><li>è¯¸è‘›äº®çš„é”¦å›Šå¦™è®¡ï¼Œæ¯ä¸€ä¸ªé”¦å›Šå°±æ˜¯ä¸€ä¸ªç­–ç•¥ã€‚ </li><li>æ—…è¡Œçš„å‡ºæ¸¸æ–¹å¼ï¼Œé€‰æ‹©éª‘è‡ªè¡Œè½¦ã€åæ±½è½¦ï¼Œæ¯ä¸€ç§æ—…è¡Œæ–¹å¼éƒ½æ˜¯ä¸€ä¸ªç­–ç•¥ã€‚ </li><li>JAVA AWT ä¸­çš„ LayoutManagerã€‚</li></ul><h6 id="ä¼˜ç‚¹ï¼š"><a href="#ä¼˜ç‚¹ï¼š" class="headerlink" title="ä¼˜ç‚¹ï¼š"></a>ä¼˜ç‚¹ï¼š</h6><ul><li>ç®—æ³•å¯ä»¥è‡ªç”±åˆ‡æ¢ã€‚ </li><li>é¿å…ä½¿ç”¨å¤šé‡æ¡ä»¶åˆ¤æ–­ã€‚ </li><li>æ‰©å±•æ€§è‰¯å¥½ã€‚</li></ul><h6 id="ç¼ºç‚¹ï¼š"><a href="#ç¼ºç‚¹ï¼š" class="headerlink" title="ç¼ºç‚¹ï¼š"></a>ç¼ºç‚¹ï¼š</h6><ul><li>ç­–ç•¥ç±»ä¼šå¢å¤šã€‚ </li><li>æ‰€æœ‰ç­–ç•¥ç±»éƒ½éœ€è¦å¯¹å¤–æš´éœ²(è¿™ä¸ªä¹Ÿä¸ä¸€å®š)ã€‚</li></ul><h6 id="ä½¿ç”¨åœºæ™¯ï¼š"><a href="#ä½¿ç”¨åœºæ™¯ï¼š" class="headerlink" title="ä½¿ç”¨åœºæ™¯ï¼š"></a>ä½¿ç”¨åœºæ™¯ï¼š</h6><ul><li>å¦‚æœåœ¨ä¸€ä¸ªç³»ç»Ÿé‡Œé¢æœ‰è®¸å¤šç±»ï¼Œå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«ä»…åœ¨äºå®ƒä»¬çš„è¡Œä¸ºï¼Œé‚£ä¹ˆä½¿ç”¨ç­–ç•¥æ¨¡å¼å¯ä»¥åŠ¨æ€åœ°è®©ä¸€ä¸ªå¯¹è±¡åœ¨è®¸å¤šè¡Œä¸ºä¸­é€‰æ‹©ä¸€ç§è¡Œä¸ºã€‚ </li><li>ä¸€ä¸ªç³»ç»Ÿéœ€è¦åŠ¨æ€åœ°åœ¨å‡ ç§ç®—æ³•ä¸­é€‰æ‹©ä¸€ç§ã€‚ </li><li>å¦‚æœä¸€ä¸ªå¯¹è±¡æœ‰å¾ˆå¤šçš„è¡Œä¸ºï¼Œå¦‚æœä¸ç”¨æ°å½“çš„æ¨¡å¼ï¼Œè¿™äº›è¡Œä¸ºå°±åªå¥½ä½¿ç”¨å¤šé‡çš„æ¡ä»¶é€‰æ‹©è¯­å¥æ¥å®ç°ã€‚</li></ul><blockquote><p>æ³¨æ„ï¼š å¦‚æœä¸€ä¸ªç³»ç»Ÿçš„ç­–ç•¥å¤šäºå››ä¸ªï¼Œå°±éœ€è¦è€ƒè™‘ä½¿ç”¨æ··åˆæ¨¡å¼ï¼Œè§£å†³ç­–ç•¥ç±»è†¨èƒ€çš„é—®é¢˜ã€‚</p></blockquote><h4 id="ä¸šåŠ¡åœºæ™¯"><a href="#ä¸šåŠ¡åœºæ™¯" class="headerlink" title="ä¸šåŠ¡åœºæ™¯"></a>ä¸šåŠ¡åœºæ™¯</h4><p>ä»¥æŠ½å¥–æ´»åŠ¨å‘å¥–ä¸ºä¾‹ï¼Œå¥–å“å¤šç§å¤šæ ·ï¼Œå¯èƒ½æ˜¯ç°é‡‘å¥–ï¼Œè¯è´¹å¥–å“ï¼Œå®ç‰©å¥–ç­‰ç­‰ï¼Œæ¯ç§å¥–å“çš„å‘æ”¾æ–¹å¼éƒ½ä¸ä¸€æ ·ï¼Œæ¯”å¦‚ç°é‡‘æ˜¯ç›´æ¥è½¬è´¦ï¼Œè¯è´¹å¥–å“æ˜¯è°ƒç”¨è¿è¥å•†æä¾›æ¥å£å‘æ”¾ï¼Œå®ç‰©å¥–éœ€è¦äººå·¥å¿«é€’å¯„é€ã€‚åœ¨æœªé‡‡ç”¨ç­–ç•¥æ¨¡å¼ä¹‹å‰ï¼Œå°‘ä¸äº†ä½¿ç”¨ ifâ€¦elseâ€¦æ¥åˆ¤æ–­å‘æ”¾ï¼Œå½“å¢åŠ ä¸€ç§å¥–å“ç±»å‹æ—¶ï¼Œå°±éœ€è¦å¢åŠ  if åˆ¤æ–­ã€‚è€Œé‡‡å–ç­–ç•¥æ¨¡å¼ä¹‹åï¼Œåªéœ€å®ç°ä¸€ä¸ªç­–ç•¥ç±»å³å¯ï¼Œå¯¹åŸæ¥çš„é€»è¾‘æ— éœ€åšä»»ä½•æ”¹åŠ¨ï¼Œä¹Ÿä¸ä¼šå½±å“å…¶ä»–ç­–ç•¥çš„æ­£å¸¸é€»è¾‘ã€‚</p><h4 id="UMLå›¾"><a href="#UMLå›¾" class="headerlink" title="UMLå›¾"></a>UMLå›¾</h4><p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20201025114859.png" alt="ç­–ç•¥æ¨¡å¼UMLå›¾"></p><h4 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h4><p>å®¢æˆ·ç«¯éœ€è¦åˆ¤æ–­è¦ä½¿ç”¨å“ªä¸€ä¸ªå…·ä½“çš„ç­–ç•¥ç±»ï¼Œè‹¥è¿˜æ˜¯æŒ‰ç…§ä¼ ç»Ÿçš„æ–¹æ³• ifâ€¦elseâ€¦æ¥åˆ¤æ–­ç­–ç•¥æ¨¡å¼å°±æ²¡æœ‰æ„ä¹‰äº†ï¼Œå› æ­¤ç­–ç•¥æ¨¡å¼ä¸€èˆ¬éƒ½æ˜¯ç»“åˆå…¶ä»–æ¨¡å¼å…±åŒä½¿ç”¨ã€‚æœ¬æ–‡ä¸­ç­–ç•¥ç±»ä½¿ç”¨ Byte æ¥æ ‡è¯†ï¼Œä¹Ÿå¯ä»¥åœ¨ç­–ç•¥ç±»ä¸­å¢åŠ æŠ½è±¡æ–¹æ³•ï¼Œè¿”å›å€¼ä¸ºæšä¸¾ç±»å‹ã€‚</p><ol><li><p>å®šä¹‰ç­–ç•¥æ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.ydstudio.flashsale.service;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç­–ç•¥æ¥å£</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> åˆ˜æ´‹ Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/10/24</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">RewardSendStrategy</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‘æ”¾å¥–åŠ±çš„ç±»å‹,é€šè¿‡è¿™ä¸ªæ–¹æ³•æ¥æ ‡ç¤ºä¸åŒçš„ç­–ç•¥</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">Byte <span class="title">type</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–¹æ³•å¥–åŠ±çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">sendReward</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>å‘é€ç°é‡‘å¥–åŠ±ç­–ç•¥å®ç°ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.ydstudio.flashsale.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ydstudio.flashsale.common.enums.RewardTypeEnum;</span><br><span class="line"><span class="keyword">import</span> com.ydstudio.flashsale.service.RewardSendStrategy;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å‘é€ç°é‡‘å¥–å“ç­–ç•¥</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> åˆ˜æ´‹ Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/10/24</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CashRewardSendStrategy</span> <span class="keyword">implements</span> <span class="title">RewardSendStrategy</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Byte <span class="title">type</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> RewardTypeEnum.CASH.getCode();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendReward</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"å‘æ”¾ç°é‡‘å¥–å“"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>å‘æ”¾ç§¯åˆ†å¥–å“ç­–ç•¥å®ç°ç±»</p>   <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.ydstudio.flashsale.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ydstudio.flashsale.common.enums.RewardTypeEnum;</span><br><span class="line"><span class="keyword">import</span> com.ydstudio.flashsale.service.RewardSendStrategy;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å‘æ”¾ç§¯åˆ†å¥–å“ç­–ç•¥</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> åˆ˜æ´‹ Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/10/24</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PointRewardSendStrategy</span> <span class="keyword">implements</span> <span class="title">RewardSendStrategy</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Byte <span class="title">type</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> RewardTypeEnum.POINT.getCode();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendReward</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"å‘æ”¾ç§¯åˆ†å¥–å“"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>å‘æ”¾ä¼˜æƒ åˆ¸å¥–å“ç­–ç•¥å®ç°ç±»</p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">    </span><br><span class="line"><span class="keyword">package</span> com.ydstudio.flashsale.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ydstudio.flashsale.common.enums.RewardTypeEnum;</span><br><span class="line"><span class="keyword">import</span> com.ydstudio.flashsale.service.RewardSendStrategy;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å‘é€ä¼˜æƒ åˆ¸ç­–ç•¥</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> åˆ˜æ´‹ Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/10/24</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CouponRewardSendStrategy</span> <span class="keyword">implements</span> <span class="title">RewardSendStrategy</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Byte <span class="title">type</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> RewardTypeEnum.COUPON.getCode();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendReward</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"å‘æ”¾ä¼˜æƒ åˆ¸å¥–å“"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>å‘æ”¾è°¢è°¢å‚ä¸ç­–ç•¥å®ç°ç±»</p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.ydstudio.flashsale.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ydstudio.flashsale.common.enums.RewardTypeEnum;</span><br><span class="line"><span class="keyword">import</span> com.ydstudio.flashsale.service.RewardSendStrategy;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è°¢è°¢å‚ä¸å¥–å“å‘æ”¾ç­–ç•¥</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> åˆ˜æ´‹ Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/10/24</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThankYouRewardSendStrategy</span> <span class="keyword">implements</span> <span class="title">RewardSendStrategy</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Byte <span class="title">type</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> RewardTypeEnum.THANK_YOU.getCode();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendReward</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"è°¢è°¢å‚ä¸"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><ol start="6"><li><p>å®ç°å¯¹æŠ½è±¡ç­–ç•¥å°è£…çš„ä¸Šä¸‹æ–‡å¯¹è±¡</p><p>é€šå¸¸ JavaWeb å¼€å‘ä½¿ç”¨ Spring æ¡†æ¶çš„æ¯”è¾ƒå¤šï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ç”¨Spring æä¾›çš„@Autowiredæ³¨è§£çš„ä¸€ä¸ªå°æŠ€å·§ï¼Œæ¥æ›´æ–¹ä¾¿çš„å®ç°å°è£…ã€‚ä¸ç”¨å†ä½¿ç”¨ <code>java RewardSendStrategyContext</code> å»å®ç° <code>java org.springframework.context.ApplicationContextAware</code> æˆ–è€…æ¯ä¸ªç­–ç•¥ç±»å†å®ç° <code>java org.springframework.beans.factory</code>æ¥å£ç„¶åå°†ç­–ç•¥ç±»æ·»åŠ åˆ° RewardSendStrategyContext ä¸­çš„ </p><p>å±æ€§ä¸­ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.ydstudio.flashsale.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.BeansException;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContextAware;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ConcurrentHashMap;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> åˆ˜æ´‹ Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/10/25</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RewardSendStrategyContext</span> <span class="keyword">implements</span> <span class="title">ApplicationContextAware</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> Map&lt;Byte, RewardSendStrategy&gt; strategyMap = <span class="keyword">new</span> ConcurrentHashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setApplicationContext</span><span class="params">(ApplicationContext applicationContext)</span> <span class="keyword">throws</span> BeansException </span>&#123;</span><br><span class="line"></span><br><span class="line">        Map&lt;String, RewardSendStrategy&gt; beans = applicationContext.getBeansOfType(RewardSendStrategy<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        beans.values().forEach(bean -&gt; strategyMap.put(bean.type(), bean));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šè¿‡ type è·å–å¥–åŠ±å®ç°</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> type</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> RewardSendStrategy <span class="title">getRewardSendStrategy</span><span class="params">(Byte type)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        RewardSendStrategy sendStrategy = strategyMap.get(type);</span><br><span class="line">        <span class="keyword">if</span> (sendStrategy == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException(<span class="string">"æ²¡æœ‰æ­¤ç§å¥–åŠ±çš„å‘æ”¾å®ç°"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> sendStrategy;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>@Autowried</strong> å°æŠ€å·§ï¼Œçœ‹ä¸‹è¿™ä¸ªæ³¨è§£çš„ä¸Šçš„æ³¨é‡Šï¼Œæˆ‘ä¸‹é¢æ¥é€šè¿‡ä¸¾ä¾‹å­è¯´æ˜ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;In case of a &#123;@link java.util.Collection&#125; or &#123;@link java.util.Map&#125;</span></span><br><span class="line"><span class="comment"> * dependency type, the container will autowire all beans matching the</span></span><br><span class="line"><span class="comment"> * declared value type. In case of a Map, the keys must be declared as</span></span><br><span class="line"><span class="comment"> * type String and will be resolved to the corresponding bean names.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Target</span>(&#123;ElementType.CONSTRUCTOR, ElementType.FIELD, ElementType.METHOD, ElementType.ANNOTATION_TYPE&#125;)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Autowired &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Declares whether the annotated dependency is required.</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;Defaults to &#123;<span class="doctag">@code</span> true&#125;.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">required</span><span class="params">()</span> <span class="keyword">default</span> <span class="keyword">true</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹è¯´æ˜ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># è¿™æ ·å®šä¹‰å±æ€§çš„æ—¶å€™ï¼ŒSpring ä¼šè‡ªåŠ¨çš„å°†è¿™ä¸ªæ¥å£çš„å®ç°ç±»beanå…¨éƒ½è‡ªåŠ¨æ·»åŠ åˆ°è¿™ä¸ª rewardSendStrategyList ä¸­</span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> List&lt;RewardSendStrategy&gt; rewardSendStrategyList;</span><br><span class="line"></span><br><span class="line"># è¿™æ ·å®šä¹‰å±æ€§çš„æ—¶å€™ï¼ŒSpring ä¼šè‡ªåŠ¨çš„ä»¥å®ç°ç±» beanName ä½œä¸º keyï¼Œbean ä½œä¸º value æ·»åŠ åˆ°è¿™ä¸ª Map ä¸­</span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span>  Map&lt;String, RewardSendStrategy&gt; strategyMap;</span><br></pre></td></tr></table></figure><p><strong>æ‰€ä»¥ç­–ç•¥ç±»ä¸Šä¸‹æ–‡å¯¹è±¡åº”è¯¥è¿™æ ·å»ç¼–ç å®ç°ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ydstudio.flashsale.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.CollectionUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ConcurrentMap;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.Collectors;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å‘é€å¥–åŠ±çš„ Context ç±»</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> åˆ˜æ´‹ Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/10/25</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RewardSendStrategyContext</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;RewardSendStrategy&gt; rewardSendStrategyList;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šè¿‡ type è·å–å¥–åŠ±å®ç°</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> type</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RewardSendStrategy <span class="title">getRewardSendStrategy</span><span class="params">(Byte type)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (CollectionUtils.isEmpty(rewardSendStrategyList)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"RewardSendStrategy æ³¨å…¥å¤±è´¥"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        ConcurrentMap&lt;Byte, RewardSendStrategy&gt; strategyMap = rewardSendStrategyList.stream()</span><br><span class="line">                .collect(Collectors.toConcurrentMap(RewardSendStrategy::type, RewardSendStrategy -&gt; RewardSendStrategy));</span><br><span class="line"></span><br><span class="line">        RewardSendStrategy sendStrategy = strategyMap.get(type);</span><br><span class="line">        <span class="keyword">if</span> (sendStrategy == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException(<span class="string">"æ²¡æœ‰æ­¤ç§å¥–åŠ±çš„å‘æ”¾å®ç°"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> sendStrategy;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·å†™æ˜¯ä¸æ˜¯å¾ˆä¼˜é›…ï¼ï¼ï¼é‚£è°ƒç”¨æ–¹å¦‚ä½•ä½¿ç”¨å‘¢ï¼Ÿå¾ˆç®€å•çš„ç›´æ¥æ³¨å…¥å°±èƒ½ä½¿ç”¨äº†ï¼Œå“ˆå“ˆ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> RewardSendStrategyContext strategyContext;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">    Byte aByte = <span class="keyword">new</span> Byte(<span class="string">"1"</span>);</span><br><span class="line"></span><br><span class="line">    RewardSendStrategy rewardSendStrategy = strategyContext.getRewardSendStrategy(aByte);</span><br><span class="line">    log.info(<span class="string">"å¥–åŠ±å‘æ”¾å®ç° &#123;&#125;"</span>,sendStrategy);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>åˆ°æ­¤ç­–ç•¥æ¨¡å¼çš„æ¦‚å¿µã€ç»“æ„å’Œä»£ç å®ç°éƒ½è¯´å®Œäº†ï¼Œæ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼å¤§å®¶åœ¨æ’¸ç çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœé‡åˆ°ç±»ä¼¼çš„åœºæ™¯å¯ä»¥ä½¿ç”¨ç­–ç•¥æ¨¡å¼çš„æ—¶å€™ï¼Œä¸€å®šè¦å°è¯•å»ä½¿ç”¨ç­–ç•¥æ¨¡å¼å»ä¼˜åŒ–è‡ªå·±ä»£ç ï¼Œè¿™æ ·æ—¢é”»ç‚¼äº†è‡ªå·±ï¼Œä¹Ÿå†™å‡ºäº†ç‰›é€¼çš„ä»£ç ä½•ä¹è€Œä¸ä¸ºå‘¢ï¼Ÿéš¾é“ä½ ä¸€ç›´æƒ³å½“ CURD boy ä¹ˆï¼Ÿï¼Ÿï¼Ÿï¼Ÿ</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç­–ç•¥æ¨¡å¼ï¼ˆStrategy Patternï¼‰æˆ‘è§‰å¾—åœ¨23ä¸­å¸¸è§çš„è®¾è®¡æ¨¡å¼é‡Œé¢æ˜¯ä¸€ç§æ¯”è¾ƒç®€å•çš„ï¼Œä½¿ç”¨åœºæ™¯ä¹Ÿå¾ˆå¤šã€‚åœ¨ç­–ç•¥æ¨¡å¼ä¸­ï¼Œä¸€ä¸ªç±»çš„è¡Œä¸ºæˆ–å…¶ç®—æ³•å¯ä»¥åœ¨è¿è¡Œæ—¶æ›´æ”¹ã€‚è¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºè¡Œä¸ºå‹æ¨¡å¼ã€‚åœ¨ç­–ç•¥æ¨¡å¼ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºè¡¨ç¤ºå„ç§ç­–ç•¥çš„å¯¹è±¡å’Œä¸€ä¸ªè¡Œä¸ºéšç€ç­–ç•¥å¯¹è±¡æ”¹å˜è€Œæ”¹å˜çš„ context å¯¹è±¡,ç­–ç•¥å¯¹è±¡æ”¹å˜ context å¯¹è±¡çš„æ‰§è¡Œç®—æ³•ã€‚&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="java" scheme="https://ydstudios.gitee.io/tags/java/"/>
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="https://ydstudios.gitee.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
      <category term="ç­–ç•¥æ¨¡å¼" scheme="https://ydstudios.gitee.io/tags/%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>Windowsä¸‹æ­å»ºRocketMQåŒä¸»åŒä»é›†ç¾¤</title>
    <link href="https://ydstudios.gitee.io/post/459042a5.html"/>
    <id>https://ydstudios.gitee.io/post/459042a5.html</id>
    <published>2020-10-02T11:06:35.000Z</published>
    <updated>2020-10-10T14:35:40.000Z</updated>
    
    <content type="html"><![CDATA[<p>RocketMQæ˜¯é˜¿é‡Œå·´å·´2016å¹´MQä¸­é—´ä»¶ï¼Œä½¿ç”¨Javaè¯­è¨€å¼€å‘ï¼Œåœ¨é˜¿é‡Œå†…éƒ¨ï¼ŒRocketMQæ‰¿æ¥äº†ä¾‹å¦‚â€œåŒ11â€ç­‰é«˜å¹¶å‘åœºæ™¯çš„æ¶ˆæ¯æµè½¬ï¼Œèƒ½å¤Ÿå¤„ç†ä¸‡äº¿çº§åˆ«çš„æ¶ˆæ¯ã€‚æˆ‘ä»¬ä»Šå¤©å°±åœ¨ windowsä¸‹æ­å»ºRocketMQå¤šMasterå¤šSlaveæ¨¡å¼ï¼ˆåŒæ­¥ï¼‰çš„é›†ç¾¤ã€‚</p><a id="more"></a><h2 id="1-å‡†å¤‡å·¥ä½œ"><a href="#1-å‡†å¤‡å·¥ä½œ" class="headerlink" title="1 å‡†å¤‡å·¥ä½œ"></a>1 å‡†å¤‡å·¥ä½œ</h2><h3 id="1-1-ä¸‹è½½RocketMQ"><a href="#1-1-ä¸‹è½½RocketMQ" class="headerlink" title="1.1 ä¸‹è½½RocketMQ"></a>1.1 ä¸‹è½½RocketMQ</h3><p>RocketMQç‰ˆæœ¬ï¼š4.7.1</p><p><a href="https://www.apache.org/dyn/closer.cgi?path=rocketmq/4.7.1/rocketmq-all-4.7.1-source-release.zip" target="_blank" rel="noopener">ä¸‹è½½åœ°å€</a></p><h3 id="1-2-ç¯å¢ƒè¦æ±‚"><a href="#1-2-ç¯å¢ƒè¦æ±‚" class="headerlink" title="1.2 ç¯å¢ƒè¦æ±‚"></a>1.2 ç¯å¢ƒè¦æ±‚</h3><ul><li><p>Linux64ä½ç³»ç»Ÿ</p></li><li><p>JDK1.8(64ä½)</p></li><li><p>æºç å®‰è£…éœ€è¦å®‰è£…Maven 3.2.x</p></li></ul><h2 id="2-å®‰è£…RocketMQ"><a href="#2-å®‰è£…RocketMQ" class="headerlink" title="2 å®‰è£…RocketMQ"></a>2 å®‰è£…RocketMQ</h2><h3 id="2-1-å®‰è£…æ­¥éª¤"><a href="#2-1-å®‰è£…æ­¥éª¤" class="headerlink" title="2.1 å®‰è£…æ­¥éª¤"></a>2.1 å®‰è£…æ­¥éª¤</h3><p>æœ¬æ•™ç¨‹ä»¥äºŒè¿›åˆ¶åŒ…æ–¹å¼å®‰è£…</p><ol><li>è§£å‹å®‰è£…åŒ…</li><li>è¿›å…¥å®‰è£…ç›®å½•</li></ol><h3 id="2-2-ç›®å½•ä»‹ç»"><a href="#2-2-ç›®å½•ä»‹ç»" class="headerlink" title="2.2 ç›®å½•ä»‹ç»"></a>2.2 ç›®å½•ä»‹ç»</h3><ul><li>binï¼šå¯åŠ¨è„šæœ¬ï¼ŒåŒ…æ‹¬shellè„šæœ¬å’ŒCMDè„šæœ¬</li><li>confï¼šå®ä¾‹é…ç½®æ–‡ä»¶ ï¼ŒåŒ…æ‹¬brokeré…ç½®æ–‡ä»¶ã€logbacké…ç½®æ–‡ä»¶ç­‰</li><li>libï¼šä¾èµ–jaråŒ…ï¼ŒåŒ…æ‹¬Nettyã€commons-langã€FastJSONç­‰</li></ul><h2 id="3-é…ç½®mqnamesrvåŒä¸»"><a href="#3-é…ç½®mqnamesrvåŒä¸»" class="headerlink" title="3 é…ç½®mqnamesrvåŒä¸»"></a>3 é…ç½®mqnamesrvåŒä¸»</h2><p>åœ¨RocketMQ çš„é…ç½®æ–‡ä»¶å¤¹çš„ç›®å½•ä¸‹ï¼Œåˆ†åˆ«åˆ›å»ºæ–‡ä»¶namesrv-a.propertiesã€namesrv-b.properties</p><p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20201010215427.png" alt="namesrvé…ç½®æ–‡ä»¶"></p><p>å†…å®¹åˆ†åˆ«æ˜¯</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">listenPort=9876</span><br><span class="line"></span><br><span class="line">listenPort=9870</span><br></pre></td></tr></table></figure><p>å³è¡¨ç¤ºnamesrv-aç›‘å¬ç«¯å£æ˜¯9876ï¼Œnamesrv-bç›‘å¬ç«¯å£æ˜¯9870.</p><h3 id="3-1-å¯åŠ¨åŒä¸»namesrv"><a href="#3-1-å¯åŠ¨åŒä¸»namesrv" class="headerlink" title="3.1 å¯åŠ¨åŒä¸»namesrv"></a>3.1 å¯åŠ¨åŒä¸»namesrv</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">start mqnamesrv.cmd -c D:/ProgramFiles/rocketmq-all-4.7.1/conf/namesrv/namesrv-a.properties</span><br><span class="line"></span><br><span class="line">start mqnamesrv.cmd -c D:/ProgramFiles/rocketmq-all-4.7.1/conf/namesrv/namesrv-b.properties</span><br></pre></td></tr></table></figure><p>å¯åŠ¨æˆåŠŸä¼šåœ¨ç»ˆç«¯æ‰“å°</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The Name Server boot success serializeType=JSON</span><br></pre></td></tr></table></figure><h2 id="4-é…ç½®brokeråŒä¸»åŒä»"><a href="#4-é…ç½®brokeråŒä¸»åŒä»" class="headerlink" title="4 é…ç½®brokeråŒä¸»åŒä»"></a>4 é…ç½®brokeråŒä¸»åŒä»</h2><p>æ­¤æ¬¡æˆ‘ä»¬é‡‡ç”¨å¤šMasterå¤šSlaveæ¨¡å¼ï¼ˆåŒæ­¥ï¼‰çš„æ–¹å¼ï¼Œæ¯ä¸ªMasteré…ç½®ä¸€ä¸ªSlaveï¼Œæœ‰å¤šå¯¹Master-Slaveï¼ŒHAé‡‡ç”¨åŒæ­¥åŒå†™æ–¹å¼ï¼Œå³åªæœ‰ä¸»å¤‡éƒ½å†™æˆåŠŸï¼Œæ‰å‘åº”ç”¨è¿”å›æˆåŠŸï¼Œè¿™ç§æ¨¡å¼çš„ä¼˜ç¼ºç‚¹å¦‚ä¸‹ï¼š</p><ul><li>ä¼˜ç‚¹ï¼šæ•°æ®ä¸æœåŠ¡éƒ½æ— å•ç‚¹æ•…éšœï¼ŒMasterå®•æœºæƒ…å†µä¸‹ï¼Œæ¶ˆæ¯æ— å»¶è¿Ÿï¼ŒæœåŠ¡å¯ç”¨æ€§ä¸æ•°æ®å¯ç”¨æ€§éƒ½éå¸¸é«˜ï¼›</li><li>ç¼ºç‚¹ï¼šæ€§èƒ½æ¯”å¼‚æ­¥å¤åˆ¶æ¨¡å¼ç•¥ä½ï¼ˆå¤§çº¦ä½10%å·¦å³ï¼‰ï¼Œå‘é€å•ä¸ªæ¶ˆæ¯çš„RTä¼šç•¥é«˜ï¼Œä¸”ç›®å‰ç‰ˆæœ¬åœ¨ä¸»èŠ‚ç‚¹å®•æœºåï¼Œå¤‡æœºä¸èƒ½è‡ªåŠ¨åˆ‡æ¢ä¸ºä¸»æœºã€‚</li></ul><p>namesrvAddr æˆ‘ä»¬å°±ä¸ç›´æ¥å†™åˆ°é…ç½®æ–‡ä»¶é‡Œï¼Œæˆ‘ä»¬é‡‡ç”¨åœ¨å‘½ä»¤è¡Œçš„å½¢å¼æ¥æŒ‡å®š namesrvAddr</p><p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20201010215545.png" alt="é˜Ÿåˆ—çš„æ–‡ä»¶ä¿å­˜è·¯å¾„"></p><h3 id="4-1-broker-a-çš„é…ç½®"><a href="#4-1-broker-a-çš„é…ç½®" class="headerlink" title="4.1 broker-a çš„é…ç½®"></a>4.1 broker-a çš„é…ç½®</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> broker<span class="_">-a</span> çš„é…ç½®</span></span><br><span class="line">brokerClusterName=DefaultCluster</span><br><span class="line"><span class="meta">#</span><span class="bash"> brokeråå­—ï¼Œæ³¨æ„æ­¤å¤„ä¸åŒçš„é…ç½®æ–‡ä»¶å¡«å†™çš„ä¸ä¸€æ ·</span></span><br><span class="line">brokerName=broker-a</span><br><span class="line">brokerId=0</span><br><span class="line"><span class="meta">#</span><span class="bash">nameServeråœ°å€ï¼Œåˆ†å·åˆ†å‰²</span></span><br><span class="line"><span class="meta">#</span><span class="bash">namesrvAddr=127.0.0.1:9876;127.0.0.1:9870</span></span><br><span class="line"><span class="meta">#</span><span class="bash">åœ¨å‘é€æ¶ˆæ¯æ—¶ï¼Œè‡ªåŠ¨åˆ›å»ºæœåŠ¡å™¨ä¸å­˜åœ¨çš„topicï¼Œé»˜è®¤åˆ›å»ºçš„é˜Ÿåˆ—æ•°</span></span><br><span class="line">defaultTopicQueueNums=4</span><br><span class="line"><span class="meta">#</span><span class="bash">æ˜¯å¦å…è®¸ Broker è‡ªåŠ¨åˆ›å»ºTopicï¼Œå»ºè®®çº¿ä¸‹å¼€å¯ï¼Œçº¿ä¸Šå…³é—­</span></span><br><span class="line">autoCreateTopicEnable=true</span><br><span class="line"><span class="meta">#</span><span class="bash">æ˜¯å¦å…è®¸ Broker è‡ªåŠ¨åˆ›å»ºè®¢é˜…ç»„ï¼Œå»ºè®®çº¿ä¸‹å¼€å¯ï¼Œçº¿ä¸Šå…³é—­</span></span><br><span class="line">autoCreateSubscriptionGroup=true</span><br><span class="line"><span class="meta">#</span><span class="bash">Broker å¯¹å¤–æœåŠ¡çš„ç›‘å¬ç«¯å£,</span></span><br><span class="line">listenPort=10911</span><br><span class="line">brokerIP1=127.0.0.1</span><br><span class="line">brokerIP2=127.0.0.1</span><br><span class="line">deleteWhen=04</span><br><span class="line">fileReservedTime=48</span><br><span class="line">brokerRole=SYNC_MASTER</span><br><span class="line">flushDiskType=ASYNC_FLUSH</span><br><span class="line">waitTimeMillsInSendQueue=500</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storePathRootDir=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-a/broker-a</span><br><span class="line"><span class="meta">#</span><span class="bash">commitLog å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storePathCommitLog=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-a/broker-a/commitlog</span><br><span class="line"><span class="meta">#</span><span class="bash">æ¶ˆè´¹é˜Ÿåˆ—å­˜å‚¨è·¯å¾„å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storePathConsumeQueue=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-a/broker-a/consumequeue</span><br><span class="line"><span class="meta">#</span><span class="bash">æ¶ˆæ¯ç´¢å¼•å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storePathIndex=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-a/broker-a/index</span><br><span class="line"><span class="meta">#</span><span class="bash">checkpoint æ–‡ä»¶å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storeCheckpoint=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-a/broker-a/checkpoint</span><br><span class="line"><span class="meta">#</span><span class="bash">abort æ–‡ä»¶å­˜å‚¨è·¯å¾„</span></span><br><span class="line">abortFile=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-a/broker-a/abort</span><br></pre></td></tr></table></figure><h3 id="4-2-broker-a-s-çš„é…ç½®"><a href="#4-2-broker-a-s-çš„é…ç½®" class="headerlink" title="4.2 broker-a-s çš„é…ç½®"></a>4.2 broker-a-s çš„é…ç½®</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> broker<span class="_">-a</span><span class="_">-s</span> çš„é…ç½®</span></span><br><span class="line">brokerClusterName=DefaultCluster</span><br><span class="line">brokerName=broker-a</span><br><span class="line">brokerId=1</span><br><span class="line">listenPort=10931</span><br><span class="line"><span class="meta">#</span><span class="bash">nameServeråœ°å€ï¼Œåˆ†å·åˆ†å‰²</span></span><br><span class="line"><span class="meta">#</span><span class="bash">namesrvAddr=127.0.0.1:9876;127.0.0.1:9870</span></span><br><span class="line">brokerIP1=127.0.0.1</span><br><span class="line">brokerIP2=127.0.0.1</span><br><span class="line">deleteWhen=04</span><br><span class="line">fileReservedTime=48</span><br><span class="line">brokerRole=SLAVE</span><br><span class="line">flushDiskType=ASYNC_FLUSH</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storePathRootDir=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-a-s/broker-a-s</span><br><span class="line"><span class="meta">#</span><span class="bash">commitLog å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storePathCommitLog=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-a-s/broker-a-s/commitlog</span><br><span class="line"><span class="meta">#</span><span class="bash">æ¶ˆè´¹é˜Ÿåˆ—å­˜å‚¨è·¯å¾„å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storePathConsumeQueue=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-a-s/broker-a-s/consumequeue</span><br><span class="line"><span class="meta">#</span><span class="bash">æ¶ˆæ¯ç´¢å¼•å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storePathIndex=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-a-s/broker-a-s/index</span><br><span class="line"><span class="meta">#</span><span class="bash">checkpoint æ–‡ä»¶å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storeCheckpoint=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-a-s/broker-a-s/checkpoint</span><br><span class="line"><span class="meta">#</span><span class="bash">abort æ–‡ä»¶å­˜å‚¨è·¯å¾„</span></span><br><span class="line">abortFile=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-a-s/broker-a-s/abort</span><br></pre></td></tr></table></figure><h3 id="4-3-broker-b-çš„é…ç½®"><a href="#4-3-broker-b-çš„é…ç½®" class="headerlink" title="4.3 broker-b çš„é…ç½®"></a>4.3 broker-b çš„é…ç½®</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> broker-b çš„é…ç½®</span></span><br><span class="line">brokerClusterName=DefaultCluster</span><br><span class="line">brokerName=broker-b</span><br><span class="line">brokerId=0</span><br><span class="line"><span class="meta">#</span><span class="bash">nameServeråœ°å€ï¼Œåˆ†å·åˆ†å‰²</span></span><br><span class="line"><span class="meta">#</span><span class="bash">namesrvAddr=127.0.0.1:9876;127.0.0.1:9870</span></span><br><span class="line"><span class="meta">#</span><span class="bash">åœ¨å‘é€æ¶ˆæ¯æ—¶ï¼Œè‡ªåŠ¨åˆ›å»ºæœåŠ¡å™¨ä¸å­˜åœ¨çš„topicï¼Œé»˜è®¤åˆ›å»ºçš„é˜Ÿåˆ—æ•°</span></span><br><span class="line">defaultTopicQueueNums=4</span><br><span class="line"><span class="meta">#</span><span class="bash">æ˜¯å¦å…è®¸ Broker è‡ªåŠ¨åˆ›å»ºTopicï¼Œå»ºè®®çº¿ä¸‹å¼€å¯ï¼Œçº¿ä¸Šå…³é—­</span></span><br><span class="line">autoCreateTopicEnable=true</span><br><span class="line"><span class="meta">#</span><span class="bash">æ˜¯å¦å…è®¸ Broker è‡ªåŠ¨åˆ›å»ºè®¢é˜…ç»„ï¼Œå»ºè®®çº¿ä¸‹å¼€å¯ï¼Œçº¿ä¸Šå…³é—­</span></span><br><span class="line">autoCreateSubscriptionGroup=true</span><br><span class="line"><span class="meta">#</span><span class="bash">Broker å¯¹å¤–æœåŠ¡çš„ç›‘å¬ç«¯å£,</span></span><br><span class="line">listenPort=10951</span><br><span class="line">brokerIP1=127.0.0.1</span><br><span class="line">brokerIP2=127.0.0.1</span><br><span class="line">deleteWhen=04</span><br><span class="line">fileReservedTime=48</span><br><span class="line">brokerRole=SYNC_MASTER</span><br><span class="line">flushDiskType=ASYNC_FLUSH</span><br><span class="line">waitTimeMillsInSendQueue=500</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storePathRootDir=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-b/broker-b</span><br><span class="line"><span class="meta">#</span><span class="bash">commitLog å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storePathCommitLog=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-b/broker-b/commitlog</span><br><span class="line"><span class="meta">#</span><span class="bash">æ¶ˆè´¹é˜Ÿåˆ—å­˜å‚¨è·¯å¾„å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storePathConsumeQueue=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-b/broker-b/consumequeue</span><br><span class="line"><span class="meta">#</span><span class="bash">æ¶ˆæ¯ç´¢å¼•å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storePathIndex=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-b/broker-b/index</span><br><span class="line"><span class="meta">#</span><span class="bash">checkpoint æ–‡ä»¶å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storeCheckpoint=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-b/broker-b/checkpoint</span><br><span class="line"><span class="meta">#</span><span class="bash">abort æ–‡ä»¶å­˜å‚¨è·¯å¾„</span></span><br><span class="line">abortFile=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-b/broker-b/abort</span><br></pre></td></tr></table></figure><h3 id="4-4-broker-b-s-çš„é…ç½®"><a href="#4-4-broker-b-s-çš„é…ç½®" class="headerlink" title="4.4 broker-b-s çš„é…ç½®"></a>4.4 broker-b-s çš„é…ç½®</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> broker-b<span class="_">-s</span> çš„é…ç½®</span></span><br><span class="line"></span><br><span class="line">brokerClusterName=DefaultCluster</span><br><span class="line">brokerName=broker-b</span><br><span class="line">brokerId=1</span><br><span class="line">listenPort=10971</span><br><span class="line"><span class="meta">#</span><span class="bash">nameServeråœ°å€ï¼Œåˆ†å·åˆ†å‰²</span></span><br><span class="line"><span class="meta">#</span><span class="bash">namesrvAddr=127.0.0.1:9876;127.0.0.1:9870</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> å¯ä»¥ä¸é…ç½®</span></span><br><span class="line">brokerIP1=127.0.0.1</span><br><span class="line">brokerIP2=127.0.0.1</span><br><span class="line">deleteWhen=04</span><br><span class="line">fileReservedTime=48</span><br><span class="line">brokerRole=SLAVE</span><br><span class="line">flushDiskType=ASYNC_FLUSH</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storePathRootDir=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-b-s/broker-b-s</span><br><span class="line"><span class="meta">#</span><span class="bash">commitLog å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storePathCommitLog=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-b-s/broker-b-s/commitlog</span><br><span class="line"><span class="meta">#</span><span class="bash">æ¶ˆè´¹é˜Ÿåˆ—å­˜å‚¨è·¯å¾„å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storePathConsumeQueue=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-b-s/broker-b-s/consumequeue</span><br><span class="line"><span class="meta">#</span><span class="bash">æ¶ˆæ¯ç´¢å¼•å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storePathIndex=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-b-s/broker-b-s/index</span><br><span class="line"><span class="meta">#</span><span class="bash">checkpoint æ–‡ä»¶å­˜å‚¨è·¯å¾„</span></span><br><span class="line">storeCheckpoint=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-b-s/broker-b-s/checkpoint</span><br><span class="line"><span class="meta">#</span><span class="bash">abort æ–‡ä»¶å­˜å‚¨è·¯å¾„</span></span><br><span class="line">abortFile=D:/ProgramFiles/rocketmq-all-4.7.1/store-broker-b-s/broker-b-s/abort</span><br></pre></td></tr></table></figure><h3 id="4-5-å¯åŠ¨åŒä¸»åŒä»boker"><a href="#4-5-å¯åŠ¨åŒä¸»åŒä»boker" class="headerlink" title="4.5 å¯åŠ¨åŒä¸»åŒä»boker"></a>4.5 å¯åŠ¨åŒä¸»åŒä»boker</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">start mqbroker.cmd -c D:/ProgramFiles/rocketmq-all-4.7.1/conf/2m-2s-sync/broker-a.properties  -n "127.0.0.1:9876;127.0.0.1:9870"</span><br><span class="line"></span><br><span class="line">start mqbroker.cmd -c D:/ProgramFiles/rocketmq-all-4.7.1/conf/2m-2s-sync/broker-a-s.properties -n "127.0.0.1:9876;127.0.0.1:9870"</span><br><span class="line"></span><br><span class="line">start mqbroker.cmd -c D:/ProgramFiles/rocketmq-all-4.7.1/conf/2m-2s-sync/broker-b.properties  -n "127.0.0.1:9876;127.0.0.1:9870"</span><br><span class="line"></span><br><span class="line">start mqbroker.cmd -c D:/ProgramFiles/rocketmq-all-4.7.1/conf/2m-2s-sync/broker-b-s.properties -n "127.0.0.1:9876;127.0.0.1:9870"</span><br></pre></td></tr></table></figure><h2 id="5-é…ç½®rocketmq-console"><a href="#5-é…ç½®rocketmq-console" class="headerlink" title="5 é…ç½®rocketmq-console"></a>5 é…ç½®rocketmq-console</h2><p><code>RocketMQ</code>æœ‰ä¸€ä¸ªå¯¹å…¶æ‰©å±•çš„å¼€æºé¡¹ç›®<a href="https://github.com/apache/rocketmq-externals" target="_blank" rel="noopener">incubator-rocketmq-externals</a>ï¼Œè¿™ä¸ªé¡¹ç›®ä¸­æœ‰ä¸€ä¸ªå­æ¨¡å—å«<code>rocketmq-console</code>ï¼Œè¿™ä¸ªä¾¿æ˜¯ç®¡ç†æ§åˆ¶å°é¡¹ç›®äº†ï¼Œå…ˆå°†<a href="https://github.com/apache/rocketmq-externals" target="_blank" rel="noopener">incubator-rocketmq-externals</a>æ‹‰åˆ°æœ¬åœ°ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦è‡ªå·±å¯¹<code>rocketmq-console</code>è¿›è¡Œç¼–è¯‘æ‰“åŒ…è¿è¡Œã€‚</p><h3 id="5-1-ä¸‹è½½å¹¶ç¼–è¯‘æ‰“åŒ…"><a href="#5-1-ä¸‹è½½å¹¶ç¼–è¯‘æ‰“åŒ…" class="headerlink" title="5.1 ä¸‹è½½å¹¶ç¼–è¯‘æ‰“åŒ…"></a>5.1 ä¸‹è½½å¹¶ç¼–è¯‘æ‰“åŒ…</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/apache/rocketmq-externals</span><br><span class="line">cd rocketmq-console</span><br><span class="line">mvn clean package -Dmaven.test.skip=true</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šæ‰“åŒ…å‰åœ¨<code>rocketmq-console</code>ä¸­é…ç½®<code>namesrv</code>é›†ç¾¤åœ°å€ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">server.port=80</span><br><span class="line">rocketmq.config.namesrvAddr=127.0.0.1:9876;192.168.25.138:9870</span><br></pre></td></tr></table></figure><p>å¯åŠ¨rocketmq-consoleï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar rocketmq-console-ng-2.0.0.jar</span><br></pre></td></tr></table></figure><p><em>æ³¨æ„</em>  ä½ æ‰§è¡Œä¸Šè¿°å‘½ä»¤ä¹‹åå¯èƒ½å¾—åˆ°çš„ jar åŒ…çš„åå­—å’Œæˆ‘çš„ä¸ä¸€æ ·ï¼Œæ¯•ç«Ÿäººå®¶ä¹Ÿæ˜¯ä¸€ç›´åœ¨æ›´æ–°ç‰ˆæœ¬ï¼Œæ³¨æ„çœ‹è‡ªå·±å¯¹åº”ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œé€‚å½“æ›¿æ¢å°±è¡Œã€‚</p><p>å¯åŠ¨æˆåŠŸåï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡æµè§ˆå™¨è®¿é—®<code>http://localhost:80</code>è¿›å…¥é›†ç¾¤ç•Œé¢äº†å¦‚ä¸‹å›¾ï¼š<br><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20201010215859.png" alt="æ¶ˆæ¯é˜Ÿåˆ—é›†ç¾¤"></p><h2 id="6-åœ¨æ­å»ºè¿‡ç¨‹ä¸­å‡ºç°çš„é—®é¢˜"><a href="#6-åœ¨æ­å»ºè¿‡ç¨‹ä¸­å‡ºç°çš„é—®é¢˜" class="headerlink" title="6 åœ¨æ­å»ºè¿‡ç¨‹ä¸­å‡ºç°çš„é—®é¢˜"></a>6 åœ¨æ­å»ºè¿‡ç¨‹ä¸­å‡ºç°çš„é—®é¢˜</h2><h3 id="6-1-Lock-failed-MQ-already-started"><a href="#6-1-Lock-failed-MQ-already-started" class="headerlink" title="6.1 Lock failed,MQ already started"></a>6.1 Lock failed,MQ already started</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">java.lang.RuntimeException: Lock failed,MQ already started</span><br><span class="line">        at org.apache.rocketmq.store.DefaultMessageStore.start(DefaultMessageStore.java:227)</span><br><span class="line">        at org.apache.rocketmq.broker.BrokerController.start(BrokerController.java:853)</span><br><span class="line">        at org.apache.rocketmq.broker.BrokerStartup.start(BrokerStartup.java:64)</span><br><span class="line">        at org.apache.rocketmq.broker.BrokerStartup.main(BrokerStartup.java:58)</span><br></pre></td></tr></table></figure><p>å‡ºç°è¿™ä¸ªé—®é¢˜ æ˜¯å› ä¸ºæˆ‘ä»¬åœ¨é›†ç¾¤ä¸­masterå’Œslaveå…±ç”¨ä¸€ä¸ªstorePathé€ æˆçš„ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬è¦å¯åŠ¨çš„æ¯ä¸€ä¸ªbrokerè¦æŒ‡å®šä¸ä¸€æ ·çš„storePath è·¯å¾„å°±è¡Œï¼Œä¹Ÿå°±æ˜¯åœ¨æˆ‘ä»¬çš„é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹å³å¯ï¼Œå®Œç¾è§£å†³ã€‚</p><h3 id="6-2-é›†ç¾¤çŠ¶æ€-SLAVE-NOT-AVAILABLE"><a href="#6-2-é›†ç¾¤çŠ¶æ€-SLAVE-NOT-AVAILABLE" class="headerlink" title="6.2 é›†ç¾¤çŠ¶æ€ SLAVE_NOT_AVAILABLE"></a>6.2 é›†ç¾¤çŠ¶æ€ SLAVE_NOT_AVAILABLE</h3><p>ä¸»ä»çš„brokerName ä¸€å®šè¦è®¾ç½®æˆä¸€æ ·çš„ï¼Œä¸»brokerName=broker-a é‚£ä¹ˆä»çš„brokerName=broker-aï¼Œä¸ç„¶å‘é€æ¶ˆæ¯ä¼šå‡ºç° SLAVE_NOT_AVAILABLE</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> brokeråå­—ï¼Œæ³¨æ„æ­¤å¤„ä¸åŒçš„é…ç½®æ–‡ä»¶å¡«å†™çš„ä¸ä¸€æ ·</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> broker<span class="_">-a</span> çš„é…ç½®</span></span><br><span class="line"></span><br><span class="line">brokerClusterName=DefaultCluster</span><br><span class="line">brokerName=broker-a</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> broker<span class="_">-a</span><span class="_">-s</span> çš„é…ç½®</span></span><br><span class="line"></span><br><span class="line">brokerClusterName=DefaultCluster</span><br><span class="line">brokerName=broker-a</span><br></pre></td></tr></table></figure><h3 id="6-3-æ¶ˆæ¯å‘é€å‡ºç°-TIMEOUT-CLEAN-QUEUE-broker-busy"><a href="#6-3-æ¶ˆæ¯å‘é€å‡ºç°-TIMEOUT-CLEAN-QUEUE-broker-busy" class="headerlink" title="6.3 æ¶ˆæ¯å‘é€å‡ºç° [TIMEOUT_CLEAN_QUEUE]broker busy"></a>6.3 æ¶ˆæ¯å‘é€å‡ºç° [TIMEOUT_CLEAN_QUEUE]broker busy</h3> <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">org.apache.rocketmq.client.exception.MQBrokerException: CODE: 2  DESC: [TIMEOUT_CLEAN_QUEUE]broker busy, start flow control for a while, period in queue: 205ms, size of queue: 2</span><br></pre></td></tr></table></figure><p> è§£å†³æ–¹å¼å°±æ˜¯åˆç†è®¾ç½®waitTimeMillsInSendQueueçš„å€¼</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æ¸…é™¤å‘é€çº¿ç¨‹æ± ä»»åŠ¡é˜Ÿåˆ—çš„ç­‰å¾…æ—¶é—´ã€‚å¦‚æœç³»ç»Ÿæ—¶é—´å‡å»ä»»åŠ¡æ”¾å…¥é˜Ÿåˆ—ä¸­çš„æ—¶é—´å°äºwaitTimeMillsInSendQueueï¼Œæœ¬æ¬¡è¯·æ±‚ä»»åŠ¡æš‚æ—¶ä¸ç§»é™¤è¯¥ä»»åŠ¡ é»˜è®¤200ms</span></span><br><span class="line">waitTimeMillsInSendQueue=200</span><br></pre></td></tr></table></figure><p>åˆ°æ­¤RocketMQåŒä¸»åŒä»é›†ç¾¤å°±æ­å»ºå®Œæ¯•ã€‚</p><p><em>å‚è€ƒèµ„æ–™</em><br><a href="https://blog.csdn.net/chenzhong2010/article/details/106749258" target="_blank" rel="noopener">å‚è€ƒ1</a><br><a href="https://blog.csdn.net/vucko/article/details/107487675" target="_blank" rel="noopener">å‚è€ƒ2</a><br><a href="https://blog.csdn.net/jianghuiyun/article/details/77971583" target="_blank" rel="noopener">å‚è€ƒ3</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;RocketMQæ˜¯é˜¿é‡Œå·´å·´2016å¹´MQä¸­é—´ä»¶ï¼Œä½¿ç”¨Javaè¯­è¨€å¼€å‘ï¼Œåœ¨é˜¿é‡Œå†…éƒ¨ï¼ŒRocketMQæ‰¿æ¥äº†ä¾‹å¦‚â€œåŒ11â€ç­‰é«˜å¹¶å‘åœºæ™¯çš„æ¶ˆæ¯æµè½¬ï¼Œèƒ½å¤Ÿå¤„ç†ä¸‡äº¿çº§åˆ«çš„æ¶ˆæ¯ã€‚æˆ‘ä»¬ä»Šå¤©å°±åœ¨ windowsä¸‹æ­å»ºRocketMQå¤šMasterå¤šSlaveæ¨¡å¼ï¼ˆåŒæ­¥ï¼‰çš„é›†ç¾¤ã€‚&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="Windows" scheme="https://ydstudios.gitee.io/tags/Windows/"/>
    
      <category term="RocketMQ" scheme="https://ydstudios.gitee.io/tags/RocketMQ/"/>
    
      <category term="åŒä¸»åŒä»é›†ç¾¤" scheme="https://ydstudios.gitee.io/tags/%E5%8F%8C%E4%B8%BB%E5%8F%8C%E4%BB%8E%E9%9B%86%E7%BE%A4/"/>
    
  </entry>
  
  <entry>
    <title>JavaScriptæ¥æ”¶åç«¯Longç±»å‹æ•°æ®ç²¾åº¦ä¸¢å¤±é—®é¢˜</title>
    <link href="https://ydstudios.gitee.io/post/175ad151.html"/>
    <id>https://ydstudios.gitee.io/post/175ad151.html</id>
    <published>2020-08-26T22:30:22.000Z</published>
    <updated>2020-08-27T14:30:42.000Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œé€šå¸¸æˆ‘ä»¬çš„æ•°æ®åº“ä¸»é”®ä¼šä½¿ç”¨ bigintï¼Œå®ƒå¯¹åº” Java ä¸­çš„ Longï¼Œä½†æ˜¯å½“Longçš„æ•°å€¼è¶…è¿‡ä¸€å®šå€¼æ—¶ä¼ åˆ°å‰ç«¯åä¼šä¸¢å¤±ç²¾åº¦ã€‚åŸå› æ˜¯JavaScriptçš„numberç±»å‹æœ‰ä¸ªå®‰å…¨å€¼ï¼Œå³2çš„53æ¬¡æ–¹ï¼Œä¸º9007199254740991ï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªå€¼ï¼Œé‚£ä¹ˆJavaScriptä¼šå‡ºç°ä¸ç²¾ç¡®çš„é—®é¢˜ã€‚</p><a id="more"></a><p>æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨ä¸­æ‰“å°å‡ºJavaScriptçš„numberç±»å‹æœ‰ä¸ªå®‰å…¨å€¼ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20200826225013.png" alt="JavaScriptçš„numberç±»å‹æœ‰ä¸ªå®‰å…¨å€¼"></p><p>å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿæœ€ç®€å•çš„åŠæ³•å°±æ˜¯ç›´æ¥åå°åœ¨è¿”å›ç»™å‰ç«¯çš„æ—¶å€™ï¼ŒæŠŠ Long ç±»å‹çš„æ•°æ®è½¬æ¢æˆå­—ç¬¦ä¸²å³å¯ã€‚å¦‚æœè‡ªå·±æ‰‹åŠ¨è½¬æˆ‘æƒ³è¿™ä¸ªä¼šæ˜¯ä¸€ä¸ªå·¥ä½œé‡ä¸å°çš„æ´»ï¼Œé‚£æˆ‘ä»¬æ€ä¹ˆå®‰å…¨å¿«é€Ÿçš„è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ</p><ul><li><p>æ–¹æ¡ˆä¸€</p><p>å¦‚æœä½ ä»¬æ˜¯ä½¿ç”¨jacksonæ¡†æ¶çš„è¯ï¼Œå¯ä»¥åœ¨ç›¸åº”çš„å­—æ®µä¸ŠåŠ ä¸Šä»¥ä¸‹çš„æ³¨è§£ï¼ˆè‹¥æ˜¯ç”¨çš„ FastJson ä¹Ÿæœ‰ç›¸åº”çš„æ³¨è§£ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.annotation.JsonSerialize;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.ser.std.ToStringSerializer;</span><br><span class="line"><span class="comment">//åºåˆ—åŒ–æˆStringçš„ä¼ </span></span><br><span class="line"></span><br><span class="line"> <span class="meta">@JsonSerialize</span>(using = ToStringSerializer<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class"> <span class="title">private</span> <span class="title">Long</span> <span class="title">id</span></span>;</span><br></pre></td></tr></table></figure></li><li><p>æ–¹æ¡ˆäºŒ</p><p>å¯ä»¥è‡ªå®šä¹‰Jacksonçš„ObjectMapper</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomJacksonObjectMapper</span> <span class="keyword">extends</span> <span class="title">ObjectMapper</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CustomJacksonObjectMapper</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        <span class="comment">// è®¾ç½®æ—¥æœŸè½¬æ¢yyyy-MM-dd HH:mm:ss</span></span><br><span class="line">        setDateFormat(<span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd HH:mm:ss"</span>));</span><br><span class="line">        <span class="comment">// åºåˆ—æ¢æˆjsonæ—¶,å°†æ‰€æœ‰çš„longå˜æˆstring,å› ä¸ºjsä¸­å¾—æ•°å­—ç±»å‹ä¸èƒ½åŒ…å«æ‰€æœ‰çš„java longå€¼</span></span><br><span class="line">        SimpleModule simpleModule = <span class="keyword">new</span> SimpleModule(<span class="string">"LongModule"</span>, <span class="keyword">new</span> Version(<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="string">""</span>));</span><br><span class="line">        simpleModule.addSerializer(Long<span class="class">.<span class="keyword">class</span>, <span class="title">ToStringSerializer</span>.<span class="title">instance</span>)</span>;</span><br><span class="line">        simpleModule.addSerializer(Long.TYPE, ToStringSerializer.instance);</span><br><span class="line">        registerModule(simpleModule);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æ–¹æ¡ˆä¸‰</p><p>å‰ç«¯è‡ªå·±è§£å†³ï¼Œä½¿ç”¨ç¬¬ä¸‰æ–¹åº“å¦‚json-bigint ç­‰</p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œé€šå¸¸æˆ‘ä»¬çš„æ•°æ®åº“ä¸»é”®ä¼šä½¿ç”¨ bigintï¼Œå®ƒå¯¹åº” Java ä¸­çš„ Longï¼Œä½†æ˜¯å½“Longçš„æ•°å€¼è¶…è¿‡ä¸€å®šå€¼æ—¶ä¼ åˆ°å‰ç«¯åä¼šä¸¢å¤±ç²¾åº¦ã€‚åŸå› æ˜¯JavaScriptçš„numberç±»å‹æœ‰ä¸ªå®‰å…¨å€¼ï¼Œå³2çš„53æ¬¡æ–¹ï¼Œä¸º9007199254740991ï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªå€¼ï¼Œé‚£ä¹ˆJavaScriptä¼šå‡ºç°ä¸ç²¾ç¡®çš„é—®é¢˜ã€‚&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="java" scheme="https://ydstudios.gitee.io/tags/java/"/>
    
      <category term="JavaScript" scheme="https://ydstudios.gitee.io/tags/JavaScript/"/>
    
      <category term="æ•°æ®ç²¾åº¦" scheme="https://ydstudios.gitee.io/tags/%E6%95%B0%E6%8D%AE%E7%B2%BE%E5%BA%A6/"/>
    
  </entry>
  
  <entry>
    <title>ç¼–ç¨‹è¿‡ç¨‹ä¸­æŠ½è±¡ç±»å’Œæ¥å£çš„æŠ‰æ‹©</title>
    <link href="https://ydstudios.gitee.io/post/665bcc51.html"/>
    <id>https://ydstudios.gitee.io/post/665bcc51.html</id>
    <published>2020-08-24T21:51:35.000Z</published>
    <updated>2020-10-10T14:35:31.000Z</updated>
    
    <content type="html"><![CDATA[<p>ä½œä¸ºä¸€ä½ç¨‹åºå‘˜åœ¨ç¼–ç çš„è¿‡ç¨‹ä¸­ï¼Œç»ˆä¼šé‡åˆ°è¿™ç§æƒ…å†µï¼šè¿™ä¸ªåŠŸèƒ½æˆ‘åˆ°åº•æ˜¯ç”¨æ¥å£å‘¢ï¼Ÿè¿˜æ˜¯ç”¨æŠ½è±¡ç±»å‘¢ï¼Ÿ</p><a id="more"></a><p>æœ€è¿‘åœ¨é¡¹ç›®ä¸­è´Ÿè´£æ”¯ä»˜åŠŸèƒ½ï¼Œç”±äºé¡¹ç›®æ˜¯åœ¨åŸæœ‰çš„åŸºç¡€ä¸Šï¼Œç”±å°ç¨‹åºæ‰©å……ç»ˆç«¯åˆ°äº†Appï¼Œå°ç¨‹åºä¹‹å‰åˆå¯¹æ¥äº†å¾®ä¿¡çš„ jsapi ï¼Œæ‰€ä»¥ç°åœ¨çš„å¯¹æ¥æ”¯ä»˜å¹³å°çš„æƒ…å†µå˜ä¸ºï¼Œé“¶è”æ”¯ä»˜å®App æ”¯ä»˜ã€æ˜“ä»˜å® Appæ”¯ä»˜ã€å¾®ä¿¡jspaiæ”¯ä»˜ã€å¾®ä¿¡Appæ”¯ä»˜ã€‚ï¼ˆä¸ºå•¥æ²¡æœ‰å¯¹æ¥å°ç¨‹åºæ”¯ä»˜ï¼Œå´å¯¹æ¥äº† jsapi æ”¯ä»˜ï¼Œé‚£æˆ‘å°±ä¸æ™“å¾—äº†ï¼‰ã€‚å¯¹æ¥ä¸€ä¸ªå¹³å°çš„æ”¯ä»˜å°±éœ€è¦å®ç°ä¸‹å•ã€å¼‚æ­¥å›è°ƒå¤„ç†ã€è®¢å•æŸ¥è¯¢ã€è®¢å•é€€æ¬¾ã€è®¢å•é€€æ¬¾æŸ¥è¯¢ï¼Œäºæ˜¯æˆ‘å°±åœ¨æŠ½è±¡ç±»å’Œæ¥å£ä¹‹é—´å¾˜å¾Šï¼Œä¸è¿‡çŸ­æš‚çš„æ€è€ƒè¿‡åæˆ‘è¿˜æ˜¯é€‰æ‹©äº†æ¥å£ã€‚</p><p>é‚£ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æ¥å£ï¼Ÿä»€ä¹ˆæ—¶å€™ä½¿ç”¨æŠ½è±¡ç±»ï¼Ÿ</p><p>ä½¿ç”¨æŠ½è±¡ç±»æ˜¯ä¸ºäº†ä»£ç çš„å¤ç”¨ï¼Œè€Œä½¿ç”¨æ¥å£çš„åŠ¨æœºæ˜¯ä¸ºäº†å®ç°å¤šæ€æ€§ã€‚<br>æŠ½è±¡ç±»é€‚åˆç”¨æ¥å®šä¹‰æŸä¸ªé¢†åŸŸçš„å›ºæœ‰å±æ€§ï¼Œä¹Ÿå°±æ˜¯æœ¬è´¨ï¼Œæ¥å£é€‚åˆç”¨æ¥å®šä¹‰æŸä¸ªé¢†åŸŸçš„æ‰©å±•åŠŸèƒ½ã€‚</p><h4 id="ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æŠ½è±¡ç±»"><a href="#ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æŠ½è±¡ç±»" class="headerlink" title="ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æŠ½è±¡ç±»?"></a>ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æŠ½è±¡ç±»?</h4><ul><li>å½“2ä¸ªæˆ–å¤šä¸ªç±»ä¸­æœ‰é‡å¤éƒ¨åˆ†çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æŠ½è±¡å‡ºæ¥ä¸€ä¸ªåŸºç±»ï¼Œå¦‚æœå¸Œæœ›è¿™ä¸ªåŸºç±»ä¸èƒ½è¢«å®ä¾‹åŒ–ï¼Œå°±å¯ä»¥æŠŠè¿™ä¸ªåŸºç±»è®¾è®¡æˆæŠ½è±¡ç±»ã€‚</li><li>å½“éœ€è¦ä¸ºä¸€äº›ç±»æä¾›å…¬å…±çš„å®ç°ä»£ç æ—¶ï¼Œåº”ä¼˜å…ˆè€ƒè™‘æŠ½è±¡ç±»ã€‚ å› ä¸ºæŠ½è±¡ç±»ä¸­çš„éæŠ½è±¡æ–¹æ³•å¯ä»¥è¢«å­ç±»ç»§æ‰¿ä¸‹æ¥ï¼Œå› ä¸ºæŠ½è±¡ç±»ä¸­çš„éæŠ½è±¡æ–¹æ³•å¯ä»¥è¢«å­ç±»ç»§æ‰¿ä¸‹æ¥ï¼Œä½¿å®ç°åŠŸèƒ½çš„ä»£ç æ›´ç®€å•ã€‚æŠ½è±¡ç±»åªèƒ½æ˜¯å•ç»§æ‰¿çš„ï¼Œä¸èƒ½å¤šç»§æ‰¿ã€‚</li></ul><h4 id="ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æ¥å£ï¼Ÿ"><a href="#ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æ¥å£ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æ¥å£ï¼Ÿ"></a>ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æ¥å£ï¼Ÿ</h4><ul><li>å½“æ³¨é‡ä»£ç çš„æ‰©å±•æ€§è·Ÿå¯ç»´æŠ¤æ€§æ—¶ï¼Œåº”å½“ä¼˜å…ˆé‡‡ç”¨æ¥å£ã€‚</li><li>æ¥å£ä¸å®ç°å®ƒçš„ç±»ä¹‹é—´å¯ä»¥ä¸å­˜åœ¨ä»»ä½•å±‚æ¬¡å…³ç³»ï¼Œæ¥å£å¯ä»¥å®ç°æ¯«ä¸ç›¸å…³ç±»çš„ç›¸åŒè¡Œä¸ºï¼Œæ¯”æŠ½è±¡ç±»çš„ä½¿ç”¨æ›´åŠ æ–¹ä¾¿çµæ´»;</li><li>æ¥å£åªå…³å¿ƒå¯¹è±¡ä¹‹é—´çš„äº¤äº’çš„æ–¹æ³•ï¼Œè€Œä¸å…³å¿ƒå¯¹è±¡æ‰€å¯¹åº”çš„å…·ä½“ç±»ã€‚æ¥å£æ˜¯ç¨‹åºä¹‹é—´çš„ä¸€ä¸ªåè®®ï¼Œæ¯”æŠ½è±¡ç±»çš„ä½¿ç”¨æ›´å®‰å…¨ã€æ¸…æ™°ã€‚ä¸€èˆ¬ä½¿ç”¨æ¥å£çš„æƒ…å†µæ›´å¤šã€‚</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä½œä¸ºä¸€ä½ç¨‹åºå‘˜åœ¨ç¼–ç çš„è¿‡ç¨‹ä¸­ï¼Œç»ˆä¼šé‡åˆ°è¿™ç§æƒ…å†µï¼šè¿™ä¸ªåŠŸèƒ½æˆ‘åˆ°åº•æ˜¯ç”¨æ¥å£å‘¢ï¼Ÿè¿˜æ˜¯ç”¨æŠ½è±¡ç±»å‘¢ï¼Ÿ&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="ç¼–ç¨‹" scheme="https://ydstudios.gitee.io/tags/%E7%BC%96%E7%A8%8B/"/>
    
      <category term="æŠ½è±¡ç±»" scheme="https://ydstudios.gitee.io/tags/%E6%8A%BD%E8%B1%A1%E7%B1%BB/"/>
    
      <category term="æ¥å£" scheme="https://ydstudios.gitee.io/tags/%E6%8E%A5%E5%8F%A3/"/>
    
  </entry>
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼å­¦ä¹ ä¹‹è´£ä»»é“¾æ¨¡å¼</title>
    <link href="https://ydstudios.gitee.io/post/8ec2718b.html"/>
    <id>https://ydstudios.gitee.io/post/8ec2718b.html</id>
    <published>2020-05-12T22:36:21.000Z</published>
    <updated>2020-12-06T04:57:23.000Z</updated>
    
    <content type="html"><![CDATA[<h5 id="è´£ä»»é“¾æ¨¡å¼"><a href="#è´£ä»»é“¾æ¨¡å¼" class="headerlink" title="è´£ä»»é“¾æ¨¡å¼"></a>è´£ä»»é“¾æ¨¡å¼</h5><p>é¡¾åæ€ä¹‰ï¼Œè´£ä»»é“¾æ¨¡å¼ï¼ˆChain of Responsibility Patternï¼‰ä¸ºè¯·æ±‚åˆ›å»ºäº†ä¸€ä¸ªæ¥æ”¶è€…å¯¹è±¡çš„é“¾ã€‚è¿™ç§æ¨¡å¼ç»™äºˆè¯·æ±‚çš„ç±»å‹ï¼Œå¯¹è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…è¿›è¡Œè§£è€¦ã€‚è¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºè¡Œä¸ºå‹æ¨¡å¼ã€‚åœ¨è¿™ç§æ¨¡å¼ä¸­ï¼Œé€šå¸¸æ¯ä¸ªæ¥æ”¶è€…éƒ½åŒ…å«å¯¹å¦ä¸€ä¸ªæ¥æ”¶è€…çš„å¼•ç”¨ã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡ä¸èƒ½å¤„ç†è¯¥è¯·æ±‚ï¼Œé‚£ä¹ˆå®ƒä¼šæŠŠç›¸åŒçš„è¯·æ±‚ä¼ ç»™ä¸‹ä¸€ä¸ªæ¥æ”¶è€…ï¼Œä¾æ­¤ç±»æ¨ã€‚</p><a id="more"></a><h6 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h6><p>æ„å›¾ï¼šé¿å…è¯·æ±‚å‘é€è€…ä¸æ¥æ”¶è€…è€¦åˆåœ¨ä¸€èµ·ï¼Œè®©å¤šä¸ªå¯¹è±¡éƒ½æœ‰å¯èƒ½æ¥æ”¶è¯·æ±‚ï¼Œå°†è¿™äº›å¯¹è±¡è¿æ¥æˆä¸€æ¡é“¾ï¼Œå¹¶ä¸”æ²¿ç€è¿™æ¡é“¾ä¼ é€’è¯·æ±‚ï¼Œç›´åˆ°æœ‰å¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚</p><ul><li>ä¸»è¦è§£å†³ï¼šèŒè´£é“¾ä¸Šçš„å¤„ç†è€…è´Ÿè´£å¤„ç†è¯·æ±‚ï¼Œå®¢æˆ·åªéœ€è¦å°†è¯·æ±‚å‘é€åˆ°èŒè´£é“¾ä¸Šå³å¯ï¼Œæ— é¡»å…³å¿ƒè¯·æ±‚çš„å¤„ç†ç»†èŠ‚å’Œè¯·æ±‚çš„ä¼ é€’ï¼Œæ‰€ä»¥èŒè´£é“¾å°†è¯·æ±‚çš„å‘é€è€…å’Œè¯·æ±‚çš„å¤„ç†è€…è§£è€¦äº†ã€‚</li></ul><ul><li><p>ä½•æ—¶ä½¿ç”¨ ï¼šåœ¨å¤„ç†æ¶ˆæ¯çš„æ—¶å€™ä»¥è¿‡æ»¤å¾ˆå¤šé“ã€‚</p></li><li><p>å¦‚ä½•è§£å†³ï¼šæ‹¦æˆªçš„ç±»éƒ½å®ç°ç»Ÿä¸€æ¥å£ã€‚</p></li></ul><ul><li><p>å…³é”®ä»£ç ï¼šHandler é‡Œé¢èšåˆå®ƒè‡ªå·±ï¼Œåœ¨ HandlerRequest é‡Œåˆ¤æ–­æ˜¯å¦åˆé€‚ï¼Œå¦‚æœæ²¡è¾¾åˆ°æ¡ä»¶åˆ™å‘ä¸‹ä¼ é€’ï¼Œå‘è°ä¼ é€’ä¹‹å‰ set è¿›å»ã€‚</p></li><li><p>åº”ç”¨å®ä¾‹ï¼š 1ã€çº¢æ¥¼æ¢¦ä¸­çš„â€å‡»é¼“ä¼ èŠ±â€ã€‚ 2ã€JS ä¸­çš„äº‹ä»¶å†’æ³¡ã€‚ 3ã€JAVA WEB ä¸­ Apache Tomcat å¯¹ Encoding çš„å¤„ç†ï¼ŒStruts2 çš„æ‹¦æˆªå™¨ï¼Œjsp servlet çš„ Filterã€‚</p></li></ul><h6 id="ä¼˜ç‚¹ï¼š"><a href="#ä¼˜ç‚¹ï¼š" class="headerlink" title="ä¼˜ç‚¹ï¼š"></a>ä¼˜ç‚¹ï¼š</h6><ul><li>é™ä½è€¦åˆåº¦ã€‚å®ƒå°†è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…è§£è€¦ã€‚ </li><li>ç®€åŒ–äº†å¯¹è±¡ã€‚ä½¿å¾—å¯¹è±¡ä¸éœ€è¦çŸ¥é“é“¾çš„ç»“æ„ã€‚ </li><li>å¢å¼ºç»™å¯¹è±¡æŒ‡æ´¾èŒè´£çš„çµæ´»æ€§ã€‚é€šè¿‡æ”¹å˜é“¾å†…çš„æˆå‘˜æˆ–è€…è°ƒåŠ¨å®ƒä»¬çš„æ¬¡åºï¼Œå…è®¸åŠ¨æ€åœ°æ–°å¢æˆ–è€…åˆ é™¤è´£ä»»ã€‚</li><li>å¢åŠ æ–°çš„è¯·æ±‚å¤„ç†ç±»å¾ˆæ–¹ä¾¿ã€‚</li></ul><h6 id="ç¼ºç‚¹ï¼š"><a href="#ç¼ºç‚¹ï¼š" class="headerlink" title="ç¼ºç‚¹ï¼š"></a>ç¼ºç‚¹ï¼š</h6><ul><li><p>ä¸èƒ½ä¿è¯è¯·æ±‚ä¸€å®šè¢«æ¥æ”¶ã€‚ </p></li><li><p>ç³»ç»Ÿæ€§èƒ½å°†å—åˆ°ä¸€å®šå½±å“ï¼Œè€Œä¸”åœ¨è¿›è¡Œä»£ç è°ƒè¯•æ—¶ä¸å¤ªæ–¹ä¾¿ï¼Œå¯èƒ½ä¼šé€ æˆå¾ªç¯è°ƒç”¨ã€‚ </p></li><li><p>å¯èƒ½ä¸å®¹æ˜“è§‚å¯Ÿè¿è¡Œæ—¶çš„ç‰¹å¾ï¼Œæœ‰ç¢äºé™¤é”™ã€‚</p></li></ul><h6 id="ä½¿ç”¨åœºæ™¯ï¼š"><a href="#ä½¿ç”¨åœºæ™¯ï¼š" class="headerlink" title="ä½¿ç”¨åœºæ™¯ï¼š"></a>ä½¿ç”¨åœºæ™¯ï¼š</h6><ul><li>æœ‰å¤šä¸ªå¯¹è±¡å¯ä»¥å¤„ç†åŒä¸€ä¸ªè¯·æ±‚ï¼Œå…·ä½“å“ªä¸ªå¯¹è±¡å¤„ç†è¯¥è¯·æ±‚ç”±è¿è¡Œæ—¶åˆ»è‡ªåŠ¨ç¡®å®šã€‚ </li><li>åœ¨ä¸æ˜ç¡®æŒ‡å®šæ¥æ”¶è€…çš„æƒ…å†µä¸‹ï¼Œå‘å¤šä¸ªå¯¹è±¡ä¸­çš„ä¸€ä¸ªæäº¤ä¸€ä¸ªè¯·æ±‚ã€‚ </li><li>å¯åŠ¨æ€æŒ‡å®šä¸€ç»„å¯¹è±¡å¤„ç†è¯·æ±‚</li></ul><h6 id="å®é™…åœºæ™¯"><a href="#å®é™…åœºæ™¯" class="headerlink" title="å®é™…åœºæ™¯"></a>å®é™…åœºæ™¯</h6><p>æœ¬æ–‡ä»¥å„ç§ç”µå•†ç³»ç»Ÿè®¢å•å®ä»˜é‡‘é¢è®¡ç®—ä¸ºä¾‹ï¼Œè®¢å•æœ€ç»ˆç”¨æˆ·æ‰€éœ€è¦ä»˜çš„é‡‘é¢å¯èƒ½æ˜¯è¿™æ ·çš„ï¼š</p><p><strong>åº”ä»˜é‡‘é¢=è®¢å•é‡‘é¢-ä¼˜æƒ åˆ¸ä¼˜æƒ é‡‘é¢-ä¿ƒé”€æ´»åŠ¨ä¼˜æƒ é‡‘é¢-ä¼šå‘˜æƒç›Šä¼˜æƒ é‡‘é¢</strong></p><p>å½“ç„¶ä¹Ÿæœ‰å¯èƒ½è¿˜ä¼šå¢åŠ å…¶ä»–çš„è®¡ç®—æ­¥éª¤ï¼Œä½¿ç”¨è´£ä»»é“¾æ¨¡å¼æ¥å®ç°è®¢å•é‡‘é¢è®¡ç®—ï¼Œè‹¥å¢åŠ äº†å…¶ä»–è®¡ç®—æ­¥éª¤ï¼Œç›´æ¥å°†æ­¥éª¤åŠ å…¥åˆ°é“¾ä¸­å³å¯ï¼Œè€Œæ— éœ€æ”¹åŠ¨ä»¥å‰çš„ä»£ç ï¼Œæœ€å¤§ç¨‹åº¦å‡å°å‡ºé”™çš„å¯èƒ½æ€§ã€‚è´£ä»»é“¾åˆ†ä¸ºçº¯è´£ä»»é“¾ä¸ä¸çº¯è´£ä»»é“¾ï¼Œåœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œå¾ˆå°‘æœ‰çº¯çš„è´£ä»»é“¾ï¼Œæ‰€è°“çº¯çš„è´£ä»»é“¾ï¼Œå°±æ˜¯å•ä¸ªé“¾ä¸Šå¤„ç†å™¨è¦ä¹ˆç‹¬ç«‹å¤„ç†ï¼Œè¦ä¹ˆå¤„ç†ä¸äº†äº¤ç»™ä¸‹ä¸€ä¸ªå¤„ç†å™¨è¿›è¡Œå¤„ç†ã€‚</p><h6 id="æœ¬æ–‡ç¤ºä¾‹UMLå›¾"><a href="#æœ¬æ–‡ç¤ºä¾‹UMLå›¾" class="headerlink" title="æœ¬æ–‡ç¤ºä¾‹UMLå›¾"></a>æœ¬æ–‡ç¤ºä¾‹UMLå›¾</h6><p><img src="https://gitee.com/ydstudios/blogImage/raw/master/img/20200512224609.jpg" alt="ç¤ºä¾‹ UML å›¾"></p><p> <strong>ä¸ºäº†ç®€åŒ–ç¤ºä¾‹ï¼Œä»£ç ä¸­å…³äºä¼˜æƒ é‡‘é¢çš„è®¡ç®—éƒ½å†™å›ºå®šå€¼ã€‚</strong></p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å°è£…å¤„ç†å™¨é“¾å¤„ç†å…ƒç´ ä¸Šä¸‹æ–‡ï¼Œå³å¾…å¤„ç†çš„è®¢å•</span></span><br><span class="line"><span class="comment"> * çœç•¥ get/set æ–¹æ³•</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/5/4</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.6.5</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderDto</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å½“å‰å¤„ç†å™¨ä½äºå¤„ç†å™¨ chain ä¸Šçš„ä½ç½®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> pos;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¢å•å·</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String orderNo;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¢å•é‡‘é¢</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Double amount;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * VIP ç­‰çº§</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer vipLevel;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¼˜æƒ åˆ¸</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String couponNo;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  æŠ½è±¡å¤„ç†è€…</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/5/4</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.6.5</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderAbstractHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‡å…é‡‘é¢å¤„ç†</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> orderDto å¾…å¤„ç†è®¢å•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> chain å¤„ç†å™¨é“¾</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">doHandle</span><span class="params">(OrderDto orderDto, OrderHandlerChain chain)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¢å•å¤„ç†å™¨çš„æƒé‡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">int</span> <span class="title">weight</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>è®¢å•å¤„ç†å™¨é“¾<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è®¢å•å¤„ç†å™¨é“¾</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/5/4</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.6.5</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderHandlerChain</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;OrderAbstractHandler&gt; chainList = <span class="keyword">new</span> ArrayList&lt;&gt;(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åˆå§‹åŒ–è®¢å•å¤„ç†å™¨é“¾</span></span><br><span class="line"><span class="comment"> * çœŸå®ç¼–ç çš„æ—¶å€™å°½é‡ä¸è¦è¿™æ ·å†™ï¼Œè¿™æ ·ä¸å¤Ÿä¼˜é›…</span></span><br><span class="line"><span class="comment"> * å¯ä»¥å®ç°  ApplicationContextAware  è¿›è¡Œ bean çš„æ³¨å…¥æˆ–è€…å…¶ä»–æ–¹å¼å®ç°è‡ªåŠ¨æ³¨å…¥å°±å¥½</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">OrderHandlerChain</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        </span><br><span class="line">        chainList.add(<span class="keyword">new</span> CouponOrderHandler());</span><br><span class="line">        chainList.add(<span class="keyword">new</span> VipOrderHandler());</span><br><span class="line">        chainList.add(<span class="keyword">new</span> SalesOrderHandler());</span><br><span class="line">        <span class="comment">// æ ¹æ®å¤„ç†å™¨çš„æƒé‡ï¼Œå¯¹å¤„ç†å™¨é“¾ä¸­å…ƒç´ è¿›è¡Œæ’åº</span></span><br><span class="line">        chainList.sort(Comparator.comparingInt(OrderAbstractHandler::weight));</span><br><span class="line">        System.out.println(<span class="keyword">this</span>.chainList);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(OrderDto context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (context.getPos() &lt; chainList.size()) &#123;</span><br><span class="line">            OrderAbstractHandler handler = chainList.get(context.getPos());</span><br><span class="line">            <span class="comment">// ç§»åŠ¨ä½äºå¤„ç†å™¨é“¾ä¸­çš„ä½ç½®</span></span><br><span class="line">            context.setPos(context.getPos() + <span class="number">1</span>);</span><br><span class="line">            handler.doHandle(context, <span class="keyword">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">`</span><br></pre></td></tr></table></figure></li></ul><h6 id="å…·ä½“å¤„ç†å®ç°"><a href="#å…·ä½“å¤„ç†å®ç°" class="headerlink" title="å…·ä½“å¤„ç†å®ç°"></a>å…·ä½“å¤„ç†å®ç°</h6><ul><li>ä¼˜æƒ åˆ¸å‡å…é‡‘é¢å®ç°</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä¼˜æƒ åˆ¸å‡å…é‡‘é¢</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> åˆ˜æ´‹ Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/5/4</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.6.5</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CouponOrderHandler</span> <span class="keyword">extends</span> <span class="title">OrderAbstractHandler</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doHandle</span><span class="params">(OrderDto context, OrderHandlerChain chain)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (context.getCouponNo() != <span class="keyword">null</span>) &#123;</span><br><span class="line">            context.setAmount(context.getAmount() - <span class="number">10</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è°ƒç”¨ä¸‹ä¸€ä¸ªå¤„ç†å™¨è¿›è¡Œå¤„ç†</span></span><br><span class="line">        chain.handle(context);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">int</span> <span class="title">weight</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ä¼šå‘˜ç­‰çº§å‡å…é‡‘é¢å®ç°<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä¼šå‘˜ç­‰çº§å‡å…é‡‘é¢</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/5/4</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.6.5</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VipOrderHandler</span> <span class="keyword">extends</span> <span class="title">OrderAbstractHandler</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doHandle</span><span class="params">(OrderDto context, OrderHandlerChain chain)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (context.getVipLevel() &gt; <span class="number">2</span>) &#123;</span><br><span class="line">            context.setAmount(context.getAmount() - <span class="number">5</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è°ƒç”¨ä¸‹ä¸€ä¸ªå¤„ç†å™¨è¿›è¡Œå¤„ç†</span></span><br><span class="line">        chain.handle(context);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">int</span> <span class="title">weight</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>ä¿ƒé”€æ´»åŠ¨ä¼˜æƒ é‡‘é¢å®ç°<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä¿ƒé”€æ´»åŠ¨ä¼˜æƒ é‡‘é¢</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Sam</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/5/4</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.6.5</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SalesOrderHandler</span> <span class="keyword">extends</span> <span class="title">OrderAbstractHandler</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doHandle</span><span class="params">(OrderDto context, OrderHandlerChain chain)</span> </span>&#123;</span><br><span class="line">        Double amount = context.getAmount();</span><br><span class="line">        <span class="keyword">if</span> (amount != <span class="keyword">null</span> &amp;&amp; amount &gt; <span class="number">80</span>d) &#123;</span><br><span class="line">            context.setAmount(amount * <span class="number">0.9</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è°ƒç”¨ä¸‹ä¸€ä¸ªå¤„ç†å™¨è¿›è¡Œå¤„ç†</span></span><br><span class="line">        chain.handle(context);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">int</span> <span class="title">weight</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p><strong>æµ‹è¯•ç»“æœ</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        OrderHandlerChain orderHandlerChain = <span class="keyword">new</span> OrderHandlerChain();</span><br><span class="line">        OrderDto order = <span class="keyword">new</span> OrderDto();</span><br><span class="line">        order.setOrderNo(<span class="string">"123"</span>);</span><br><span class="line">        order.setAmount(<span class="number">100</span>d);</span><br><span class="line">        order.setVipLevel(<span class="number">3</span>);</span><br><span class="line">        order.setCouponNo(<span class="string">"111"</span>);</span><br><span class="line"></span><br><span class="line">        orderHandlerChain.handle(order);</span><br><span class="line">        System.out.println(<span class="string">"è®¢å•æœ€ç»ˆé‡‘é¢ä¸ºï¼š "</span> + order.getAmount());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆè¾“å‡ºç»“æœï¼š è®¢å•æœ€ç»ˆé‡‘é¢ä¸ºï¼š 76.5<br>å¦‚æœåˆ é™¤ä¼˜æƒ åˆ¸ï¼Œè®¢å•çš„å®ä»˜é‡‘é¢å°±åˆå˜åŠ¨äº†ã€‚</p><p><strong>æ€»ç»“ï¼š</strong></p><p>å¤„ç†å™¨é“¾è°ƒç”¨handleæ–¹æ³•ï¼Œé€ä¸ªè°ƒç”¨å¤„ç†å™¨é“¾ä¸­çš„å¤„ç†å™¨çš„doHanleæ–¹æ³•ï¼Œå¯¹è®¢å•è¿›è¡Œå¤„ç†ï¼Œå½“å‰å¤„ç†å™¨å¤„ç†å®Œæ¯•åï¼Œå¯ä»¥é€‰æ‹©æ˜¯å¦ç»§ç»­äº¤ç”±ä¸‹ä¸€ä¸ªå¤„ç†å™¨è¿›è¡Œå¤„ç†ï¼Œå³è®¾ç½®chain.handle(context);ï¼Œå¦‚æœä¸éœ€è¦ç»§ç»­å¾€ä¸‹å¤„ç†ï¼Œä¸è°ƒç”¨æ­¤ä»£ç å³å¯ã€‚ </p><p>ç½‘ä¸Šæµä¼ çš„ä»£ç éƒ½æ˜¯ç›´æ¥åœ¨æŠ½è±¡å¤„ç†å™¨ä¸­åŒ…å«ä¸‹ä¸€ä¸ªå¤„ç†å™¨çš„å¼•ç”¨ï¼Œè¿™æ ·å¯¼è‡´åœ¨å®¢æˆ·ç«¯ä½¿ç”¨çš„æ—¶å€™ï¼Œå°±éœ€è¦æ‰‹åŠ¨å»é€ä¸ªsetä¸‹çº§å¤„ç†å™¨ï¼Œæ‰‹è¯¯å¾ˆå®¹æ˜“é€ æˆå¤„ç†å™¨æ­»å¾ªç¯çš„æƒ…å†µï¼Œä¹Ÿå¯èƒ½å‡ºç°ç¼ºå¤±æŸä¸ªå¤„ç†å™¨çš„æƒ…å†µï¼Œå› è€Œæœ¬æ–‡å‚ç…§Tomcatæºç ä¸­Filterçš„ä½œæ³•ï¼Œå¼•å…¥äº†Chainç±»ï¼Œç»Ÿä¸€å¯¹å¤„ç†å™¨å°è£…ä¸ºé“¾ï¼Œå‡å°‘å®¢æˆ·ç«¯ä½¿ç”¨æ—¶å‡ºé”™çš„å¯èƒ½ã€‚</p><p>é“¾å¼å¤„ç†çš„å¥½å¤„åœ¨äºå¢åŠ å‡å°‘æ–°çš„å¤„ç†å™¨ä¸ä¼šå½±å“å…¶ä»–å¤„ç†å™¨çš„é€»è¾‘ï¼Œå„ä¸ªå¤„ç†å™¨ä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼Œå¯ä»¥å‡å°è€¦åˆå¸¦æ¥çš„å½±å“ã€‚</p><blockquote><p>å‚è€ƒ<a href="http://nullpointer.pw/design-patterns-chain-responsibility.html" target="_blank" rel="noopener">è®¾è®¡æ¨¡å¼ä¹‹è´£ä»»é“¾æ¨¡å¼å®æˆ˜</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;h5 id=&quot;è´£ä»»é“¾æ¨¡å¼&quot;&gt;&lt;a href=&quot;#è´£ä»»é“¾æ¨¡å¼&quot; class=&quot;headerlink&quot; title=&quot;è´£ä»»é“¾æ¨¡å¼&quot;&gt;&lt;/a&gt;è´£ä»»é“¾æ¨¡å¼&lt;/h5&gt;&lt;p&gt;é¡¾åæ€ä¹‰ï¼Œè´£ä»»é“¾æ¨¡å¼ï¼ˆChain of Responsibility Patternï¼‰ä¸ºè¯·æ±‚åˆ›å»ºäº†ä¸€ä¸ªæ¥æ”¶è€…å¯¹è±¡çš„é“¾ã€‚è¿™ç§æ¨¡å¼ç»™äºˆè¯·æ±‚çš„ç±»å‹ï¼Œå¯¹è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…è¿›è¡Œè§£è€¦ã€‚è¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºè¡Œä¸ºå‹æ¨¡å¼ã€‚åœ¨è¿™ç§æ¨¡å¼ä¸­ï¼Œé€šå¸¸æ¯ä¸ªæ¥æ”¶è€…éƒ½åŒ…å«å¯¹å¦ä¸€ä¸ªæ¥æ”¶è€…çš„å¼•ç”¨ã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡ä¸èƒ½å¤„ç†è¯¥è¯·æ±‚ï¼Œé‚£ä¹ˆå®ƒä¼šæŠŠç›¸åŒçš„è¯·æ±‚ä¼ ç»™ä¸‹ä¸€ä¸ªæ¥æ”¶è€…ï¼Œä¾æ­¤ç±»æ¨ã€‚&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="java" scheme="https://ydstudios.gitee.io/tags/java/"/>
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="https://ydstudios.gitee.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
      <category term="è´£ä»»é“¾æ¨¡å¼" scheme="https://ydstudios.gitee.io/tags/%E8%B4%A3%E4%BB%BB%E9%93%BE%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>MySQLçš„bin-log</title>
    <link href="https://ydstudios.gitee.io/post/d1d9a9.html"/>
    <id>https://ydstudios.gitee.io/post/d1d9a9.html</id>
    <published>2020-03-15T15:22:12.000Z</published>
    <updated>2020-12-18T14:02:34.000Z</updated>
    
    <content type="html"><![CDATA[<h6 id="ä»€ä¹ˆæ˜¯binlogï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯binlogï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯binlogï¼Ÿ"></a>ä»€ä¹ˆæ˜¯binlogï¼Ÿ</h6><p>mysql-binlogæ˜¯MySQLæ•°æ®åº“çš„äºŒè¿›åˆ¶æ—¥å¿—ï¼Œç”¨äºè®°å½•ç”¨æˆ·å¯¹æ•°æ®åº“æ“ä½œçš„SQLè¯­å¥ï¼ˆé™¤äº†æ•°æ®æŸ¥è¯¢è¯­å¥ï¼Œå³è®°å½•insertã€updateã€deleteçš„sqlï¼‰ä¿¡æ¯ã€‚<br>å¯ä»¥ä½¿ç”¨mysqlbinå‘½ä»¤æŸ¥çœ‹äºŒè¿›åˆ¶æ—¥å¿—çš„å†…å®¹ã€‚</p><a id="more"></a><h6 id="MySQL-bin-log-çš„æ ¼å¼"><a href="#MySQL-bin-log-çš„æ ¼å¼" class="headerlink" title="MySQL bin-log çš„æ ¼å¼"></a>MySQL bin-log çš„æ ¼å¼</h6><p>binlogçš„æ ¼å¼ä¹Ÿæœ‰ä¸‰ç§ï¼šSTATEMENTã€ROWã€MIXED </p><ul><li><p>1ã€ STATMENTæ¨¡å¼ï¼šåŸºäºSQLè¯­å¥çš„å¤åˆ¶(statement-based replication, SBR)ï¼Œæ¯ä¸€æ¡ä¼šä¿®æ”¹æ•°æ®çš„sqlè¯­å¥ä¼šè®°å½•åˆ°binlogä¸­ã€‚<br>ä¼˜ç‚¹ï¼šä¸éœ€è¦è®°å½•æ¯ä¸€æ¡SQLè¯­å¥ä¸æ¯è¡Œçš„æ•°æ®å˜åŒ–ï¼Œè¿™æ ·å­binlogçš„æ—¥å¿—ä¹Ÿä¼šæ¯”è¾ƒå°‘ï¼Œå‡å°‘äº†ç£ç›˜IOï¼Œæé«˜æ€§èƒ½ã€‚<br>ç¼ºç‚¹ï¼šåœ¨æŸäº›æƒ…å†µä¸‹ä¼šå¯¼è‡´master-slaveä¸­çš„æ•°æ®ä¸ä¸€è‡´(å¦‚sleep()å‡½æ•°ï¼Œ last_insert_id()ï¼Œä»¥åŠuser-defined functions(udf)ç­‰ä¼šå‡ºç°é—®é¢˜)</p></li><li><p>2ã€ROWæ¨¡å¼ï¼šåŸºäºè¡Œçš„å¤åˆ¶(row-based replication, RBR)ï¼šä¸è®°å½•æ¯ä¸€æ¡SQLè¯­å¥çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œä»…éœ€è®°å½•å“ªæ¡æ•°æ®è¢«ä¿®æ”¹äº†ï¼Œä¿®æ”¹æˆäº†ä»€ä¹ˆæ ·å­äº†ã€‚<br>ä¼˜ç‚¹ï¼šä¸ä¼šå‡ºç°æŸäº›ç‰¹å®šæƒ…å†µä¸‹çš„å­˜å‚¨è¿‡ç¨‹ã€æˆ–functionã€æˆ–triggerçš„è°ƒç”¨å’Œè§¦å‘æ— æ³•è¢«æ­£ç¡®å¤åˆ¶çš„é—®é¢˜ã€‚<br>ç¼ºç‚¹ï¼šä¼šäº§ç”Ÿå¤§é‡çš„æ—¥å¿—ï¼Œå°¤å…¶æ˜¯alter tableçš„æ—¶å€™ä¼šè®©æ—¥å¿—æš´æ¶¨ã€‚</p></li><li><p>3ã€MIXEDæ¨¡å¼ï¼šæ··åˆæ¨¡å¼å¤åˆ¶(mixed-based replication, MBR)ï¼šä»¥ä¸Šä¸¤ç§æ¨¡å¼çš„æ··åˆä½¿ç”¨ï¼Œä¸€èˆ¬çš„å¤åˆ¶ä½¿ç”¨STATEMENTæ¨¡å¼ä¿å­˜binlogï¼Œå¯¹äºSTATEMENTæ¨¡å¼æ— æ³•å¤åˆ¶çš„æ“ä½œä½¿ç”¨ROWæ¨¡å¼ä¿å­˜binlogï¼ŒMySQLä¼šæ ¹æ®æ‰§è¡Œçš„SQLè¯­å¥é€‰æ‹©æ—¥å¿—ä¿å­˜æ–¹å¼ã€‚</p></li></ul><h6 id="æœåŠ¡å™¨ä¸Šç”¨å“ªç§æ¨¡å¼å¥½å‘¢ï¼Ÿ"><a href="#æœåŠ¡å™¨ä¸Šç”¨å“ªç§æ¨¡å¼å¥½å‘¢ï¼Ÿ" class="headerlink" title="æœåŠ¡å™¨ä¸Šç”¨å“ªç§æ¨¡å¼å¥½å‘¢ï¼Ÿ"></a>æœåŠ¡å™¨ä¸Šç”¨å“ªç§æ¨¡å¼å¥½å‘¢ï¼Ÿ</h6><p>æˆ‘ä»¬æ¥ä¸¾ä¾‹å­è¯´æ˜ï¼š</p><ul><li><ol><li>insert into xxtable values (x,y,z)ä¸ºä¾‹</li></ol></li></ul><p>å½±å“ï¼š1è¡Œ,ä¸”ä¸ºæ–°å¢1è¡Œ, å¯¹äºå…¶ä»–è¡Œæ²¡æœ‰å½±å“. è¿™ä¸ªæƒ…å†µ,ç”¨rowæ ¼å¼,ç›´æ¥å¤åˆ¶ç£ç›˜ä¸Š1è¡Œçš„æ–°å¢å˜åŒ–ã€‚</p><ul><li><ol start="2"><li>update xxtable set age=21 where name=â€™sssâ€™ä¸ºä¾‹<br>å½±å“ï¼šä¸€èˆ¬ä¹Ÿåªæ˜¯å½±å“1è¡Œ. ç”¨rowä¹Ÿæ¯”è¾ƒåˆé€‚ã€‚</li></ol></li><li><ol start="3"><li>è¿‡å¹´å‘çº¢åŒ…,å…¨å…¬å¸çš„äºº,éƒ½æ¶¨è–ª100å…ƒ.<br>update xxtable set salary=salary+100;<br>å½±å“: è¿™ä¸ªè¯­å¥å¸¦æ¥çš„å½±å“æ˜¯é’ˆå¯¹æ¯ä¸€è¡Œçš„, å› æ­¤ç£ç›˜ä¸Šå¾ˆå¤šrowéƒ½å‘ç”Ÿäº†å˜åŒ–.æ­¤å¤„é€‚åˆç”¨statmentæ ¼å¼çš„æ—¥å¿—.</li></ol></li></ul><p>MySQLåæ¥åˆæä¾›äº†ä¸€ä¸ªæ–°çš„æ··åˆæ¨¡å¼ï¼ˆMIXEDï¼‰ï¼Œå¾ˆå¥½ç†è§£ä¸ºä¸Šè¿°ä¸¤ç§çš„æ¨¡å¼çš„è‡ªç”±åˆ‡æ¢ã€‚Mysqlä¼šæ ¹æ®æ‰§è¡ŒSQLæ¥é€‰æ‹©ä½¿ç”¨STATEMENTè¿˜æ˜¯ROWæ¨¡å¼ã€‚<br>æ‰€ä»¥æˆ‘ä»¬ç”¨è¿™ç§æ¨¡å¼æ˜¯æœ€å¥½çš„ï¼Œèƒ½å…¼é¡¾ä¸¤è€…çš„ä¼˜ç‚¹ã€‚</p><h6 id="MySQLå¦‚ä½•é…ç½®bin-log"><a href="#MySQLå¦‚ä½•é…ç½®bin-log" class="headerlink" title="MySQLå¦‚ä½•é…ç½®bin-log"></a>MySQLå¦‚ä½•é…ç½®bin-log</h6><p>åœ¨MySQLé…ç½®æ–‡ä»¶my.cnfæ–‡ä»¶ä¸­çš„mysqldèŠ‚ä¸­æ·»åŠ ä¸‹é¢çš„é…ç½®æ–‡ä»¶ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line"><span class="comment">#è®¾ç½®æ—¥å¿—æ ¼å¼</span></span><br><span class="line">binlog_format = mixed</span><br><span class="line"></span><br><span class="line"><span class="comment">#è®¾ç½®æ—¥å¿—è·¯å¾„ï¼Œæ³¨æ„è·¯ç»éœ€è¦mysqlç”¨æˆ·æœ‰æƒé™å†™</span></span><br><span class="line">log-bin = /data/mysql/logs/mysql-bin.log</span><br><span class="line"></span><br><span class="line"><span class="comment">#è®¾ç½®binlogæ¸…ç†æ—¶é—´</span></span><br><span class="line">expire_logs_days = 7</span><br><span class="line"></span><br><span class="line"><span class="comment">#binlogæ¯ä¸ªæ—¥å¿—æ–‡ä»¶å¤§å°</span></span><br><span class="line">max_binlog_size = 100m</span><br><span class="line"></span><br><span class="line"><span class="comment">#binlogç¼“å­˜å¤§å°</span></span><br><span class="line">binlog_cache_size = 4m</span><br><span class="line"></span><br><span class="line"><span class="comment">#æœ€å¤§binlogç¼“å­˜å¤§å°</span></span><br><span class="line">max_binlog_cache_size = 512m</span><br></pre></td></tr></table></figure><p>é‡å¯MySQLç”Ÿæ•ˆï¼Œå¦‚æœä¸æ–¹ä¾¿é‡å¯æœåŠ¡ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä¿®æ”¹å¯¹åº”çš„å˜é‡å³å¯ã€‚</p><h6 id="MySQLçš„bin-logå¦‚ä½•æŸ¥çœ‹"><a href="#MySQLçš„bin-logå¦‚ä½•æŸ¥çœ‹" class="headerlink" title="MySQLçš„bin-logå¦‚ä½•æŸ¥çœ‹"></a>MySQLçš„bin-logå¦‚ä½•æŸ¥çœ‹</h6><p>MySQLçš„bin-logæ˜¯äºŒè¿›åˆ¶æ ¼å¼çš„æ— æ³•ç›´æ¥æŸ¥çœ‹ï¼ŒMySQLæä¾›äº†ä¸¤ç§æ–¹å¼è¿›è¡ŒæŸ¥çœ‹ã€‚</p><ul><li>1ã€ ç®€å•æŸ¥çœ‹ show binlog events<br>è¯­æ³• ï¼š<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">BINLOG</span> <span class="keyword">EVENTS</span></span><br><span class="line">[<span class="keyword">IN</span> <span class="string">'log_name'</span>]</span><br><span class="line">[<span class="keyword">FROM</span> pos]</span><br><span class="line">[<span class="keyword">LIMIT</span> [<span class="keyword">offset</span>,] <span class="keyword">row_count</span>]</span><br></pre></td></tr></table></figure>åœ¨MySQLå®¢æˆ·ç«¯ä¸­æ‰§è¡Œ<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">mysql&gt; show binlog events in 'mysql-bin.000004' \G</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">   Log_name: mysql-bin.000004</span><br><span class="line">        Pos: 4</span><br><span class="line"> Event_type: Format_desc</span><br><span class="line">  Server_id: 1</span><br><span class="line">End_log_pos: 107</span><br><span class="line">       Info: Server ver: 5.5.48-log, Binlog ver: 4</span><br><span class="line">*************************** 2. row ***************************</span><br><span class="line">   Log_name: mysql-bin.000004</span><br><span class="line">        Pos: 107</span><br><span class="line"> Event_type: Query</span><br><span class="line">  Server_id: 1</span><br><span class="line">End_log_pos: 331</span><br><span class="line">       Info: <span class="keyword">use</span> <span class="string">`db01`</span>; <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`student`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="string">`student_name`</span> <span class="built_in">varchar</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8</span><br><span class="line">*************************** <span class="number">3.</span> <span class="keyword">row</span> ***************************</span><br><span class="line">   Log_name: mysql-<span class="keyword">bin</span><span class="number">.000004</span></span><br><span class="line">        Pos: <span class="number">331</span></span><br><span class="line"> Event_type: <span class="keyword">Query</span></span><br><span class="line">  Server_id: <span class="number">1</span></span><br><span class="line">End_log_pos: <span class="number">399</span></span><br><span class="line">       Info: <span class="keyword">BEGIN</span></span><br><span class="line">*************************** <span class="number">4.</span> <span class="keyword">row</span> ***************************</span><br><span class="line">   Log_name: mysql-<span class="keyword">bin</span><span class="number">.000004</span></span><br><span class="line">        Pos: <span class="number">399</span></span><br><span class="line"> Event_type: Intvar</span><br><span class="line">  Server_id: <span class="number">1</span></span><br><span class="line">End_log_pos: <span class="number">427</span></span><br><span class="line">       Info: INSERT_ID=<span class="number">1</span></span><br><span class="line">*************************** <span class="number">5.</span> <span class="keyword">row</span> ***************************</span><br><span class="line">   Log_name: mysql-<span class="keyword">bin</span><span class="number">.000004</span></span><br><span class="line">        Pos: <span class="number">427</span></span><br><span class="line"> Event_type: <span class="keyword">Query</span></span><br><span class="line">  Server_id: <span class="number">1</span></span><br><span class="line">End_log_pos: <span class="number">563</span></span><br><span class="line">       Info: <span class="keyword">use</span> <span class="string">`db01`</span>; <span class="keyword">insert</span> <span class="keyword">into</span> <span class="string">`db01`</span>.<span class="string">`student`</span> ( <span class="string">`id`</span>, <span class="string">`student_name`</span>) <span class="keyword">values</span> ( <span class="string">'0'</span>, <span class="string">'jim'</span>)</span><br><span class="line">*************************** <span class="number">6.</span> <span class="keyword">row</span> ***************************</span><br><span class="line">   Log_name: mysql-<span class="keyword">bin</span><span class="number">.000004</span></span><br><span class="line">        Pos: <span class="number">563</span></span><br><span class="line"> Event_type: Xid</span><br><span class="line">  Server_id: <span class="number">1</span></span><br><span class="line">End_log_pos: <span class="number">590</span></span><br><span class="line">       Info: <span class="keyword">COMMIT</span> <span class="comment">/* xid=22 */</span></span><br><span class="line">*************************** <span class="number">7.</span> <span class="keyword">row</span> ***************************</span><br><span class="line">   Log_name: mysql-<span class="keyword">bin</span><span class="number">.000004</span></span><br><span class="line">        Pos: <span class="number">590</span></span><br><span class="line"> Event_type: <span class="keyword">Query</span></span><br><span class="line">  Server_id: <span class="number">1</span></span><br><span class="line">End_log_pos: <span class="number">842</span></span><br><span class="line">       Info: <span class="keyword">use</span> <span class="string">`db02`</span>; <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`student`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="string">`student_name`</span> <span class="built_in">varchar</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`birthday`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8</span><br><span class="line">*************************** <span class="number">8.</span> <span class="keyword">row</span> ***************************</span><br><span class="line">   Log_name: mysql-<span class="keyword">bin</span><span class="number">.000004</span></span><br><span class="line">        Pos: <span class="number">842</span></span><br><span class="line"> Event_type: <span class="keyword">Query</span></span><br><span class="line">  Server_id: <span class="number">1</span></span><br><span class="line">End_log_pos: <span class="number">910</span></span><br><span class="line">       Info: <span class="keyword">BEGIN</span></span><br><span class="line">*************************** <span class="number">9.</span> <span class="keyword">row</span> ***************************</span><br><span class="line">   Log_name: mysql-<span class="keyword">bin</span><span class="number">.000004</span></span><br><span class="line">        Pos: <span class="number">910</span></span><br><span class="line"> Event_type: Intvar</span><br><span class="line">  Server_id: <span class="number">1</span></span><br><span class="line">End_log_pos: <span class="number">938</span></span><br><span class="line">       Info: INSERT_ID=<span class="number">2</span></span><br><span class="line">*************************** <span class="number">10.</span> <span class="keyword">row</span> ***************************</span><br><span class="line">   Log_name: mysql-<span class="keyword">bin</span><span class="number">.000004</span></span><br><span class="line">        Pos: <span class="number">938</span></span><br><span class="line"> Event_type: <span class="keyword">Query</span></span><br><span class="line">  Server_id: <span class="number">1</span></span><br><span class="line">End_log_pos: <span class="number">1077</span></span><br><span class="line">       Info: <span class="keyword">use</span> <span class="string">`db01`</span>; <span class="keyword">insert</span> <span class="keyword">into</span> <span class="string">`db01`</span>.<span class="string">`student`</span> ( <span class="string">`id`</span>, <span class="string">`student_name`</span>) <span class="keyword">values</span> ( <span class="string">'0'</span>, <span class="string">'åˆ˜æ´‹'</span>)</span><br><span class="line">*************************** <span class="number">11.</span> <span class="keyword">row</span> ***************************</span><br><span class="line">   Log_name: mysql-<span class="keyword">bin</span><span class="number">.000004</span></span><br><span class="line">        Pos: <span class="number">1077</span></span><br><span class="line"> Event_type: Xid</span><br><span class="line">  Server_id: <span class="number">1</span></span><br><span class="line">End_log_pos: <span class="number">1104</span></span><br><span class="line">       Info: <span class="keyword">COMMIT</span> <span class="comment">/* xid=128 */</span></span><br><span class="line">*************************** <span class="number">12.</span> <span class="keyword">row</span> ***************************</span><br><span class="line">   Log_name: mysql-<span class="keyword">bin</span><span class="number">.000004</span></span><br><span class="line">        Pos: <span class="number">1104</span></span><br><span class="line"> Event_type: <span class="keyword">Query</span></span><br><span class="line">  Server_id: <span class="number">1</span></span><br><span class="line">End_log_pos: <span class="number">1172</span></span><br><span class="line">       Info: <span class="keyword">BEGIN</span></span><br><span class="line">*************************** <span class="number">13.</span> <span class="keyword">row</span> ***************************</span><br><span class="line">   Log_name: mysql-<span class="keyword">bin</span><span class="number">.000004</span></span><br><span class="line">        Pos: <span class="number">1172</span></span><br><span class="line"> Event_type: Intvar</span><br><span class="line">  Server_id: <span class="number">1</span></span><br><span class="line">End_log_pos: <span class="number">1200</span></span><br><span class="line">       Info: INSERT_ID=<span class="number">3</span></span><br><span class="line">*************************** <span class="number">14.</span> <span class="keyword">row</span> ***************************</span><br><span class="line">   Log_name: mysql-<span class="keyword">bin</span><span class="number">.000004</span></span><br><span class="line">        Pos: <span class="number">1200</span></span><br><span class="line"> Event_type: <span class="keyword">Query</span></span><br><span class="line">  Server_id: <span class="number">1</span></span><br><span class="line">End_log_pos: <span class="number">1342</span></span><br><span class="line">       Info: <span class="keyword">use</span> <span class="string">`db01`</span>; <span class="keyword">insert</span> <span class="keyword">into</span> <span class="string">`db01`</span>.<span class="string">`student`</span> ( <span class="string">`id`</span>, <span class="string">`student_name`</span>) <span class="keyword">values</span> ( <span class="string">'0'</span>, <span class="string">'å¼ ä»å®¹'</span>)</span><br><span class="line">*************************** <span class="number">15.</span> <span class="keyword">row</span> ***************************</span><br><span class="line">   Log_name: mysql-<span class="keyword">bin</span><span class="number">.000004</span></span><br><span class="line">        Pos: <span class="number">1342</span></span><br><span class="line"> Event_type: Xid</span><br><span class="line">  Server_id: <span class="number">1</span></span><br><span class="line">End_log_pos: <span class="number">1369</span></span><br><span class="line">       Info: <span class="keyword">COMMIT</span> <span class="comment">/* xid=146 */</span></span><br><span class="line"><span class="number">15</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure></li></ul><p>å…¶å®æˆ‘åœ¨14å’Œ15è¡Œä¹‹é—´ï¼Œè¿›è¡Œäº†ä¸€æ¬¡SelectæŸ¥è¯¢ï¼Œä½†æ˜¯è¿™ä¸ªæ“ä½œåœ¨bin-logä¸­å¹¶æ²¡æœ‰å‘ç°ï¼Œå°è¯äº†å¼€å¤´è¯´çš„bin-logä¸è®°å½•SelectæŸ¥è¯¢ã€‚</p><p><strong>ä¸Šè¿°å‡ºç°çš„å‚æ•°è§£é‡Šï¼š</strong></p><ul><li>Log_name:The name of the file that is being listed.</li><li>Posï¼šThe position at which the event occurs.</li><li>Event_typeï¼šAn identifier that describes the event type.</li><li>Server_idï¼šThe server ID of the server on which the event originated.</li><li>End_log_posï¼šThe position at which the next event begins, which is equal to Pos plus the size of the event.</li><li>Infoï¼šMore detailed information about the event type. The format of this information depends on the event type.</li></ul><ul><li><p>1ã€ è¯¦ç»†æŸ¥çœ‹ mysqlbinlog</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¯­æ³•ï¼š mysqlbinlog [bin-log-name]</span><br></pre></td></tr></table></figure></li><li><p>é—®é¢˜1ï¼šæ— æ³•è¯†åˆ«çš„ç¼–ç </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Sam-Mac:data Sam$ /usr/local/mysql/bin/mysqlbinlog  ./mysql-bin.000004</span><br><span class="line">/usr/local/mysql/bin/mysqlbinlog: unknown variable 'default-character-set=utf8'</span><br></pre></td></tr></table></figure><p>åŸå› ï¼š mysqlbinlogè¿™ä¸ªå·¥å…·æ— æ³•è¯†åˆ«binlogä¸­çš„é…ç½®ä¸­çš„default-character-set=utf8mb4è¿™ä¸ªæŒ‡ä»¤ï¼Œä½¿ç”¨å‚æ•°â€“no-defaults</p></li><li><p>é—®é¢˜2ï¼šbin-logæ—¥å¿—æ–‡ä»¶ä¸å­˜åœ¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/mysql/bin/mysqlbinlog: File './mysql-bin.000004' not found (Errcode: 13)</span><br></pre></td></tr></table></figure><p>åŸå› ï¼šæƒé™é—®é¢˜ä½¿ç”¨sudo</p></li></ul><p><strong>æœ€ç»ˆå‘½ä»¤ï¼š sudo /usr/local/mysql/bin/mysqlbinlog â€“no-defaults /usr/local/mysql/data/mysql-bin.000004</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">Sam-Mac:data Sam$ sudo /usr/local/mysql/bin/mysqlbinlog <span class="comment">--no-defaults /usr/local/mysql/data/mysql-bin.000004</span></span><br><span class="line"><span class="comment">/*!50530 SET @@SESSION.PSEUDO_SLAVE_MODE=1*/</span>;</span><br><span class="line"><span class="comment">/*!40019 SET @@session.max_insert_delayed_threads=0*/</span>;</span><br><span class="line"><span class="comment">/*!50003 SET @OLD_COMPLETION_TYPE=@@COMPLETION_TYPE,COMPLETION_TYPE=0*/</span>;</span><br><span class="line">DELIMITER <span class="comment">/*!*/</span>;</span><br><span class="line"><span class="comment"># at 4</span></span><br><span class="line"><span class="comment">#200315 13:18:28 server id 1  end_log_pos 107 Start: binlog v 4, server v 5.5.48-log created 200315 13:18:28 at startup</span></span><br><span class="line"><span class="comment"># Warning: this binlog is either in use or was not closed properly.</span></span><br><span class="line"><span class="keyword">ROLLBACK</span><span class="comment">/*!*/</span>;</span><br><span class="line">BINLOG '</span><br><span class="line">pLptXg8BAAAAZwAAAGsAAAABAAQANS41LjQ4LWxvZwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAACkum1eEzgNAAgAEgAEBAQEEgAAVAAEGggAAAAICAgCAA==</span><br><span class="line">'<span class="comment">/*!*/</span>;</span><br><span class="line"><span class="comment"># at 107</span></span><br><span class="line"><span class="comment">#200315 13:21:09 server id 1  end_log_pos 331 Querythread_id=5exec_time=0error_code=0</span></span><br><span class="line"><span class="keyword">use</span> <span class="string">`db01`</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="keyword">SET</span> <span class="built_in">TIMESTAMP</span>=<span class="number">1584249669</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="keyword">SET</span> @@session.pseudo_thread_id=<span class="number">5</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="keyword">SET</span> @@session.foreign_key_checks=<span class="number">1</span>, @@session.sql_auto_is_null=<span class="number">0</span>, @@session.unique_checks=<span class="number">1</span>, @@session.autocommit=<span class="number">1</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="keyword">SET</span> @@session.sql_mode=<span class="number">0</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="keyword">SET</span> @@session.auto_increment_increment=<span class="number">1</span>, @@session.auto_increment_offset=<span class="number">1</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="comment">/*!\C utf8 */</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="keyword">SET</span> @@session.character_set_client=<span class="number">33</span>,@@session.collation_connection=<span class="number">33</span>,@@session.collation_server=<span class="number">33</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="keyword">SET</span> @@session.lc_time_names=<span class="number">0</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="keyword">SET</span> @@session.collation_database=<span class="keyword">DEFAULT</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`student`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="string">`student_name`</span> <span class="built_in">varchar</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8</span><br><span class="line"><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="comment"># at 331</span></span><br><span class="line"><span class="comment">#200315 13:22:39 server id 1  end_log_pos 399 Querythread_id=59exec_time=0error_code=0</span></span><br><span class="line"><span class="keyword">SET</span> <span class="built_in">TIMESTAMP</span>=<span class="number">1584249759</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="comment"># at 399</span></span><br><span class="line"><span class="comment">#200315 13:22:39 server id 1  end_log_pos 427 Intvar</span></span><br><span class="line"><span class="keyword">SET</span> INSERT_ID=<span class="number">1</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="comment"># at 427</span></span><br><span class="line"><span class="comment">#200315 13:22:39 server id 1  end_log_pos 563 Querythread_id=59exec_time=0error_code=0</span></span><br><span class="line"><span class="keyword">SET</span> <span class="built_in">TIMESTAMP</span>=<span class="number">1584249759</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="string">`db01`</span>.<span class="string">`student`</span> ( <span class="string">`id`</span>, <span class="string">`student_name`</span>) <span class="keyword">values</span> ( <span class="string">'0'</span>, <span class="string">'jim'</span>)</span><br><span class="line"><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="comment"># at 563</span></span><br><span class="line"><span class="comment">#200315 13:22:39 server id 1  end_log_pos 590 Xid = 22</span></span><br><span class="line"><span class="keyword">COMMIT</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="comment"># at 590</span></span><br><span class="line"><span class="comment">#200315 13:25:56 server id 1  end_log_pos 842 Querythread_id=5exec_time=0error_code=0</span></span><br><span class="line"><span class="keyword">use</span> <span class="string">`db02`</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="keyword">SET</span> <span class="built_in">TIMESTAMP</span>=<span class="number">1584249956</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`student`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="string">`student_name`</span> <span class="built_in">varchar</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`birthday`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8</span><br><span class="line"><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="comment"># at 842</span></span><br><span class="line"><span class="comment">#200315 16:36:37 server id 1  end_log_pos 910 Querythread_id=1201exec_time=0error_code=0</span></span><br><span class="line"><span class="keyword">SET</span> <span class="built_in">TIMESTAMP</span>=<span class="number">1584261397</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="comment"># at 910</span></span><br><span class="line"><span class="comment">#200315 16:36:37 server id 1  end_log_pos 938 Intvar</span></span><br><span class="line"><span class="keyword">SET</span> INSERT_ID=<span class="number">2</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="comment"># at 938</span></span><br><span class="line"><span class="comment">#200315 16:36:37 server id 1  end_log_pos 1077 Querythread_id=1201exec_time=0error_code=0</span></span><br><span class="line"><span class="keyword">use</span> <span class="string">`db01`</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="keyword">SET</span> <span class="built_in">TIMESTAMP</span>=<span class="number">1584261397</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="string">`db01`</span>.<span class="string">`student`</span> ( <span class="string">`id`</span>, <span class="string">`student_name`</span>) <span class="keyword">values</span> ( <span class="string">'0'</span>, <span class="string">'åˆ˜æ´‹'</span>)</span><br><span class="line"><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="comment"># at 1077</span></span><br><span class="line"><span class="comment">#200315 16:36:37 server id 1  end_log_pos 1104 Xid = 128</span></span><br><span class="line"><span class="keyword">COMMIT</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="comment"># at 1104</span></span><br><span class="line"><span class="comment">#200315 16:37:09 server id 1  end_log_pos 1172 Querythread_id=1201exec_time=0error_code=0</span></span><br><span class="line"><span class="keyword">SET</span> <span class="built_in">TIMESTAMP</span>=<span class="number">1584261429</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="comment"># at 1172</span></span><br><span class="line"><span class="comment">#200315 16:37:09 server id 1  end_log_pos 1200 Intvar</span></span><br><span class="line"><span class="keyword">SET</span> INSERT_ID=<span class="number">3</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="comment"># at 1200</span></span><br><span class="line"><span class="comment">#200315 16:37:09 server id 1  end_log_pos 1342 Querythread_id=1201exec_time=0error_code=0</span></span><br><span class="line"><span class="keyword">SET</span> <span class="built_in">TIMESTAMP</span>=<span class="number">1584261429</span><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="string">`db01`</span>.<span class="string">`student`</span> ( <span class="string">`id`</span>, <span class="string">`student_name`</span>) <span class="keyword">values</span> ( <span class="string">'0'</span>, <span class="string">'å¼ ä»å®¹'</span>)</span><br><span class="line"><span class="comment">/*!*/</span>;</span><br><span class="line"><span class="comment"># at 1342</span></span><br><span class="line"><span class="comment">#200315 16:37:09 server id 1  end_log_pos 1369 Xid = 146</span></span><br><span class="line"><span class="keyword">COMMIT</span><span class="comment">/*!*/</span>;</span><br><span class="line">DELIMITER ;</span><br><span class="line"><span class="comment"># End of log file</span></span><br><span class="line"><span class="keyword">ROLLBACK</span> <span class="comment">/* added by mysqlbinlog */</span>;</span><br><span class="line"><span class="comment">/*!50003 SET COMPLETION_TYPE=@OLD_COMPLETION_TYPE*/</span>;</span><br><span class="line"><span class="comment">/*!50530 SET @@SESSION.PSEUDO_SLAVE_MODE=0*/</span>;</span><br><span class="line">Sam-Mac:data Sam$</span><br></pre></td></tr></table></figure><h6 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h6><p>æ— è®ºæ˜¯å¢é‡å¤‡ä»½è¿˜æ˜¯ä¸»ä»å¤åˆ¶ï¼Œéƒ½æ˜¯éœ€è¦å¼€å¯mysql-binlogæ—¥å¿—ï¼Œæœ€å¥½è·Ÿæ•°æ®ç›®å½•è®¾ç½®åˆ°ä¸åŒçš„ç£ç›˜åˆ†åŒºï¼Œå¯ä»¥é™ä½ioç­‰å¾…ï¼Œæå‡æ€§èƒ½ï¼›<br>å¹¶ä¸”åœ¨ç£ç›˜æ•…éšœçš„æ—¶å€™å¯ä»¥åˆ©ç”¨mysql-binlogæ¢å¤æ•°æ®ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h6 id=&quot;ä»€ä¹ˆæ˜¯binlogï¼Ÿ&quot;&gt;&lt;a href=&quot;#ä»€ä¹ˆæ˜¯binlogï¼Ÿ&quot; class=&quot;headerlink&quot; title=&quot;ä»€ä¹ˆæ˜¯binlogï¼Ÿ&quot;&gt;&lt;/a&gt;ä»€ä¹ˆæ˜¯binlogï¼Ÿ&lt;/h6&gt;&lt;p&gt;mysql-binlogæ˜¯MySQLæ•°æ®åº“çš„äºŒè¿›åˆ¶æ—¥å¿—ï¼Œç”¨äºè®°å½•ç”¨æˆ·å¯¹æ•°æ®åº“æ“ä½œçš„SQLè¯­å¥ï¼ˆé™¤äº†æ•°æ®æŸ¥è¯¢è¯­å¥ï¼Œå³è®°å½•insertã€updateã€deleteçš„sqlï¼‰ä¿¡æ¯ã€‚&lt;br&gt;å¯ä»¥ä½¿ç”¨mysqlbinå‘½ä»¤æŸ¥çœ‹äºŒè¿›åˆ¶æ—¥å¿—çš„å†…å®¹ã€‚&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="mysql" scheme="https://ydstudios.gitee.io/tags/mysql/"/>
    
      <category term="binlog" scheme="https://ydstudios.gitee.io/tags/binlog/"/>
    
  </entry>
  
  <entry>
    <title>MySQL åˆ é™¤ relay log çš„æ–¹æ³•</title>
    <link href="https://ydstudios.gitee.io/post/da13f861.html"/>
    <id>https://ydstudios.gitee.io/post/da13f861.html</id>
    <published>2020-03-15T14:35:19.000Z</published>
    <updated>2020-12-18T13:59:10.000Z</updated>
    
    <content type="html"><![CDATA[<h6 id="æ–¹æ³•1-ï¼šè‡ªåŠ¨-è®¾ç½®å‚æ•°-relay-log-purge-1"><a href="#æ–¹æ³•1-ï¼šè‡ªåŠ¨-è®¾ç½®å‚æ•°-relay-log-purge-1" class="headerlink" title="æ–¹æ³•1 ï¼šè‡ªåŠ¨ è®¾ç½®å‚æ•° relay_log_purge = 1"></a>æ–¹æ³•1 ï¼šè‡ªåŠ¨ è®¾ç½®å‚æ•° relay_log_purge = 1</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> SET GLOBAL relay_log_purge = 1;</span></span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line">æˆ–è€…åœ¨/etc/my.cnf [mysqld]æ¨¡å—ä¸‹é¢å¢åŠ ä»¥ä¸‹å†…å®¹</span><br><span class="line">relay-log-purge = 1</span><br></pre></td></tr></table></figure><a id="more"></a><p>è¿™ä¸ªå‚æ•°éœ€è¦é‡å¯æ•°æ®åº“æ‰å¯ç”Ÿæ•ˆã€‚é»˜è®¤æƒ…å†µä¸‹relay-log-purge æ˜¯å¼€å¯çš„ã€‚<br>å¦‚æœä½ å¯¹ä»æ•°æ®åº“è¦æ±‚ä¸é«˜ï¼Œå¯ä»¥å°†relay_log_purge = 1ã€‚<br>å¦‚æœæ•°æ®åº“è¦æ‰‹åŠ¨åˆ é™¤relay logè¯·æ‰§è¡Œ SET GLOBAL relay_log_purge=0ã€‚<br>æˆ–è€…åœ¨/etc/my.cnf</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> [mysqld]æ¨¡å—ä¸‹é¢å¢åŠ ä»¥ä¸‹å†…å®¹</span></span><br><span class="line">relay-log-purge = 0</span><br></pre></td></tr></table></figure><p>æ¨¡æ‹Ÿåœºæ™¯ï¼š<br>1ï¼‰ä»åº“æŸ¥çœ‹relay logæƒ…å†µ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@aliyun1212 data]# ll</span><br><span class="line">total 5255240</span><br><span class="line">-rw-r----- 1 mysql mysql         56 Aug 18 15:40 auto.cnf</span><br><span class="line">-rw-r----- 1 mysql mysql        207 Aug 23 16:06 mysqld-relay-bin.000032</span><br><span class="line">-rw-r----- 1 mysql mysql        344 Aug 23 18:14 mysqld-relay-bin.000033</span><br><span class="line">-rw-r----- 1 mysql mysql        207 Aug 23 18:14 mysqld-relay-bin.000034</span><br><span class="line">-rw-r----- 1 mysql mysql        321 Aug 23 18:14 mysqld-relay-bin.000035</span><br><span class="line">-rw-r----- 1 mysql mysql        100 Aug 23 18:14 mysqld-relay-bin.index</span><br></pre></td></tr></table></figure><p>2ï¼‰ä»åº“æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> SET GLOBAL relay_log_purge = 1;</span></span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> show variables like <span class="string">'relay_log_purge'</span>;</span></span><br><span class="line">+-----------------+-------+</span><br><span class="line">| Variable_name   | Value |</span><br><span class="line">+-----------------+-------+</span><br><span class="line">| relay_log_purge | ON    |</span><br><span class="line">+-----------------+-------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure><p>3ï¼‰ä¸»åº“æ‰§è¡Œflush logs;</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> flush logs;</span></span><br><span class="line">Query OK, 0 rows affected (0.12 sec)</span><br></pre></td></tr></table></figure><p>ç”Ÿæˆæ–°çš„binlog<br>4ï¼‰ä»åº“æŸ¥çœ‹relay log æƒ…å†µ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@aliyun1212 data]# ll</span><br><span class="line">total 5255232</span><br><span class="line">-rw-r----- 1 mysql mysql         56 Aug 18 15:40 auto.cnf</span><br><span class="line">-rw-r----- 1 mysql mysql        255 Aug 26 03:16 mysqld-relay-bin.000036</span><br><span class="line">-rw-r----- 1 mysql mysql        369 Aug 26 03:16 mysqld-relay-bin.000037</span><br><span class="line">-rw-r----- 1 mysql mysql         50 Aug 26 03:16 mysqld-relay-bin.index</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ä»åº“çš„relay log è‡ªåŠ¨åˆ é™¤åªä¿ç•™æœ€è¿‘çš„ä¸¤ä¸ªrelay logã€‚è¯´æ˜ä¸‹å¦‚æœä»åº“åŒæ­¥å‡ºç°é—®é¢˜ï¼Œæ²¡æœ‰åº”ç”¨çš„relay log ä¹Ÿä¸ä¼šè‡ªåŠ¨åˆ é™¤relay logã€‚ç›´åˆ°è§£å†³æ‰é”™è¯¯ï¼Œå¦åˆ™relay log ä¼šè¶ŠæŒ¤è¶Šå¤šã€‚</p><h6 id="æ–¹æ³•2ï¼šæ‰‹åŠ¨-rm-rf-åˆ é™¤reloy-log"><a href="#æ–¹æ³•2ï¼šæ‰‹åŠ¨-rm-rf-åˆ é™¤reloy-log" class="headerlink" title="æ–¹æ³•2ï¼šæ‰‹åŠ¨ rm -rf åˆ é™¤reloy log"></a>æ–¹æ³•2ï¼šæ‰‹åŠ¨ rm -rf åˆ é™¤reloy log</h6><p>1ï¼‰æŸ¥çœ‹ä»åº“</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@aliyun1212 data]# ll</span><br><span class="line">total 5255256</span><br><span class="line">-rw-r----- 1 mysql mysql         56 Aug 18 15:40 auto.cnf</span><br><span class="line">-rw-r----- 1 mysql mysql        255 Aug 26 03:16 mysqld-relay-bin.000036</span><br><span class="line">-rw-r----- 1 mysql mysql        422 Aug 26 03:27 mysqld-relay-bin.000037</span><br><span class="line">-rw-r----- 1 mysql mysql        255 Aug 26 03:27 mysqld-relay-bin.000038</span><br><span class="line">-rw-r----- 1 mysql mysql        683 Aug 26 03:27 mysqld-relay-bin.000039</span><br><span class="line">-rw-r----- 1 mysql mysql        255 Aug 26 03:27 mysqld-relay-bin.000040</span><br><span class="line">-rw-r----- 1 mysql mysql        683 Aug 26 03:27 mysqld-relay-bin.000041</span><br><span class="line">-rw-r----- 1 mysql mysql        255 Aug 26 03:27 mysqld-relay-bin.000042</span><br><span class="line">-rw-r----- 1 mysql mysql        369 Aug 26 03:27 mysqld-relay-bin.000043</span><br><span class="line">-rw-r----- 1 mysql mysql        200 Aug 26 03:27 mysqld-relay-bin.index</span><br></pre></td></tr></table></figure><p>2ï¼‰ä»åº“æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@aliyun1212 data]# rm -rf mysqld-relay-bin.000036 mysqld-relay-bin.37 mysqld-relay-bin.38</span><br><span class="line">[root@aliyun1212 data]# ll</span><br><span class="line">total 5255244</span><br><span class="line">-rw-r----- 1 mysql mysql         56 Aug 18 15:40 auto.cnf</span><br><span class="line">-rw-r----- 1 mysql mysql        683 Aug 26 03:27 mysqld-relay-bin.000039</span><br><span class="line">-rw-r----- 1 mysql mysql        255 Aug 26 03:27 mysqld-relay-bin.000040</span><br><span class="line">-rw-r----- 1 mysql mysql        683 Aug 26 03:27 mysqld-relay-bin.000041</span><br><span class="line">-rw-r----- 1 mysql mysql        255 Aug 26 03:27 mysqld-relay-bin.000042</span><br><span class="line">-rw-r----- 1 mysql mysql        369 Aug 26 03:27 mysqld-relay-bin.000043</span><br><span class="line">-rw-r----- 1 mysql mysql        200 Aug 26 03:27 mysqld-relay-bin.index</span><br></pre></td></tr></table></figure><p>ä»åº“æ“ä½œç³»ç»Ÿå±‚é¢rm relay log ä¸»åº“æ›´æ–°æ•°æ®ä»åº“å¯ä»¥ç»§ç»­åŒæ­¥ï¼š<br>ä¸»åº“æ“ä½œï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> insert into <span class="built_in">test</span> values(13,<span class="string">'ff'</span>);</span></span><br><span class="line">Query OK, 1 row affected (0.44 sec)</span><br></pre></td></tr></table></figure><p>ä»åº“å¯ä»¥çœ‹åˆ°æ•°æ®è¢«åŒæ­¥</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> select * from <span class="built_in">test</span>;</span></span><br><span class="line">+----+------+</span><br><span class="line">| id | name |</span><br><span class="line">+----+------+</span><br><span class="line">|  1 | abc  |</span><br><span class="line">|  4 | cc   |</span><br><span class="line">|  5 | dd   |</span><br><span class="line">|  6 | ee   |</span><br><span class="line">|  7 | ee   |</span><br><span class="line">|  8 | ee   |</span><br><span class="line">|  9 | ff   |</span><br><span class="line">| 10 | ff   |</span><br><span class="line">| 11 | ff   |</span><br><span class="line">| 12 | ff   |</span><br><span class="line">| 13 | ff   |</span><br><span class="line">+----+------+</span><br></pre></td></tr></table></figure><p>å¦‚æœæ­¤æ—¶ stop slave<br>ç„¶ååœ¨æ‰§è¡Œstart slave ,ä¼šæç¤ºä»¥ä¸‹é”™è¯¯ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> start slave;</span></span><br><span class="line">ERROR 1872 (HY000): Slave failed to initialize relay log info structure from the repository</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶è¦æ‰§è¡Œæ­¥éª¤3<br>3ï¼‰ç¼–è¾‘æ–‡ä»¶mysqld-relay-bin.index åˆ é™¤åˆšæ‰åˆ é™¤çš„relay log mysqld-relay-bin.000039ä¹‹å‰çš„ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@aliyun1212 data]# vi mysqld-relay-bin.index </span><br><span class="line">./mysqld-relay-bin.000039</span><br><span class="line">./mysqld-relay-bin.000040</span><br><span class="line">./mysqld-relay-bin.000041</span><br><span class="line">./mysqld-relay-bin.000042</span><br><span class="line">./mysqld-relay-bin.000043</span><br></pre></td></tr></table></figure><p>å†æ¬¡å¯åŠ¨start slave</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> start slave;</span></span><br><span class="line">ERROR 1872 (HY000): Slave failed to initialize relay log info structure from the repository</span><br></pre></td></tr></table></figure><p>è¿˜æ˜¯ä¼šæŠ¥é”™ã€‚<br>æ­¤æ—¶å¿…é¡»é‡å¯ä»åº“mysql æ•°æ®åº“</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@aliyun1212 ~]# service mysql restart</span><br><span class="line">Shutting down MySQL..                                      [  OK  ]</span><br><span class="line">Starting MySQL....                                         [  OK  ]</span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ä»åº“çŠ¶æ€æ­£å¸¸</span></span><br><span class="line"></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> show slave status/G</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h6 id=&quot;æ–¹æ³•1-ï¼šè‡ªåŠ¨-è®¾ç½®å‚æ•°-relay-log-purge-1&quot;&gt;&lt;a href=&quot;#æ–¹æ³•1-ï¼šè‡ªåŠ¨-è®¾ç½®å‚æ•°-relay-log-purge-1&quot; class=&quot;headerlink&quot; title=&quot;æ–¹æ³•1 ï¼šè‡ªåŠ¨ è®¾ç½®å‚æ•° relay_log_purge = 1&quot;&gt;&lt;/a&gt;æ–¹æ³•1 ï¼šè‡ªåŠ¨ è®¾ç½®å‚æ•° relay_log_purge = 1&lt;/h6&gt;&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;mysql&amp;gt;&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; SET GLOBAL relay_log_purge = 1;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Query OK, 0 rows affected (0.00 sec)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;æˆ–è€…åœ¨/etc/my.cnf [mysqld]æ¨¡å—ä¸‹é¢å¢åŠ ä»¥ä¸‹å†…å®¹&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;relay-log-purge = 1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
    
      <category term="mysql" scheme="https://ydstudios.gitee.io/tags/mysql/"/>
    
      <category term="relay-log" scheme="https://ydstudios.gitee.io/tags/relay-log/"/>
    
  </entry>
  
  <entry>
    <title>åˆ©ç”¨Macç”µè„‘è‡ªå¸¦åº”ç”¨å°†iPhoneæŠ•å±åˆ°Macç”µè„‘çš„æ•™ç¨‹</title>
    <link href="https://ydstudios.gitee.io/post/29afd8a9.html"/>
    <id>https://ydstudios.gitee.io/post/29afd8a9.html</id>
    <published>2020-03-10T12:40:32.000Z</published>
    <updated>2020-03-10T07:01:03.000Z</updated>
    
    <content type="html"><![CDATA[<p>ä½ åªéœ€è¦å‡†å¤‡ä¸€æ ¹USBæ•°æ®çº¿ï¼Œä¹Ÿå°±æ˜¯æ‰‹æœºçš„å……ç”µçº¿å³å¯ï¼Œæœ€å¥½æ˜¯åŸè£…çš„USBçº¿ã€‚</p><a id="more"></a><h4 id="æ‰‹æœºé€šè¿‡USBçº¿è¿æ¥ç”µè„‘"><a href="#æ‰‹æœºé€šè¿‡USBçº¿è¿æ¥ç”µè„‘" class="headerlink" title="æ‰‹æœºé€šè¿‡USBçº¿è¿æ¥ç”µè„‘"></a>æ‰‹æœºé€šè¿‡USBçº¿è¿æ¥ç”µè„‘</h4><p>å¦‚æœæ‰‹æœºæ˜¯ç¬¬ä¸€æ¬¡æ’ä¸Šè¿™å°ç”µè„‘å¯èƒ½ä¼šå¼¹å‡ºä¿¡ä»»ç­‰å¼¹æ¡†ï¼Œæ‰‹æœºç«¯ç‚¹å‡»ã€ä¿¡ä»»ã€‘ï¼Œç”µè„‘ç«¯ç‚¹å‡»ã€ç»§ç»­ã€‘ã€‚<br>æ€»çš„æ¥è¯´ï¼Œå°±æ˜¯å…è®¸ç”µè„‘è®¿é—®æ‰‹æœºã€‚</p><h4 id="æ‰“å¼€Mac-ç³»ç»Ÿè‡ªå¸¦çš„æ’­æ”¾å™¨QuickTime-Player"><a href="#æ‰“å¼€Mac-ç³»ç»Ÿè‡ªå¸¦çš„æ’­æ”¾å™¨QuickTime-Player" class="headerlink" title="æ‰“å¼€Mac ç³»ç»Ÿè‡ªå¸¦çš„æ’­æ”¾å™¨QuickTime Player"></a>æ‰“å¼€Mac ç³»ç»Ÿè‡ªå¸¦çš„æ’­æ”¾å™¨QuickTime Player</h4><p>ç›´æ¥command + ç©ºæ ¼é”® è°ƒå‡ºSpotLight æœç´¢ â€œQuickTimeâ€ï¼Œå³å¯è°ƒå‡ºQuickTime Playeræ’­æ”¾å™¨ã€‚</p><h4 id="èœå•æ ã€æ–‡ä»¶ã€‘â€“-gt-ã€æ–°å»ºå½±ç‰‡å½•åˆ¶ã€‘"><a href="#èœå•æ ã€æ–‡ä»¶ã€‘â€“-gt-ã€æ–°å»ºå½±ç‰‡å½•åˆ¶ã€‘" class="headerlink" title="èœå•æ ã€æ–‡ä»¶ã€‘â€“&gt;ã€æ–°å»ºå½±ç‰‡å½•åˆ¶ã€‘"></a>èœå•æ ã€æ–‡ä»¶ã€‘â€“&gt;ã€æ–°å»ºå½±ç‰‡å½•åˆ¶ã€‘</h4><p>æ‰“å¼€ã€QuickTime Playerã€‘åï¼Œåœ¨å·¦ä¸Šè§’çš„èœå•æ ä¸­ã€æ–‡ä»¶ã€‘èœå•ï¼Œæ‰¾åˆ°ç¬¬ä¸€é¡¹ã€æ–°å»ºå½±ç‰‡å½•åˆ¶ã€‘ã€‚</p><h4 id="æ›´æ”¹æ‘„åƒå¤´é€‰é¡¹ï¼Œé€‰ä¸­æ‰‹æœºå³å¯ã€‚"><a href="#æ›´æ”¹æ‘„åƒå¤´é€‰é¡¹ï¼Œé€‰ä¸­æ‰‹æœºå³å¯ã€‚" class="headerlink" title="æ›´æ”¹æ‘„åƒå¤´é€‰é¡¹ï¼Œé€‰ä¸­æ‰‹æœºå³å¯ã€‚"></a>æ›´æ”¹æ‘„åƒå¤´é€‰é¡¹ï¼Œé€‰ä¸­æ‰‹æœºå³å¯ã€‚</h4><p>ç‚¹å‡»ã€æ–°å»ºå½±ç‰‡å½•åˆ¶ã€‘åï¼Œæ­¤æ—¶é»˜è®¤æ˜¯æ‰“å¼€çš„ç”µè„‘è‡ªå¸¦çš„æ‘„åƒå¤´ï¼Œæ­¤æ—¶å¯ä»¥æ›´æ–°æ‘„åƒå¤´çš„æ¥æºå’Œéº¦å…‹é£æ¥æºã€‚<br>æ¨èç›¸æœºé€‰æ‹©iPhoneçš„ï¼Œéº¦å…‹é£é€‰æ‹©å†…ç½®éº¦å…‹é£ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä½ åªéœ€è¦å‡†å¤‡ä¸€æ ¹USBæ•°æ®çº¿ï¼Œä¹Ÿå°±æ˜¯æ‰‹æœºçš„å……ç”µçº¿å³å¯ï¼Œæœ€å¥½æ˜¯åŸè£…çš„USBçº¿ã€‚&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="MAC" scheme="https://ydstudios.gitee.io/tags/MAC/"/>
    
      <category term="iPhone" scheme="https://ydstudios.gitee.io/tags/iPhone/"/>
    
      <category term="æŠ•å±" scheme="https://ydstudios.gitee.io/tags/%E6%8A%95%E5%B1%8F/"/>
    
  </entry>
  
  <entry>
    <title>JVMé…ç½®å‚æ•°çš„ç±»å‹</title>
    <link href="https://ydstudios.gitee.io/post/ea8be9c5.html"/>
    <id>https://ydstudios.gitee.io/post/ea8be9c5.html</id>
    <published>2020-02-06T15:55:13.000Z</published>
    <updated>2020-02-06T07:57:04.000Z</updated>
    
    <content type="html"><![CDATA[<h5 id="å‚æ•°åç§°çš„è¯´æ˜"><a href="#å‚æ•°åç§°çš„è¯´æ˜" class="headerlink" title="å‚æ•°åç§°çš„è¯´æ˜"></a>å‚æ•°åç§°çš„è¯´æ˜</h5><p>JVMé…ç½®å‚æ•°åˆ†åˆ«ç”¨äºè·Ÿè¸ªç›‘æ§JVMçŠ¶æ€ï¼Œåˆ†é…å †å†…å­˜ä»¥åŠåˆ†é…æ ˆå†…å­˜ã€‚æŒ‰ç…§ç±»å‹åˆ†ä¸ºä¸‰ç±»æ ‡å‡†å‚æ•°ã€éæ ‡å‡†å‚æ•°å’Œéç¨³å®šå‚æ•°</p><a id="more"></a><h6 id="æ ‡å‡†å‚æ•°"><a href="#æ ‡å‡†å‚æ•°" class="headerlink" title="æ ‡å‡†å‚æ•°(-)"></a>æ ‡å‡†å‚æ•°(-)</h6><p>æ‰€æœ‰ JVM éƒ½å¿…é¡»æ”¯æŒè¿™äº›å‚æ•°çš„åŠŸèƒ½, è€Œä¸”å‘åå…¼å®¹, å¦‚:</p><ul><li><p>-client : è®¾ç½® JVM ä½¿ç”¨ client æ¨¡å¼, ç‰¹ç‚¹æ˜¯å¯åŠ¨é€Ÿåº¦æ¯”è¾ƒå¿«, ä½†è¿è¡Œæ—¶æ€§èƒ½å’Œå†…å­˜ç®¡ç†æ•ˆç‡ä¸é«˜. é€šå¸¸ç”¨äºå®¢æˆ·ç«¯åº”ç”¨ç¨‹åºæˆ–å¼€å‘è°ƒè¯•; åœ¨32ä½ç¯å¢ƒä¸‹ç›´æ¥è¿è¡Œ Java ç¨‹åºé»˜è®¤å¯ç”¨è¯¥æ¨¡å¼.</p></li><li><p>-server : è®¾ç½® JVM ä½¿ server æ¨¡å¼, ç‰¹ç‚¹æ˜¯å¯åŠ¨é€Ÿåº¦æ¯”è¾ƒæ…¢, ä½†è¿è¡Œæ—¶æ€§èƒ½å’Œå†…å­˜ç®¡ç†æ•ˆç‡å¾ˆé«˜, é€‚ç”¨äºç”Ÿäº§ç¯å¢ƒ; åœ¨å…·æœ‰64ä½èƒ½åŠ›çš„JDKç¯å¢ƒä¸‹é»˜è®¤å¯ç”¨è¯¥æ¨¡å¼.</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Sam-Mac:hexo-blog Sam$ java -version</span><br><span class="line">java version <span class="string">"1.8.0_74"</span></span><br><span class="line">Java(TM) SE Runtime Environment (build 1.8.0_74-b02)</span><br><span class="line">Java HotSpot(TM) 64-Bit Server VM (build 25.74-b02, mixed mode)</span><br><span class="line">Sam-Mac:hexo-blog Sam$</span><br></pre></td></tr></table></figure><h6 id="éæ ‡å‡†å‚æ•°-X"><a href="#éæ ‡å‡†å‚æ•°-X" class="headerlink" title="éæ ‡å‡†å‚æ•°(-X)"></a>éæ ‡å‡†å‚æ•°(-X)</h6><p>å„ JVM å‚å•†åº”è¯¥éƒ½å®ç°è¿™äº›å‚æ•°çš„åŠŸèƒ½, ä½†æ˜¯å¹¶ä¸ä¿è¯æ‰€æœ‰çš„ JVM å®ç°éƒ½æ»¡è¶³, ä¸”ä¸ä¿è¯å‘åå…¼å®¹ã€‚è¿™äº›ç”¨çš„ä¸å¤šï¼Œçœ‹çœ‹å°±å¥½ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// è§£é‡Šæ‰§è¡Œ</span><br><span class="line">-Xint</span><br><span class="line"></span><br><span class="line">// ç¬¬ä¸€æ¬¡ä½¿ç”¨å°±ç¼–è¯‘æˆæœ¬åœ°ä»£ç </span><br><span class="line">-Xcomp</span><br><span class="line"></span><br><span class="line">// æ··åˆæ¨¡å¼</span><br><span class="line">-Xmixed</span><br></pre></td></tr></table></figure><h6 id="éç¨³å®šå‚æ•°-XX"><a href="#éç¨³å®šå‚æ•°-XX" class="headerlink" title="éç¨³å®šå‚æ•°(-XX)"></a>éç¨³å®šå‚æ•°(-XX)</h6><p>æ­¤ç±»å‚æ•°å„ä¸ªJVMå®ç°ä¼šæœ‰æ‰€ä¸åŒ, å°†æ¥å¯èƒ½ä¼šä¸è¢«æ”¯æŒ, éœ€è¦æ…é‡ä½¿ç”¨ã€‚è¿™ç§ç±»å‹çš„å‚æ•°è‡ªå·±åˆå¯åˆ†ä¸ºä¸¤ç§ï¼Œåˆ†åˆ«å¦‚ä¸‹ï¼š</p><ul><li><p>å¸ƒå°”ç±»å‹ã€‚ -XX:+ æˆ–è€… - æŸä¸ªå±æ€§å€¼ï¼Œ+ è¡¨ç¤ºå¼€å¯ï¼Œ-è¡¨ç¤ºå…³é—­ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// æ‰“å°GCè¯¦ç»†ä¿¡æ¯</span><br><span class="line">-XX:+PrintGCDetails</span><br><span class="line"></span><br><span class="line">// ä¸æ‰“å°GCè¯¦ç»†ä¿¡æ¯</span><br><span class="line">-XX:-PrintGCDetails</span><br></pre></td></tr></table></figure></li><li><p>KVç±»å‹ã€‚-XX:å±æ€§key=å±æ€§å€¼valueï¼Œä¾‹å¦‚ï¼š</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// è®¾ç½®Metaspaceçš„å¤§å°</span><br><span class="line">-XX:MetaspaceSize=1024m</span><br></pre></td></tr></table></figure><p>æ³¨æ„: åœ¨â€-XX:â€åçš„å‚æ•°è‹¥ä¸éœ€è¦èµ‹å€¼, å³åªæ˜¯ç”¨æ¥é…ç½®å¼€å¯æˆ–å…³é—­ç›¸åº”é€‰é¡¹, åˆ™éœ€è¦æœ‰ â€œ+â€ (å¼€å¯) æˆ– â€œ-â€œ (ç¦æ­¢) , å¦åˆ™åº”ç”¨ç¨‹åºå°†åœ¨æ—¥å¿—æ–‡ä»¶ (å¦‚ Tomcat çš„æ—¥å¿—æ–‡ä»¶ catalina.out ) ä¸­æŠ›å‡ºå¦‚ä¸‹é”™è¯¯:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Missing +/- setting <span class="keyword">for</span> VM option <span class="string">'UseConcMarkSweepGC'</span>. </span><br><span class="line">Error: Could not create the Java Virtual Machine.</span><br><span class="line">Error: A fatal exception has occurred. Program will <span class="built_in">exit</span>.</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡º, è¿™é‡Œç¼ºå°‘äº† â€œ+/-â€œ ç¬¦å·, å¯¼è‡´è™šæ‹Ÿæœºå¯åŠ¨å¼‚å¸¸, ä¿®æ”¹åå³å¯æ­£å¸¸å¯åŠ¨.</p><p>æˆ‘ä»¬å¸¸è®¾ç½®çš„JVMå‚æ•°Xmså’ŒXmx,å±äºå“ªç§ç±»å‹çš„JVMå‚æ•°ï¼Ÿ-Xmsç­‰ä»·äº-XX:InitialHeapSize,-Xmxç­‰ä»·äº-XX:MaxHeapSizeï¼Œæ‰€ä»¥ä»–ä»¬éƒ½æ˜¯XXç±»å‹å‚æ•°ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h5 id=&quot;å‚æ•°åç§°çš„è¯´æ˜&quot;&gt;&lt;a href=&quot;#å‚æ•°åç§°çš„è¯´æ˜&quot; class=&quot;headerlink&quot; title=&quot;å‚æ•°åç§°çš„è¯´æ˜&quot;&gt;&lt;/a&gt;å‚æ•°åç§°çš„è¯´æ˜&lt;/h5&gt;&lt;p&gt;JVMé…ç½®å‚æ•°åˆ†åˆ«ç”¨äºè·Ÿè¸ªç›‘æ§JVMçŠ¶æ€ï¼Œåˆ†é…å †å†…å­˜ä»¥åŠåˆ†é…æ ˆå†…å­˜ã€‚æŒ‰ç…§ç±»å‹åˆ†ä¸ºä¸‰ç±»æ ‡å‡†å‚æ•°ã€éæ ‡å‡†å‚æ•°å’Œéç¨³å®šå‚æ•°&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="Jvm" scheme="https://ydstudios.gitee.io/tags/Jvm/"/>
    
  </entry>
  
  <entry>
    <title>Springé…ç½®æ–‡ä»¶ä¸­çš„classpath:å’Œclasspath*:çš„åŒºåˆ«</title>
    <link href="https://ydstudios.gitee.io/post/38b6491c.html"/>
    <id>https://ydstudios.gitee.io/post/38b6491c.html</id>
    <published>2020-01-28T22:46:48.000Z</published>
    <updated>2020-01-28T14:53:41.000Z</updated>
    
    <content type="html"><![CDATA[<p> classpathæ˜¯springçš„å†™æ³•ï¼Œclasspathæ˜¯æŒ‡WEB-INFæ–‡ä»¶å¤¹ä¸‹çš„classesç›®å½•ï¼Œå¯¹åº”æºä»£ç srcç›®å½•ï¼Œç”¨äºå­˜æ”¾ä»srcä¸­æ‹·è´è¿‡å»çš„å„ç§é…ç½®æ–‡ä»¶ï¼Œä»¥åŠç¼–è¯‘è¿‡åçš„classæ–‡ä»¶ã€‚Springå¯ä»¥é€šè¿‡æŒ‡å®šclasspath*:ä¸classpath:å‰ç¼€åŠ ä¸Šè·¯å¾„çš„æ–¹å¼ä»classpathåŠ è½½é…ç½®æ–‡ä»¶ã€‚</p><a id="more"></a><h5 id="classpath-çš„å…·ä½“å«ä¹‰"><a href="#classpath-çš„å…·ä½“å«ä¹‰" class="headerlink" title="classpath: çš„å…·ä½“å«ä¹‰"></a>classpath: çš„å…·ä½“å«ä¹‰</h5><p>classpath:è¡¨ç¤ºä»ç±»è·¯å¾„ä¸­åŠ è½½èµ„æºï¼Œclasspath:å’Œclasspath:/æ˜¯ç­‰ä»·çš„ï¼Œéƒ½æ˜¯ç›¸å¯¹äºç±»çš„æ ¹è·¯å¾„ã€‚èµ„æºæ–‡ä»¶åº“æ ‡å‡†çš„åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œä¹Ÿå¯ä»¥åœ¨JARæˆ–ZIPçš„ç±»åŒ…ä¸­ã€‚</p><h5 id="classpath-çš„å…·ä½“å«ä¹‰-1"><a href="#classpath-çš„å…·ä½“å«ä¹‰-1" class="headerlink" title="classpath*: çš„å…·ä½“å«ä¹‰"></a>classpath*: çš„å…·ä½“å«ä¹‰</h5><p>classpath*:ï¼šå‡è®¾å¤šä¸ªJARåŒ…æˆ–æ–‡ä»¶ç³»ç»Ÿç±»è·¯å¾„éƒ½æœ‰ä¸€ä¸ªç›¸åŒçš„é…ç½®æ–‡ä»¶ï¼Œclasspath:åªä¼šåœ¨ç¬¬ä¸€ä¸ªåŠ è½½çš„ç±»è·¯å¾„ä¸‹æŸ¥æ‰¾ï¼Œè€Œclasspath:ä¼šæ‰«ææ‰€æœ‰è¿™äº›JARåŒ…åŠç±»è·¯å¾„ä¸‹å‡ºç°çš„åŒåæ–‡ä»¶ã€‚</p><h5 id="å…·ä½“ä¾‹å­å¦‚ä¸‹"><a href="#å…·ä½“ä¾‹å­å¦‚ä¸‹" class="headerlink" title="å…·ä½“ä¾‹å­å¦‚ä¸‹"></a>å…·ä½“ä¾‹å­å¦‚ä¸‹</h5><ul><li>classpath:applicationContext.xmlï¼ŒåŒ¹é…classpathä¸‹çš„æŒ‡å®šæ–‡ä»¶         </li><li>classpath:/spring/applicationContext.xmlï¼ŒåŒ¹é…classpathå­ç›®å½•ä¸‹çš„æŒ‡å®šæ–‡ä»¶</li><li>classpath:spring-*.xmlï¼ŒåŒ¹é…classpathä¸‹çš„æŒ‡å®šå‰ç¼€çš„æ–‡ä»¶</li><li>classpath:<em>*/spring-</em>.xmlï¼ŒåŒ¹é…classpathä¸‹æ‰€æœ‰ç›®å½•ä¸‹çš„æŒ‡å®šå‰ç¼€çš„æ–‡ä»¶</li><li>classpath<em>:**/spring-</em>.xmlï¼ŒåŒ¹é…å½“å‰classpathå’Œjarä¸­classpathä¸‹æ‰€æœ‰ç›®å½•ä¸‹çš„æŒ‡å®šå‰ç¼€çš„æ–‡ä»¶</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt; classpathæ˜¯springçš„å†™æ³•ï¼Œclasspathæ˜¯æŒ‡WEB-INFæ–‡ä»¶å¤¹ä¸‹çš„classesç›®å½•ï¼Œå¯¹åº”æºä»£ç srcç›®å½•ï¼Œç”¨äºå­˜æ”¾ä»srcä¸­æ‹·è´è¿‡å»çš„å„ç§é…ç½®æ–‡ä»¶ï¼Œä»¥åŠç¼–è¯‘è¿‡åçš„classæ–‡ä»¶ã€‚Springå¯ä»¥é€šè¿‡æŒ‡å®šclasspath*:ä¸classpath:å‰ç¼€åŠ ä¸Šè·¯å¾„çš„æ–¹å¼ä»classpathåŠ è½½é…ç½®æ–‡ä»¶ã€‚&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="spring" scheme="https://ydstudios.gitee.io/tags/spring/"/>
    
  </entry>
  
</feed>
